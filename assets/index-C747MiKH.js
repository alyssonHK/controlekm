(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function By(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var h1={exports:{}},Pu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N_;function F4(){if(N_)return Pu;N_=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,o){var u=null;if(o!==void 0&&(u=""+o),s.key!==void 0&&(u=""+s.key),"key"in s){o={};for(var h in s)h!=="key"&&(o[h]=s[h])}else o=s;return s=o.ref,{$$typeof:r,type:i,key:u,ref:s!==void 0?s:null,props:o}}return Pu.Fragment=e,Pu.jsx=t,Pu.jsxs=t,Pu}var O_;function P4(){return O_||(O_=1,h1.exports=F4()),h1.exports}var z=P4(),d1={exports:{}},nt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_;function L4(){if(I_)return nt;I_=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.iterator;function y(W){return W===null||typeof W!="object"?null:(W=x&&W[x]||W["@@iterator"],typeof W=="function"?W:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,S={};function w(W,xe,V){this.props=W,this.context=xe,this.refs=S,this.updater=V||T}w.prototype.isReactComponent={},w.prototype.setState=function(W,xe){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,xe,"setState")},w.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function G(){}G.prototype=w.prototype;function Z(W,xe,V){this.props=W,this.context=xe,this.refs=S,this.updater=V||T}var K=Z.prototype=new G;K.constructor=Z,b(K,w.prototype),K.isPureReactComponent=!0;var ne=Array.isArray,pe={H:null,A:null,T:null,S:null,V:null},Re=Object.prototype.hasOwnProperty;function N(W,xe,V,X,q,Q){return V=Q.ref,{$$typeof:r,type:W,key:xe,ref:V!==void 0?V:null,props:Q}}function D(W,xe){return N(W.type,xe,void 0,void 0,void 0,W.props)}function R(W){return typeof W=="object"&&W!==null&&W.$$typeof===r}function k(W){var xe={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(V){return xe[V]})}var F=/\/+/g;function B(W,xe){return typeof W=="object"&&W!==null&&W.key!=null?k(""+W.key):xe.toString(36)}function P(){}function qe(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(P,P):(W.status="pending",W.then(function(xe){W.status==="pending"&&(W.status="fulfilled",W.value=xe)},function(xe){W.status==="pending"&&(W.status="rejected",W.reason=xe)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function Be(W,xe,V,X,q){var Q=typeof W;(Q==="undefined"||Q==="boolean")&&(W=null);var oe=!1;if(W===null)oe=!0;else switch(Q){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(W.$$typeof){case r:case e:oe=!0;break;case v:return oe=W._init,Be(oe(W._payload),xe,V,X,q)}}if(oe)return q=q(W),oe=X===""?"."+B(W,0):X,ne(q)?(V="",oe!=null&&(V=oe.replace(F,"$&/")+"/"),Be(q,xe,V,"",function(Ne){return Ne})):q!=null&&(R(q)&&(q=D(q,V+(q.key==null||W&&W.key===q.key?"":(""+q.key).replace(F,"$&/")+"/")+oe)),xe.push(q)),1;oe=0;var de=X===""?".":X+":";if(ne(W))for(var ve=0;ve<W.length;ve++)X=W[ve],Q=de+B(X,ve),oe+=Be(X,xe,V,Q,q);else if(ve=y(W),typeof ve=="function")for(W=ve.call(W),ve=0;!(X=W.next()).done;)X=X.value,Q=de+B(X,ve++),oe+=Be(X,xe,V,Q,q);else if(Q==="object"){if(typeof W.then=="function")return Be(qe(W),xe,V,X,q);throw xe=String(W),Error("Objects are not valid as a React child (found: "+(xe==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":xe)+"). If you meant to render a collection of children, use an array instead.")}return oe}function J(W,xe,V){if(W==null)return W;var X=[],q=0;return Be(W,X,"","",function(Q){return xe.call(V,Q,q++)}),X}function ye(W){if(W._status===-1){var xe=W._result;xe=xe(),xe.then(function(V){(W._status===0||W._status===-1)&&(W._status=1,W._result=V)},function(V){(W._status===0||W._status===-1)&&(W._status=2,W._result=V)}),W._status===-1&&(W._status=0,W._result=xe)}if(W._status===1)return W._result.default;throw W._result}var Pe=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var xe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(xe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)};function He(){}return nt.Children={map:J,forEach:function(W,xe,V){J(W,function(){xe.apply(this,arguments)},V)},count:function(W){var xe=0;return J(W,function(){xe++}),xe},toArray:function(W){return J(W,function(xe){return xe})||[]},only:function(W){if(!R(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},nt.Component=w,nt.Fragment=t,nt.Profiler=s,nt.PureComponent=Z,nt.StrictMode=i,nt.Suspense=g,nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=pe,nt.__COMPILER_RUNTIME={__proto__:null,c:function(W){return pe.H.useMemoCache(W)}},nt.cache=function(W){return function(){return W.apply(null,arguments)}},nt.cloneElement=function(W,xe,V){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var X=b({},W.props),q=W.key,Q=void 0;if(xe!=null)for(oe in xe.ref!==void 0&&(Q=void 0),xe.key!==void 0&&(q=""+xe.key),xe)!Re.call(xe,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&xe.ref===void 0||(X[oe]=xe[oe]);var oe=arguments.length-2;if(oe===1)X.children=V;else if(1<oe){for(var de=Array(oe),ve=0;ve<oe;ve++)de[ve]=arguments[ve+2];X.children=de}return N(W.type,q,void 0,void 0,Q,X)},nt.createContext=function(W){return W={$$typeof:u,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:o,_context:W},W},nt.createElement=function(W,xe,V){var X,q={},Q=null;if(xe!=null)for(X in xe.key!==void 0&&(Q=""+xe.key),xe)Re.call(xe,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(q[X]=xe[X]);var oe=arguments.length-2;if(oe===1)q.children=V;else if(1<oe){for(var de=Array(oe),ve=0;ve<oe;ve++)de[ve]=arguments[ve+2];q.children=de}if(W&&W.defaultProps)for(X in oe=W.defaultProps,oe)q[X]===void 0&&(q[X]=oe[X]);return N(W,Q,void 0,void 0,null,q)},nt.createRef=function(){return{current:null}},nt.forwardRef=function(W){return{$$typeof:h,render:W}},nt.isValidElement=R,nt.lazy=function(W){return{$$typeof:v,_payload:{_status:-1,_result:W},_init:ye}},nt.memo=function(W,xe){return{$$typeof:m,type:W,compare:xe===void 0?null:xe}},nt.startTransition=function(W){var xe=pe.T,V={};pe.T=V;try{var X=W(),q=pe.S;q!==null&&q(V,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(He,Pe)}catch(Q){Pe(Q)}finally{pe.T=xe}},nt.unstable_useCacheRefresh=function(){return pe.H.useCacheRefresh()},nt.use=function(W){return pe.H.use(W)},nt.useActionState=function(W,xe,V){return pe.H.useActionState(W,xe,V)},nt.useCallback=function(W,xe){return pe.H.useCallback(W,xe)},nt.useContext=function(W){return pe.H.useContext(W)},nt.useDebugValue=function(){},nt.useDeferredValue=function(W,xe){return pe.H.useDeferredValue(W,xe)},nt.useEffect=function(W,xe,V){var X=pe.H;if(typeof V=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(W,xe)},nt.useId=function(){return pe.H.useId()},nt.useImperativeHandle=function(W,xe,V){return pe.H.useImperativeHandle(W,xe,V)},nt.useInsertionEffect=function(W,xe){return pe.H.useInsertionEffect(W,xe)},nt.useLayoutEffect=function(W,xe){return pe.H.useLayoutEffect(W,xe)},nt.useMemo=function(W,xe){return pe.H.useMemo(W,xe)},nt.useOptimistic=function(W,xe){return pe.H.useOptimistic(W,xe)},nt.useReducer=function(W,xe,V){return pe.H.useReducer(W,xe,V)},nt.useRef=function(W){return pe.H.useRef(W)},nt.useState=function(W){return pe.H.useState(W)},nt.useSyncExternalStore=function(W,xe,V){return pe.H.useSyncExternalStore(W,xe,V)},nt.useTransition=function(){return pe.H.useTransition()},nt.version="19.1.0",nt}var k_;function cm(){return k_||(k_=1,d1.exports=L4()),d1.exports}var tt=cm();const V4=By(tt);var m1={exports:{}},Lu={},g1={exports:{}},p1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M_;function B4(){return M_||(M_=1,function(r){function e(J,ye){var Pe=J.length;J.push(ye);e:for(;0<Pe;){var He=Pe-1>>>1,W=J[He];if(0<s(W,ye))J[He]=ye,J[Pe]=W,Pe=He;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var ye=J[0],Pe=J.pop();if(Pe!==ye){J[0]=Pe;e:for(var He=0,W=J.length,xe=W>>>1;He<xe;){var V=2*(He+1)-1,X=J[V],q=V+1,Q=J[q];if(0>s(X,Pe))q<W&&0>s(Q,X)?(J[He]=Q,J[q]=Pe,He=q):(J[He]=X,J[V]=Pe,He=V);else if(q<W&&0>s(Q,Pe))J[He]=Q,J[q]=Pe,He=q;else break e}}return ye}function s(J,ye){var Pe=J.sortIndex-ye.sortIndex;return Pe!==0?Pe:J.id-ye.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var u=Date,h=u.now();r.unstable_now=function(){return u.now()-h}}var g=[],m=[],v=1,x=null,y=3,T=!1,b=!1,S=!1,w=!1,G=typeof setTimeout=="function"?setTimeout:null,Z=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;function ne(J){for(var ye=t(m);ye!==null;){if(ye.callback===null)i(m);else if(ye.startTime<=J)i(m),ye.sortIndex=ye.expirationTime,e(g,ye);else break;ye=t(m)}}function pe(J){if(S=!1,ne(J),!b)if(t(g)!==null)b=!0,Re||(Re=!0,B());else{var ye=t(m);ye!==null&&Be(pe,ye.startTime-J)}}var Re=!1,N=-1,D=5,R=-1;function k(){return w?!0:!(r.unstable_now()-R<D)}function F(){if(w=!1,Re){var J=r.unstable_now();R=J;var ye=!0;try{e:{b=!1,S&&(S=!1,Z(N),N=-1),T=!0;var Pe=y;try{t:{for(ne(J),x=t(g);x!==null&&!(x.expirationTime>J&&k());){var He=x.callback;if(typeof He=="function"){x.callback=null,y=x.priorityLevel;var W=He(x.expirationTime<=J);if(J=r.unstable_now(),typeof W=="function"){x.callback=W,ne(J),ye=!0;break t}x===t(g)&&i(g),ne(J)}else i(g);x=t(g)}if(x!==null)ye=!0;else{var xe=t(m);xe!==null&&Be(pe,xe.startTime-J),ye=!1}}break e}finally{x=null,y=Pe,T=!1}ye=void 0}}finally{ye?B():Re=!1}}}var B;if(typeof K=="function")B=function(){K(F)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,qe=P.port2;P.port1.onmessage=F,B=function(){qe.postMessage(null)}}else B=function(){G(F,0)};function Be(J,ye){N=G(function(){J(r.unstable_now())},ye)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(J){J.callback=null},r.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<J?Math.floor(1e3/J):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_next=function(J){switch(y){case 1:case 2:case 3:var ye=3;break;default:ye=y}var Pe=y;y=ye;try{return J()}finally{y=Pe}},r.unstable_requestPaint=function(){w=!0},r.unstable_runWithPriority=function(J,ye){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var Pe=y;y=J;try{return ye()}finally{y=Pe}},r.unstable_scheduleCallback=function(J,ye,Pe){var He=r.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?He+Pe:He):Pe=He,J){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=Pe+W,J={id:v++,callback:ye,priorityLevel:J,startTime:Pe,expirationTime:W,sortIndex:-1},Pe>He?(J.sortIndex=Pe,e(m,J),t(g)===null&&J===t(m)&&(S?(Z(N),N=-1):S=!0,Be(pe,Pe-He))):(J.sortIndex=W,e(g,J),b||T||(b=!0,Re||(Re=!0,B()))),J},r.unstable_shouldYield=k,r.unstable_wrapCallback=function(J){var ye=y;return function(){var Pe=y;y=ye;try{return J.apply(this,arguments)}finally{y=Pe}}}}(p1)),p1}var F_;function U4(){return F_||(F_=1,g1.exports=B4()),g1.exports}var v1={exports:{}},Wr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P_;function j4(){if(P_)return Wr;P_=1;var r=cm();function e(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(g,m,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:x==null?null:""+x,children:g,containerInfo:m,implementation:v}}var u=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Wr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Wr.createPortal=function(g,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(g,m,null,v)},Wr.flushSync=function(g){var m=u.T,v=i.p;try{if(u.T=null,i.p=2,g)return g()}finally{u.T=m,i.p=v,i.d.f()}},Wr.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},Wr.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Wr.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var v=m.as,x=h(v,m.crossOrigin),y=typeof m.integrity=="string"?m.integrity:void 0,T=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:T}):v==="script"&&i.d.X(g,{crossOrigin:x,integrity:y,fetchPriority:T,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Wr.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=h(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},Wr.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,x=h(v,m.crossOrigin);i.d.L(g,v,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Wr.preloadModule=function(g,m){if(typeof g=="string")if(m){var v=h(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},Wr.requestFormReset=function(g){i.d.r(g)},Wr.unstable_batchedUpdates=function(g,m){return g(m)},Wr.useFormState=function(g,m,v){return u.H.useFormState(g,m,v)},Wr.useFormStatus=function(){return u.H.useHostTransitionStatus()},Wr.version="19.1.0",Wr}var L_;function z4(){if(L_)return v1.exports;L_=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),v1.exports=j4(),v1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V_;function H4(){if(V_)return Lu;V_=1;var r=U4(),e=cm(),t=z4();function i(n){var a="https://react.dev/errors/"+n;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function o(n){var a=n,l=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(l=a.return),n=a.return;while(n)}return a.tag===3?l:null}function u(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function h(n){if(o(n)!==n)throw Error(i(188))}function g(n){var a=n.alternate;if(!a){if(a=o(n),a===null)throw Error(i(188));return a!==n?null:n}for(var l=n,c=a;;){var d=l.return;if(d===null)break;var p=d.alternate;if(p===null){if(c=d.return,c!==null){l=c;continue}break}if(d.child===p.child){for(p=d.child;p;){if(p===l)return h(d),n;if(p===c)return h(d),a;p=p.sibling}throw Error(i(188))}if(l.return!==c.return)l=d,c=p;else{for(var A=!1,O=d.child;O;){if(O===l){A=!0,l=d,c=p;break}if(O===c){A=!0,c=d,l=p;break}O=O.sibling}if(!A){for(O=p.child;O;){if(O===l){A=!0,l=p,c=d;break}if(O===c){A=!0,c=p,l=d;break}O=O.sibling}if(!A)throw Error(i(189))}}if(l.alternate!==c)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?n:a}function m(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n;for(n=n.child;n!==null;){if(a=m(n),a!==null)return a;n=n.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),G=Symbol.for("react.provider"),Z=Symbol.for("react.consumer"),K=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),pe=Symbol.for("react.suspense"),Re=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),k=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function B(n){return n===null||typeof n!="object"?null:(n=F&&n[F]||n["@@iterator"],typeof n=="function"?n:null)}var P=Symbol.for("react.client.reference");function qe(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===P?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case b:return"Fragment";case w:return"Profiler";case S:return"StrictMode";case pe:return"Suspense";case Re:return"SuspenseList";case R:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case T:return"Portal";case K:return(n.displayName||"Context")+".Provider";case Z:return(n._context.displayName||"Context")+".Consumer";case ne:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case N:return a=n.displayName||null,a!==null?a:qe(n.type)||"Memo";case D:a=n._payload,n=n._init;try{return qe(n(a))}catch{}}return null}var Be=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pe={pending:!1,data:null,method:null,action:null},He=[],W=-1;function xe(n){return{current:n}}function V(n){0>W||(n.current=He[W],He[W]=null,W--)}function X(n,a){W++,He[W]=n.current,n.current=a}var q=xe(null),Q=xe(null),oe=xe(null),de=xe(null);function ve(n,a){switch(X(oe,a),X(Q,n),X(q,null),a.nodeType){case 9:case 11:n=(n=a.documentElement)&&(n=n.namespaceURI)?i_(n):0;break;default:if(n=a.tagName,a=a.namespaceURI)a=i_(a),n=a_(a,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}V(q),X(q,n)}function Ne(){V(q),V(Q),V(oe)}function De(n){n.memoizedState!==null&&X(de,n);var a=q.current,l=a_(a,n.type);a!==l&&(X(Q,n),X(q,l))}function ut(n){Q.current===n&&(V(q),V(Q)),de.current===n&&(V(de),Ou._currentValue=Pe)}var rt=Object.prototype.hasOwnProperty,Wt=r.unstable_scheduleCallback,lt=r.unstable_cancelCallback,tn=r.unstable_shouldYield,Bt=r.unstable_requestPaint,Ve=r.unstable_now,Xr=r.unstable_getCurrentPriorityLevel,rn=r.unstable_ImmediatePriority,hn=r.unstable_UserBlockingPriority,dn=r.unstable_NormalPriority,_l=r.unstable_LowPriority,pi=r.unstable_IdlePriority,Yr=r.log,Wi=r.unstable_setDisableYieldValue,jt=null,yt=null;function rr(n){if(typeof Yr=="function"&&Wi(n),yt&&typeof yt.setStrictMode=="function")try{yt.setStrictMode(jt,n)}catch{}}var Ar=Math.clz32?Math.clz32:vi,As=Math.log,xl=Math.LN2;function vi(n){return n>>>=0,n===0?32:31-(As(n)/xl|0)|0}var _i=256,xi=4194304;function mn(n){var a=n&42;if(a!==0)return a;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Ra(n,a,l){var c=n.pendingLanes;if(c===0)return 0;var d=0,p=n.suspendedLanes,A=n.pingedLanes;n=n.warmLanes;var O=c&134217727;return O!==0?(c=O&~p,c!==0?d=mn(c):(A&=O,A!==0?d=mn(A):l||(l=O&~n,l!==0&&(d=mn(l))))):(O=c&~p,O!==0?d=mn(O):A!==0?d=mn(A):l||(l=c&~n,l!==0&&(d=mn(l)))),d===0?0:a!==0&&a!==d&&(a&p)===0&&(p=d&-d,l=a&-a,p>=l||p===32&&(l&4194048)!==0)?a:d}function Qi(n,a){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&a)===0}function Ca(n,a){switch(n){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ba(){var n=_i;return _i<<=1,(_i&4194048)===0&&(_i=256),n}function Da(){var n=xi;return xi<<=1,(xi&62914560)===0&&(xi=4194304),n}function ni(n){for(var a=[],l=0;31>l;l++)a.push(n);return a}function ii(n,a){n.pendingLanes|=a,a!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function yi(n,a,l,c,d,p){var A=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var O=n.entanglements,Y=n.expirationTimes,le=n.hiddenUpdates;for(l=A&~l;0<l;){var Ee=31-Ar(l),Se=1<<Ee;O[Ee]=0,Y[Ee]=-1;var fe=le[Ee];if(fe!==null)for(le[Ee]=null,Ee=0;Ee<fe.length;Ee++){var he=fe[Ee];he!==null&&(he.lane&=-536870913)}l&=~Se}c!==0&&Un(n,c,0),p!==0&&d===0&&n.tag!==0&&(n.suspendedLanes|=p&~(A&~a))}function Un(n,a,l){n.pendingLanes|=a,n.suspendedLanes&=~a;var c=31-Ar(a);n.entangledLanes|=a,n.entanglements[c]=n.entanglements[c]|1073741824|l&4194090}function Ss(n,a){var l=n.entangledLanes|=a;for(n=n.entanglements;l;){var c=31-Ar(l),d=1<<c;d&a|n[c]&a&&(n[c]|=a),l&=~d}}function Ei(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Na(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ti(){var n=ye.p;return n!==0?n:(n=window.event,n===void 0?32:S_(n.type))}function yl(n,a){var l=ye.p;try{return ye.p=n,a()}finally{ye.p=l}}var zt=Math.random().toString(36).slice(2),nr="__reactFiber$"+zt,Yt="__reactProps$"+zt,gn="__reactContainer$"+zt,ws="__reactEvents$"+zt,Vo="__reactListeners$"+zt,C="__reactHandles$"+zt,j="__reactResources$"+zt,M="__reactMarker$"+zt;function L(n){delete n[nr],delete n[Yt],delete n[ws],delete n[Vo],delete n[C]}function U(n){var a=n[nr];if(a)return a;for(var l=n.parentNode;l;){if(a=l[gn]||l[nr]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(n=u_(n);n!==null;){if(l=n[nr])return l;n=u_(n)}return a}n=l,l=n.parentNode}return null}function H(n){if(n=n[nr]||n[gn]){var a=n.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return n}return null}function se(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n.stateNode;throw Error(i(33))}function me(n){var a=n[j];return a||(a=n[j]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function re(n){n[M]=!0}var ue=new Set,ce={};function be(n,a){Ie(n,a),Ie(n+"Capture",a)}function Ie(n,a){for(ce[n]=a,n=0;n<a.length;n++)ue.add(a[n])}var Ue=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Oe={},Le={};function $e(n){return rt.call(Le,n)?!0:rt.call(Oe,n)?!1:Ue.test(n)?Le[n]=!0:(Oe[n]=!0,!1)}function Et(n,a,l){if($e(a))if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(a);return}}n.setAttribute(a,""+l)}}function dt(n,a,l){if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttribute(a,""+l)}}function mt(n,a,l,c){if(c===null)n.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(a,l,""+c)}}var wn,Ai;function nn(n){if(wn===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);wn=a&&a[1]||"",Ai=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+wn+n+Ai}var pn=!1;function Si(n,a){if(!n||pn)return"";pn=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Se=function(){throw Error()};if(Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(he){var fe=he}Reflect.construct(n,[],Se)}else{try{Se.call()}catch(he){fe=he}n.call(Se.prototype)}}else{try{throw Error()}catch(he){fe=he}(Se=n())&&typeof Se.catch=="function"&&Se.catch(function(){})}}catch(he){if(he&&fe&&typeof he.stack=="string")return[he.stack,fe.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),A=p[0],O=p[1];if(A&&O){var Y=A.split(`
`),le=O.split(`
`);for(d=c=0;c<Y.length&&!Y[c].includes("DetermineComponentFrameRoot");)c++;for(;d<le.length&&!le[d].includes("DetermineComponentFrameRoot");)d++;if(c===Y.length||d===le.length)for(c=Y.length-1,d=le.length-1;1<=c&&0<=d&&Y[c]!==le[d];)d--;for(;1<=c&&0<=d;c--,d--)if(Y[c]!==le[d]){if(c!==1||d!==1)do if(c--,d--,0>d||Y[c]!==le[d]){var Ee=`
`+Y[c].replace(" at new "," at ");return n.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",n.displayName)),Ee}while(1<=c&&0<=d);break}}}finally{pn=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?nn(l):""}function an(n){switch(n.tag){case 26:case 27:case 5:return nn(n.type);case 16:return nn("Lazy");case 13:return nn("Suspense");case 19:return nn("SuspenseList");case 0:case 15:return Si(n.type,!1);case 11:return Si(n.type.render,!1);case 1:return Si(n.type,!0);case 31:return nn("Activity");default:return""}}function El(n){try{var a="";do a+=an(n),n=n.return;while(n);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function sn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Bo(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ph(n){var a=Bo(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),c=""+n[a];if(!n.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var d=l.get,p=l.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return d.call(this)},set:function(A){c=""+A,p.call(this,A)}}),Object.defineProperty(n,a,{enumerable:l.enumerable}),{getValue:function(){return c},setValue:function(A){c=""+A},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function Tl(n){n._valueTracker||(n._valueTracker=ph(n))}function Uo(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var l=a.getValue(),c="";return n&&(c=Bo(n)?n.checked?"true":"false":n.value),n=c,n!==l?(a.setValue(n),!0):!1}function Rs(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var vh=/[\n"\\]/g;function lr(n){return n.replace(vh,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Rn(n,a,l,c,d,p,A,O){n.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?n.type=A:n.removeAttribute("type"),a!=null?A==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+sn(a)):n.value!==""+sn(a)&&(n.value=""+sn(a)):A!=="submit"&&A!=="reset"||n.removeAttribute("value"),a!=null?Oa(n,A,sn(a)):l!=null?Oa(n,A,sn(l)):c!=null&&n.removeAttribute("value"),d==null&&p!=null&&(n.defaultChecked=!!p),d!=null&&(n.checked=d&&typeof d!="function"&&typeof d!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?n.name=""+sn(O):n.removeAttribute("name")}function Cs(n,a,l,c,d,p,A,O){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(n.type=p),a!=null||l!=null){if(!(p!=="submit"&&p!=="reset"||a!=null))return;l=l!=null?""+sn(l):"",a=a!=null?""+sn(a):l,O||a===n.value||(n.value=a),n.defaultValue=a}c=c??d,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=O?n.checked:!!c,n.defaultChecked=!!c,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(n.name=A)}function Oa(n,a,l){a==="number"&&Rs(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function $i(n,a,l,c){if(n=n.options,a){a={};for(var d=0;d<l.length;d++)a["$"+l[d]]=!0;for(l=0;l<n.length;l++)d=a.hasOwnProperty("$"+n[l].value),n[l].selected!==d&&(n[l].selected=d),d&&c&&(n[l].defaultSelected=!0)}else{for(l=""+sn(l),a=null,d=0;d<n.length;d++){if(n[d].value===l){n[d].selected=!0,c&&(n[d].defaultSelected=!0);return}a!==null||n[d].disabled||(a=n[d])}a!==null&&(a.selected=!0)}}function Mt(n,a,l){if(a!=null&&(a=""+sn(a),a!==n.value&&(n.value=a),l==null)){n.defaultValue!==a&&(n.defaultValue=a);return}n.defaultValue=l!=null?""+sn(l):""}function bs(n,a,l,c){if(a==null){if(c!=null){if(l!=null)throw Error(i(92));if(Be(c)){if(1<c.length)throw Error(i(93));c=c[0]}l=c}l==null&&(l=""),a=l}l=sn(a),n.defaultValue=l,c=n.textContent,c===l&&c!==""&&c!==null&&(n.value=c)}function jn(n,a){if(a){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=a;return}}n.textContent=a}var Ds=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kc(n,a,l){var c=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?n.setProperty(a,""):a==="float"?n.cssFloat="":n[a]="":c?n.setProperty(a,l):typeof l!="number"||l===0||Ds.has(a)?a==="float"?n.cssFloat=l:n[a]=(""+l).trim():n[a]=l+"px"}function jo(n,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(n=n.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var d in a)c=a[d],a.hasOwnProperty(d)&&l[d]!==c&&kc(n,d,c)}else for(var p in a)a.hasOwnProperty(p)&&kc(n,p,a[p])}function zo(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _h=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Al(n){return xh.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var Zi=null;function zn(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ji=null,ea=null;function Ho(n){var a=H(n);if(a&&(n=a.stateNode)){var l=n[Yt]||null;e:switch(n=a.stateNode,a.type){case"input":if(Rn(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+lr(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var c=l[a];if(c!==n&&c.form===n.form){var d=c[Yt]||null;if(!d)throw Error(i(90));Rn(c,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(a=0;a<l.length;a++)c=l[a],c.form===n.form&&Uo(c)}break e;case"textarea":Mt(n,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&$i(n,!!l.multiple,a,!1)}}}var wi=!1;function Mc(n,a,l){if(wi)return n(a,l);wi=!0;try{var c=n(a);return c}finally{if(wi=!1,(Ji!==null||ea!==null)&&(bf(),Ji&&(a=Ji,n=ea,ea=Ji=null,Ho(a),n)))for(a=0;a<n.length;a++)Ho(n[a])}}function Ns(n,a){var l=n.stateNode;if(l===null)return null;var c=l[Yt]||null;if(c===null)return null;l=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hn=!1;if(ai)try{var Os={};Object.defineProperty(Os,"passive",{get:function(){Hn=!0}}),window.addEventListener("test",Os,Os),window.removeEventListener("test",Os,Os)}catch{Hn=!1}var Ri=null,Ia=null,ta=null;function Go(){if(ta)return ta;var n,a=Ia,l=a.length,c,d="value"in Ri?Ri.value:Ri.textContent,p=d.length;for(n=0;n<l&&a[n]===d[n];n++);var A=l-n;for(c=1;c<=A&&a[l-c]===d[p-c];c++);return ta=d.slice(n,1<c?1-c:void 0)}function Ci(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function bi(){return!0}function qo(){return!1}function Sr(n){function a(l,c,d,p,A){this._reactName=l,this._targetInst=d,this.type=c,this.nativeEvent=p,this.target=A,this.currentTarget=null;for(var O in n)n.hasOwnProperty(O)&&(l=n[O],this[O]=l?l(p):p[O]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?bi:qo,this.isPropagationStopped=qo,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=bi)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=bi)},persist:function(){},isPersistent:bi}),a}var Rt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sl=Sr(Rt),Is=v({},Rt,{view:0,detail:0}),Fc=Sr(Is),wl,Rl,Di,ks=v({},Is,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ps,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Di&&(Di&&n.type==="mousemove"?(wl=n.screenX-Di.screenX,Rl=n.screenY-Di.screenY):Rl=wl=0,Di=n),wl)},movementY:function(n){return"movementY"in n?n.movementY:Rl}}),Gn=Sr(ks),Pc=v({},ks,{dataTransfer:0}),yh=Sr(Pc),Ms=v({},Is,{relatedTarget:0}),Cl=Sr(Ms),Xo=v({},Rt,{animationName:0,elapsedTime:0,pseudoElement:0}),bl=Sr(Xo),Lc=v({},Rt,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Dl=Sr(Lc),Eh=v({},Rt,{data:0}),Yo=Sr(Eh),Fs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ko(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Bc[n])?!!a[n]:!1}function Ps(){return Ko}var Uc=v({},Is,{key:function(n){if(n.key){var a=Fs[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Ci(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Vc[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ps,charCode:function(n){return n.type==="keypress"?Ci(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ci(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Nl=Sr(Uc),jc=v({},ks,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wo=Sr(jc),ra=v({},Is,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ps}),zc=Sr(ra),Hc=v({},Rt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gc=Sr(Hc),qc=v({},ks,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ol=Sr(qc),ln=v({},Rt,{newState:0,oldState:0}),Xc=Sr(ln),Yc=[9,13,27,32],Ni=ai&&"CompositionEvent"in window,f=null;ai&&"documentMode"in document&&(f=document.documentMode);var _=ai&&"TextEvent"in window&&!f,E=ai&&(!Ni||f&&8<f&&11>=f),I=" ",ie=!1;function ge(n,a){switch(n){case"keyup":return Yc.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Me(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var gt=!1;function vr(n,a){switch(n){case"compositionend":return Me(a);case"keypress":return a.which!==32?null:(ie=!0,I);case"textInput":return n=a.data,n===I&&ie?null:n;default:return null}}function pt(n,a){if(gt)return n==="compositionend"||!Ni&&ge(n,a)?(n=Go(),ta=Ia=Ri=null,gt=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return E&&a.locale!=="ko"?null:a.data;default:return null}}var wr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _r(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!wr[n.type]:a==="textarea"}function na(n,a,l,c){Ji?ea?ea.push(c):ea=[c]:Ji=c,a=Mf(a,"onChange"),0<a.length&&(l=new Sl("onChange","change",null,l,c),n.push({event:l,listeners:a}))}var kr=null,Oi=null;function Qo(n){Jv(n,0)}function Kc(n){var a=se(n);if(Uo(a))return n}function yg(n,a){if(n==="change")return a}var Eg=!1;if(ai){var Th;if(ai){var Ah="oninput"in document;if(!Ah){var Tg=document.createElement("div");Tg.setAttribute("oninput","return;"),Ah=typeof Tg.oninput=="function"}Th=Ah}else Th=!1;Eg=Th&&(!document.documentMode||9<document.documentMode)}function Ag(){kr&&(kr.detachEvent("onpropertychange",Sg),Oi=kr=null)}function Sg(n){if(n.propertyName==="value"&&Kc(Oi)){var a=[];na(a,Oi,n,zn(n)),Mc(Qo,a)}}function fA(n,a,l){n==="focusin"?(Ag(),kr=a,Oi=l,kr.attachEvent("onpropertychange",Sg)):n==="focusout"&&Ag()}function hA(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Kc(Oi)}function dA(n,a){if(n==="click")return Kc(a)}function mA(n,a){if(n==="input"||n==="change")return Kc(a)}function gA(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Cn=typeof Object.is=="function"?Object.is:gA;function $o(n,a){if(Cn(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var l=Object.keys(n),c=Object.keys(a);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var d=l[c];if(!rt.call(a,d)||!Cn(n[d],a[d]))return!1}return!0}function wg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Rg(n,a){var l=wg(n);n=0;for(var c;l;){if(l.nodeType===3){if(c=n+l.textContent.length,n<=a&&c>=a)return{node:l,offset:a-n};n=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=wg(l)}}function Cg(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?Cg(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function bg(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var a=Rs(n.document);a instanceof n.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)n=a.contentWindow;else break;a=Rs(n.document)}return a}function Sh(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}var pA=ai&&"documentMode"in document&&11>=document.documentMode,Il=null,wh=null,Zo=null,Rh=!1;function Dg(n,a,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Rh||Il==null||Il!==Rs(c)||(c=Il,"selectionStart"in c&&Sh(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Zo&&$o(Zo,c)||(Zo=c,c=Mf(wh,"onSelect"),0<c.length&&(a=new Sl("onSelect","select",null,a,l),n.push({event:a,listeners:c}),a.target=Il)))}function Ls(n,a){var l={};return l[n.toLowerCase()]=a.toLowerCase(),l["Webkit"+n]="webkit"+a,l["Moz"+n]="moz"+a,l}var kl={animationend:Ls("Animation","AnimationEnd"),animationiteration:Ls("Animation","AnimationIteration"),animationstart:Ls("Animation","AnimationStart"),transitionrun:Ls("Transition","TransitionRun"),transitionstart:Ls("Transition","TransitionStart"),transitioncancel:Ls("Transition","TransitionCancel"),transitionend:Ls("Transition","TransitionEnd")},Ch={},Ng={};ai&&(Ng=document.createElement("div").style,"AnimationEvent"in window||(delete kl.animationend.animation,delete kl.animationiteration.animation,delete kl.animationstart.animation),"TransitionEvent"in window||delete kl.transitionend.transition);function Vs(n){if(Ch[n])return Ch[n];if(!kl[n])return n;var a=kl[n],l;for(l in a)if(a.hasOwnProperty(l)&&l in Ng)return Ch[n]=a[l];return n}var Og=Vs("animationend"),Ig=Vs("animationiteration"),kg=Vs("animationstart"),vA=Vs("transitionrun"),_A=Vs("transitionstart"),xA=Vs("transitioncancel"),Mg=Vs("transitionend"),Fg=new Map,bh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bh.push("scrollEnd");function si(n,a){Fg.set(n,a),be(a,[n])}var Pg=new WeakMap;function qn(n,a){if(typeof n=="object"&&n!==null){var l=Pg.get(n);return l!==void 0?l:(a={value:n,source:a,stack:El(a)},Pg.set(n,a),a)}return{value:n,source:a,stack:El(a)}}var Xn=[],Ml=0,Dh=0;function Wc(){for(var n=Ml,a=Dh=Ml=0;a<n;){var l=Xn[a];Xn[a++]=null;var c=Xn[a];Xn[a++]=null;var d=Xn[a];Xn[a++]=null;var p=Xn[a];if(Xn[a++]=null,c!==null&&d!==null){var A=c.pending;A===null?d.next=d:(d.next=A.next,A.next=d),c.pending=d}p!==0&&Lg(l,d,p)}}function Qc(n,a,l,c){Xn[Ml++]=n,Xn[Ml++]=a,Xn[Ml++]=l,Xn[Ml++]=c,Dh|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Nh(n,a,l,c){return Qc(n,a,l,c),$c(n)}function Fl(n,a){return Qc(n,null,null,a),$c(n)}function Lg(n,a,l){n.lanes|=l;var c=n.alternate;c!==null&&(c.lanes|=l);for(var d=!1,p=n.return;p!==null;)p.childLanes|=l,c=p.alternate,c!==null&&(c.childLanes|=l),p.tag===22&&(n=p.stateNode,n===null||n._visibility&1||(d=!0)),n=p,p=p.return;return n.tag===3?(p=n.stateNode,d&&a!==null&&(d=31-Ar(l),n=p.hiddenUpdates,c=n[d],c===null?n[d]=[a]:c.push(a),a.lane=l|536870912),p):null}function $c(n){if(50<Au)throw Au=0,Pd=null,Error(i(185));for(var a=n.return;a!==null;)n=a,a=n.return;return n.tag===3?n.stateNode:null}var Pl={};function yA(n,a,l,c){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bn(n,a,l,c){return new yA(n,a,l,c)}function Oh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ia(n,a){var l=n.alternate;return l===null?(l=bn(n.tag,a,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=a,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,a=n.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function Vg(n,a){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=a,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,a=l.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n}function Zc(n,a,l,c,d,p){var A=0;if(c=n,typeof n=="function")Oh(n)&&(A=1);else if(typeof n=="string")A=T4(n,l,q.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case R:return n=bn(31,l,a,d),n.elementType=R,n.lanes=p,n;case b:return Bs(l.children,d,p,a);case S:A=8,d|=24;break;case w:return n=bn(12,l,a,d|2),n.elementType=w,n.lanes=p,n;case pe:return n=bn(13,l,a,d),n.elementType=pe,n.lanes=p,n;case Re:return n=bn(19,l,a,d),n.elementType=Re,n.lanes=p,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case G:case K:A=10;break e;case Z:A=9;break e;case ne:A=11;break e;case N:A=14;break e;case D:A=16,c=null;break e}A=29,l=Error(i(130,n===null?"null":typeof n,"")),c=null}return a=bn(A,l,a,d),a.elementType=n,a.type=c,a.lanes=p,a}function Bs(n,a,l,c){return n=bn(7,n,c,a),n.lanes=l,n}function Ih(n,a,l){return n=bn(6,n,null,a),n.lanes=l,n}function kh(n,a,l){return a=bn(4,n.children!==null?n.children:[],n.key,a),a.lanes=l,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}var Ll=[],Vl=0,Jc=null,ef=0,Yn=[],Kn=0,Us=null,aa=1,sa="";function js(n,a){Ll[Vl++]=ef,Ll[Vl++]=Jc,Jc=n,ef=a}function Bg(n,a,l){Yn[Kn++]=aa,Yn[Kn++]=sa,Yn[Kn++]=Us,Us=n;var c=aa;n=sa;var d=32-Ar(c)-1;c&=~(1<<d),l+=1;var p=32-Ar(a)+d;if(30<p){var A=d-d%5;p=(c&(1<<A)-1).toString(32),c>>=A,d-=A,aa=1<<32-Ar(a)+d|l<<d|c,sa=p+n}else aa=1<<p|l<<d|c,sa=n}function Mh(n){n.return!==null&&(js(n,1),Bg(n,1,0))}function Fh(n){for(;n===Jc;)Jc=Ll[--Vl],Ll[Vl]=null,ef=Ll[--Vl],Ll[Vl]=null;for(;n===Us;)Us=Yn[--Kn],Yn[Kn]=null,sa=Yn[--Kn],Yn[Kn]=null,aa=Yn[--Kn],Yn[Kn]=null}var on=null,Zt=null,St=!1,zs=null,Ii=!1,Ph=Error(i(519));function Hs(n){var a=Error(i(418,""));throw tu(qn(a,n)),Ph}function Ug(n){var a=n.stateNode,l=n.type,c=n.memoizedProps;switch(a[nr]=n,a[Yt]=c,l){case"dialog":ft("cancel",a),ft("close",a);break;case"iframe":case"object":case"embed":ft("load",a);break;case"video":case"audio":for(l=0;l<wu.length;l++)ft(wu[l],a);break;case"source":ft("error",a);break;case"img":case"image":case"link":ft("error",a),ft("load",a);break;case"details":ft("toggle",a);break;case"input":ft("invalid",a),Cs(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),Tl(a);break;case"select":ft("invalid",a);break;case"textarea":ft("invalid",a),bs(a,c.value,c.defaultValue,c.children),Tl(a)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||c.suppressHydrationWarning===!0||n_(a.textContent,l)?(c.popover!=null&&(ft("beforetoggle",a),ft("toggle",a)),c.onScroll!=null&&ft("scroll",a),c.onScrollEnd!=null&&ft("scrollend",a),c.onClick!=null&&(a.onclick=Ff),a=!0):a=!1,a||Hs(n)}function jg(n){for(on=n.return;on;)switch(on.tag){case 5:case 13:Ii=!1;return;case 27:case 3:Ii=!0;return;default:on=on.return}}function Jo(n){if(n!==on)return!1;if(!St)return jg(n),St=!0,!1;var a=n.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||Zd(n.type,n.memoizedProps)),l=!l),l&&Zt&&Hs(n),jg(n),a===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8)if(l=n.data,l==="/$"){if(a===0){Zt=oi(n.nextSibling);break e}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++;n=n.nextSibling}Zt=null}}else a===27?(a=Zt,Ka(n.type)?(n=r1,r1=null,Zt=n):Zt=a):Zt=on?oi(n.stateNode.nextSibling):null;return!0}function eu(){Zt=on=null,St=!1}function zg(){var n=zs;return n!==null&&(xn===null?xn=n:xn.push.apply(xn,n),zs=null),n}function tu(n){zs===null?zs=[n]:zs.push(n)}var Lh=xe(null),Gs=null,la=null;function ka(n,a,l){X(Lh,a._currentValue),a._currentValue=l}function oa(n){n._currentValue=Lh.current,V(Lh)}function Vh(n,a,l){for(;n!==null;){var c=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),n===l)break;n=n.return}}function Bh(n,a,l,c){var d=n.child;for(d!==null&&(d.return=n);d!==null;){var p=d.dependencies;if(p!==null){var A=d.child;p=p.firstContext;e:for(;p!==null;){var O=p;p=d;for(var Y=0;Y<a.length;Y++)if(O.context===a[Y]){p.lanes|=l,O=p.alternate,O!==null&&(O.lanes|=l),Vh(p.return,l,n),c||(A=null);break e}p=O.next}}else if(d.tag===18){if(A=d.return,A===null)throw Error(i(341));A.lanes|=l,p=A.alternate,p!==null&&(p.lanes|=l),Vh(A,l,n),A=null}else A=d.child;if(A!==null)A.return=d;else for(A=d;A!==null;){if(A===n){A=null;break}if(d=A.sibling,d!==null){d.return=A.return,A=d;break}A=A.return}d=A}}function ru(n,a,l,c){n=null;for(var d=a,p=!1;d!==null;){if(!p){if((d.flags&524288)!==0)p=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var A=d.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var O=d.type;Cn(d.pendingProps.value,A.value)||(n!==null?n.push(O):n=[O])}}else if(d===de.current){if(A=d.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(n!==null?n.push(Ou):n=[Ou])}d=d.return}n!==null&&Bh(a,n,l,c),a.flags|=262144}function tf(n){for(n=n.firstContext;n!==null;){if(!Cn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function qs(n){Gs=n,la=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Kr(n){return Hg(Gs,n)}function rf(n,a){return Gs===null&&qs(n),Hg(n,a)}function Hg(n,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},la===null){if(n===null)throw Error(i(308));la=a,n.dependencies={lanes:0,firstContext:a},n.flags|=524288}else la=la.next=a;return l}var EA=typeof AbortController<"u"?AbortController:function(){var n=[],a=this.signal={aborted:!1,addEventListener:function(l,c){n.push(c)}};this.abort=function(){a.aborted=!0,n.forEach(function(l){return l()})}},TA=r.unstable_scheduleCallback,AA=r.unstable_NormalPriority,xr={$$typeof:K,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uh(){return{controller:new EA,data:new Map,refCount:0}}function nu(n){n.refCount--,n.refCount===0&&TA(AA,function(){n.controller.abort()})}var iu=null,jh=0,Bl=0,Ul=null;function SA(n,a){if(iu===null){var l=iu=[];jh=0,Bl=Hd(),Ul={status:"pending",value:void 0,then:function(c){l.push(c)}}}return jh++,a.then(Gg,Gg),a}function Gg(){if(--jh===0&&iu!==null){Ul!==null&&(Ul.status="fulfilled");var n=iu;iu=null,Bl=0,Ul=null;for(var a=0;a<n.length;a++)(0,n[a])()}}function wA(n,a){var l=[],c={status:"pending",value:null,reason:null,then:function(d){l.push(d)}};return n.then(function(){c.status="fulfilled",c.value=a;for(var d=0;d<l.length;d++)(0,l[d])(a)},function(d){for(c.status="rejected",c.reason=d,d=0;d<l.length;d++)(0,l[d])(void 0)}),c}var qg=J.S;J.S=function(n,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&SA(n,a),qg!==null&&qg(n,a)};var Xs=xe(null);function zh(){var n=Xs.current;return n!==null?n:Ht.pooledCache}function nf(n,a){a===null?X(Xs,Xs.current):X(Xs,a.pool)}function Xg(){var n=zh();return n===null?null:{parent:xr._currentValue,pool:n}}var au=Error(i(460)),Yg=Error(i(474)),af=Error(i(542)),Hh={then:function(){}};function Kg(n){return n=n.status,n==="fulfilled"||n==="rejected"}function sf(){}function Wg(n,a,l){switch(l=n[l],l===void 0?n.push(a):l!==a&&(a.then(sf,sf),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,$g(n),n;default:if(typeof a.status=="string")a.then(sf,sf);else{if(n=Ht,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=a,n.status="pending",n.then(function(c){if(a.status==="pending"){var d=a;d.status="fulfilled",d.value=c}},function(c){if(a.status==="pending"){var d=a;d.status="rejected",d.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,$g(n),n}throw su=a,au}}var su=null;function Qg(){if(su===null)throw Error(i(459));var n=su;return su=null,n}function $g(n){if(n===au||n===af)throw Error(i(483))}var Ma=!1;function Gh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qh(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Fa(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Pa(n,a,l){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(bt&2)!==0){var d=c.pending;return d===null?a.next=a:(a.next=d.next,d.next=a),c.pending=a,a=$c(n),Lg(n,null,l),a}return Qc(n,c,a,l),$c(n)}function lu(n,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var c=a.lanes;c&=n.pendingLanes,l|=c,a.lanes=l,Ss(n,l)}}function Xh(n,a){var l=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var d=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var A={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};p===null?d=p=A:p=p.next=A,l=l.next}while(l!==null);p===null?d=p=a:p=p.next=a}else d=p=a;l={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=a:n.next=a,l.lastBaseUpdate=a}var Yh=!1;function ou(){if(Yh){var n=Ul;if(n!==null)throw n}}function uu(n,a,l,c){Yh=!1;var d=n.updateQueue;Ma=!1;var p=d.firstBaseUpdate,A=d.lastBaseUpdate,O=d.shared.pending;if(O!==null){d.shared.pending=null;var Y=O,le=Y.next;Y.next=null,A===null?p=le:A.next=le,A=Y;var Ee=n.alternate;Ee!==null&&(Ee=Ee.updateQueue,O=Ee.lastBaseUpdate,O!==A&&(O===null?Ee.firstBaseUpdate=le:O.next=le,Ee.lastBaseUpdate=Y))}if(p!==null){var Se=d.baseState;A=0,Ee=le=Y=null,O=p;do{var fe=O.lane&-536870913,he=fe!==O.lane;if(he?(vt&fe)===fe:(c&fe)===fe){fe!==0&&fe===Bl&&(Yh=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Ze=n,Ke=O;fe=a;var Lt=l;switch(Ke.tag){case 1:if(Ze=Ke.payload,typeof Ze=="function"){Se=Ze.call(Lt,Se,fe);break e}Se=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=Ke.payload,fe=typeof Ze=="function"?Ze.call(Lt,Se,fe):Ze,fe==null)break e;Se=v({},Se,fe);break e;case 2:Ma=!0}}fe=O.callback,fe!==null&&(n.flags|=64,he&&(n.flags|=8192),he=d.callbacks,he===null?d.callbacks=[fe]:he.push(fe))}else he={lane:fe,tag:O.tag,payload:O.payload,callback:O.callback,next:null},Ee===null?(le=Ee=he,Y=Se):Ee=Ee.next=he,A|=fe;if(O=O.next,O===null){if(O=d.shared.pending,O===null)break;he=O,O=he.next,he.next=null,d.lastBaseUpdate=he,d.shared.pending=null}}while(!0);Ee===null&&(Y=Se),d.baseState=Y,d.firstBaseUpdate=le,d.lastBaseUpdate=Ee,p===null&&(d.shared.lanes=0),Ga|=A,n.lanes=A,n.memoizedState=Se}}function Zg(n,a){if(typeof n!="function")throw Error(i(191,n));n.call(a)}function Jg(n,a){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)Zg(l[n],a)}var jl=xe(null),lf=xe(0);function ep(n,a){n=ga,X(lf,n),X(jl,a),ga=n|a.baseLanes}function Kh(){X(lf,ga),X(jl,jl.current)}function Wh(){ga=lf.current,V(jl),V(lf)}var La=0,at=null,Ft=null,or=null,of=!1,zl=!1,Ys=!1,uf=0,cu=0,Hl=null,RA=0;function ir(){throw Error(i(321))}function Qh(n,a){if(a===null)return!1;for(var l=0;l<a.length&&l<n.length;l++)if(!Cn(n[l],a[l]))return!1;return!0}function $h(n,a,l,c,d,p){return La=p,at=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,J.H=n===null||n.memoizedState===null?Lp:Vp,Ys=!1,p=l(c,d),Ys=!1,zl&&(p=rp(a,l,c,d)),tp(n),p}function tp(n){J.H=gf;var a=Ft!==null&&Ft.next!==null;if(La=0,or=Ft=at=null,of=!1,cu=0,Hl=null,a)throw Error(i(300));n===null||Rr||(n=n.dependencies,n!==null&&tf(n)&&(Rr=!0))}function rp(n,a,l,c){at=n;var d=0;do{if(zl&&(Hl=null),cu=0,zl=!1,25<=d)throw Error(i(301));if(d+=1,or=Ft=null,n.updateQueue!=null){var p=n.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}J.H=kA,p=a(l,c)}while(zl);return p}function CA(){var n=J.H,a=n.useState()[0];return a=typeof a.then=="function"?fu(a):a,n=n.useState()[0],(Ft!==null?Ft.memoizedState:null)!==n&&(at.flags|=1024),a}function Zh(){var n=uf!==0;return uf=0,n}function Jh(n,a,l){a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~l}function ed(n){if(of){for(n=n.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}of=!1}La=0,or=Ft=at=null,zl=!1,cu=uf=0,Hl=null}function vn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?at.memoizedState=or=n:or=or.next=n,or}function ur(){if(Ft===null){var n=at.alternate;n=n!==null?n.memoizedState:null}else n=Ft.next;var a=or===null?at.memoizedState:or.next;if(a!==null)or=a,Ft=n;else{if(n===null)throw at.alternate===null?Error(i(467)):Error(i(310));Ft=n,n={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},or===null?at.memoizedState=or=n:or=or.next=n}return or}function td(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function fu(n){var a=cu;return cu+=1,Hl===null&&(Hl=[]),n=Wg(Hl,n,a),a=at,(or===null?a.memoizedState:or.next)===null&&(a=a.alternate,J.H=a===null||a.memoizedState===null?Lp:Vp),n}function cf(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return fu(n);if(n.$$typeof===K)return Kr(n)}throw Error(i(438,String(n)))}function rd(n){var a=null,l=at.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var c=at.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(d){return d.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=td(),at.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(n),c=0;c<n;c++)l[c]=k;return a.index++,l}function ua(n,a){return typeof a=="function"?a(n):a}function ff(n){var a=ur();return nd(a,Ft,n)}function nd(n,a,l){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=l;var d=n.baseQueue,p=c.pending;if(p!==null){if(d!==null){var A=d.next;d.next=p.next,p.next=A}a.baseQueue=d=p,c.pending=null}if(p=n.baseState,d===null)n.memoizedState=p;else{a=d.next;var O=A=null,Y=null,le=a,Ee=!1;do{var Se=le.lane&-536870913;if(Se!==le.lane?(vt&Se)===Se:(La&Se)===Se){var fe=le.revertLane;if(fe===0)Y!==null&&(Y=Y.next={lane:0,revertLane:0,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),Se===Bl&&(Ee=!0);else if((La&fe)===fe){le=le.next,fe===Bl&&(Ee=!0);continue}else Se={lane:0,revertLane:le.revertLane,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},Y===null?(O=Y=Se,A=p):Y=Y.next=Se,at.lanes|=fe,Ga|=fe;Se=le.action,Ys&&l(p,Se),p=le.hasEagerState?le.eagerState:l(p,Se)}else fe={lane:Se,revertLane:le.revertLane,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},Y===null?(O=Y=fe,A=p):Y=Y.next=fe,at.lanes|=Se,Ga|=Se;le=le.next}while(le!==null&&le!==a);if(Y===null?A=p:Y.next=O,!Cn(p,n.memoizedState)&&(Rr=!0,Ee&&(l=Ul,l!==null)))throw l;n.memoizedState=p,n.baseState=A,n.baseQueue=Y,c.lastRenderedState=p}return d===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function id(n){var a=ur(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var c=l.dispatch,d=l.pending,p=a.memoizedState;if(d!==null){l.pending=null;var A=d=d.next;do p=n(p,A.action),A=A.next;while(A!==d);Cn(p,a.memoizedState)||(Rr=!0),a.memoizedState=p,a.baseQueue===null&&(a.baseState=p),l.lastRenderedState=p}return[p,c]}function np(n,a,l){var c=at,d=ur(),p=St;if(p){if(l===void 0)throw Error(i(407));l=l()}else l=a();var A=!Cn((Ft||d).memoizedState,l);A&&(d.memoizedState=l,Rr=!0),d=d.queue;var O=sp.bind(null,c,d,n);if(hu(2048,8,O,[n]),d.getSnapshot!==a||A||or!==null&&or.memoizedState.tag&1){if(c.flags|=2048,Gl(9,hf(),ap.bind(null,c,d,l,a),null),Ht===null)throw Error(i(349));p||(La&124)!==0||ip(c,a,l)}return l}function ip(n,a,l){n.flags|=16384,n={getSnapshot:a,value:l},a=at.updateQueue,a===null?(a=td(),at.updateQueue=a,a.stores=[n]):(l=a.stores,l===null?a.stores=[n]:l.push(n))}function ap(n,a,l,c){a.value=l,a.getSnapshot=c,lp(a)&&op(n)}function sp(n,a,l){return l(function(){lp(a)&&op(n)})}function lp(n){var a=n.getSnapshot;n=n.value;try{var l=a();return!Cn(n,l)}catch{return!0}}function op(n){var a=Fl(n,2);a!==null&&kn(a,n,2)}function ad(n){var a=vn();if(typeof n=="function"){var l=n;if(n=l(),Ys){rr(!0);try{l()}finally{rr(!1)}}}return a.memoizedState=a.baseState=n,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ua,lastRenderedState:n},a}function up(n,a,l,c){return n.baseState=l,nd(n,Ft,typeof c=="function"?c:ua)}function bA(n,a,l,c,d){if(mf(n))throw Error(i(485));if(n=a.action,n!==null){var p={payload:d,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){p.listeners.push(A)}};J.T!==null?l(!0):p.isTransition=!1,c(p),l=a.pending,l===null?(p.next=a.pending=p,cp(a,p)):(p.next=l.next,a.pending=l.next=p)}}function cp(n,a){var l=a.action,c=a.payload,d=n.state;if(a.isTransition){var p=J.T,A={};J.T=A;try{var O=l(d,c),Y=J.S;Y!==null&&Y(A,O),fp(n,a,O)}catch(le){sd(n,a,le)}finally{J.T=p}}else try{p=l(d,c),fp(n,a,p)}catch(le){sd(n,a,le)}}function fp(n,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){hp(n,a,c)},function(c){return sd(n,a,c)}):hp(n,a,l)}function hp(n,a,l){a.status="fulfilled",a.value=l,dp(a),n.state=l,a=n.pending,a!==null&&(l=a.next,l===a?n.pending=null:(l=l.next,a.next=l,cp(n,l)))}function sd(n,a,l){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=l,dp(a),a=a.next;while(a!==c)}n.action=null}function dp(n){n=n.listeners;for(var a=0;a<n.length;a++)(0,n[a])()}function mp(n,a){return a}function gp(n,a){if(St){var l=Ht.formState;if(l!==null){e:{var c=at;if(St){if(Zt){t:{for(var d=Zt,p=Ii;d.nodeType!==8;){if(!p){d=null;break t}if(d=oi(d.nextSibling),d===null){d=null;break t}}p=d.data,d=p==="F!"||p==="F"?d:null}if(d){Zt=oi(d.nextSibling),c=d.data==="F!";break e}}Hs(c)}c=!1}c&&(a=l[0])}}return l=vn(),l.memoizedState=l.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mp,lastRenderedState:a},l.queue=c,l=Mp.bind(null,at,c),c.dispatch=l,c=ad(!1),p=fd.bind(null,at,!1,c.queue),c=vn(),d={state:a,dispatch:null,action:n,pending:null},c.queue=d,l=bA.bind(null,at,d,p,l),d.dispatch=l,c.memoizedState=n,[a,l,!1]}function pp(n){var a=ur();return vp(a,Ft,n)}function vp(n,a,l){if(a=nd(n,a,mp)[0],n=ff(ua)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=fu(a)}catch(A){throw A===au?af:A}else c=a;a=ur();var d=a.queue,p=d.dispatch;return l!==a.memoizedState&&(at.flags|=2048,Gl(9,hf(),DA.bind(null,d,l),null)),[c,p,n]}function DA(n,a){n.action=a}function _p(n){var a=ur(),l=Ft;if(l!==null)return vp(a,l,n);ur(),a=a.memoizedState,l=ur();var c=l.queue.dispatch;return l.memoizedState=n,[a,c,!1]}function Gl(n,a,l,c){return n={tag:n,create:l,deps:c,inst:a,next:null},a=at.updateQueue,a===null&&(a=td(),at.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=n.next=n:(c=l.next,l.next=n,n.next=c,a.lastEffect=n),n}function hf(){return{destroy:void 0,resource:void 0}}function xp(){return ur().memoizedState}function df(n,a,l,c){var d=vn();c=c===void 0?null:c,at.flags|=n,d.memoizedState=Gl(1|a,hf(),l,c)}function hu(n,a,l,c){var d=ur();c=c===void 0?null:c;var p=d.memoizedState.inst;Ft!==null&&c!==null&&Qh(c,Ft.memoizedState.deps)?d.memoizedState=Gl(a,p,l,c):(at.flags|=n,d.memoizedState=Gl(1|a,p,l,c))}function yp(n,a){df(8390656,8,n,a)}function Ep(n,a){hu(2048,8,n,a)}function Tp(n,a){return hu(4,2,n,a)}function Ap(n,a){return hu(4,4,n,a)}function Sp(n,a){if(typeof a=="function"){n=n();var l=a(n);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function wp(n,a,l){l=l!=null?l.concat([n]):null,hu(4,4,Sp.bind(null,a,n),l)}function ld(){}function Rp(n,a){var l=ur();a=a===void 0?null:a;var c=l.memoizedState;return a!==null&&Qh(a,c[1])?c[0]:(l.memoizedState=[n,a],n)}function Cp(n,a){var l=ur();a=a===void 0?null:a;var c=l.memoizedState;if(a!==null&&Qh(a,c[1]))return c[0];if(c=n(),Ys){rr(!0);try{n()}finally{rr(!1)}}return l.memoizedState=[c,a],c}function od(n,a,l){return l===void 0||(La&1073741824)!==0?n.memoizedState=a:(n.memoizedState=l,n=Nv(),at.lanes|=n,Ga|=n,l)}function bp(n,a,l,c){return Cn(l,a)?l:jl.current!==null?(n=od(n,l,c),Cn(n,a)||(Rr=!0),n):(La&42)===0?(Rr=!0,n.memoizedState=l):(n=Nv(),at.lanes|=n,Ga|=n,a)}function Dp(n,a,l,c,d){var p=ye.p;ye.p=p!==0&&8>p?p:8;var A=J.T,O={};J.T=O,fd(n,!1,a,l);try{var Y=d(),le=J.S;if(le!==null&&le(O,Y),Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var Ee=wA(Y,c);du(n,a,Ee,In(n))}else du(n,a,c,In(n))}catch(Se){du(n,a,{then:function(){},status:"rejected",reason:Se},In())}finally{ye.p=p,J.T=A}}function NA(){}function ud(n,a,l,c){if(n.tag!==5)throw Error(i(476));var d=Np(n).queue;Dp(n,d,a,Pe,l===null?NA:function(){return Op(n),l(c)})}function Np(n){var a=n.memoizedState;if(a!==null)return a;a={memoizedState:Pe,baseState:Pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ua,lastRenderedState:Pe},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ua,lastRenderedState:l},next:null},n.memoizedState=a,n=n.alternate,n!==null&&(n.memoizedState=a),a}function Op(n){var a=Np(n).next.queue;du(n,a,{},In())}function cd(){return Kr(Ou)}function Ip(){return ur().memoizedState}function kp(){return ur().memoizedState}function OA(n){for(var a=n.return;a!==null;){switch(a.tag){case 24:case 3:var l=In();n=Fa(l);var c=Pa(a,n,l);c!==null&&(kn(c,a,l),lu(c,a,l)),a={cache:Uh()},n.payload=a;return}a=a.return}}function IA(n,a,l){var c=In();l={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},mf(n)?Fp(a,l):(l=Nh(n,a,l,c),l!==null&&(kn(l,n,c),Pp(l,a,c)))}function Mp(n,a,l){var c=In();du(n,a,l,c)}function du(n,a,l,c){var d={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(mf(n))Fp(a,d);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=a.lastRenderedReducer,p!==null))try{var A=a.lastRenderedState,O=p(A,l);if(d.hasEagerState=!0,d.eagerState=O,Cn(O,A))return Qc(n,a,d,0),Ht===null&&Wc(),!1}catch{}finally{}if(l=Nh(n,a,d,c),l!==null)return kn(l,n,c),Pp(l,a,c),!0}return!1}function fd(n,a,l,c){if(c={lane:2,revertLane:Hd(),action:c,hasEagerState:!1,eagerState:null,next:null},mf(n)){if(a)throw Error(i(479))}else a=Nh(n,l,c,2),a!==null&&kn(a,n,2)}function mf(n){var a=n.alternate;return n===at||a!==null&&a===at}function Fp(n,a){zl=of=!0;var l=n.pending;l===null?a.next=a:(a.next=l.next,l.next=a),n.pending=a}function Pp(n,a,l){if((l&4194048)!==0){var c=a.lanes;c&=n.pendingLanes,l|=c,a.lanes=l,Ss(n,l)}}var gf={readContext:Kr,use:cf,useCallback:ir,useContext:ir,useEffect:ir,useImperativeHandle:ir,useLayoutEffect:ir,useInsertionEffect:ir,useMemo:ir,useReducer:ir,useRef:ir,useState:ir,useDebugValue:ir,useDeferredValue:ir,useTransition:ir,useSyncExternalStore:ir,useId:ir,useHostTransitionStatus:ir,useFormState:ir,useActionState:ir,useOptimistic:ir,useMemoCache:ir,useCacheRefresh:ir},Lp={readContext:Kr,use:cf,useCallback:function(n,a){return vn().memoizedState=[n,a===void 0?null:a],n},useContext:Kr,useEffect:yp,useImperativeHandle:function(n,a,l){l=l!=null?l.concat([n]):null,df(4194308,4,Sp.bind(null,a,n),l)},useLayoutEffect:function(n,a){return df(4194308,4,n,a)},useInsertionEffect:function(n,a){df(4,2,n,a)},useMemo:function(n,a){var l=vn();a=a===void 0?null:a;var c=n();if(Ys){rr(!0);try{n()}finally{rr(!1)}}return l.memoizedState=[c,a],c},useReducer:function(n,a,l){var c=vn();if(l!==void 0){var d=l(a);if(Ys){rr(!0);try{l(a)}finally{rr(!1)}}}else d=a;return c.memoizedState=c.baseState=d,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:d},c.queue=n,n=n.dispatch=IA.bind(null,at,n),[c.memoizedState,n]},useRef:function(n){var a=vn();return n={current:n},a.memoizedState=n},useState:function(n){n=ad(n);var a=n.queue,l=Mp.bind(null,at,a);return a.dispatch=l,[n.memoizedState,l]},useDebugValue:ld,useDeferredValue:function(n,a){var l=vn();return od(l,n,a)},useTransition:function(){var n=ad(!1);return n=Dp.bind(null,at,n.queue,!0,!1),vn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,a,l){var c=at,d=vn();if(St){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),Ht===null)throw Error(i(349));(vt&124)!==0||ip(c,a,l)}d.memoizedState=l;var p={value:l,getSnapshot:a};return d.queue=p,yp(sp.bind(null,c,p,n),[n]),c.flags|=2048,Gl(9,hf(),ap.bind(null,c,p,l,a),null),l},useId:function(){var n=vn(),a=Ht.identifierPrefix;if(St){var l=sa,c=aa;l=(c&~(1<<32-Ar(c)-1)).toString(32)+l,a="«"+a+"R"+l,l=uf++,0<l&&(a+="H"+l.toString(32)),a+="»"}else l=RA++,a="«"+a+"r"+l.toString(32)+"»";return n.memoizedState=a},useHostTransitionStatus:cd,useFormState:gp,useActionState:gp,useOptimistic:function(n){var a=vn();a.memoizedState=a.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=fd.bind(null,at,!0,l),l.dispatch=a,[n,a]},useMemoCache:rd,useCacheRefresh:function(){return vn().memoizedState=OA.bind(null,at)}},Vp={readContext:Kr,use:cf,useCallback:Rp,useContext:Kr,useEffect:Ep,useImperativeHandle:wp,useInsertionEffect:Tp,useLayoutEffect:Ap,useMemo:Cp,useReducer:ff,useRef:xp,useState:function(){return ff(ua)},useDebugValue:ld,useDeferredValue:function(n,a){var l=ur();return bp(l,Ft.memoizedState,n,a)},useTransition:function(){var n=ff(ua)[0],a=ur().memoizedState;return[typeof n=="boolean"?n:fu(n),a]},useSyncExternalStore:np,useId:Ip,useHostTransitionStatus:cd,useFormState:pp,useActionState:pp,useOptimistic:function(n,a){var l=ur();return up(l,Ft,n,a)},useMemoCache:rd,useCacheRefresh:kp},kA={readContext:Kr,use:cf,useCallback:Rp,useContext:Kr,useEffect:Ep,useImperativeHandle:wp,useInsertionEffect:Tp,useLayoutEffect:Ap,useMemo:Cp,useReducer:id,useRef:xp,useState:function(){return id(ua)},useDebugValue:ld,useDeferredValue:function(n,a){var l=ur();return Ft===null?od(l,n,a):bp(l,Ft.memoizedState,n,a)},useTransition:function(){var n=id(ua)[0],a=ur().memoizedState;return[typeof n=="boolean"?n:fu(n),a]},useSyncExternalStore:np,useId:Ip,useHostTransitionStatus:cd,useFormState:_p,useActionState:_p,useOptimistic:function(n,a){var l=ur();return Ft!==null?up(l,Ft,n,a):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:rd,useCacheRefresh:kp},ql=null,mu=0;function pf(n){var a=mu;return mu+=1,ql===null&&(ql=[]),Wg(ql,n,a)}function gu(n,a){a=a.props.ref,n.ref=a!==void 0?a:null}function vf(n,a){throw a.$$typeof===x?Error(i(525)):(n=Object.prototype.toString.call(a),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n)))}function Bp(n){var a=n._init;return a(n._payload)}function Up(n){function a(te,ee){if(n){var ae=te.deletions;ae===null?(te.deletions=[ee],te.flags|=16):ae.push(ee)}}function l(te,ee){if(!n)return null;for(;ee!==null;)a(te,ee),ee=ee.sibling;return null}function c(te){for(var ee=new Map;te!==null;)te.key!==null?ee.set(te.key,te):ee.set(te.index,te),te=te.sibling;return ee}function d(te,ee){return te=ia(te,ee),te.index=0,te.sibling=null,te}function p(te,ee,ae){return te.index=ae,n?(ae=te.alternate,ae!==null?(ae=ae.index,ae<ee?(te.flags|=67108866,ee):ae):(te.flags|=67108866,ee)):(te.flags|=1048576,ee)}function A(te){return n&&te.alternate===null&&(te.flags|=67108866),te}function O(te,ee,ae,Te){return ee===null||ee.tag!==6?(ee=Ih(ae,te.mode,Te),ee.return=te,ee):(ee=d(ee,ae),ee.return=te,ee)}function Y(te,ee,ae,Te){var Ge=ae.type;return Ge===b?Ee(te,ee,ae.props.children,Te,ae.key):ee!==null&&(ee.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===D&&Bp(Ge)===ee.type)?(ee=d(ee,ae.props),gu(ee,ae),ee.return=te,ee):(ee=Zc(ae.type,ae.key,ae.props,null,te.mode,Te),gu(ee,ae),ee.return=te,ee)}function le(te,ee,ae,Te){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ae.containerInfo||ee.stateNode.implementation!==ae.implementation?(ee=kh(ae,te.mode,Te),ee.return=te,ee):(ee=d(ee,ae.children||[]),ee.return=te,ee)}function Ee(te,ee,ae,Te,Ge){return ee===null||ee.tag!==7?(ee=Bs(ae,te.mode,Te,Ge),ee.return=te,ee):(ee=d(ee,ae),ee.return=te,ee)}function Se(te,ee,ae){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=Ih(""+ee,te.mode,ae),ee.return=te,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case y:return ae=Zc(ee.type,ee.key,ee.props,null,te.mode,ae),gu(ae,ee),ae.return=te,ae;case T:return ee=kh(ee,te.mode,ae),ee.return=te,ee;case D:var Te=ee._init;return ee=Te(ee._payload),Se(te,ee,ae)}if(Be(ee)||B(ee))return ee=Bs(ee,te.mode,ae,null),ee.return=te,ee;if(typeof ee.then=="function")return Se(te,pf(ee),ae);if(ee.$$typeof===K)return Se(te,rf(te,ee),ae);vf(te,ee)}return null}function fe(te,ee,ae,Te){var Ge=ee!==null?ee.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Ge!==null?null:O(te,ee,""+ae,Te);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case y:return ae.key===Ge?Y(te,ee,ae,Te):null;case T:return ae.key===Ge?le(te,ee,ae,Te):null;case D:return Ge=ae._init,ae=Ge(ae._payload),fe(te,ee,ae,Te)}if(Be(ae)||B(ae))return Ge!==null?null:Ee(te,ee,ae,Te,null);if(typeof ae.then=="function")return fe(te,ee,pf(ae),Te);if(ae.$$typeof===K)return fe(te,ee,rf(te,ae),Te);vf(te,ae)}return null}function he(te,ee,ae,Te,Ge){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return te=te.get(ae)||null,O(ee,te,""+Te,Ge);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case y:return te=te.get(Te.key===null?ae:Te.key)||null,Y(ee,te,Te,Ge);case T:return te=te.get(Te.key===null?ae:Te.key)||null,le(ee,te,Te,Ge);case D:var ot=Te._init;return Te=ot(Te._payload),he(te,ee,ae,Te,Ge)}if(Be(Te)||B(Te))return te=te.get(ae)||null,Ee(ee,te,Te,Ge,null);if(typeof Te.then=="function")return he(te,ee,ae,pf(Te),Ge);if(Te.$$typeof===K)return he(te,ee,ae,rf(ee,Te),Ge);vf(ee,Te)}return null}function Ze(te,ee,ae,Te){for(var Ge=null,ot=null,Xe=ee,We=ee=0,br=null;Xe!==null&&We<ae.length;We++){Xe.index>We?(br=Xe,Xe=null):br=Xe.sibling;var Tt=fe(te,Xe,ae[We],Te);if(Tt===null){Xe===null&&(Xe=br);break}n&&Xe&&Tt.alternate===null&&a(te,Xe),ee=p(Tt,ee,We),ot===null?Ge=Tt:ot.sibling=Tt,ot=Tt,Xe=br}if(We===ae.length)return l(te,Xe),St&&js(te,We),Ge;if(Xe===null){for(;We<ae.length;We++)Xe=Se(te,ae[We],Te),Xe!==null&&(ee=p(Xe,ee,We),ot===null?Ge=Xe:ot.sibling=Xe,ot=Xe);return St&&js(te,We),Ge}for(Xe=c(Xe);We<ae.length;We++)br=he(Xe,te,We,ae[We],Te),br!==null&&(n&&br.alternate!==null&&Xe.delete(br.key===null?We:br.key),ee=p(br,ee,We),ot===null?Ge=br:ot.sibling=br,ot=br);return n&&Xe.forEach(function(Ja){return a(te,Ja)}),St&&js(te,We),Ge}function Ke(te,ee,ae,Te){if(ae==null)throw Error(i(151));for(var Ge=null,ot=null,Xe=ee,We=ee=0,br=null,Tt=ae.next();Xe!==null&&!Tt.done;We++,Tt=ae.next()){Xe.index>We?(br=Xe,Xe=null):br=Xe.sibling;var Ja=fe(te,Xe,Tt.value,Te);if(Ja===null){Xe===null&&(Xe=br);break}n&&Xe&&Ja.alternate===null&&a(te,Xe),ee=p(Ja,ee,We),ot===null?Ge=Ja:ot.sibling=Ja,ot=Ja,Xe=br}if(Tt.done)return l(te,Xe),St&&js(te,We),Ge;if(Xe===null){for(;!Tt.done;We++,Tt=ae.next())Tt=Se(te,Tt.value,Te),Tt!==null&&(ee=p(Tt,ee,We),ot===null?Ge=Tt:ot.sibling=Tt,ot=Tt);return St&&js(te,We),Ge}for(Xe=c(Xe);!Tt.done;We++,Tt=ae.next())Tt=he(Xe,te,We,Tt.value,Te),Tt!==null&&(n&&Tt.alternate!==null&&Xe.delete(Tt.key===null?We:Tt.key),ee=p(Tt,ee,We),ot===null?Ge=Tt:ot.sibling=Tt,ot=Tt);return n&&Xe.forEach(function(M4){return a(te,M4)}),St&&js(te,We),Ge}function Lt(te,ee,ae,Te){if(typeof ae=="object"&&ae!==null&&ae.type===b&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case y:e:{for(var Ge=ae.key;ee!==null;){if(ee.key===Ge){if(Ge=ae.type,Ge===b){if(ee.tag===7){l(te,ee.sibling),Te=d(ee,ae.props.children),Te.return=te,te=Te;break e}}else if(ee.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===D&&Bp(Ge)===ee.type){l(te,ee.sibling),Te=d(ee,ae.props),gu(Te,ae),Te.return=te,te=Te;break e}l(te,ee);break}else a(te,ee);ee=ee.sibling}ae.type===b?(Te=Bs(ae.props.children,te.mode,Te,ae.key),Te.return=te,te=Te):(Te=Zc(ae.type,ae.key,ae.props,null,te.mode,Te),gu(Te,ae),Te.return=te,te=Te)}return A(te);case T:e:{for(Ge=ae.key;ee!==null;){if(ee.key===Ge)if(ee.tag===4&&ee.stateNode.containerInfo===ae.containerInfo&&ee.stateNode.implementation===ae.implementation){l(te,ee.sibling),Te=d(ee,ae.children||[]),Te.return=te,te=Te;break e}else{l(te,ee);break}else a(te,ee);ee=ee.sibling}Te=kh(ae,te.mode,Te),Te.return=te,te=Te}return A(te);case D:return Ge=ae._init,ae=Ge(ae._payload),Lt(te,ee,ae,Te)}if(Be(ae))return Ze(te,ee,ae,Te);if(B(ae)){if(Ge=B(ae),typeof Ge!="function")throw Error(i(150));return ae=Ge.call(ae),Ke(te,ee,ae,Te)}if(typeof ae.then=="function")return Lt(te,ee,pf(ae),Te);if(ae.$$typeof===K)return Lt(te,ee,rf(te,ae),Te);vf(te,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,ee!==null&&ee.tag===6?(l(te,ee.sibling),Te=d(ee,ae),Te.return=te,te=Te):(l(te,ee),Te=Ih(ae,te.mode,Te),Te.return=te,te=Te),A(te)):l(te,ee)}return function(te,ee,ae,Te){try{mu=0;var Ge=Lt(te,ee,ae,Te);return ql=null,Ge}catch(Xe){if(Xe===au||Xe===af)throw Xe;var ot=bn(29,Xe,null,te.mode);return ot.lanes=Te,ot.return=te,ot}finally{}}}var Xl=Up(!0),jp=Up(!1),Wn=xe(null),ki=null;function Va(n){var a=n.alternate;X(yr,yr.current&1),X(Wn,n),ki===null&&(a===null||jl.current!==null||a.memoizedState!==null)&&(ki=n)}function zp(n){if(n.tag===22){if(X(yr,yr.current),X(Wn,n),ki===null){var a=n.alternate;a!==null&&a.memoizedState!==null&&(ki=n)}}else Ba()}function Ba(){X(yr,yr.current),X(Wn,Wn.current)}function ca(n){V(Wn),ki===n&&(ki=null),V(yr)}var yr=xe(0);function _f(n){for(var a=n;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||t1(l)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function hd(n,a,l,c){a=n.memoizedState,l=l(c,a),l=l==null?a:v({},a,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var dd={enqueueSetState:function(n,a,l){n=n._reactInternals;var c=In(),d=Fa(c);d.payload=a,l!=null&&(d.callback=l),a=Pa(n,d,c),a!==null&&(kn(a,n,c),lu(a,n,c))},enqueueReplaceState:function(n,a,l){n=n._reactInternals;var c=In(),d=Fa(c);d.tag=1,d.payload=a,l!=null&&(d.callback=l),a=Pa(n,d,c),a!==null&&(kn(a,n,c),lu(a,n,c))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var l=In(),c=Fa(l);c.tag=2,a!=null&&(c.callback=a),a=Pa(n,c,l),a!==null&&(kn(a,n,l),lu(a,n,l))}};function Hp(n,a,l,c,d,p,A){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,p,A):a.prototype&&a.prototype.isPureReactComponent?!$o(l,c)||!$o(d,p):!0}function Gp(n,a,l,c){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,c),a.state!==n&&dd.enqueueReplaceState(a,a.state,null)}function Ks(n,a){var l=a;if("ref"in a){l={};for(var c in a)c!=="ref"&&(l[c]=a[c])}if(n=n.defaultProps){l===a&&(l=v({},l));for(var d in n)l[d]===void 0&&(l[d]=n[d])}return l}var xf=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function qp(n){xf(n)}function Xp(n){console.error(n)}function Yp(n){xf(n)}function yf(n,a){try{var l=n.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Kp(n,a,l){try{var c=n.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function md(n,a,l){return l=Fa(l),l.tag=3,l.payload={element:null},l.callback=function(){yf(n,a)},l}function Wp(n){return n=Fa(n),n.tag=3,n}function Qp(n,a,l,c){var d=l.type.getDerivedStateFromError;if(typeof d=="function"){var p=c.value;n.payload=function(){return d(p)},n.callback=function(){Kp(a,l,c)}}var A=l.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(n.callback=function(){Kp(a,l,c),typeof d!="function"&&(qa===null?qa=new Set([this]):qa.add(this));var O=c.stack;this.componentDidCatch(c.value,{componentStack:O!==null?O:""})})}function MA(n,a,l,c,d){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=l.alternate,a!==null&&ru(a,l,d,!0),l=Wn.current,l!==null){switch(l.tag){case 13:return ki===null?Vd():l.alternate===null&&Jt===0&&(Jt=3),l.flags&=-257,l.flags|=65536,l.lanes=d,c===Hh?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([c]):a.add(c),Ud(n,c,d)),!1;case 22:return l.flags|=65536,c===Hh?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([c]):l.add(c)),Ud(n,c,d)),!1}throw Error(i(435,l.tag))}return Ud(n,c,d),Vd(),!1}if(St)return a=Wn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=d,c!==Ph&&(n=Error(i(422),{cause:c}),tu(qn(n,l)))):(c!==Ph&&(a=Error(i(423),{cause:c}),tu(qn(a,l))),n=n.current.alternate,n.flags|=65536,d&=-d,n.lanes|=d,c=qn(c,l),d=md(n.stateNode,c,d),Xh(n,d),Jt!==4&&(Jt=2)),!1;var p=Error(i(520),{cause:c});if(p=qn(p,l),Tu===null?Tu=[p]:Tu.push(p),Jt!==4&&(Jt=2),a===null)return!0;c=qn(c,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,n=d&-d,l.lanes|=n,n=md(l.stateNode,c,n),Xh(l,n),!1;case 1:if(a=l.type,p=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(qa===null||!qa.has(p))))return l.flags|=65536,d&=-d,l.lanes|=d,d=Wp(d),Qp(d,n,l,c),Xh(l,d),!1}l=l.return}while(l!==null);return!1}var $p=Error(i(461)),Rr=!1;function Mr(n,a,l,c){a.child=n===null?jp(a,null,l,c):Xl(a,n.child,l,c)}function Zp(n,a,l,c,d){l=l.render;var p=a.ref;if("ref"in c){var A={};for(var O in c)O!=="ref"&&(A[O]=c[O])}else A=c;return qs(a),c=$h(n,a,l,A,p,d),O=Zh(),n!==null&&!Rr?(Jh(n,a,d),fa(n,a,d)):(St&&O&&Mh(a),a.flags|=1,Mr(n,a,c,d),a.child)}function Jp(n,a,l,c,d){if(n===null){var p=l.type;return typeof p=="function"&&!Oh(p)&&p.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=p,ev(n,a,p,c,d)):(n=Zc(l.type,null,c,a,a.mode,d),n.ref=a.ref,n.return=a,a.child=n)}if(p=n.child,!Td(n,d)){var A=p.memoizedProps;if(l=l.compare,l=l!==null?l:$o,l(A,c)&&n.ref===a.ref)return fa(n,a,d)}return a.flags|=1,n=ia(p,c),n.ref=a.ref,n.return=a,a.child=n}function ev(n,a,l,c,d){if(n!==null){var p=n.memoizedProps;if($o(p,c)&&n.ref===a.ref)if(Rr=!1,a.pendingProps=c=p,Td(n,d))(n.flags&131072)!==0&&(Rr=!0);else return a.lanes=n.lanes,fa(n,a,d)}return gd(n,a,l,c,d)}function tv(n,a,l){var c=a.pendingProps,d=c.children,p=n!==null?n.memoizedState:null;if(c.mode==="hidden"){if((a.flags&128)!==0){if(c=p!==null?p.baseLanes|l:l,n!==null){for(d=a.child=n.child,p=0;d!==null;)p=p|d.lanes|d.childLanes,d=d.sibling;a.childLanes=p&~c}else a.childLanes=0,a.child=null;return rv(n,a,c,l)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},n!==null&&nf(a,p!==null?p.cachePool:null),p!==null?ep(a,p):Kh(),zp(a);else return a.lanes=a.childLanes=536870912,rv(n,a,p!==null?p.baseLanes|l:l,l)}else p!==null?(nf(a,p.cachePool),ep(a,p),Ba(),a.memoizedState=null):(n!==null&&nf(a,null),Kh(),Ba());return Mr(n,a,d,l),a.child}function rv(n,a,l,c){var d=zh();return d=d===null?null:{parent:xr._currentValue,pool:d},a.memoizedState={baseLanes:l,cachePool:d},n!==null&&nf(a,null),Kh(),zp(a),n!==null&&ru(n,a,c,!0),null}function Ef(n,a){var l=a.ref;if(l===null)n!==null&&n.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(n===null||n.ref!==l)&&(a.flags|=4194816)}}function gd(n,a,l,c,d){return qs(a),l=$h(n,a,l,c,void 0,d),c=Zh(),n!==null&&!Rr?(Jh(n,a,d),fa(n,a,d)):(St&&c&&Mh(a),a.flags|=1,Mr(n,a,l,d),a.child)}function nv(n,a,l,c,d,p){return qs(a),a.updateQueue=null,l=rp(a,c,l,d),tp(n),c=Zh(),n!==null&&!Rr?(Jh(n,a,p),fa(n,a,p)):(St&&c&&Mh(a),a.flags|=1,Mr(n,a,l,p),a.child)}function iv(n,a,l,c,d){if(qs(a),a.stateNode===null){var p=Pl,A=l.contextType;typeof A=="object"&&A!==null&&(p=Kr(A)),p=new l(c,p),a.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=dd,a.stateNode=p,p._reactInternals=a,p=a.stateNode,p.props=c,p.state=a.memoizedState,p.refs={},Gh(a),A=l.contextType,p.context=typeof A=="object"&&A!==null?Kr(A):Pl,p.state=a.memoizedState,A=l.getDerivedStateFromProps,typeof A=="function"&&(hd(a,l,A,c),p.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(A=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),A!==p.state&&dd.enqueueReplaceState(p,p.state,null),uu(a,c,p,d),ou(),p.state=a.memoizedState),typeof p.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(n===null){p=a.stateNode;var O=a.memoizedProps,Y=Ks(l,O);p.props=Y;var le=p.context,Ee=l.contextType;A=Pl,typeof Ee=="object"&&Ee!==null&&(A=Kr(Ee));var Se=l.getDerivedStateFromProps;Ee=typeof Se=="function"||typeof p.getSnapshotBeforeUpdate=="function",O=a.pendingProps!==O,Ee||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(O||le!==A)&&Gp(a,p,c,A),Ma=!1;var fe=a.memoizedState;p.state=fe,uu(a,c,p,d),ou(),le=a.memoizedState,O||fe!==le||Ma?(typeof Se=="function"&&(hd(a,l,Se,c),le=a.memoizedState),(Y=Ma||Hp(a,l,Y,c,fe,le,A))?(Ee||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(a.flags|=4194308)):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=le),p.props=c,p.state=le,p.context=A,c=Y):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{p=a.stateNode,qh(n,a),A=a.memoizedProps,Ee=Ks(l,A),p.props=Ee,Se=a.pendingProps,fe=p.context,le=l.contextType,Y=Pl,typeof le=="object"&&le!==null&&(Y=Kr(le)),O=l.getDerivedStateFromProps,(le=typeof O=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(A!==Se||fe!==Y)&&Gp(a,p,c,Y),Ma=!1,fe=a.memoizedState,p.state=fe,uu(a,c,p,d),ou();var he=a.memoizedState;A!==Se||fe!==he||Ma||n!==null&&n.dependencies!==null&&tf(n.dependencies)?(typeof O=="function"&&(hd(a,l,O,c),he=a.memoizedState),(Ee=Ma||Hp(a,l,Ee,c,fe,he,Y)||n!==null&&n.dependencies!==null&&tf(n.dependencies))?(le||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,he,Y),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,he,Y)),typeof p.componentDidUpdate=="function"&&(a.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof p.componentDidUpdate!="function"||A===n.memoizedProps&&fe===n.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&fe===n.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=he),p.props=c,p.state=he,p.context=Y,c=Ee):(typeof p.componentDidUpdate!="function"||A===n.memoizedProps&&fe===n.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&fe===n.memoizedState||(a.flags|=1024),c=!1)}return p=c,Ef(n,a),c=(a.flags&128)!==0,p||c?(p=a.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:p.render(),a.flags|=1,n!==null&&c?(a.child=Xl(a,n.child,null,d),a.child=Xl(a,null,l,d)):Mr(n,a,l,d),a.memoizedState=p.state,n=a.child):n=fa(n,a,d),n}function av(n,a,l,c){return eu(),a.flags|=256,Mr(n,a,l,c),a.child}var pd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vd(n){return{baseLanes:n,cachePool:Xg()}}function _d(n,a,l){return n=n!==null?n.childLanes&~l:0,a&&(n|=Qn),n}function sv(n,a,l){var c=a.pendingProps,d=!1,p=(a.flags&128)!==0,A;if((A=p)||(A=n!==null&&n.memoizedState===null?!1:(yr.current&2)!==0),A&&(d=!0,a.flags&=-129),A=(a.flags&32)!==0,a.flags&=-33,n===null){if(St){if(d?Va(a):Ba(),St){var O=Zt,Y;if(Y=O){e:{for(Y=O,O=Ii;Y.nodeType!==8;){if(!O){O=null;break e}if(Y=oi(Y.nextSibling),Y===null){O=null;break e}}O=Y}O!==null?(a.memoizedState={dehydrated:O,treeContext:Us!==null?{id:aa,overflow:sa}:null,retryLane:536870912,hydrationErrors:null},Y=bn(18,null,null,0),Y.stateNode=O,Y.return=a,a.child=Y,on=a,Zt=null,Y=!0):Y=!1}Y||Hs(a)}if(O=a.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return t1(O)?a.lanes=32:a.lanes=536870912,null;ca(a)}return O=c.children,c=c.fallback,d?(Ba(),d=a.mode,O=Tf({mode:"hidden",children:O},d),c=Bs(c,d,l,null),O.return=a,c.return=a,O.sibling=c,a.child=O,d=a.child,d.memoizedState=vd(l),d.childLanes=_d(n,A,l),a.memoizedState=pd,c):(Va(a),xd(a,O))}if(Y=n.memoizedState,Y!==null&&(O=Y.dehydrated,O!==null)){if(p)a.flags&256?(Va(a),a.flags&=-257,a=yd(n,a,l)):a.memoizedState!==null?(Ba(),a.child=n.child,a.flags|=128,a=null):(Ba(),d=c.fallback,O=a.mode,c=Tf({mode:"visible",children:c.children},O),d=Bs(d,O,l,null),d.flags|=2,c.return=a,d.return=a,c.sibling=d,a.child=c,Xl(a,n.child,null,l),c=a.child,c.memoizedState=vd(l),c.childLanes=_d(n,A,l),a.memoizedState=pd,a=d);else if(Va(a),t1(O)){if(A=O.nextSibling&&O.nextSibling.dataset,A)var le=A.dgst;A=le,c=Error(i(419)),c.stack="",c.digest=A,tu({value:c,source:null,stack:null}),a=yd(n,a,l)}else if(Rr||ru(n,a,l,!1),A=(l&n.childLanes)!==0,Rr||A){if(A=Ht,A!==null&&(c=l&-l,c=(c&42)!==0?1:Ei(c),c=(c&(A.suspendedLanes|l))!==0?0:c,c!==0&&c!==Y.retryLane))throw Y.retryLane=c,Fl(n,c),kn(A,n,c),$p;O.data==="$?"||Vd(),a=yd(n,a,l)}else O.data==="$?"?(a.flags|=192,a.child=n.child,a=null):(n=Y.treeContext,Zt=oi(O.nextSibling),on=a,St=!0,zs=null,Ii=!1,n!==null&&(Yn[Kn++]=aa,Yn[Kn++]=sa,Yn[Kn++]=Us,aa=n.id,sa=n.overflow,Us=a),a=xd(a,c.children),a.flags|=4096);return a}return d?(Ba(),d=c.fallback,O=a.mode,Y=n.child,le=Y.sibling,c=ia(Y,{mode:"hidden",children:c.children}),c.subtreeFlags=Y.subtreeFlags&65011712,le!==null?d=ia(le,d):(d=Bs(d,O,l,null),d.flags|=2),d.return=a,c.return=a,c.sibling=d,a.child=c,c=d,d=a.child,O=n.child.memoizedState,O===null?O=vd(l):(Y=O.cachePool,Y!==null?(le=xr._currentValue,Y=Y.parent!==le?{parent:le,pool:le}:Y):Y=Xg(),O={baseLanes:O.baseLanes|l,cachePool:Y}),d.memoizedState=O,d.childLanes=_d(n,A,l),a.memoizedState=pd,c):(Va(a),l=n.child,n=l.sibling,l=ia(l,{mode:"visible",children:c.children}),l.return=a,l.sibling=null,n!==null&&(A=a.deletions,A===null?(a.deletions=[n],a.flags|=16):A.push(n)),a.child=l,a.memoizedState=null,l)}function xd(n,a){return a=Tf({mode:"visible",children:a},n.mode),a.return=n,n.child=a}function Tf(n,a){return n=bn(22,n,null,a),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function yd(n,a,l){return Xl(a,n.child,null,l),n=xd(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function lv(n,a,l){n.lanes|=a;var c=n.alternate;c!==null&&(c.lanes|=a),Vh(n.return,a,l)}function Ed(n,a,l,c,d){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:d}:(p.isBackwards=a,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=l,p.tailMode=d)}function ov(n,a,l){var c=a.pendingProps,d=c.revealOrder,p=c.tail;if(Mr(n,a,c.children,l),c=yr.current,(c&2)!==0)c=c&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&lv(n,l,a);else if(n.tag===19)lv(n,l,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}switch(X(yr,c),d){case"forwards":for(l=a.child,d=null;l!==null;)n=l.alternate,n!==null&&_f(n)===null&&(d=l),l=l.sibling;l=d,l===null?(d=a.child,a.child=null):(d=l.sibling,l.sibling=null),Ed(a,!1,d,l,p);break;case"backwards":for(l=null,d=a.child,a.child=null;d!==null;){if(n=d.alternate,n!==null&&_f(n)===null){a.child=d;break}n=d.sibling,d.sibling=l,l=d,d=n}Ed(a,!0,l,null,p);break;case"together":Ed(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function fa(n,a,l){if(n!==null&&(a.dependencies=n.dependencies),Ga|=a.lanes,(l&a.childLanes)===0)if(n!==null){if(ru(n,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(n!==null&&a.child!==n.child)throw Error(i(153));if(a.child!==null){for(n=a.child,l=ia(n,n.pendingProps),a.child=l,l.return=a;n.sibling!==null;)n=n.sibling,l=l.sibling=ia(n,n.pendingProps),l.return=a;l.sibling=null}return a.child}function Td(n,a){return(n.lanes&a)!==0?!0:(n=n.dependencies,!!(n!==null&&tf(n)))}function FA(n,a,l){switch(a.tag){case 3:ve(a,a.stateNode.containerInfo),ka(a,xr,n.memoizedState.cache),eu();break;case 27:case 5:De(a);break;case 4:ve(a,a.stateNode.containerInfo);break;case 10:ka(a,a.type,a.memoizedProps.value);break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Va(a),a.flags|=128,null):(l&a.child.childLanes)!==0?sv(n,a,l):(Va(a),n=fa(n,a,l),n!==null?n.sibling:null);Va(a);break;case 19:var d=(n.flags&128)!==0;if(c=(l&a.childLanes)!==0,c||(ru(n,a,l,!1),c=(l&a.childLanes)!==0),d){if(c)return ov(n,a,l);a.flags|=128}if(d=a.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),X(yr,yr.current),c)break;return null;case 22:case 23:return a.lanes=0,tv(n,a,l);case 24:ka(a,xr,n.memoizedState.cache)}return fa(n,a,l)}function uv(n,a,l){if(n!==null)if(n.memoizedProps!==a.pendingProps)Rr=!0;else{if(!Td(n,l)&&(a.flags&128)===0)return Rr=!1,FA(n,a,l);Rr=(n.flags&131072)!==0}else Rr=!1,St&&(a.flags&1048576)!==0&&Bg(a,ef,a.index);switch(a.lanes=0,a.tag){case 16:e:{n=a.pendingProps;var c=a.elementType,d=c._init;if(c=d(c._payload),a.type=c,typeof c=="function")Oh(c)?(n=Ks(c,n),a.tag=1,a=iv(null,a,c,n,l)):(a.tag=0,a=gd(null,a,c,n,l));else{if(c!=null){if(d=c.$$typeof,d===ne){a.tag=11,a=Zp(null,a,c,n,l);break e}else if(d===N){a.tag=14,a=Jp(null,a,c,n,l);break e}}throw a=qe(c)||c,Error(i(306,a,""))}}return a;case 0:return gd(n,a,a.type,a.pendingProps,l);case 1:return c=a.type,d=Ks(c,a.pendingProps),iv(n,a,c,d,l);case 3:e:{if(ve(a,a.stateNode.containerInfo),n===null)throw Error(i(387));c=a.pendingProps;var p=a.memoizedState;d=p.element,qh(n,a),uu(a,c,null,l);var A=a.memoizedState;if(c=A.cache,ka(a,xr,c),c!==p.cache&&Bh(a,[xr],l,!0),ou(),c=A.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:A.cache},a.updateQueue.baseState=p,a.memoizedState=p,a.flags&256){a=av(n,a,c,l);break e}else if(c!==d){d=qn(Error(i(424)),a),tu(d),a=av(n,a,c,l);break e}else{switch(n=a.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Zt=oi(n.firstChild),on=a,St=!0,zs=null,Ii=!0,l=jp(a,null,c,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(eu(),c===d){a=fa(n,a,l);break e}Mr(n,a,c,l)}a=a.child}return a;case 26:return Ef(n,a),n===null?(l=d_(a.type,null,a.pendingProps,null))?a.memoizedState=l:St||(l=a.type,n=a.pendingProps,c=Pf(oe.current).createElement(l),c[nr]=a,c[Yt]=n,Pr(c,l,n),re(c),a.stateNode=c):a.memoizedState=d_(a.type,n.memoizedProps,a.pendingProps,n.memoizedState),null;case 27:return De(a),n===null&&St&&(c=a.stateNode=c_(a.type,a.pendingProps,oe.current),on=a,Ii=!0,d=Zt,Ka(a.type)?(r1=d,Zt=oi(c.firstChild)):Zt=d),Mr(n,a,a.pendingProps.children,l),Ef(n,a),n===null&&(a.flags|=4194304),a.child;case 5:return n===null&&St&&((d=c=Zt)&&(c=u4(c,a.type,a.pendingProps,Ii),c!==null?(a.stateNode=c,on=a,Zt=oi(c.firstChild),Ii=!1,d=!0):d=!1),d||Hs(a)),De(a),d=a.type,p=a.pendingProps,A=n!==null?n.memoizedProps:null,c=p.children,Zd(d,p)?c=null:A!==null&&Zd(d,A)&&(a.flags|=32),a.memoizedState!==null&&(d=$h(n,a,CA,null,null,l),Ou._currentValue=d),Ef(n,a),Mr(n,a,c,l),a.child;case 6:return n===null&&St&&((n=l=Zt)&&(l=c4(l,a.pendingProps,Ii),l!==null?(a.stateNode=l,on=a,Zt=null,n=!0):n=!1),n||Hs(a)),null;case 13:return sv(n,a,l);case 4:return ve(a,a.stateNode.containerInfo),c=a.pendingProps,n===null?a.child=Xl(a,null,c,l):Mr(n,a,c,l),a.child;case 11:return Zp(n,a,a.type,a.pendingProps,l);case 7:return Mr(n,a,a.pendingProps,l),a.child;case 8:return Mr(n,a,a.pendingProps.children,l),a.child;case 12:return Mr(n,a,a.pendingProps.children,l),a.child;case 10:return c=a.pendingProps,ka(a,a.type,c.value),Mr(n,a,c.children,l),a.child;case 9:return d=a.type._context,c=a.pendingProps.children,qs(a),d=Kr(d),c=c(d),a.flags|=1,Mr(n,a,c,l),a.child;case 14:return Jp(n,a,a.type,a.pendingProps,l);case 15:return ev(n,a,a.type,a.pendingProps,l);case 19:return ov(n,a,l);case 31:return c=a.pendingProps,l=a.mode,c={mode:c.mode,children:c.children},n===null?(l=Tf(c,l),l.ref=a.ref,a.child=l,l.return=a,a=l):(l=ia(n.child,c),l.ref=a.ref,a.child=l,l.return=a,a=l),a;case 22:return tv(n,a,l);case 24:return qs(a),c=Kr(xr),n===null?(d=zh(),d===null&&(d=Ht,p=Uh(),d.pooledCache=p,p.refCount++,p!==null&&(d.pooledCacheLanes|=l),d=p),a.memoizedState={parent:c,cache:d},Gh(a),ka(a,xr,d)):((n.lanes&l)!==0&&(qh(n,a),uu(a,null,null,l),ou()),d=n.memoizedState,p=a.memoizedState,d.parent!==c?(d={parent:c,cache:c},a.memoizedState=d,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=d),ka(a,xr,c)):(c=p.cache,ka(a,xr,c),c!==d.cache&&Bh(a,[xr],l,!0))),Mr(n,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function ha(n){n.flags|=4}function cv(n,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!__(a)){if(a=Wn.current,a!==null&&((vt&4194048)===vt?ki!==null:(vt&62914560)!==vt&&(vt&536870912)===0||a!==ki))throw su=Hh,Yg;n.flags|=8192}}function Af(n,a){a!==null&&(n.flags|=4),n.flags&16384&&(a=n.tag!==22?Da():536870912,n.lanes|=a,Ql|=a)}function pu(n,a){if(!St)switch(n.tailMode){case"hidden":a=n.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Qt(n){var a=n.alternate!==null&&n.alternate.child===n.child,l=0,c=0;if(a)for(var d=n.child;d!==null;)l|=d.lanes|d.childLanes,c|=d.subtreeFlags&65011712,c|=d.flags&65011712,d.return=n,d=d.sibling;else for(d=n.child;d!==null;)l|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=n,d=d.sibling;return n.subtreeFlags|=c,n.childLanes=l,a}function PA(n,a,l){var c=a.pendingProps;switch(Fh(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(a),null;case 1:return Qt(a),null;case 3:return l=a.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),oa(xr),Ne(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(Jo(a)?ha(a):n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,zg())),Qt(a),null;case 26:return l=a.memoizedState,n===null?(ha(a),l!==null?(Qt(a),cv(a,l)):(Qt(a),a.flags&=-16777217)):l?l!==n.memoizedState?(ha(a),Qt(a),cv(a,l)):(Qt(a),a.flags&=-16777217):(n.memoizedProps!==c&&ha(a),Qt(a),a.flags&=-16777217),null;case 27:ut(a),l=oe.current;var d=a.type;if(n!==null&&a.stateNode!=null)n.memoizedProps!==c&&ha(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return Qt(a),null}n=q.current,Jo(a)?Ug(a):(n=c_(d,c,l),a.stateNode=n,ha(a))}return Qt(a),null;case 5:if(ut(a),l=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==c&&ha(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return Qt(a),null}if(n=q.current,Jo(a))Ug(a);else{switch(d=Pf(oe.current),n){case 1:n=d.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:n=d.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":n=d.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":n=d.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":n=d.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof c.is=="string"?d.createElement("select",{is:c.is}):d.createElement("select"),c.multiple?n.multiple=!0:c.size&&(n.size=c.size);break;default:n=typeof c.is=="string"?d.createElement(l,{is:c.is}):d.createElement(l)}}n[nr]=a,n[Yt]=c;e:for(d=a.child;d!==null;){if(d.tag===5||d.tag===6)n.appendChild(d.stateNode);else if(d.tag!==4&&d.tag!==27&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===a)break e;for(;d.sibling===null;){if(d.return===null||d.return===a)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}a.stateNode=n;e:switch(Pr(n,l,c),l){case"button":case"input":case"select":case"textarea":n=!!c.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&ha(a)}}return Qt(a),a.flags&=-16777217,null;case 6:if(n&&a.stateNode!=null)n.memoizedProps!==c&&ha(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(n=oe.current,Jo(a)){if(n=a.stateNode,l=a.memoizedProps,c=null,d=on,d!==null)switch(d.tag){case 27:case 5:c=d.memoizedProps}n[nr]=a,n=!!(n.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||n_(n.nodeValue,l)),n||Hs(a)}else n=Pf(n).createTextNode(c),n[nr]=a,a.stateNode=n}return Qt(a),null;case 13:if(c=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(d=Jo(a),c!==null&&c.dehydrated!==null){if(n===null){if(!d)throw Error(i(318));if(d=a.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(i(317));d[nr]=a}else eu(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Qt(a),d=!1}else d=zg(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=d),d=!0;if(!d)return a.flags&256?(ca(a),a):(ca(a),null)}if(ca(a),(a.flags&128)!==0)return a.lanes=l,a;if(l=c!==null,n=n!==null&&n.memoizedState!==null,l){c=a.child,d=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(d=c.alternate.memoizedState.cachePool.pool);var p=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==d&&(c.flags|=2048)}return l!==n&&l&&(a.child.flags|=8192),Af(a,a.updateQueue),Qt(a),null;case 4:return Ne(),n===null&&Yd(a.stateNode.containerInfo),Qt(a),null;case 10:return oa(a.type),Qt(a),null;case 19:if(V(yr),d=a.memoizedState,d===null)return Qt(a),null;if(c=(a.flags&128)!==0,p=d.rendering,p===null)if(c)pu(d,!1);else{if(Jt!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(p=_f(n),p!==null){for(a.flags|=128,pu(d,!1),n=p.updateQueue,a.updateQueue=n,Af(a,n),a.subtreeFlags=0,n=l,l=a.child;l!==null;)Vg(l,n),l=l.sibling;return X(yr,yr.current&1|2),a.child}n=n.sibling}d.tail!==null&&Ve()>Rf&&(a.flags|=128,c=!0,pu(d,!1),a.lanes=4194304)}else{if(!c)if(n=_f(p),n!==null){if(a.flags|=128,c=!0,n=n.updateQueue,a.updateQueue=n,Af(a,n),pu(d,!0),d.tail===null&&d.tailMode==="hidden"&&!p.alternate&&!St)return Qt(a),null}else 2*Ve()-d.renderingStartTime>Rf&&l!==536870912&&(a.flags|=128,c=!0,pu(d,!1),a.lanes=4194304);d.isBackwards?(p.sibling=a.child,a.child=p):(n=d.last,n!==null?n.sibling=p:a.child=p,d.last=p)}return d.tail!==null?(a=d.tail,d.rendering=a,d.tail=a.sibling,d.renderingStartTime=Ve(),a.sibling=null,n=yr.current,X(yr,c?n&1|2:n&1),a):(Qt(a),null);case 22:case 23:return ca(a),Wh(),c=a.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(l&536870912)!==0&&(a.flags&128)===0&&(Qt(a),a.subtreeFlags&6&&(a.flags|=8192)):Qt(a),l=a.updateQueue,l!==null&&Af(a,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==l&&(a.flags|=2048),n!==null&&V(Xs),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),oa(xr),Qt(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function LA(n,a){switch(Fh(a),a.tag){case 1:return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return oa(xr),Ne(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 26:case 27:case 5:return ut(a),null;case 13:if(ca(a),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(i(340));eu()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return V(yr),null;case 4:return Ne(),null;case 10:return oa(a.type),null;case 22:case 23:return ca(a),Wh(),n!==null&&V(Xs),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 24:return oa(xr),null;case 25:return null;default:return null}}function fv(n,a){switch(Fh(a),a.tag){case 3:oa(xr),Ne();break;case 26:case 27:case 5:ut(a);break;case 4:Ne();break;case 13:ca(a);break;case 19:V(yr);break;case 10:oa(a.type);break;case 22:case 23:ca(a),Wh(),n!==null&&V(Xs);break;case 24:oa(xr)}}function vu(n,a){try{var l=a.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var d=c.next;l=d;do{if((l.tag&n)===n){c=void 0;var p=l.create,A=l.inst;c=p(),A.destroy=c}l=l.next}while(l!==d)}}catch(O){Ut(a,a.return,O)}}function Ua(n,a,l){try{var c=a.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var p=d.next;c=p;do{if((c.tag&n)===n){var A=c.inst,O=A.destroy;if(O!==void 0){A.destroy=void 0,d=a;var Y=l,le=O;try{le()}catch(Ee){Ut(d,Y,Ee)}}}c=c.next}while(c!==p)}}catch(Ee){Ut(a,a.return,Ee)}}function hv(n){var a=n.updateQueue;if(a!==null){var l=n.stateNode;try{Jg(a,l)}catch(c){Ut(n,n.return,c)}}}function dv(n,a,l){l.props=Ks(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(c){Ut(n,a,c)}}function _u(n,a){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof l=="function"?n.refCleanup=l(c):l.current=c}}catch(d){Ut(n,a,d)}}function Mi(n,a){var l=n.ref,c=n.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(d){Ut(n,a,d)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(d){Ut(n,a,d)}else l.current=null}function mv(n){var a=n.type,l=n.memoizedProps,c=n.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(d){Ut(n,n.return,d)}}function Ad(n,a,l){try{var c=n.stateNode;i4(c,n.type,l,a),c[Yt]=a}catch(d){Ut(n,n.return,d)}}function gv(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ka(n.type)||n.tag===4}function Sd(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||gv(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ka(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function wd(n,a,l){var c=n.tag;if(c===5||c===6)n=n.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(n),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Ff));else if(c!==4&&(c===27&&Ka(n.type)&&(l=n.stateNode,a=null),n=n.child,n!==null))for(wd(n,a,l),n=n.sibling;n!==null;)wd(n,a,l),n=n.sibling}function Sf(n,a,l){var c=n.tag;if(c===5||c===6)n=n.stateNode,a?l.insertBefore(n,a):l.appendChild(n);else if(c!==4&&(c===27&&Ka(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(Sf(n,a,l),n=n.sibling;n!==null;)Sf(n,a,l),n=n.sibling}function pv(n){var a=n.stateNode,l=n.memoizedProps;try{for(var c=n.type,d=a.attributes;d.length;)a.removeAttributeNode(d[0]);Pr(a,c,l),a[nr]=n,a[Yt]=l}catch(p){Ut(n,n.return,p)}}var da=!1,ar=!1,Rd=!1,vv=typeof WeakSet=="function"?WeakSet:Set,Cr=null;function VA(n,a){if(n=n.containerInfo,Qd=zf,n=bg(n),Sh(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var d=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var A=0,O=-1,Y=-1,le=0,Ee=0,Se=n,fe=null;t:for(;;){for(var he;Se!==l||d!==0&&Se.nodeType!==3||(O=A+d),Se!==p||c!==0&&Se.nodeType!==3||(Y=A+c),Se.nodeType===3&&(A+=Se.nodeValue.length),(he=Se.firstChild)!==null;)fe=Se,Se=he;for(;;){if(Se===n)break t;if(fe===l&&++le===d&&(O=A),fe===p&&++Ee===c&&(Y=A),(he=Se.nextSibling)!==null)break;Se=fe,fe=Se.parentNode}Se=he}l=O===-1||Y===-1?null:{start:O,end:Y}}else l=null}l=l||{start:0,end:0}}else l=null;for($d={focusedElem:n,selectionRange:l},zf=!1,Cr=a;Cr!==null;)if(a=Cr,n=a.child,(a.subtreeFlags&1024)!==0&&n!==null)n.return=a,Cr=n;else for(;Cr!==null;){switch(a=Cr,p=a.alternate,n=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&p!==null){n=void 0,l=a,d=p.memoizedProps,p=p.memoizedState,c=l.stateNode;try{var Ze=Ks(l.type,d,l.elementType===l.type);n=c.getSnapshotBeforeUpdate(Ze,p),c.__reactInternalSnapshotBeforeUpdate=n}catch(Ke){Ut(l,l.return,Ke)}}break;case 3:if((n&1024)!==0){if(n=a.stateNode.containerInfo,l=n.nodeType,l===9)e1(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":e1(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=a.sibling,n!==null){n.return=a.return,Cr=n;break}Cr=a.return}}function _v(n,a,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:ja(n,l),c&4&&vu(5,l);break;case 1:if(ja(n,l),c&4)if(n=l.stateNode,a===null)try{n.componentDidMount()}catch(A){Ut(l,l.return,A)}else{var d=Ks(l.type,a.memoizedProps);a=a.memoizedState;try{n.componentDidUpdate(d,a,n.__reactInternalSnapshotBeforeUpdate)}catch(A){Ut(l,l.return,A)}}c&64&&hv(l),c&512&&_u(l,l.return);break;case 3:if(ja(n,l),c&64&&(n=l.updateQueue,n!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{Jg(n,a)}catch(A){Ut(l,l.return,A)}}break;case 27:a===null&&c&4&&pv(l);case 26:case 5:ja(n,l),a===null&&c&4&&mv(l),c&512&&_u(l,l.return);break;case 12:ja(n,l);break;case 13:ja(n,l),c&4&&Ev(n,l),c&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=YA.bind(null,l),f4(n,l))));break;case 22:if(c=l.memoizedState!==null||da,!c){a=a!==null&&a.memoizedState!==null||ar,d=da;var p=ar;da=c,(ar=a)&&!p?za(n,l,(l.subtreeFlags&8772)!==0):ja(n,l),da=d,ar=p}break;case 30:break;default:ja(n,l)}}function xv(n){var a=n.alternate;a!==null&&(n.alternate=null,xv(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&L(a)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Kt=null,_n=!1;function ma(n,a,l){for(l=l.child;l!==null;)yv(n,a,l),l=l.sibling}function yv(n,a,l){if(yt&&typeof yt.onCommitFiberUnmount=="function")try{yt.onCommitFiberUnmount(jt,l)}catch{}switch(l.tag){case 26:ar||Mi(l,a),ma(n,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ar||Mi(l,a);var c=Kt,d=_n;Ka(l.type)&&(Kt=l.stateNode,_n=!1),ma(n,a,l),Cu(l.stateNode),Kt=c,_n=d;break;case 5:ar||Mi(l,a);case 6:if(c=Kt,d=_n,Kt=null,ma(n,a,l),Kt=c,_n=d,Kt!==null)if(_n)try{(Kt.nodeType===9?Kt.body:Kt.nodeName==="HTML"?Kt.ownerDocument.body:Kt).removeChild(l.stateNode)}catch(p){Ut(l,a,p)}else try{Kt.removeChild(l.stateNode)}catch(p){Ut(l,a,p)}break;case 18:Kt!==null&&(_n?(n=Kt,o_(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),Fu(n)):o_(Kt,l.stateNode));break;case 4:c=Kt,d=_n,Kt=l.stateNode.containerInfo,_n=!0,ma(n,a,l),Kt=c,_n=d;break;case 0:case 11:case 14:case 15:ar||Ua(2,l,a),ar||Ua(4,l,a),ma(n,a,l);break;case 1:ar||(Mi(l,a),c=l.stateNode,typeof c.componentWillUnmount=="function"&&dv(l,a,c)),ma(n,a,l);break;case 21:ma(n,a,l);break;case 22:ar=(c=ar)||l.memoizedState!==null,ma(n,a,l),ar=c;break;default:ma(n,a,l)}}function Ev(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Fu(n)}catch(l){Ut(a,a.return,l)}}function BA(n){switch(n.tag){case 13:case 19:var a=n.stateNode;return a===null&&(a=n.stateNode=new vv),a;case 22:return n=n.stateNode,a=n._retryCache,a===null&&(a=n._retryCache=new vv),a;default:throw Error(i(435,n.tag))}}function Cd(n,a){var l=BA(n);a.forEach(function(c){var d=KA.bind(null,n,c);l.has(c)||(l.add(c),c.then(d,d))})}function Dn(n,a){var l=a.deletions;if(l!==null)for(var c=0;c<l.length;c++){var d=l[c],p=n,A=a,O=A;e:for(;O!==null;){switch(O.tag){case 27:if(Ka(O.type)){Kt=O.stateNode,_n=!1;break e}break;case 5:Kt=O.stateNode,_n=!1;break e;case 3:case 4:Kt=O.stateNode.containerInfo,_n=!0;break e}O=O.return}if(Kt===null)throw Error(i(160));yv(p,A,d),Kt=null,_n=!1,p=d.alternate,p!==null&&(p.return=null),d.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)Tv(a,n),a=a.sibling}var li=null;function Tv(n,a){var l=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Dn(a,n),Nn(n),c&4&&(Ua(3,n,n.return),vu(3,n),Ua(5,n,n.return));break;case 1:Dn(a,n),Nn(n),c&512&&(ar||l===null||Mi(l,l.return)),c&64&&da&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var d=li;if(Dn(a,n),Nn(n),c&512&&(ar||l===null||Mi(l,l.return)),c&4){var p=l!==null?l.memoizedState:null;if(c=n.memoizedState,l===null)if(c===null)if(n.stateNode===null){e:{c=n.type,l=n.memoizedProps,d=d.ownerDocument||d;t:switch(c){case"title":p=d.getElementsByTagName("title")[0],(!p||p[M]||p[nr]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=d.createElement(c),d.head.insertBefore(p,d.querySelector("head > title"))),Pr(p,c,l),p[nr]=n,re(p),c=p;break e;case"link":var A=p_("link","href",d).get(c+(l.href||""));if(A){for(var O=0;O<A.length;O++)if(p=A[O],p.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&p.getAttribute("rel")===(l.rel==null?null:l.rel)&&p.getAttribute("title")===(l.title==null?null:l.title)&&p.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){A.splice(O,1);break t}}p=d.createElement(c),Pr(p,c,l),d.head.appendChild(p);break;case"meta":if(A=p_("meta","content",d).get(c+(l.content||""))){for(O=0;O<A.length;O++)if(p=A[O],p.getAttribute("content")===(l.content==null?null:""+l.content)&&p.getAttribute("name")===(l.name==null?null:l.name)&&p.getAttribute("property")===(l.property==null?null:l.property)&&p.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&p.getAttribute("charset")===(l.charSet==null?null:l.charSet)){A.splice(O,1);break t}}p=d.createElement(c),Pr(p,c,l),d.head.appendChild(p);break;default:throw Error(i(468,c))}p[nr]=n,re(p),c=p}n.stateNode=c}else v_(d,n.type,n.stateNode);else n.stateNode=g_(d,c,n.memoizedProps);else p!==c?(p===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):p.count--,c===null?v_(d,n.type,n.stateNode):g_(d,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Ad(n,n.memoizedProps,l.memoizedProps)}break;case 27:Dn(a,n),Nn(n),c&512&&(ar||l===null||Mi(l,l.return)),l!==null&&c&4&&Ad(n,n.memoizedProps,l.memoizedProps);break;case 5:if(Dn(a,n),Nn(n),c&512&&(ar||l===null||Mi(l,l.return)),n.flags&32){d=n.stateNode;try{jn(d,"")}catch(he){Ut(n,n.return,he)}}c&4&&n.stateNode!=null&&(d=n.memoizedProps,Ad(n,d,l!==null?l.memoizedProps:d)),c&1024&&(Rd=!0);break;case 6:if(Dn(a,n),Nn(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,l=n.stateNode;try{l.nodeValue=c}catch(he){Ut(n,n.return,he)}}break;case 3:if(Bf=null,d=li,li=Lf(a.containerInfo),Dn(a,n),li=d,Nn(n),c&4&&l!==null&&l.memoizedState.isDehydrated)try{Fu(a.containerInfo)}catch(he){Ut(n,n.return,he)}Rd&&(Rd=!1,Av(n));break;case 4:c=li,li=Lf(n.stateNode.containerInfo),Dn(a,n),Nn(n),li=c;break;case 12:Dn(a,n),Nn(n);break;case 13:Dn(a,n),Nn(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(kd=Ve()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Cd(n,c)));break;case 22:d=n.memoizedState!==null;var Y=l!==null&&l.memoizedState!==null,le=da,Ee=ar;if(da=le||d,ar=Ee||Y,Dn(a,n),ar=Ee,da=le,Nn(n),c&8192)e:for(a=n.stateNode,a._visibility=d?a._visibility&-2:a._visibility|1,d&&(l===null||Y||da||ar||Ws(n)),l=null,a=n;;){if(a.tag===5||a.tag===26){if(l===null){Y=l=a;try{if(p=Y.stateNode,d)A=p.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{O=Y.stateNode;var Se=Y.memoizedProps.style,fe=Se!=null&&Se.hasOwnProperty("display")?Se.display:null;O.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(he){Ut(Y,Y.return,he)}}}else if(a.tag===6){if(l===null){Y=a;try{Y.stateNode.nodeValue=d?"":Y.memoizedProps}catch(he){Ut(Y,Y.return,he)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===n)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break e;for(;a.sibling===null;){if(a.return===null||a.return===n)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=n.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Cd(n,l))));break;case 19:Dn(a,n),Nn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Cd(n,c)));break;case 30:break;case 21:break;default:Dn(a,n),Nn(n)}}function Nn(n){var a=n.flags;if(a&2){try{for(var l,c=n.return;c!==null;){if(gv(c)){l=c;break}c=c.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var d=l.stateNode,p=Sd(n);Sf(n,p,d);break;case 5:var A=l.stateNode;l.flags&32&&(jn(A,""),l.flags&=-33);var O=Sd(n);Sf(n,O,A);break;case 3:case 4:var Y=l.stateNode.containerInfo,le=Sd(n);wd(n,le,Y);break;default:throw Error(i(161))}}catch(Ee){Ut(n,n.return,Ee)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function Av(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var a=n;Av(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),n=n.sibling}}function ja(n,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)_v(n,a.alternate,a),a=a.sibling}function Ws(n){for(n=n.child;n!==null;){var a=n;switch(a.tag){case 0:case 11:case 14:case 15:Ua(4,a,a.return),Ws(a);break;case 1:Mi(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&dv(a,a.return,l),Ws(a);break;case 27:Cu(a.stateNode);case 26:case 5:Mi(a,a.return),Ws(a);break;case 22:a.memoizedState===null&&Ws(a);break;case 30:Ws(a);break;default:Ws(a)}n=n.sibling}}function za(n,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,d=n,p=a,A=p.flags;switch(p.tag){case 0:case 11:case 15:za(d,p,l),vu(4,p);break;case 1:if(za(d,p,l),c=p,d=c.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(le){Ut(c,c.return,le)}if(c=p,d=c.updateQueue,d!==null){var O=c.stateNode;try{var Y=d.shared.hiddenCallbacks;if(Y!==null)for(d.shared.hiddenCallbacks=null,d=0;d<Y.length;d++)Zg(Y[d],O)}catch(le){Ut(c,c.return,le)}}l&&A&64&&hv(p),_u(p,p.return);break;case 27:pv(p);case 26:case 5:za(d,p,l),l&&c===null&&A&4&&mv(p),_u(p,p.return);break;case 12:za(d,p,l);break;case 13:za(d,p,l),l&&A&4&&Ev(d,p);break;case 22:p.memoizedState===null&&za(d,p,l),_u(p,p.return);break;case 30:break;default:za(d,p,l)}a=a.sibling}}function bd(n,a){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(n=a.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&nu(l))}function Dd(n,a){n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&nu(n))}function Fi(n,a,l,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Sv(n,a,l,c),a=a.sibling}function Sv(n,a,l,c){var d=a.flags;switch(a.tag){case 0:case 11:case 15:Fi(n,a,l,c),d&2048&&vu(9,a);break;case 1:Fi(n,a,l,c);break;case 3:Fi(n,a,l,c),d&2048&&(n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&nu(n)));break;case 12:if(d&2048){Fi(n,a,l,c),n=a.stateNode;try{var p=a.memoizedProps,A=p.id,O=p.onPostCommit;typeof O=="function"&&O(A,a.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(Y){Ut(a,a.return,Y)}}else Fi(n,a,l,c);break;case 13:Fi(n,a,l,c);break;case 23:break;case 22:p=a.stateNode,A=a.alternate,a.memoizedState!==null?p._visibility&2?Fi(n,a,l,c):xu(n,a):p._visibility&2?Fi(n,a,l,c):(p._visibility|=2,Yl(n,a,l,c,(a.subtreeFlags&10256)!==0)),d&2048&&bd(A,a);break;case 24:Fi(n,a,l,c),d&2048&&Dd(a.alternate,a);break;default:Fi(n,a,l,c)}}function Yl(n,a,l,c,d){for(d=d&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var p=n,A=a,O=l,Y=c,le=A.flags;switch(A.tag){case 0:case 11:case 15:Yl(p,A,O,Y,d),vu(8,A);break;case 23:break;case 22:var Ee=A.stateNode;A.memoizedState!==null?Ee._visibility&2?Yl(p,A,O,Y,d):xu(p,A):(Ee._visibility|=2,Yl(p,A,O,Y,d)),d&&le&2048&&bd(A.alternate,A);break;case 24:Yl(p,A,O,Y,d),d&&le&2048&&Dd(A.alternate,A);break;default:Yl(p,A,O,Y,d)}a=a.sibling}}function xu(n,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=n,c=a,d=c.flags;switch(c.tag){case 22:xu(l,c),d&2048&&bd(c.alternate,c);break;case 24:xu(l,c),d&2048&&Dd(c.alternate,c);break;default:xu(l,c)}a=a.sibling}}var yu=8192;function Kl(n){if(n.subtreeFlags&yu)for(n=n.child;n!==null;)wv(n),n=n.sibling}function wv(n){switch(n.tag){case 26:Kl(n),n.flags&yu&&n.memoizedState!==null&&S4(li,n.memoizedState,n.memoizedProps);break;case 5:Kl(n);break;case 3:case 4:var a=li;li=Lf(n.stateNode.containerInfo),Kl(n),li=a;break;case 22:n.memoizedState===null&&(a=n.alternate,a!==null&&a.memoizedState!==null?(a=yu,yu=16777216,Kl(n),yu=a):Kl(n));break;default:Kl(n)}}function Rv(n){var a=n.alternate;if(a!==null&&(n=a.child,n!==null)){a.child=null;do a=n.sibling,n.sibling=null,n=a;while(n!==null)}}function Eu(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];Cr=c,bv(c,n)}Rv(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Cv(n),n=n.sibling}function Cv(n){switch(n.tag){case 0:case 11:case 15:Eu(n),n.flags&2048&&Ua(9,n,n.return);break;case 3:Eu(n);break;case 12:Eu(n);break;case 22:var a=n.stateNode;n.memoizedState!==null&&a._visibility&2&&(n.return===null||n.return.tag!==13)?(a._visibility&=-3,wf(n)):Eu(n);break;default:Eu(n)}}function wf(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];Cr=c,bv(c,n)}Rv(n)}for(n=n.child;n!==null;){switch(a=n,a.tag){case 0:case 11:case 15:Ua(8,a,a.return),wf(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,wf(a));break;default:wf(a)}n=n.sibling}}function bv(n,a){for(;Cr!==null;){var l=Cr;switch(l.tag){case 0:case 11:case 15:Ua(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:nu(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,Cr=c;else e:for(l=n;Cr!==null;){c=Cr;var d=c.sibling,p=c.return;if(xv(c),c===l){Cr=null;break e}if(d!==null){d.return=p,Cr=d;break e}Cr=p}}}var UA={getCacheForType:function(n){var a=Kr(xr),l=a.data.get(n);return l===void 0&&(l=n(),a.data.set(n,l)),l}},jA=typeof WeakMap=="function"?WeakMap:Map,bt=0,Ht=null,ct=null,vt=0,Dt=0,On=null,Ha=!1,Wl=!1,Nd=!1,ga=0,Jt=0,Ga=0,Qs=0,Od=0,Qn=0,Ql=0,Tu=null,xn=null,Id=!1,kd=0,Rf=1/0,Cf=null,qa=null,Fr=0,Xa=null,$l=null,Zl=0,Md=0,Fd=null,Dv=null,Au=0,Pd=null;function In(){if((bt&2)!==0&&vt!==0)return vt&-vt;if(J.T!==null){var n=Bl;return n!==0?n:Hd()}return Ti()}function Nv(){Qn===0&&(Qn=(vt&536870912)===0||St?ba():536870912);var n=Wn.current;return n!==null&&(n.flags|=32),Qn}function kn(n,a,l){(n===Ht&&(Dt===2||Dt===9)||n.cancelPendingCommit!==null)&&(Jl(n,0),Ya(n,vt,Qn,!1)),ii(n,l),((bt&2)===0||n!==Ht)&&(n===Ht&&((bt&2)===0&&(Qs|=l),Jt===4&&Ya(n,vt,Qn,!1)),Pi(n))}function Ov(n,a,l){if((bt&6)!==0)throw Error(i(327));var c=!l&&(a&124)===0&&(a&n.expiredLanes)===0||Qi(n,a),d=c?GA(n,a):Bd(n,a,!0),p=c;do{if(d===0){Wl&&!c&&Ya(n,a,0,!1);break}else{if(l=n.current.alternate,p&&!zA(l)){d=Bd(n,a,!1),p=!1;continue}if(d===2){if(p=a,n.errorRecoveryDisabledLanes&p)var A=0;else A=n.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){a=A;e:{var O=n;d=Tu;var Y=O.current.memoizedState.isDehydrated;if(Y&&(Jl(O,A).flags|=256),A=Bd(O,A,!1),A!==2){if(Nd&&!Y){O.errorRecoveryDisabledLanes|=p,Qs|=p,d=4;break e}p=xn,xn=d,p!==null&&(xn===null?xn=p:xn.push.apply(xn,p))}d=A}if(p=!1,d!==2)continue}}if(d===1){Jl(n,0),Ya(n,a,0,!0);break}e:{switch(c=n,p=d,p){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Ya(c,a,Qn,!Ha);break e;case 2:xn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(d=kd+300-Ve(),10<d)){if(Ya(c,a,Qn,!Ha),Ra(c,0,!0)!==0)break e;c.timeoutHandle=s_(Iv.bind(null,c,l,xn,Cf,Id,a,Qn,Qs,Ql,Ha,p,2,-0,0),d);break e}Iv(c,l,xn,Cf,Id,a,Qn,Qs,Ql,Ha,p,0,-0,0)}}break}while(!0);Pi(n)}function Iv(n,a,l,c,d,p,A,O,Y,le,Ee,Se,fe,he){if(n.timeoutHandle=-1,Se=a.subtreeFlags,(Se&8192||(Se&16785408)===16785408)&&(Nu={stylesheets:null,count:0,unsuspend:A4},wv(a),Se=w4(),Se!==null)){n.cancelPendingCommit=Se(Bv.bind(null,n,a,p,l,c,d,A,O,Y,Ee,1,fe,he)),Ya(n,p,A,!le);return}Bv(n,a,p,l,c,d,A,O,Y)}function zA(n){for(var a=n;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var d=l[c],p=d.getSnapshot;d=d.value;try{if(!Cn(p(),d))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ya(n,a,l,c){a&=~Od,a&=~Qs,n.suspendedLanes|=a,n.pingedLanes&=~a,c&&(n.warmLanes|=a),c=n.expirationTimes;for(var d=a;0<d;){var p=31-Ar(d),A=1<<p;c[p]=-1,d&=~A}l!==0&&Un(n,l,a)}function bf(){return(bt&6)===0?(Su(0),!1):!0}function Ld(){if(ct!==null){if(Dt===0)var n=ct.return;else n=ct,la=Gs=null,ed(n),ql=null,mu=0,n=ct;for(;n!==null;)fv(n.alternate,n),n=n.return;ct=null}}function Jl(n,a){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,s4(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),Ld(),Ht=n,ct=l=ia(n.current,null),vt=a,Dt=0,On=null,Ha=!1,Wl=Qi(n,a),Nd=!1,Ql=Qn=Od=Qs=Ga=Jt=0,xn=Tu=null,Id=!1,(a&8)!==0&&(a|=a&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=a;0<c;){var d=31-Ar(c),p=1<<d;a|=n[d],c&=~p}return ga=a,Wc(),l}function kv(n,a){at=null,J.H=gf,a===au||a===af?(a=Qg(),Dt=3):a===Yg?(a=Qg(),Dt=4):Dt=a===$p?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,On=a,ct===null&&(Jt=1,yf(n,qn(a,n.current)))}function Mv(){var n=J.H;return J.H=gf,n===null?gf:n}function Fv(){var n=J.A;return J.A=UA,n}function Vd(){Jt=4,Ha||(vt&4194048)!==vt&&Wn.current!==null||(Wl=!0),(Ga&134217727)===0&&(Qs&134217727)===0||Ht===null||Ya(Ht,vt,Qn,!1)}function Bd(n,a,l){var c=bt;bt|=2;var d=Mv(),p=Fv();(Ht!==n||vt!==a)&&(Cf=null,Jl(n,a)),a=!1;var A=Jt;e:do try{if(Dt!==0&&ct!==null){var O=ct,Y=On;switch(Dt){case 8:Ld(),A=6;break e;case 3:case 2:case 9:case 6:Wn.current===null&&(a=!0);var le=Dt;if(Dt=0,On=null,eo(n,O,Y,le),l&&Wl){A=0;break e}break;default:le=Dt,Dt=0,On=null,eo(n,O,Y,le)}}HA(),A=Jt;break}catch(Ee){kv(n,Ee)}while(!0);return a&&n.shellSuspendCounter++,la=Gs=null,bt=c,J.H=d,J.A=p,ct===null&&(Ht=null,vt=0,Wc()),A}function HA(){for(;ct!==null;)Pv(ct)}function GA(n,a){var l=bt;bt|=2;var c=Mv(),d=Fv();Ht!==n||vt!==a?(Cf=null,Rf=Ve()+500,Jl(n,a)):Wl=Qi(n,a);e:do try{if(Dt!==0&&ct!==null){a=ct;var p=On;t:switch(Dt){case 1:Dt=0,On=null,eo(n,a,p,1);break;case 2:case 9:if(Kg(p)){Dt=0,On=null,Lv(a);break}a=function(){Dt!==2&&Dt!==9||Ht!==n||(Dt=7),Pi(n)},p.then(a,a);break e;case 3:Dt=7;break e;case 4:Dt=5;break e;case 7:Kg(p)?(Dt=0,On=null,Lv(a)):(Dt=0,On=null,eo(n,a,p,7));break;case 5:var A=null;switch(ct.tag){case 26:A=ct.memoizedState;case 5:case 27:var O=ct;if(!A||__(A)){Dt=0,On=null;var Y=O.sibling;if(Y!==null)ct=Y;else{var le=O.return;le!==null?(ct=le,Df(le)):ct=null}break t}}Dt=0,On=null,eo(n,a,p,5);break;case 6:Dt=0,On=null,eo(n,a,p,6);break;case 8:Ld(),Jt=6;break e;default:throw Error(i(462))}}qA();break}catch(Ee){kv(n,Ee)}while(!0);return la=Gs=null,J.H=c,J.A=d,bt=l,ct!==null?0:(Ht=null,vt=0,Wc(),Jt)}function qA(){for(;ct!==null&&!tn();)Pv(ct)}function Pv(n){var a=uv(n.alternate,n,ga);n.memoizedProps=n.pendingProps,a===null?Df(n):ct=a}function Lv(n){var a=n,l=a.alternate;switch(a.tag){case 15:case 0:a=nv(l,a,a.pendingProps,a.type,void 0,vt);break;case 11:a=nv(l,a,a.pendingProps,a.type.render,a.ref,vt);break;case 5:ed(a);default:fv(l,a),a=ct=Vg(a,ga),a=uv(l,a,ga)}n.memoizedProps=n.pendingProps,a===null?Df(n):ct=a}function eo(n,a,l,c){la=Gs=null,ed(a),ql=null,mu=0;var d=a.return;try{if(MA(n,d,a,l,vt)){Jt=1,yf(n,qn(l,n.current)),ct=null;return}}catch(p){if(d!==null)throw ct=d,p;Jt=1,yf(n,qn(l,n.current)),ct=null;return}a.flags&32768?(St||c===1?n=!0:Wl||(vt&536870912)!==0?n=!1:(Ha=n=!0,(c===2||c===9||c===3||c===6)&&(c=Wn.current,c!==null&&c.tag===13&&(c.flags|=16384))),Vv(a,n)):Df(a)}function Df(n){var a=n;do{if((a.flags&32768)!==0){Vv(a,Ha);return}n=a.return;var l=PA(a.alternate,a,ga);if(l!==null){ct=l;return}if(a=a.sibling,a!==null){ct=a;return}ct=a=n}while(a!==null);Jt===0&&(Jt=5)}function Vv(n,a){do{var l=LA(n.alternate,n);if(l!==null){l.flags&=32767,ct=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(n=n.sibling,n!==null)){ct=n;return}ct=n=l}while(n!==null);Jt=6,ct=null}function Bv(n,a,l,c,d,p,A,O,Y){n.cancelPendingCommit=null;do Nf();while(Fr!==0);if((bt&6)!==0)throw Error(i(327));if(a!==null){if(a===n.current)throw Error(i(177));if(p=a.lanes|a.childLanes,p|=Dh,yi(n,l,p,A,O,Y),n===Ht&&(ct=Ht=null,vt=0),$l=a,Xa=n,Zl=l,Md=p,Fd=d,Dv=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,WA(dn,function(){return Gv(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=J.T,J.T=null,d=ye.p,ye.p=2,A=bt,bt|=4;try{VA(n,a,l)}finally{bt=A,ye.p=d,J.T=c}}Fr=1,Uv(),jv(),zv()}}function Uv(){if(Fr===1){Fr=0;var n=Xa,a=$l,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=J.T,J.T=null;var c=ye.p;ye.p=2;var d=bt;bt|=4;try{Tv(a,n);var p=$d,A=bg(n.containerInfo),O=p.focusedElem,Y=p.selectionRange;if(A!==O&&O&&O.ownerDocument&&Cg(O.ownerDocument.documentElement,O)){if(Y!==null&&Sh(O)){var le=Y.start,Ee=Y.end;if(Ee===void 0&&(Ee=le),"selectionStart"in O)O.selectionStart=le,O.selectionEnd=Math.min(Ee,O.value.length);else{var Se=O.ownerDocument||document,fe=Se&&Se.defaultView||window;if(fe.getSelection){var he=fe.getSelection(),Ze=O.textContent.length,Ke=Math.min(Y.start,Ze),Lt=Y.end===void 0?Ke:Math.min(Y.end,Ze);!he.extend&&Ke>Lt&&(A=Lt,Lt=Ke,Ke=A);var te=Rg(O,Ke),ee=Rg(O,Lt);if(te&&ee&&(he.rangeCount!==1||he.anchorNode!==te.node||he.anchorOffset!==te.offset||he.focusNode!==ee.node||he.focusOffset!==ee.offset)){var ae=Se.createRange();ae.setStart(te.node,te.offset),he.removeAllRanges(),Ke>Lt?(he.addRange(ae),he.extend(ee.node,ee.offset)):(ae.setEnd(ee.node,ee.offset),he.addRange(ae))}}}}for(Se=[],he=O;he=he.parentNode;)he.nodeType===1&&Se.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<Se.length;O++){var Te=Se[O];Te.element.scrollLeft=Te.left,Te.element.scrollTop=Te.top}}zf=!!Qd,$d=Qd=null}finally{bt=d,ye.p=c,J.T=l}}n.current=a,Fr=2}}function jv(){if(Fr===2){Fr=0;var n=Xa,a=$l,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=J.T,J.T=null;var c=ye.p;ye.p=2;var d=bt;bt|=4;try{_v(n,a.alternate,a)}finally{bt=d,ye.p=c,J.T=l}}Fr=3}}function zv(){if(Fr===4||Fr===3){Fr=0,Bt();var n=Xa,a=$l,l=Zl,c=Dv;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Fr=5:(Fr=0,$l=Xa=null,Hv(n,n.pendingLanes));var d=n.pendingLanes;if(d===0&&(qa=null),Na(l),a=a.stateNode,yt&&typeof yt.onCommitFiberRoot=="function")try{yt.onCommitFiberRoot(jt,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=J.T,d=ye.p,ye.p=2,J.T=null;try{for(var p=n.onRecoverableError,A=0;A<c.length;A++){var O=c[A];p(O.value,{componentStack:O.stack})}}finally{J.T=a,ye.p=d}}(Zl&3)!==0&&Nf(),Pi(n),d=n.pendingLanes,(l&4194090)!==0&&(d&42)!==0?n===Pd?Au++:(Au=0,Pd=n):Au=0,Su(0)}}function Hv(n,a){(n.pooledCacheLanes&=a)===0&&(a=n.pooledCache,a!=null&&(n.pooledCache=null,nu(a)))}function Nf(n){return Uv(),jv(),zv(),Gv()}function Gv(){if(Fr!==5)return!1;var n=Xa,a=Md;Md=0;var l=Na(Zl),c=J.T,d=ye.p;try{ye.p=32>l?32:l,J.T=null,l=Fd,Fd=null;var p=Xa,A=Zl;if(Fr=0,$l=Xa=null,Zl=0,(bt&6)!==0)throw Error(i(331));var O=bt;if(bt|=4,Cv(p.current),Sv(p,p.current,A,l),bt=O,Su(0,!1),yt&&typeof yt.onPostCommitFiberRoot=="function")try{yt.onPostCommitFiberRoot(jt,p)}catch{}return!0}finally{ye.p=d,J.T=c,Hv(n,a)}}function qv(n,a,l){a=qn(l,a),a=md(n.stateNode,a,2),n=Pa(n,a,2),n!==null&&(ii(n,2),Pi(n))}function Ut(n,a,l){if(n.tag===3)qv(n,n,l);else for(;a!==null;){if(a.tag===3){qv(a,n,l);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(qa===null||!qa.has(c))){n=qn(l,n),l=Wp(2),c=Pa(a,l,2),c!==null&&(Qp(l,c,a,n),ii(c,2),Pi(c));break}}a=a.return}}function Ud(n,a,l){var c=n.pingCache;if(c===null){c=n.pingCache=new jA;var d=new Set;c.set(a,d)}else d=c.get(a),d===void 0&&(d=new Set,c.set(a,d));d.has(l)||(Nd=!0,d.add(l),n=XA.bind(null,n,a,l),a.then(n,n))}function XA(n,a,l){var c=n.pingCache;c!==null&&c.delete(a),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,Ht===n&&(vt&l)===l&&(Jt===4||Jt===3&&(vt&62914560)===vt&&300>Ve()-kd?(bt&2)===0&&Jl(n,0):Od|=l,Ql===vt&&(Ql=0)),Pi(n)}function Xv(n,a){a===0&&(a=Da()),n=Fl(n,a),n!==null&&(ii(n,a),Pi(n))}function YA(n){var a=n.memoizedState,l=0;a!==null&&(l=a.retryLane),Xv(n,l)}function KA(n,a){var l=0;switch(n.tag){case 13:var c=n.stateNode,d=n.memoizedState;d!==null&&(l=d.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),Xv(n,l)}function WA(n,a){return Wt(n,a)}var Of=null,to=null,jd=!1,If=!1,zd=!1,$s=0;function Pi(n){n!==to&&n.next===null&&(to===null?Of=to=n:to=to.next=n),If=!0,jd||(jd=!0,$A())}function Su(n,a){if(!zd&&If){zd=!0;do for(var l=!1,c=Of;c!==null;){if(n!==0){var d=c.pendingLanes;if(d===0)var p=0;else{var A=c.suspendedLanes,O=c.pingedLanes;p=(1<<31-Ar(42|n)+1)-1,p&=d&~(A&~O),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(l=!0,Qv(c,p))}else p=vt,p=Ra(c,c===Ht?p:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(p&3)===0||Qi(c,p)||(l=!0,Qv(c,p));c=c.next}while(l);zd=!1}}function QA(){Yv()}function Yv(){If=jd=!1;var n=0;$s!==0&&(a4()&&(n=$s),$s=0);for(var a=Ve(),l=null,c=Of;c!==null;){var d=c.next,p=Kv(c,a);p===0?(c.next=null,l===null?Of=d:l.next=d,d===null&&(to=l)):(l=c,(n!==0||(p&3)!==0)&&(If=!0)),c=d}Su(n)}function Kv(n,a){for(var l=n.suspendedLanes,c=n.pingedLanes,d=n.expirationTimes,p=n.pendingLanes&-62914561;0<p;){var A=31-Ar(p),O=1<<A,Y=d[A];Y===-1?((O&l)===0||(O&c)!==0)&&(d[A]=Ca(O,a)):Y<=a&&(n.expiredLanes|=O),p&=~O}if(a=Ht,l=vt,l=Ra(n,n===a?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,l===0||n===a&&(Dt===2||Dt===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&lt(c),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||Qi(n,l)){if(a=l&-l,a===n.callbackPriority)return a;switch(c!==null&&lt(c),Na(l)){case 2:case 8:l=hn;break;case 32:l=dn;break;case 268435456:l=pi;break;default:l=dn}return c=Wv.bind(null,n),l=Wt(l,c),n.callbackPriority=a,n.callbackNode=l,a}return c!==null&&c!==null&&lt(c),n.callbackPriority=2,n.callbackNode=null,2}function Wv(n,a){if(Fr!==0&&Fr!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(Nf()&&n.callbackNode!==l)return null;var c=vt;return c=Ra(n,n===Ht?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(Ov(n,c,a),Kv(n,Ve()),n.callbackNode!=null&&n.callbackNode===l?Wv.bind(null,n):null)}function Qv(n,a){if(Nf())return null;Ov(n,a,!0)}function $A(){l4(function(){(bt&6)!==0?Wt(rn,QA):Yv()})}function Hd(){return $s===0&&($s=ba()),$s}function $v(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Al(""+n)}function Zv(n,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,n.id&&l.setAttribute("form",n.id),a.parentNode.insertBefore(l,a),n=new FormData(n),l.parentNode.removeChild(l),n}function ZA(n,a,l,c,d){if(a==="submit"&&l&&l.stateNode===d){var p=$v((d[Yt]||null).action),A=c.submitter;A&&(a=(a=A[Yt]||null)?$v(a.formAction):A.getAttribute("formAction"),a!==null&&(p=a,A=null));var O=new Sl("action","action",null,c,d);n.push({event:O,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if($s!==0){var Y=A?Zv(d,A):new FormData(d);ud(l,{pending:!0,data:Y,method:d.method,action:p},null,Y)}}else typeof p=="function"&&(O.preventDefault(),Y=A?Zv(d,A):new FormData(d),ud(l,{pending:!0,data:Y,method:d.method,action:p},p,Y))},currentTarget:d}]})}}for(var Gd=0;Gd<bh.length;Gd++){var qd=bh[Gd],JA=qd.toLowerCase(),e4=qd[0].toUpperCase()+qd.slice(1);si(JA,"on"+e4)}si(Og,"onAnimationEnd"),si(Ig,"onAnimationIteration"),si(kg,"onAnimationStart"),si("dblclick","onDoubleClick"),si("focusin","onFocus"),si("focusout","onBlur"),si(vA,"onTransitionRun"),si(_A,"onTransitionStart"),si(xA,"onTransitionCancel"),si(Mg,"onTransitionEnd"),Ie("onMouseEnter",["mouseout","mouseover"]),Ie("onMouseLeave",["mouseout","mouseover"]),Ie("onPointerEnter",["pointerout","pointerover"]),Ie("onPointerLeave",["pointerout","pointerover"]),be("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),be("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),be("onBeforeInput",["compositionend","keypress","textInput","paste"]),be("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),t4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wu));function Jv(n,a){a=(a&4)!==0;for(var l=0;l<n.length;l++){var c=n[l],d=c.event;c=c.listeners;e:{var p=void 0;if(a)for(var A=c.length-1;0<=A;A--){var O=c[A],Y=O.instance,le=O.currentTarget;if(O=O.listener,Y!==p&&d.isPropagationStopped())break e;p=O,d.currentTarget=le;try{p(d)}catch(Ee){xf(Ee)}d.currentTarget=null,p=Y}else for(A=0;A<c.length;A++){if(O=c[A],Y=O.instance,le=O.currentTarget,O=O.listener,Y!==p&&d.isPropagationStopped())break e;p=O,d.currentTarget=le;try{p(d)}catch(Ee){xf(Ee)}d.currentTarget=null,p=Y}}}}function ft(n,a){var l=a[ws];l===void 0&&(l=a[ws]=new Set);var c=n+"__bubble";l.has(c)||(e_(a,n,2,!1),l.add(c))}function Xd(n,a,l){var c=0;a&&(c|=4),e_(l,n,c,a)}var kf="_reactListening"+Math.random().toString(36).slice(2);function Yd(n){if(!n[kf]){n[kf]=!0,ue.forEach(function(l){l!=="selectionchange"&&(t4.has(l)||Xd(l,!1,n),Xd(l,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[kf]||(a[kf]=!0,Xd("selectionchange",!1,a))}}function e_(n,a,l,c){switch(S_(a)){case 2:var d=b4;break;case 8:d=D4;break;default:d=l1}l=d.bind(null,a,l,n),d=void 0,!Hn||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(d=!0),c?d!==void 0?n.addEventListener(a,l,{capture:!0,passive:d}):n.addEventListener(a,l,!0):d!==void 0?n.addEventListener(a,l,{passive:d}):n.addEventListener(a,l,!1)}function Kd(n,a,l,c,d){var p=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var A=c.tag;if(A===3||A===4){var O=c.stateNode.containerInfo;if(O===d)break;if(A===4)for(A=c.return;A!==null;){var Y=A.tag;if((Y===3||Y===4)&&A.stateNode.containerInfo===d)return;A=A.return}for(;O!==null;){if(A=U(O),A===null)return;if(Y=A.tag,Y===5||Y===6||Y===26||Y===27){c=p=A;continue e}O=O.parentNode}}c=c.return}Mc(function(){var le=p,Ee=zn(l),Se=[];e:{var fe=Fg.get(n);if(fe!==void 0){var he=Sl,Ze=n;switch(n){case"keypress":if(Ci(l)===0)break e;case"keydown":case"keyup":he=Nl;break;case"focusin":Ze="focus",he=Cl;break;case"focusout":Ze="blur",he=Cl;break;case"beforeblur":case"afterblur":he=Cl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=yh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=zc;break;case Og:case Ig:case kg:he=bl;break;case Mg:he=Gc;break;case"scroll":case"scrollend":he=Fc;break;case"wheel":he=Ol;break;case"copy":case"cut":case"paste":he=Dl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=Wo;break;case"toggle":case"beforetoggle":he=Xc}var Ke=(a&4)!==0,Lt=!Ke&&(n==="scroll"||n==="scrollend"),te=Ke?fe!==null?fe+"Capture":null:fe;Ke=[];for(var ee=le,ae;ee!==null;){var Te=ee;if(ae=Te.stateNode,Te=Te.tag,Te!==5&&Te!==26&&Te!==27||ae===null||te===null||(Te=Ns(ee,te),Te!=null&&Ke.push(Ru(ee,Te,ae))),Lt)break;ee=ee.return}0<Ke.length&&(fe=new he(fe,Ze,null,l,Ee),Se.push({event:fe,listeners:Ke}))}}if((a&7)===0){e:{if(fe=n==="mouseover"||n==="pointerover",he=n==="mouseout"||n==="pointerout",fe&&l!==Zi&&(Ze=l.relatedTarget||l.fromElement)&&(U(Ze)||Ze[gn]))break e;if((he||fe)&&(fe=Ee.window===Ee?Ee:(fe=Ee.ownerDocument)?fe.defaultView||fe.parentWindow:window,he?(Ze=l.relatedTarget||l.toElement,he=le,Ze=Ze?U(Ze):null,Ze!==null&&(Lt=o(Ze),Ke=Ze.tag,Ze!==Lt||Ke!==5&&Ke!==27&&Ke!==6)&&(Ze=null)):(he=null,Ze=le),he!==Ze)){if(Ke=Gn,Te="onMouseLeave",te="onMouseEnter",ee="mouse",(n==="pointerout"||n==="pointerover")&&(Ke=Wo,Te="onPointerLeave",te="onPointerEnter",ee="pointer"),Lt=he==null?fe:se(he),ae=Ze==null?fe:se(Ze),fe=new Ke(Te,ee+"leave",he,l,Ee),fe.target=Lt,fe.relatedTarget=ae,Te=null,U(Ee)===le&&(Ke=new Ke(te,ee+"enter",Ze,l,Ee),Ke.target=ae,Ke.relatedTarget=Lt,Te=Ke),Lt=Te,he&&Ze)t:{for(Ke=he,te=Ze,ee=0,ae=Ke;ae;ae=ro(ae))ee++;for(ae=0,Te=te;Te;Te=ro(Te))ae++;for(;0<ee-ae;)Ke=ro(Ke),ee--;for(;0<ae-ee;)te=ro(te),ae--;for(;ee--;){if(Ke===te||te!==null&&Ke===te.alternate)break t;Ke=ro(Ke),te=ro(te)}Ke=null}else Ke=null;he!==null&&t_(Se,fe,he,Ke,!1),Ze!==null&&Lt!==null&&t_(Se,Lt,Ze,Ke,!0)}}e:{if(fe=le?se(le):window,he=fe.nodeName&&fe.nodeName.toLowerCase(),he==="select"||he==="input"&&fe.type==="file")var Ge=yg;else if(_r(fe))if(Eg)Ge=mA;else{Ge=hA;var ot=fA}else he=fe.nodeName,!he||he.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?le&&zo(le.elementType)&&(Ge=yg):Ge=dA;if(Ge&&(Ge=Ge(n,le))){na(Se,Ge,l,Ee);break e}ot&&ot(n,fe,le),n==="focusout"&&le&&fe.type==="number"&&le.memoizedProps.value!=null&&Oa(fe,"number",fe.value)}switch(ot=le?se(le):window,n){case"focusin":(_r(ot)||ot.contentEditable==="true")&&(Il=ot,wh=le,Zo=null);break;case"focusout":Zo=wh=Il=null;break;case"mousedown":Rh=!0;break;case"contextmenu":case"mouseup":case"dragend":Rh=!1,Dg(Se,l,Ee);break;case"selectionchange":if(pA)break;case"keydown":case"keyup":Dg(Se,l,Ee)}var Xe;if(Ni)e:{switch(n){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else gt?ge(n,l)&&(We="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(We="onCompositionStart");We&&(E&&l.locale!=="ko"&&(gt||We!=="onCompositionStart"?We==="onCompositionEnd"&&gt&&(Xe=Go()):(Ri=Ee,Ia="value"in Ri?Ri.value:Ri.textContent,gt=!0)),ot=Mf(le,We),0<ot.length&&(We=new Yo(We,n,null,l,Ee),Se.push({event:We,listeners:ot}),Xe?We.data=Xe:(Xe=Me(l),Xe!==null&&(We.data=Xe)))),(Xe=_?vr(n,l):pt(n,l))&&(We=Mf(le,"onBeforeInput"),0<We.length&&(ot=new Yo("onBeforeInput","beforeinput",null,l,Ee),Se.push({event:ot,listeners:We}),ot.data=Xe)),ZA(Se,n,le,l,Ee)}Jv(Se,a)})}function Ru(n,a,l){return{instance:n,listener:a,currentTarget:l}}function Mf(n,a){for(var l=a+"Capture",c=[];n!==null;){var d=n,p=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||p===null||(d=Ns(n,l),d!=null&&c.unshift(Ru(n,d,p)),d=Ns(n,a),d!=null&&c.push(Ru(n,d,p))),n.tag===3)return c;n=n.return}return[]}function ro(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function t_(n,a,l,c,d){for(var p=a._reactName,A=[];l!==null&&l!==c;){var O=l,Y=O.alternate,le=O.stateNode;if(O=O.tag,Y!==null&&Y===c)break;O!==5&&O!==26&&O!==27||le===null||(Y=le,d?(le=Ns(l,p),le!=null&&A.unshift(Ru(l,le,Y))):d||(le=Ns(l,p),le!=null&&A.push(Ru(l,le,Y)))),l=l.return}A.length!==0&&n.push({event:a,listeners:A})}var r4=/\r\n?/g,n4=/\u0000|\uFFFD/g;function r_(n){return(typeof n=="string"?n:""+n).replace(r4,`
`).replace(n4,"")}function n_(n,a){return a=r_(a),r_(n)===a}function Ff(){}function Pt(n,a,l,c,d,p){switch(l){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||jn(n,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&jn(n,""+c);break;case"className":dt(n,"class",c);break;case"tabIndex":dt(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":dt(n,l,c);break;case"style":jo(n,c,p);break;case"data":if(a!=="object"){dt(n,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||l!=="href")){n.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(l);break}c=Al(""+c),n.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(l==="formAction"?(a!=="input"&&Pt(n,a,"name",d.name,d,null),Pt(n,a,"formEncType",d.formEncType,d,null),Pt(n,a,"formMethod",d.formMethod,d,null),Pt(n,a,"formTarget",d.formTarget,d,null)):(Pt(n,a,"encType",d.encType,d,null),Pt(n,a,"method",d.method,d,null),Pt(n,a,"target",d.target,d,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(l);break}c=Al(""+c),n.setAttribute(l,c);break;case"onClick":c!=null&&(n.onclick=Ff);break;case"onScroll":c!=null&&ft("scroll",n);break;case"onScrollEnd":c!=null&&ft("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(d.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}l=Al(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,""+c):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":c===!0?n.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,c):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(l,c):n.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(l):n.setAttribute(l,c);break;case"popover":ft("beforetoggle",n),ft("toggle",n),Et(n,"popover",c);break;case"xlinkActuate":mt(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":mt(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":mt(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":mt(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":mt(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":mt(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":mt(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":mt(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":mt(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Et(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=_h.get(l)||l,Et(n,l,c))}}function Wd(n,a,l,c,d,p){switch(l){case"style":jo(n,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(d.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"children":typeof c=="string"?jn(n,c):(typeof c=="number"||typeof c=="bigint")&&jn(n,""+c);break;case"onScroll":c!=null&&ft("scroll",n);break;case"onScrollEnd":c!=null&&ft("scrollend",n);break;case"onClick":c!=null&&(n.onclick=Ff);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ce.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(d=l.endsWith("Capture"),a=l.slice(2,d?l.length-7:void 0),p=n[Yt]||null,p=p!=null?p[l]:null,typeof p=="function"&&n.removeEventListener(a,p,d),typeof c=="function")){typeof p!="function"&&p!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(a,c,d);break e}l in n?n[l]=c:c===!0?n.setAttribute(l,""):Et(n,l,c)}}}function Pr(n,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",n),ft("load",n);var c=!1,d=!1,p;for(p in l)if(l.hasOwnProperty(p)){var A=l[p];if(A!=null)switch(p){case"src":c=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Pt(n,a,p,A,l,null)}}d&&Pt(n,a,"srcSet",l.srcSet,l,null),c&&Pt(n,a,"src",l.src,l,null);return;case"input":ft("invalid",n);var O=p=A=d=null,Y=null,le=null;for(c in l)if(l.hasOwnProperty(c)){var Ee=l[c];if(Ee!=null)switch(c){case"name":d=Ee;break;case"type":A=Ee;break;case"checked":Y=Ee;break;case"defaultChecked":le=Ee;break;case"value":p=Ee;break;case"defaultValue":O=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(i(137,a));break;default:Pt(n,a,c,Ee,l,null)}}Cs(n,p,O,Y,le,A,d,!1),Tl(n);return;case"select":ft("invalid",n),c=A=p=null;for(d in l)if(l.hasOwnProperty(d)&&(O=l[d],O!=null))switch(d){case"value":p=O;break;case"defaultValue":A=O;break;case"multiple":c=O;default:Pt(n,a,d,O,l,null)}a=p,l=A,n.multiple=!!c,a!=null?$i(n,!!c,a,!1):l!=null&&$i(n,!!c,l,!0);return;case"textarea":ft("invalid",n),p=d=c=null;for(A in l)if(l.hasOwnProperty(A)&&(O=l[A],O!=null))switch(A){case"value":c=O;break;case"defaultValue":d=O;break;case"children":p=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(i(91));break;default:Pt(n,a,A,O,l,null)}bs(n,c,d,p),Tl(n);return;case"option":for(Y in l)if(l.hasOwnProperty(Y)&&(c=l[Y],c!=null))switch(Y){case"selected":n.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Pt(n,a,Y,c,l,null)}return;case"dialog":ft("beforetoggle",n),ft("toggle",n),ft("cancel",n),ft("close",n);break;case"iframe":case"object":ft("load",n);break;case"video":case"audio":for(c=0;c<wu.length;c++)ft(wu[c],n);break;case"image":ft("error",n),ft("load",n);break;case"details":ft("toggle",n);break;case"embed":case"source":case"link":ft("error",n),ft("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in l)if(l.hasOwnProperty(le)&&(c=l[le],c!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Pt(n,a,le,c,l,null)}return;default:if(zo(a)){for(Ee in l)l.hasOwnProperty(Ee)&&(c=l[Ee],c!==void 0&&Wd(n,a,Ee,c,l,void 0));return}}for(O in l)l.hasOwnProperty(O)&&(c=l[O],c!=null&&Pt(n,a,O,c,l,null))}function i4(n,a,l,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,p=null,A=null,O=null,Y=null,le=null,Ee=null;for(he in l){var Se=l[he];if(l.hasOwnProperty(he)&&Se!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":Y=Se;default:c.hasOwnProperty(he)||Pt(n,a,he,null,c,Se)}}for(var fe in c){var he=c[fe];if(Se=l[fe],c.hasOwnProperty(fe)&&(he!=null||Se!=null))switch(fe){case"type":p=he;break;case"name":d=he;break;case"checked":le=he;break;case"defaultChecked":Ee=he;break;case"value":A=he;break;case"defaultValue":O=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,a));break;default:he!==Se&&Pt(n,a,fe,he,c,Se)}}Rn(n,A,O,Y,le,Ee,p,d);return;case"select":he=A=O=fe=null;for(p in l)if(Y=l[p],l.hasOwnProperty(p)&&Y!=null)switch(p){case"value":break;case"multiple":he=Y;default:c.hasOwnProperty(p)||Pt(n,a,p,null,c,Y)}for(d in c)if(p=c[d],Y=l[d],c.hasOwnProperty(d)&&(p!=null||Y!=null))switch(d){case"value":fe=p;break;case"defaultValue":O=p;break;case"multiple":A=p;default:p!==Y&&Pt(n,a,d,p,c,Y)}a=O,l=A,c=he,fe!=null?$i(n,!!l,fe,!1):!!c!=!!l&&(a!=null?$i(n,!!l,a,!0):$i(n,!!l,l?[]:"",!1));return;case"textarea":he=fe=null;for(O in l)if(d=l[O],l.hasOwnProperty(O)&&d!=null&&!c.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Pt(n,a,O,null,c,d)}for(A in c)if(d=c[A],p=l[A],c.hasOwnProperty(A)&&(d!=null||p!=null))switch(A){case"value":fe=d;break;case"defaultValue":he=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(i(91));break;default:d!==p&&Pt(n,a,A,d,c,p)}Mt(n,fe,he);return;case"option":for(var Ze in l)if(fe=l[Ze],l.hasOwnProperty(Ze)&&fe!=null&&!c.hasOwnProperty(Ze))switch(Ze){case"selected":n.selected=!1;break;default:Pt(n,a,Ze,null,c,fe)}for(Y in c)if(fe=c[Y],he=l[Y],c.hasOwnProperty(Y)&&fe!==he&&(fe!=null||he!=null))switch(Y){case"selected":n.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:Pt(n,a,Y,fe,c,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in l)fe=l[Ke],l.hasOwnProperty(Ke)&&fe!=null&&!c.hasOwnProperty(Ke)&&Pt(n,a,Ke,null,c,fe);for(le in c)if(fe=c[le],he=l[le],c.hasOwnProperty(le)&&fe!==he&&(fe!=null||he!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,a));break;default:Pt(n,a,le,fe,c,he)}return;default:if(zo(a)){for(var Lt in l)fe=l[Lt],l.hasOwnProperty(Lt)&&fe!==void 0&&!c.hasOwnProperty(Lt)&&Wd(n,a,Lt,void 0,c,fe);for(Ee in c)fe=c[Ee],he=l[Ee],!c.hasOwnProperty(Ee)||fe===he||fe===void 0&&he===void 0||Wd(n,a,Ee,fe,c,he);return}}for(var te in l)fe=l[te],l.hasOwnProperty(te)&&fe!=null&&!c.hasOwnProperty(te)&&Pt(n,a,te,null,c,fe);for(Se in c)fe=c[Se],he=l[Se],!c.hasOwnProperty(Se)||fe===he||fe==null&&he==null||Pt(n,a,Se,fe,c,he)}var Qd=null,$d=null;function Pf(n){return n.nodeType===9?n:n.ownerDocument}function i_(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function a_(n,a){if(n===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&a==="foreignObject"?0:n}function Zd(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Jd=null;function a4(){var n=window.event;return n&&n.type==="popstate"?n===Jd?!1:(Jd=n,!0):(Jd=null,!1)}var s_=typeof setTimeout=="function"?setTimeout:void 0,s4=typeof clearTimeout=="function"?clearTimeout:void 0,l_=typeof Promise=="function"?Promise:void 0,l4=typeof queueMicrotask=="function"?queueMicrotask:typeof l_<"u"?function(n){return l_.resolve(null).then(n).catch(o4)}:s_;function o4(n){setTimeout(function(){throw n})}function Ka(n){return n==="head"}function o_(n,a){var l=a,c=0,d=0;do{var p=l.nextSibling;if(n.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"){if(0<c&&8>c){l=c;var A=n.ownerDocument;if(l&1&&Cu(A.documentElement),l&2&&Cu(A.body),l&4)for(l=A.head,Cu(l),A=l.firstChild;A;){var O=A.nextSibling,Y=A.nodeName;A[M]||Y==="SCRIPT"||Y==="STYLE"||Y==="LINK"&&A.rel.toLowerCase()==="stylesheet"||l.removeChild(A),A=O}}if(d===0){n.removeChild(p),Fu(a);return}d--}else l==="$"||l==="$?"||l==="$!"?d++:c=l.charCodeAt(0)-48;else c=0;l=p}while(l);Fu(a)}function e1(n){var a=n.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":e1(l),L(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function u4(n,a,l,c){for(;n.nodeType===1;){var d=l;if(n.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[M])switch(a){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(p=n.getAttribute("rel"),p==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(p!==d.rel||n.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||n.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||n.getAttribute("title")!==(d.title==null?null:d.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(p=n.getAttribute("src"),(p!==(d.src==null?null:d.src)||n.getAttribute("type")!==(d.type==null?null:d.type)||n.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&p&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(a==="input"&&n.type==="hidden"){var p=d.name==null?null:""+d.name;if(d.type==="hidden"&&n.getAttribute("name")===p)return n}else return n;if(n=oi(n.nextSibling),n===null)break}return null}function c4(n,a,l){if(a==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=oi(n.nextSibling),n===null))return null;return n}function t1(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function f4(n,a){var l=n.ownerDocument;if(n.data!=="$?"||l.readyState==="complete")a();else{var c=function(){a(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function oi(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return n}var r1=null;function u_(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return n;a--}else l==="/$"&&a++}n=n.previousSibling}return null}function c_(n,a,l){switch(a=Pf(l),n){case"html":if(n=a.documentElement,!n)throw Error(i(452));return n;case"head":if(n=a.head,!n)throw Error(i(453));return n;case"body":if(n=a.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Cu(n){for(var a=n.attributes;a.length;)n.removeAttributeNode(a[0]);L(n)}var $n=new Map,f_=new Set;function Lf(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var pa=ye.d;ye.d={f:h4,r:d4,D:m4,C:g4,L:p4,m:v4,X:x4,S:_4,M:y4};function h4(){var n=pa.f(),a=bf();return n||a}function d4(n){var a=H(n);a!==null&&a.tag===5&&a.type==="form"?Op(a):pa.r(n)}var no=typeof document>"u"?null:document;function h_(n,a,l){var c=no;if(c&&typeof a=="string"&&a){var d=lr(a);d='link[rel="'+n+'"][href="'+d+'"]',typeof l=="string"&&(d+='[crossorigin="'+l+'"]'),f_.has(d)||(f_.add(d),n={rel:n,crossOrigin:l,href:a},c.querySelector(d)===null&&(a=c.createElement("link"),Pr(a,"link",n),re(a),c.head.appendChild(a)))}}function m4(n){pa.D(n),h_("dns-prefetch",n,null)}function g4(n,a){pa.C(n,a),h_("preconnect",n,a)}function p4(n,a,l){pa.L(n,a,l);var c=no;if(c&&n&&a){var d='link[rel="preload"][as="'+lr(a)+'"]';a==="image"&&l&&l.imageSrcSet?(d+='[imagesrcset="'+lr(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(d+='[imagesizes="'+lr(l.imageSizes)+'"]')):d+='[href="'+lr(n)+'"]';var p=d;switch(a){case"style":p=io(n);break;case"script":p=ao(n)}$n.has(p)||(n=v({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:n,as:a},l),$n.set(p,n),c.querySelector(d)!==null||a==="style"&&c.querySelector(bu(p))||a==="script"&&c.querySelector(Du(p))||(a=c.createElement("link"),Pr(a,"link",n),re(a),c.head.appendChild(a)))}}function v4(n,a){pa.m(n,a);var l=no;if(l&&n){var c=a&&typeof a.as=="string"?a.as:"script",d='link[rel="modulepreload"][as="'+lr(c)+'"][href="'+lr(n)+'"]',p=d;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ao(n)}if(!$n.has(p)&&(n=v({rel:"modulepreload",href:n},a),$n.set(p,n),l.querySelector(d)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Du(p)))return}c=l.createElement("link"),Pr(c,"link",n),re(c),l.head.appendChild(c)}}}function _4(n,a,l){pa.S(n,a,l);var c=no;if(c&&n){var d=me(c).hoistableStyles,p=io(n);a=a||"default";var A=d.get(p);if(!A){var O={loading:0,preload:null};if(A=c.querySelector(bu(p)))O.loading=5;else{n=v({rel:"stylesheet",href:n,"data-precedence":a},l),(l=$n.get(p))&&n1(n,l);var Y=A=c.createElement("link");re(Y),Pr(Y,"link",n),Y._p=new Promise(function(le,Ee){Y.onload=le,Y.onerror=Ee}),Y.addEventListener("load",function(){O.loading|=1}),Y.addEventListener("error",function(){O.loading|=2}),O.loading|=4,Vf(A,a,c)}A={type:"stylesheet",instance:A,count:1,state:O},d.set(p,A)}}}function x4(n,a){pa.X(n,a);var l=no;if(l&&n){var c=me(l).hoistableScripts,d=ao(n),p=c.get(d);p||(p=l.querySelector(Du(d)),p||(n=v({src:n,async:!0},a),(a=$n.get(d))&&i1(n,a),p=l.createElement("script"),re(p),Pr(p,"link",n),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(d,p))}}function y4(n,a){pa.M(n,a);var l=no;if(l&&n){var c=me(l).hoistableScripts,d=ao(n),p=c.get(d);p||(p=l.querySelector(Du(d)),p||(n=v({src:n,async:!0,type:"module"},a),(a=$n.get(d))&&i1(n,a),p=l.createElement("script"),re(p),Pr(p,"link",n),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(d,p))}}function d_(n,a,l,c){var d=(d=oe.current)?Lf(d):null;if(!d)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=io(l.href),l=me(d).hoistableStyles,c=l.get(a),c||(c={type:"style",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=io(l.href);var p=me(d).hoistableStyles,A=p.get(n);if(A||(d=d.ownerDocument||d,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(n,A),(p=d.querySelector(bu(n)))&&!p._p&&(A.instance=p,A.state.loading=5),$n.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},$n.set(n,l),p||E4(d,n,l,A.state))),a&&c===null)throw Error(i(528,""));return A}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=ao(l),l=me(d).hoistableScripts,c=l.get(a),c||(c={type:"script",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function io(n){return'href="'+lr(n)+'"'}function bu(n){return'link[rel="stylesheet"]['+n+"]"}function m_(n){return v({},n,{"data-precedence":n.precedence,precedence:null})}function E4(n,a,l,c){n.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=n.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),Pr(a,"link",l),re(a),n.head.appendChild(a))}function ao(n){return'[src="'+lr(n)+'"]'}function Du(n){return"script[async]"+n}function g_(n,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var c=n.querySelector('style[data-href~="'+lr(l.href)+'"]');if(c)return a.instance=c,re(c),c;var d=v({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),re(c),Pr(c,"style",d),Vf(c,l.precedence,n),a.instance=c;case"stylesheet":d=io(l.href);var p=n.querySelector(bu(d));if(p)return a.state.loading|=4,a.instance=p,re(p),p;c=m_(l),(d=$n.get(d))&&n1(c,d),p=(n.ownerDocument||n).createElement("link"),re(p);var A=p;return A._p=new Promise(function(O,Y){A.onload=O,A.onerror=Y}),Pr(p,"link",c),a.state.loading|=4,Vf(p,l.precedence,n),a.instance=p;case"script":return p=ao(l.src),(d=n.querySelector(Du(p)))?(a.instance=d,re(d),d):(c=l,(d=$n.get(p))&&(c=v({},l),i1(c,d)),n=n.ownerDocument||n,d=n.createElement("script"),re(d),Pr(d,"link",c),n.head.appendChild(d),a.instance=d);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Vf(c,l.precedence,n));return a.instance}function Vf(n,a,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=c.length?c[c.length-1]:null,p=d,A=0;A<c.length;A++){var O=c[A];if(O.dataset.precedence===a)p=O;else if(p!==d)break}p?p.parentNode.insertBefore(n,p.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(n,a.firstChild))}function n1(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.title==null&&(n.title=a.title)}function i1(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.integrity==null&&(n.integrity=a.integrity)}var Bf=null;function p_(n,a,l){if(Bf===null){var c=new Map,d=Bf=new Map;d.set(l,c)}else d=Bf,c=d.get(l),c||(c=new Map,d.set(l,c));if(c.has(n))return c;for(c.set(n,null),l=l.getElementsByTagName(n),d=0;d<l.length;d++){var p=l[d];if(!(p[M]||p[nr]||n==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var A=p.getAttribute(a)||"";A=n+A;var O=c.get(A);O?O.push(p):c.set(A,[p])}}return c}function v_(n,a,l){n=n.ownerDocument||n,n.head.insertBefore(l,a==="title"?n.querySelector("head > title"):null)}function T4(n,a,l){if(l===1||a.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return n=a.disabled,typeof a.precedence=="string"&&n==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function __(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var Nu=null;function A4(){}function S4(n,a,l){if(Nu===null)throw Error(i(475));var c=Nu;if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var d=io(l.href),p=n.querySelector(bu(d));if(p){n=p._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(c.count++,c=Uf.bind(c),n.then(c,c)),a.state.loading|=4,a.instance=p,re(p);return}p=n.ownerDocument||n,l=m_(l),(d=$n.get(d))&&n1(l,d),p=p.createElement("link"),re(p);var A=p;A._p=new Promise(function(O,Y){A.onload=O,A.onerror=Y}),Pr(p,"link",l),a.instance=p}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(a,n),(n=a.state.preload)&&(a.state.loading&3)===0&&(c.count++,a=Uf.bind(c),n.addEventListener("load",a),n.addEventListener("error",a))}}function w4(){if(Nu===null)throw Error(i(475));var n=Nu;return n.stylesheets&&n.count===0&&a1(n,n.stylesheets),0<n.count?function(a){var l=setTimeout(function(){if(n.stylesheets&&a1(n,n.stylesheets),n.unsuspend){var c=n.unsuspend;n.unsuspend=null,c()}},6e4);return n.unsuspend=a,function(){n.unsuspend=null,clearTimeout(l)}}:null}function Uf(){if(this.count--,this.count===0){if(this.stylesheets)a1(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var jf=null;function a1(n,a){n.stylesheets=null,n.unsuspend!==null&&(n.count++,jf=new Map,a.forEach(R4,n),jf=null,Uf.call(n))}function R4(n,a){if(!(a.state.loading&4)){var l=jf.get(n);if(l)var c=l.get(null);else{l=new Map,jf.set(n,l);for(var d=n.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<d.length;p++){var A=d[p];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(l.set(A.dataset.precedence,A),c=A)}c&&l.set(null,c)}d=a.instance,A=d.getAttribute("data-precedence"),p=l.get(A)||c,p===c&&l.set(null,d),l.set(A,d),this.count++,c=Uf.bind(this),d.addEventListener("load",c),d.addEventListener("error",c),p?p.parentNode.insertBefore(d,p.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(d,n.firstChild)),a.state.loading|=4}}var Ou={$$typeof:K,Provider:null,Consumer:null,_currentValue:Pe,_currentValue2:Pe,_threadCount:0};function C4(n,a,l,c,d,p,A,O){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ni(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ni(0),this.hiddenUpdates=ni(null),this.identifierPrefix=c,this.onUncaughtError=d,this.onCaughtError=p,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function x_(n,a,l,c,d,p,A,O,Y,le,Ee,Se){return n=new C4(n,a,l,A,O,Y,le,Se),a=1,p===!0&&(a|=24),p=bn(3,null,null,a),n.current=p,p.stateNode=n,a=Uh(),a.refCount++,n.pooledCache=a,a.refCount++,p.memoizedState={element:c,isDehydrated:l,cache:a},Gh(p),n}function y_(n){return n?(n=Pl,n):Pl}function E_(n,a,l,c,d,p){d=y_(d),c.context===null?c.context=d:c.pendingContext=d,c=Fa(a),c.payload={element:l},p=p===void 0?null:p,p!==null&&(c.callback=p),l=Pa(n,c,a),l!==null&&(kn(l,n,a),lu(l,n,a))}function T_(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<a?l:a}}function s1(n,a){T_(n,a),(n=n.alternate)&&T_(n,a)}function A_(n){if(n.tag===13){var a=Fl(n,67108864);a!==null&&kn(a,n,67108864),s1(n,67108864)}}var zf=!0;function b4(n,a,l,c){var d=J.T;J.T=null;var p=ye.p;try{ye.p=2,l1(n,a,l,c)}finally{ye.p=p,J.T=d}}function D4(n,a,l,c){var d=J.T;J.T=null;var p=ye.p;try{ye.p=8,l1(n,a,l,c)}finally{ye.p=p,J.T=d}}function l1(n,a,l,c){if(zf){var d=o1(c);if(d===null)Kd(n,a,c,Hf,l),w_(n,c);else if(O4(d,n,a,l,c))c.stopPropagation();else if(w_(n,c),a&4&&-1<N4.indexOf(n)){for(;d!==null;){var p=H(d);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var A=mn(p.pendingLanes);if(A!==0){var O=p;for(O.pendingLanes|=2,O.entangledLanes|=2;A;){var Y=1<<31-Ar(A);O.entanglements[1]|=Y,A&=~Y}Pi(p),(bt&6)===0&&(Rf=Ve()+500,Su(0))}}break;case 13:O=Fl(p,2),O!==null&&kn(O,p,2),bf(),s1(p,2)}if(p=o1(c),p===null&&Kd(n,a,c,Hf,l),p===d)break;d=p}d!==null&&c.stopPropagation()}else Kd(n,a,c,null,l)}}function o1(n){return n=zn(n),u1(n)}var Hf=null;function u1(n){if(Hf=null,n=U(n),n!==null){var a=o(n);if(a===null)n=null;else{var l=a.tag;if(l===13){if(n=u(a),n!==null)return n;n=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null)}}return Hf=n,null}function S_(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xr()){case rn:return 2;case hn:return 8;case dn:case _l:return 32;case pi:return 268435456;default:return 32}default:return 32}}var c1=!1,Wa=null,Qa=null,$a=null,Iu=new Map,ku=new Map,Za=[],N4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function w_(n,a){switch(n){case"focusin":case"focusout":Wa=null;break;case"dragenter":case"dragleave":Qa=null;break;case"mouseover":case"mouseout":$a=null;break;case"pointerover":case"pointerout":Iu.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":ku.delete(a.pointerId)}}function Mu(n,a,l,c,d,p){return n===null||n.nativeEvent!==p?(n={blockedOn:a,domEventName:l,eventSystemFlags:c,nativeEvent:p,targetContainers:[d]},a!==null&&(a=H(a),a!==null&&A_(a)),n):(n.eventSystemFlags|=c,a=n.targetContainers,d!==null&&a.indexOf(d)===-1&&a.push(d),n)}function O4(n,a,l,c,d){switch(a){case"focusin":return Wa=Mu(Wa,n,a,l,c,d),!0;case"dragenter":return Qa=Mu(Qa,n,a,l,c,d),!0;case"mouseover":return $a=Mu($a,n,a,l,c,d),!0;case"pointerover":var p=d.pointerId;return Iu.set(p,Mu(Iu.get(p)||null,n,a,l,c,d)),!0;case"gotpointercapture":return p=d.pointerId,ku.set(p,Mu(ku.get(p)||null,n,a,l,c,d)),!0}return!1}function R_(n){var a=U(n.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=u(l),a!==null){n.blockedOn=a,yl(n.priority,function(){if(l.tag===13){var c=In();c=Ei(c);var d=Fl(l,c);d!==null&&kn(d,l,c),s1(l,c)}});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Gf(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var l=o1(n.nativeEvent);if(l===null){l=n.nativeEvent;var c=new l.constructor(l.type,l);Zi=c,l.target.dispatchEvent(c),Zi=null}else return a=H(l),a!==null&&A_(a),n.blockedOn=l,!1;a.shift()}return!0}function C_(n,a,l){Gf(n)&&l.delete(a)}function I4(){c1=!1,Wa!==null&&Gf(Wa)&&(Wa=null),Qa!==null&&Gf(Qa)&&(Qa=null),$a!==null&&Gf($a)&&($a=null),Iu.forEach(C_),ku.forEach(C_)}function qf(n,a){n.blockedOn===a&&(n.blockedOn=null,c1||(c1=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,I4)))}var Xf=null;function b_(n){Xf!==n&&(Xf=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Xf===n&&(Xf=null);for(var a=0;a<n.length;a+=3){var l=n[a],c=n[a+1],d=n[a+2];if(typeof c!="function"){if(u1(c||l)===null)continue;break}var p=H(l);p!==null&&(n.splice(a,3),a-=3,ud(p,{pending:!0,data:d,method:l.method,action:c},c,d))}}))}function Fu(n){function a(Y){return qf(Y,n)}Wa!==null&&qf(Wa,n),Qa!==null&&qf(Qa,n),$a!==null&&qf($a,n),Iu.forEach(a),ku.forEach(a);for(var l=0;l<Za.length;l++){var c=Za[l];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Za.length&&(l=Za[0],l.blockedOn===null);)R_(l),l.blockedOn===null&&Za.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var d=l[c],p=l[c+1],A=d[Yt]||null;if(typeof p=="function")A||b_(l);else if(A){var O=null;if(p&&p.hasAttribute("formAction")){if(d=p,A=p[Yt]||null)O=A.formAction;else if(u1(d)!==null)continue}else O=A.action;typeof O=="function"?l[c+1]=O:(l.splice(c,3),c-=3),b_(l)}}}function f1(n){this._internalRoot=n}Yf.prototype.render=f1.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,c=In();E_(l,c,n,a,null,null)},Yf.prototype.unmount=f1.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;E_(n.current,2,null,n,null,null),bf(),a[gn]=null}};function Yf(n){this._internalRoot=n}Yf.prototype.unstable_scheduleHydration=function(n){if(n){var a=Ti();n={blockedOn:null,target:n,priority:a};for(var l=0;l<Za.length&&a!==0&&a<Za[l].priority;l++);Za.splice(l,0,n),l===0&&R_(n)}};var D_=e.version;if(D_!=="19.1.0")throw Error(i(527,D_,"19.1.0"));ye.findDOMNode=function(n){var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=g(a),n=n!==null?m(n):null,n=n===null?null:n.stateNode,n};var k4={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kf.isDisabled&&Kf.supportsFiber)try{jt=Kf.inject(k4),yt=Kf}catch{}}return Lu.createRoot=function(n,a){if(!s(n))throw Error(i(299));var l=!1,c="",d=qp,p=Xp,A=Yp,O=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(d=a.onUncaughtError),a.onCaughtError!==void 0&&(p=a.onCaughtError),a.onRecoverableError!==void 0&&(A=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(O=a.unstable_transitionCallbacks)),a=x_(n,1,!1,null,null,l,c,d,p,A,O,null),n[gn]=a.current,Yd(n),new f1(a)},Lu.hydrateRoot=function(n,a,l){if(!s(n))throw Error(i(299));var c=!1,d="",p=qp,A=Xp,O=Yp,Y=null,le=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(d=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(A=l.onCaughtError),l.onRecoverableError!==void 0&&(O=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(Y=l.unstable_transitionCallbacks),l.formState!==void 0&&(le=l.formState)),a=x_(n,1,!0,a,l??null,c,d,p,A,O,Y,le),a.context=y_(null),l=a.current,c=In(),c=Ei(c),d=Fa(c),d.callback=null,Pa(l,d,c),l=c,a.current.lanes=l,ii(a,l),Pi(a),n[gn]=a.current,Yd(n),new Yf(a)},Lu.version="19.1.0",Lu}var B_;function G4(){if(B_)return m1.exports;B_=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),m1.exports=H4(),m1.exports}var q4=G4();const X4=By(q4),Y4=()=>{};var U_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy=function(r){const e=[];let t=0;for(let i=0;i<r.length;i++){let s=r.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<r.length&&(r.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(r.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},K4=function(r){const e=[];let t=0,i=0;for(;t<r.length;){const s=r[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=r[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=r[t++],u=r[t++],h=r[t++],g=((s&7)<<18|(o&63)<<12|(u&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const o=r[t++],u=r[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|u&63)}}return e.join("")},jy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<r.length;s+=3){const o=r[s],u=s+1<r.length,h=u?r[s+1]:0,g=s+2<r.length,m=g?r[s+2]:0,v=o>>2,x=(o&3)<<4|h>>4;let y=(h&15)<<2|m>>6,T=m&63;g||(T=64,u||(y=64)),i.push(t[v],t[x],t[y],t[T])}return i.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(Uy(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):K4(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<r.length;){const o=t[r.charAt(s++)],h=s<r.length?t[r.charAt(s)]:0;++s;const m=s<r.length?t[r.charAt(s)]:64;++s;const x=s<r.length?t[r.charAt(s)]:64;if(++s,o==null||h==null||m==null||x==null)throw new W4;const y=o<<2|h>>4;if(i.push(y),m!==64){const T=h<<4&240|m>>2;if(i.push(T),x!==64){const b=m<<6&192|x;i.push(b)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class W4 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Q4=function(r){const e=Uy(r);return jy.encodeByteArray(e,!0)},v0=function(r){return Q4(r).replace(/\./g,"")},$4=function(r){try{return jy.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J4=()=>Z4().__FIREBASE_DEFAULTS__,eS=()=>{if(typeof process>"u"||typeof U_>"u")return;const r=U_.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},tS=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&$4(r[1]);return e&&JSON.parse(e)},fm=()=>{try{return Y4()||J4()||eS()||tS()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},rS=r=>{var e,t;return(t=(e=fm())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},nS=r=>{const e=rS(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},zy=()=>{var r;return(r=fm())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function aS(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sS(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},r);return[v0(JSON.stringify(t)),v0(JSON.stringify(u)),""].join(".")}const Xu={};function lS(){const r={prod:[],emulator:[]};for(const e of Object.keys(Xu))Xu[e]?r.emulator.push(e):r.prod.push(e);return r}function oS(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let j_=!1;function uS(r,e){if(typeof window>"u"||typeof document>"u"||!hm(window.location.host)||Xu[r]===e||Xu[r]||j_)return;Xu[r]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",o=lS().prod.length>0;function u(){const y=document.getElementById(i);y&&y.remove()}function h(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function g(y,T){y.setAttribute("width","24"),y.setAttribute("id",T),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function m(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{j_=!0,u()},y}function v(y,T){y.setAttribute("id",T),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function x(){const y=oS(i),T=t("text"),b=document.getElementById(T)||document.createElement("span"),S=t("learnmore"),w=document.getElementById(S)||document.createElement("a"),G=t("preprendIcon"),Z=document.getElementById(G)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const K=y.element;h(K),v(w,S);const ne=m();g(Z,G),K.append(Z,b,w,ne),document.body.appendChild(K)}o?(b.innerText="Preview backend disconnected.",Z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fS(){var r;const e=(r=fm())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hS(){return!fS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dS(){try{return typeof indexedDB=="object"}catch{return!1}}function mS(){return new Promise((r,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),r(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS="FirebaseError";class bo extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=gS,Object.setPrototypeOf(this,bo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hy.prototype.create)}}class Hy{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],u=o?pS(o,i):"Error",h=`${this.serviceName}: ${u} (${s}).`;return new bo(s,h,i)}}function pS(r,e){return r.replace(vS,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const vS=/\{\$([^}]+)}/g;function _0(r,e){if(r===e)return!0;const t=Object.keys(r),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=r[s],u=e[s];if(z_(o)&&z_(u)){if(!_0(o,u))return!1}else if(o!==u)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function z_(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(r){return r&&r._delegate?r._delegate:r}class nc{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new iS;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yS(e))try{this.getOrInitializeService({instanceIdentifier:Zs})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=Zs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zs){return this.instances.has(e)}getOptions(e=Zs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);i===h&&u.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const u=this.instances.get(s);return u&&e(u,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:xS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Zs){return this.component?this.component.multipleInstances?e:Zs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xS(r){return r===Zs?void 0:r}function yS(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new _S(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(xt||(xt={}));const TS={debug:xt.DEBUG,verbose:xt.VERBOSE,info:xt.INFO,warn:xt.WARN,error:xt.ERROR,silent:xt.SILENT},AS=xt.INFO,SS={[xt.DEBUG]:"log",[xt.VERBOSE]:"log",[xt.INFO]:"info",[xt.WARN]:"warn",[xt.ERROR]:"error"},wS=(r,e,...t)=>{if(e<r.logLevel)return;const i=new Date().toISOString(),s=SS[e];if(s)console[s](`[${i}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gy{constructor(e){this.name=e,this._logLevel=AS,this._logHandler=wS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?TS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xt.DEBUG,...e),this._logHandler(this,xt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xt.VERBOSE,...e),this._logHandler(this,xt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xt.INFO,...e),this._logHandler(this,xt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xt.WARN,...e),this._logHandler(this,xt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xt.ERROR,...e),this._logHandler(this,xt.ERROR,...e)}}const RS=(r,e)=>e.some(t=>r instanceof t);let H_,G_;function CS(){return H_||(H_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bS(){return G_||(G_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qy=new WeakMap,P1=new WeakMap,Xy=new WeakMap,_1=new WeakMap,dm=new WeakMap;function DS(r){const e=new Promise((t,i)=>{const s=()=>{r.removeEventListener("success",o),r.removeEventListener("error",u)},o=()=>{t(is(r.result)),s()},u=()=>{i(r.error),s()};r.addEventListener("success",o),r.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&qy.set(t,r)}).catch(()=>{}),dm.set(e,r),e}function NS(r){if(P1.has(r))return;const e=new Promise((t,i)=>{const s=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",u),r.removeEventListener("abort",u)},o=()=>{t(),s()},u=()=>{i(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",o),r.addEventListener("error",u),r.addEventListener("abort",u)});P1.set(r,e)}let L1={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return P1.get(r);if(e==="objectStoreNames")return r.objectStoreNames||Xy.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return is(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function OS(r){L1=r(L1)}function IS(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=r.call(x1(this),e,...t);return Xy.set(i,e.sort?e.sort():[e]),is(i)}:bS().includes(r)?function(...e){return r.apply(x1(this),e),is(qy.get(this))}:function(...e){return is(r.apply(x1(this),e))}}function kS(r){return typeof r=="function"?IS(r):(r instanceof IDBTransaction&&NS(r),RS(r,CS())?new Proxy(r,L1):r)}function is(r){if(r instanceof IDBRequest)return DS(r);if(_1.has(r))return _1.get(r);const e=kS(r);return e!==r&&(_1.set(r,e),dm.set(e,r)),e}const x1=r=>dm.get(r);function MS(r,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const u=indexedDB.open(r,e),h=is(u);return i&&u.addEventListener("upgradeneeded",g=>{i(is(u.result),g.oldVersion,g.newVersion,is(u.transaction),g)}),t&&u.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),h.then(g=>{o&&g.addEventListener("close",()=>o()),s&&g.addEventListener("versionchange",m=>s(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}const FS=["get","getKey","getAll","getAllKeys","count"],PS=["put","add","delete","clear"],y1=new Map;function q_(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(y1.get(e))return y1.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=PS.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||FS.includes(t)))return;const o=async function(u,...h){const g=this.transaction(u,s?"readwrite":"readonly");let m=g.store;return i&&(m=m.index(h.shift())),(await Promise.all([m[t](...h),s&&g.done]))[0]};return y1.set(e,o),o}OS(r=>({...r,get:(e,t,i)=>q_(e,t)||r.get(e,t,i),has:(e,t)=>!!q_(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(VS(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function VS(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const V1="@firebase/app",X_="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ya=new Gy("@firebase/app"),BS="@firebase/app-compat",US="@firebase/analytics-compat",jS="@firebase/analytics",zS="@firebase/app-check-compat",HS="@firebase/app-check",GS="@firebase/auth",qS="@firebase/auth-compat",XS="@firebase/database",YS="@firebase/data-connect",KS="@firebase/database-compat",WS="@firebase/functions",QS="@firebase/functions-compat",$S="@firebase/installations",ZS="@firebase/installations-compat",JS="@firebase/messaging",ew="@firebase/messaging-compat",tw="@firebase/performance",rw="@firebase/performance-compat",nw="@firebase/remote-config",iw="@firebase/remote-config-compat",aw="@firebase/storage",sw="@firebase/storage-compat",lw="@firebase/firestore",ow="@firebase/ai",uw="@firebase/firestore-compat",cw="firebase",fw="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1="[DEFAULT]",hw={[V1]:"fire-core",[BS]:"fire-core-compat",[jS]:"fire-analytics",[US]:"fire-analytics-compat",[HS]:"fire-app-check",[zS]:"fire-app-check-compat",[GS]:"fire-auth",[qS]:"fire-auth-compat",[XS]:"fire-rtdb",[YS]:"fire-data-connect",[KS]:"fire-rtdb-compat",[WS]:"fire-fn",[QS]:"fire-fn-compat",[$S]:"fire-iid",[ZS]:"fire-iid-compat",[JS]:"fire-fcm",[ew]:"fire-fcm-compat",[tw]:"fire-perf",[rw]:"fire-perf-compat",[nw]:"fire-rc",[iw]:"fire-rc-compat",[aw]:"fire-gcs",[sw]:"fire-gcs-compat",[lw]:"fire-fst",[uw]:"fire-fst-compat",[ow]:"fire-vertex","fire-js":"fire-js",[cw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0=new Map,dw=new Map,U1=new Map;function Y_(r,e){try{r.container.addComponent(e)}catch(t){ya.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function y0(r){const e=r.name;if(U1.has(e))return ya.debug(`There were multiple attempts to register component ${e}.`),!1;U1.set(e,r);for(const t of x0.values())Y_(t,r);for(const t of dw.values())Y_(t,r);return!0}function mw(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function gw(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},as=new Hy("app","Firebase",pw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new nc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw as.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w=fw;function Yy(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const i=Object.assign({name:B1,automaticDataCollectionEnabled:!0},e),s=i.name;if(typeof s!="string"||!s)throw as.create("bad-app-name",{appName:String(s)});if(t||(t=zy()),!t)throw as.create("no-options");const o=x0.get(s);if(o){if(_0(t,o.options)&&_0(i,o.config))return o;throw as.create("duplicate-app",{appName:s})}const u=new ES(s);for(const g of U1.values())u.addComponent(g);const h=new vw(t,i,u);return x0.set(s,h),h}function xw(r=B1){const e=x0.get(r);if(!e&&r===B1&&zy())return Yy();if(!e)throw as.create("no-app",{appName:r});return e}function po(r,e,t){var i;let s=(i=hw[r])!==null&&i!==void 0?i:r;t&&(s+=`-${t}`);const o=s.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const h=[`Unable to register library "${s}" with version "${e}":`];o&&h.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ya.warn(h.join(" "));return}y0(new nc(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw="firebase-heartbeat-database",Ew=1,ic="firebase-heartbeat-store";let E1=null;function Ky(){return E1||(E1=MS(yw,Ew,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(ic)}catch(t){console.warn(t)}}}}).catch(r=>{throw as.create("idb-open",{originalErrorMessage:r.message})})),E1}async function Tw(r){try{const t=(await Ky()).transaction(ic),i=await t.objectStore(ic).get(Wy(r));return await t.done,i}catch(e){if(e instanceof bo)ya.warn(e.message);else{const t=as.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ya.warn(t.message)}}}async function K_(r,e){try{const i=(await Ky()).transaction(ic,"readwrite");await i.objectStore(ic).put(e,Wy(r)),await i.done}catch(t){if(t instanceof bo)ya.warn(t.message);else{const i=as.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ya.warn(i.message)}}}function Wy(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw=1024,Sw=30;class ww{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Cw(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=W_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(u=>u.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>Sw){const u=bw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){ya.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=W_(),{heartbeatsToSend:i,unsentEntries:s}=Rw(this._heartbeatsCache.heartbeats),o=v0(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ya.warn(t),""}}}function W_(){return new Date().toISOString().substring(0,10)}function Rw(r,e=Aw){const t=[];let i=r.slice();for(const s of r){const o=t.find(u=>u.agent===s.agent);if(o){if(o.dates.push(s.date),Q_(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Q_(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Cw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dS()?mS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Tw(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return K_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return K_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Q_(r){return v0(JSON.stringify({version:2,heartbeats:r})).length}function bw(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let i=1;i<r.length;i++)r[i].date<t&&(t=r[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(r){y0(new nc("platform-logger",e=>new LS(e),"PRIVATE")),y0(new nc("heartbeat",e=>new ww(e),"PRIVATE")),po(V1,X_,r),po(V1,X_,"esm2017"),po("fire-js","")}Dw("");var $_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ss,Qy;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,D){function R(){}R.prototype=D.prototype,N.D=D.prototype,N.prototype=new R,N.prototype.constructor=N,N.C=function(k,F,B){for(var P=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)P[qe-2]=arguments[qe];return D.prototype[F].apply(k,P)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,D,R){R||(R=0);var k=Array(16);if(typeof D=="string")for(var F=0;16>F;++F)k[F]=D.charCodeAt(R++)|D.charCodeAt(R++)<<8|D.charCodeAt(R++)<<16|D.charCodeAt(R++)<<24;else for(F=0;16>F;++F)k[F]=D[R++]|D[R++]<<8|D[R++]<<16|D[R++]<<24;D=N.g[0],R=N.g[1],F=N.g[2];var B=N.g[3],P=D+(B^R&(F^B))+k[0]+3614090360&4294967295;D=R+(P<<7&4294967295|P>>>25),P=B+(F^D&(R^F))+k[1]+3905402710&4294967295,B=D+(P<<12&4294967295|P>>>20),P=F+(R^B&(D^R))+k[2]+606105819&4294967295,F=B+(P<<17&4294967295|P>>>15),P=R+(D^F&(B^D))+k[3]+3250441966&4294967295,R=F+(P<<22&4294967295|P>>>10),P=D+(B^R&(F^B))+k[4]+4118548399&4294967295,D=R+(P<<7&4294967295|P>>>25),P=B+(F^D&(R^F))+k[5]+1200080426&4294967295,B=D+(P<<12&4294967295|P>>>20),P=F+(R^B&(D^R))+k[6]+2821735955&4294967295,F=B+(P<<17&4294967295|P>>>15),P=R+(D^F&(B^D))+k[7]+4249261313&4294967295,R=F+(P<<22&4294967295|P>>>10),P=D+(B^R&(F^B))+k[8]+1770035416&4294967295,D=R+(P<<7&4294967295|P>>>25),P=B+(F^D&(R^F))+k[9]+2336552879&4294967295,B=D+(P<<12&4294967295|P>>>20),P=F+(R^B&(D^R))+k[10]+4294925233&4294967295,F=B+(P<<17&4294967295|P>>>15),P=R+(D^F&(B^D))+k[11]+2304563134&4294967295,R=F+(P<<22&4294967295|P>>>10),P=D+(B^R&(F^B))+k[12]+1804603682&4294967295,D=R+(P<<7&4294967295|P>>>25),P=B+(F^D&(R^F))+k[13]+4254626195&4294967295,B=D+(P<<12&4294967295|P>>>20),P=F+(R^B&(D^R))+k[14]+2792965006&4294967295,F=B+(P<<17&4294967295|P>>>15),P=R+(D^F&(B^D))+k[15]+1236535329&4294967295,R=F+(P<<22&4294967295|P>>>10),P=D+(F^B&(R^F))+k[1]+4129170786&4294967295,D=R+(P<<5&4294967295|P>>>27),P=B+(R^F&(D^R))+k[6]+3225465664&4294967295,B=D+(P<<9&4294967295|P>>>23),P=F+(D^R&(B^D))+k[11]+643717713&4294967295,F=B+(P<<14&4294967295|P>>>18),P=R+(B^D&(F^B))+k[0]+3921069994&4294967295,R=F+(P<<20&4294967295|P>>>12),P=D+(F^B&(R^F))+k[5]+3593408605&4294967295,D=R+(P<<5&4294967295|P>>>27),P=B+(R^F&(D^R))+k[10]+38016083&4294967295,B=D+(P<<9&4294967295|P>>>23),P=F+(D^R&(B^D))+k[15]+3634488961&4294967295,F=B+(P<<14&4294967295|P>>>18),P=R+(B^D&(F^B))+k[4]+3889429448&4294967295,R=F+(P<<20&4294967295|P>>>12),P=D+(F^B&(R^F))+k[9]+568446438&4294967295,D=R+(P<<5&4294967295|P>>>27),P=B+(R^F&(D^R))+k[14]+3275163606&4294967295,B=D+(P<<9&4294967295|P>>>23),P=F+(D^R&(B^D))+k[3]+4107603335&4294967295,F=B+(P<<14&4294967295|P>>>18),P=R+(B^D&(F^B))+k[8]+1163531501&4294967295,R=F+(P<<20&4294967295|P>>>12),P=D+(F^B&(R^F))+k[13]+2850285829&4294967295,D=R+(P<<5&4294967295|P>>>27),P=B+(R^F&(D^R))+k[2]+4243563512&4294967295,B=D+(P<<9&4294967295|P>>>23),P=F+(D^R&(B^D))+k[7]+1735328473&4294967295,F=B+(P<<14&4294967295|P>>>18),P=R+(B^D&(F^B))+k[12]+2368359562&4294967295,R=F+(P<<20&4294967295|P>>>12),P=D+(R^F^B)+k[5]+4294588738&4294967295,D=R+(P<<4&4294967295|P>>>28),P=B+(D^R^F)+k[8]+2272392833&4294967295,B=D+(P<<11&4294967295|P>>>21),P=F+(B^D^R)+k[11]+1839030562&4294967295,F=B+(P<<16&4294967295|P>>>16),P=R+(F^B^D)+k[14]+4259657740&4294967295,R=F+(P<<23&4294967295|P>>>9),P=D+(R^F^B)+k[1]+2763975236&4294967295,D=R+(P<<4&4294967295|P>>>28),P=B+(D^R^F)+k[4]+1272893353&4294967295,B=D+(P<<11&4294967295|P>>>21),P=F+(B^D^R)+k[7]+4139469664&4294967295,F=B+(P<<16&4294967295|P>>>16),P=R+(F^B^D)+k[10]+3200236656&4294967295,R=F+(P<<23&4294967295|P>>>9),P=D+(R^F^B)+k[13]+681279174&4294967295,D=R+(P<<4&4294967295|P>>>28),P=B+(D^R^F)+k[0]+3936430074&4294967295,B=D+(P<<11&4294967295|P>>>21),P=F+(B^D^R)+k[3]+3572445317&4294967295,F=B+(P<<16&4294967295|P>>>16),P=R+(F^B^D)+k[6]+76029189&4294967295,R=F+(P<<23&4294967295|P>>>9),P=D+(R^F^B)+k[9]+3654602809&4294967295,D=R+(P<<4&4294967295|P>>>28),P=B+(D^R^F)+k[12]+3873151461&4294967295,B=D+(P<<11&4294967295|P>>>21),P=F+(B^D^R)+k[15]+530742520&4294967295,F=B+(P<<16&4294967295|P>>>16),P=R+(F^B^D)+k[2]+3299628645&4294967295,R=F+(P<<23&4294967295|P>>>9),P=D+(F^(R|~B))+k[0]+4096336452&4294967295,D=R+(P<<6&4294967295|P>>>26),P=B+(R^(D|~F))+k[7]+1126891415&4294967295,B=D+(P<<10&4294967295|P>>>22),P=F+(D^(B|~R))+k[14]+2878612391&4294967295,F=B+(P<<15&4294967295|P>>>17),P=R+(B^(F|~D))+k[5]+4237533241&4294967295,R=F+(P<<21&4294967295|P>>>11),P=D+(F^(R|~B))+k[12]+1700485571&4294967295,D=R+(P<<6&4294967295|P>>>26),P=B+(R^(D|~F))+k[3]+2399980690&4294967295,B=D+(P<<10&4294967295|P>>>22),P=F+(D^(B|~R))+k[10]+4293915773&4294967295,F=B+(P<<15&4294967295|P>>>17),P=R+(B^(F|~D))+k[1]+2240044497&4294967295,R=F+(P<<21&4294967295|P>>>11),P=D+(F^(R|~B))+k[8]+1873313359&4294967295,D=R+(P<<6&4294967295|P>>>26),P=B+(R^(D|~F))+k[15]+4264355552&4294967295,B=D+(P<<10&4294967295|P>>>22),P=F+(D^(B|~R))+k[6]+2734768916&4294967295,F=B+(P<<15&4294967295|P>>>17),P=R+(B^(F|~D))+k[13]+1309151649&4294967295,R=F+(P<<21&4294967295|P>>>11),P=D+(F^(R|~B))+k[4]+4149444226&4294967295,D=R+(P<<6&4294967295|P>>>26),P=B+(R^(D|~F))+k[11]+3174756917&4294967295,B=D+(P<<10&4294967295|P>>>22),P=F+(D^(B|~R))+k[2]+718787259&4294967295,F=B+(P<<15&4294967295|P>>>17),P=R+(B^(F|~D))+k[9]+3951481745&4294967295,N.g[0]=N.g[0]+D&4294967295,N.g[1]=N.g[1]+(F+(P<<21&4294967295|P>>>11))&4294967295,N.g[2]=N.g[2]+F&4294967295,N.g[3]=N.g[3]+B&4294967295}i.prototype.u=function(N,D){D===void 0&&(D=N.length);for(var R=D-this.blockSize,k=this.B,F=this.h,B=0;B<D;){if(F==0)for(;B<=R;)s(this,N,B),B+=this.blockSize;if(typeof N=="string"){for(;B<D;)if(k[F++]=N.charCodeAt(B++),F==this.blockSize){s(this,k),F=0;break}}else for(;B<D;)if(k[F++]=N[B++],F==this.blockSize){s(this,k),F=0;break}}this.h=F,this.o+=D},i.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var D=1;D<N.length-8;++D)N[D]=0;var R=8*this.o;for(D=N.length-8;D<N.length;++D)N[D]=R&255,R/=256;for(this.u(N),N=Array(16),D=R=0;4>D;++D)for(var k=0;32>k;k+=8)N[R++]=this.g[D]>>>k&255;return N};function o(N,D){var R=h;return Object.prototype.hasOwnProperty.call(R,N)?R[N]:R[N]=D(N)}function u(N,D){this.h=D;for(var R=[],k=!0,F=N.length-1;0<=F;F--){var B=N[F]|0;k&&B==D||(R[F]=B,k=!1)}this.g=R}var h={};function g(N){return-128<=N&&128>N?o(N,function(D){return new u([D|0],0>D?-1:0)}):new u([N|0],0>N?-1:0)}function m(N){if(isNaN(N)||!isFinite(N))return x;if(0>N)return w(m(-N));for(var D=[],R=1,k=0;N>=R;k++)D[k]=N/R|0,R*=4294967296;return new u(D,0)}function v(N,D){if(N.length==0)throw Error("number format error: empty string");if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(N.charAt(0)=="-")return w(v(N.substring(1),D));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=m(Math.pow(D,8)),k=x,F=0;F<N.length;F+=8){var B=Math.min(8,N.length-F),P=parseInt(N.substring(F,F+B),D);8>B?(B=m(Math.pow(D,B)),k=k.j(B).add(m(P))):(k=k.j(R),k=k.add(m(P)))}return k}var x=g(0),y=g(1),T=g(16777216);r=u.prototype,r.m=function(){if(S(this))return-w(this).m();for(var N=0,D=1,R=0;R<this.g.length;R++){var k=this.i(R);N+=(0<=k?k:4294967296+k)*D,D*=4294967296}return N},r.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(b(this))return"0";if(S(this))return"-"+w(this).toString(N);for(var D=m(Math.pow(N,6)),R=this,k="";;){var F=ne(R,D).g;R=G(R,F.j(D));var B=((0<R.g.length?R.g[0]:R.h)>>>0).toString(N);if(R=F,b(R))return B+k;for(;6>B.length;)B="0"+B;k=B+k}},r.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function b(N){if(N.h!=0)return!1;for(var D=0;D<N.g.length;D++)if(N.g[D]!=0)return!1;return!0}function S(N){return N.h==-1}r.l=function(N){return N=G(this,N),S(N)?-1:b(N)?0:1};function w(N){for(var D=N.g.length,R=[],k=0;k<D;k++)R[k]=~N.g[k];return new u(R,~N.h).add(y)}r.abs=function(){return S(this)?w(this):this},r.add=function(N){for(var D=Math.max(this.g.length,N.g.length),R=[],k=0,F=0;F<=D;F++){var B=k+(this.i(F)&65535)+(N.i(F)&65535),P=(B>>>16)+(this.i(F)>>>16)+(N.i(F)>>>16);k=P>>>16,B&=65535,P&=65535,R[F]=P<<16|B}return new u(R,R[R.length-1]&-2147483648?-1:0)};function G(N,D){return N.add(w(D))}r.j=function(N){if(b(this)||b(N))return x;if(S(this))return S(N)?w(this).j(w(N)):w(w(this).j(N));if(S(N))return w(this.j(w(N)));if(0>this.l(T)&&0>N.l(T))return m(this.m()*N.m());for(var D=this.g.length+N.g.length,R=[],k=0;k<2*D;k++)R[k]=0;for(k=0;k<this.g.length;k++)for(var F=0;F<N.g.length;F++){var B=this.i(k)>>>16,P=this.i(k)&65535,qe=N.i(F)>>>16,Be=N.i(F)&65535;R[2*k+2*F]+=P*Be,Z(R,2*k+2*F),R[2*k+2*F+1]+=B*Be,Z(R,2*k+2*F+1),R[2*k+2*F+1]+=P*qe,Z(R,2*k+2*F+1),R[2*k+2*F+2]+=B*qe,Z(R,2*k+2*F+2)}for(k=0;k<D;k++)R[k]=R[2*k+1]<<16|R[2*k];for(k=D;k<2*D;k++)R[k]=0;return new u(R,0)};function Z(N,D){for(;(N[D]&65535)!=N[D];)N[D+1]+=N[D]>>>16,N[D]&=65535,D++}function K(N,D){this.g=N,this.h=D}function ne(N,D){if(b(D))throw Error("division by zero");if(b(N))return new K(x,x);if(S(N))return D=ne(w(N),D),new K(w(D.g),w(D.h));if(S(D))return D=ne(N,w(D)),new K(w(D.g),D.h);if(30<N.g.length){if(S(N)||S(D))throw Error("slowDivide_ only works with positive integers.");for(var R=y,k=D;0>=k.l(N);)R=pe(R),k=pe(k);var F=Re(R,1),B=Re(k,1);for(k=Re(k,2),R=Re(R,2);!b(k);){var P=B.add(k);0>=P.l(N)&&(F=F.add(R),B=P),k=Re(k,1),R=Re(R,1)}return D=G(N,F.j(D)),new K(F,D)}for(F=x;0<=N.l(D);){for(R=Math.max(1,Math.floor(N.m()/D.m())),k=Math.ceil(Math.log(R)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),B=m(R),P=B.j(D);S(P)||0<P.l(N);)R-=k,B=m(R),P=B.j(D);b(B)&&(B=y),F=F.add(B),N=G(N,P)}return new K(F,N)}r.A=function(N){return ne(this,N).h},r.and=function(N){for(var D=Math.max(this.g.length,N.g.length),R=[],k=0;k<D;k++)R[k]=this.i(k)&N.i(k);return new u(R,this.h&N.h)},r.or=function(N){for(var D=Math.max(this.g.length,N.g.length),R=[],k=0;k<D;k++)R[k]=this.i(k)|N.i(k);return new u(R,this.h|N.h)},r.xor=function(N){for(var D=Math.max(this.g.length,N.g.length),R=[],k=0;k<D;k++)R[k]=this.i(k)^N.i(k);return new u(R,this.h^N.h)};function pe(N){for(var D=N.g.length+1,R=[],k=0;k<D;k++)R[k]=N.i(k)<<1|N.i(k-1)>>>31;return new u(R,N.h)}function Re(N,D){var R=D>>5;D%=32;for(var k=N.g.length-R,F=[],B=0;B<k;B++)F[B]=0<D?N.i(B+R)>>>D|N.i(B+R+1)<<32-D:N.i(B+R);return new u(F,N.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,Qy=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=m,u.fromString=v,ss=u}).apply(typeof $_<"u"?$_:typeof self<"u"?self:typeof window<"u"?window:{});var Wf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $y,Bu,Zy,f0,j1,Jy,e2,t2;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,_,E){return f==Array.prototype||f==Object.prototype||(f[_]=E.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wf=="object"&&Wf];for(var _=0;_<f.length;++_){var E=f[_];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var i=t(this);function s(f,_){if(_)e:{var E=i;f=f.split(".");for(var I=0;I<f.length-1;I++){var ie=f[I];if(!(ie in E))break e;E=E[ie]}f=f[f.length-1],I=E[f],_=_(I),_!=I&&_!=null&&e(E,f,{configurable:!0,writable:!0,value:_})}}function o(f,_){f instanceof String&&(f+="");var E=0,I=!1,ie={next:function(){if(!I&&E<f.length){var ge=E++;return{value:_(ge,f[ge]),done:!1}}return I=!0,{done:!0,value:void 0}}};return ie[Symbol.iterator]=function(){return ie},ie}s("Array.prototype.values",function(f){return f||function(){return o(this,function(_,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},h=this||self;function g(f){var _=typeof f;return _=_!="object"?_:f?Array.isArray(f)?"array":_:"null",_=="array"||_=="object"&&typeof f.length=="number"}function m(f){var _=typeof f;return _=="object"&&f!=null||_=="function"}function v(f,_,E){return f.call.apply(f.bind,arguments)}function x(f,_,E){if(!f)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var ie=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ie,I),f.apply(_,ie)}}return function(){return f.apply(_,arguments)}}function y(f,_,E){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:x,y.apply(null,arguments)}function T(f,_){var E=Array.prototype.slice.call(arguments,1);return function(){var I=E.slice();return I.push.apply(I,arguments),f.apply(this,I)}}function b(f,_){function E(){}E.prototype=_.prototype,f.aa=_.prototype,f.prototype=new E,f.prototype.constructor=f,f.Qb=function(I,ie,ge){for(var Me=Array(arguments.length-2),gt=2;gt<arguments.length;gt++)Me[gt-2]=arguments[gt];return _.prototype[ie].apply(I,Me)}}function S(f){const _=f.length;if(0<_){const E=Array(_);for(let I=0;I<_;I++)E[I]=f[I];return E}return[]}function w(f,_){for(let E=1;E<arguments.length;E++){const I=arguments[E];if(g(I)){const ie=f.length||0,ge=I.length||0;f.length=ie+ge;for(let Me=0;Me<ge;Me++)f[ie+Me]=I[Me]}else f.push(I)}}class G{constructor(_,E){this.i=_,this.j=E,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function Z(f){return/^[\s\xa0]*$/.test(f)}function K(){var f=h.navigator;return f&&(f=f.userAgent)?f:""}function ne(f){return ne[" "](f),f}ne[" "]=function(){};var pe=K().indexOf("Gecko")!=-1&&!(K().toLowerCase().indexOf("webkit")!=-1&&K().indexOf("Edge")==-1)&&!(K().indexOf("Trident")!=-1||K().indexOf("MSIE")!=-1)&&K().indexOf("Edge")==-1;function Re(f,_,E){for(const I in f)_.call(E,f[I],I,f)}function N(f,_){for(const E in f)_.call(void 0,f[E],E,f)}function D(f){const _={};for(const E in f)_[E]=f[E];return _}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(f,_){let E,I;for(let ie=1;ie<arguments.length;ie++){I=arguments[ie];for(E in I)f[E]=I[E];for(let ge=0;ge<R.length;ge++)E=R[ge],Object.prototype.hasOwnProperty.call(I,E)&&(f[E]=I[E])}}function F(f){var _=1;f=f.split(":");const E=[];for(;0<_&&f.length;)E.push(f.shift()),_--;return f.length&&E.push(f.join(":")),E}function B(f){h.setTimeout(()=>{throw f},0)}function P(){var f=He;let _=null;return f.g&&(_=f.g,f.g=f.g.next,f.g||(f.h=null),_.next=null),_}class qe{constructor(){this.h=this.g=null}add(_,E){const I=Be.get();I.set(_,E),this.h?this.h.next=I:this.g=I,this.h=I}}var Be=new G(()=>new J,f=>f.reset());class J{constructor(){this.next=this.g=this.h=null}set(_,E){this.h=_,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ye,Pe=!1,He=new qe,W=()=>{const f=h.Promise.resolve(void 0);ye=()=>{f.then(xe)}};var xe=()=>{for(var f;f=P();){try{f.h.call(f.g)}catch(E){B(E)}var _=Be;_.j(f),100>_.h&&(_.h++,f.next=_.g,_.g=f)}Pe=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(f,_){this.type=f,this.g=this.target=_,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var f=!1,_=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const E=()=>{};h.addEventListener("test",E,_),h.removeEventListener("test",E,_)}catch{}return f}();function Q(f,_){if(X.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var E=this.type=f.type,I=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=_,_=f.relatedTarget){if(pe){e:{try{ne(_.nodeName);var ie=!0;break e}catch{}ie=!1}ie||(_=null)}}else E=="mouseover"?_=f.fromElement:E=="mouseout"&&(_=f.toElement);this.relatedTarget=_,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:oe[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Q.aa.h.call(this)}}b(Q,X);var oe={2:"touch",3:"pen",4:"mouse"};Q.prototype.h=function(){Q.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),ve=0;function Ne(f,_,E,I,ie){this.listener=f,this.proxy=null,this.src=_,this.type=E,this.capture=!!I,this.ha=ie,this.key=++ve,this.da=this.fa=!1}function De(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function ut(f){this.src=f,this.g={},this.h=0}ut.prototype.add=function(f,_,E,I,ie){var ge=f.toString();f=this.g[ge],f||(f=this.g[ge]=[],this.h++);var Me=Wt(f,_,I,ie);return-1<Me?(_=f[Me],E||(_.fa=!1)):(_=new Ne(_,this.src,ge,!!I,ie),_.fa=E,f.push(_)),_};function rt(f,_){var E=_.type;if(E in f.g){var I=f.g[E],ie=Array.prototype.indexOf.call(I,_,void 0),ge;(ge=0<=ie)&&Array.prototype.splice.call(I,ie,1),ge&&(De(_),f.g[E].length==0&&(delete f.g[E],f.h--))}}function Wt(f,_,E,I){for(var ie=0;ie<f.length;++ie){var ge=f[ie];if(!ge.da&&ge.listener==_&&ge.capture==!!E&&ge.ha==I)return ie}return-1}var lt="closure_lm_"+(1e6*Math.random()|0),tn={};function Bt(f,_,E,I,ie){if(Array.isArray(_)){for(var ge=0;ge<_.length;ge++)Bt(f,_[ge],E,I,ie);return null}return E=Wi(E),f&&f[de]?f.K(_,E,m(I)?!!I.capture:!1,ie):Ve(f,_,E,!1,I,ie)}function Ve(f,_,E,I,ie,ge){if(!_)throw Error("Invalid event type");var Me=m(ie)?!!ie.capture:!!ie,gt=pi(f);if(gt||(f[lt]=gt=new ut(f)),E=gt.add(_,E,I,Me,ge),E.proxy)return E;if(I=Xr(),E.proxy=I,I.src=f,I.listener=E,f.addEventListener)q||(ie=Me),ie===void 0&&(ie=!1),f.addEventListener(_.toString(),I,ie);else if(f.attachEvent)f.attachEvent(dn(_.toString()),I);else if(f.addListener&&f.removeListener)f.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Xr(){function f(E){return _.call(f.src,f.listener,E)}const _=_l;return f}function rn(f,_,E,I,ie){if(Array.isArray(_))for(var ge=0;ge<_.length;ge++)rn(f,_[ge],E,I,ie);else I=m(I)?!!I.capture:!!I,E=Wi(E),f&&f[de]?(f=f.i,_=String(_).toString(),_ in f.g&&(ge=f.g[_],E=Wt(ge,E,I,ie),-1<E&&(De(ge[E]),Array.prototype.splice.call(ge,E,1),ge.length==0&&(delete f.g[_],f.h--)))):f&&(f=pi(f))&&(_=f.g[_.toString()],f=-1,_&&(f=Wt(_,E,I,ie)),(E=-1<f?_[f]:null)&&hn(E))}function hn(f){if(typeof f!="number"&&f&&!f.da){var _=f.src;if(_&&_[de])rt(_.i,f);else{var E=f.type,I=f.proxy;_.removeEventListener?_.removeEventListener(E,I,f.capture):_.detachEvent?_.detachEvent(dn(E),I):_.addListener&&_.removeListener&&_.removeListener(I),(E=pi(_))?(rt(E,f),E.h==0&&(E.src=null,_[lt]=null)):De(f)}}}function dn(f){return f in tn?tn[f]:tn[f]="on"+f}function _l(f,_){if(f.da)f=!0;else{_=new Q(_,this);var E=f.listener,I=f.ha||f.src;f.fa&&hn(f),f=E.call(I,_)}return f}function pi(f){return f=f[lt],f instanceof ut?f:null}var Yr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Wi(f){return typeof f=="function"?f:(f[Yr]||(f[Yr]=function(_){return f.handleEvent(_)}),f[Yr])}function jt(){V.call(this),this.i=new ut(this),this.M=this,this.F=null}b(jt,V),jt.prototype[de]=!0,jt.prototype.removeEventListener=function(f,_,E,I){rn(this,f,_,E,I)};function yt(f,_){var E,I=f.F;if(I)for(E=[];I;I=I.F)E.push(I);if(f=f.M,I=_.type||_,typeof _=="string")_=new X(_,f);else if(_ instanceof X)_.target=_.target||f;else{var ie=_;_=new X(I,f),k(_,ie)}if(ie=!0,E)for(var ge=E.length-1;0<=ge;ge--){var Me=_.g=E[ge];ie=rr(Me,I,!0,_)&&ie}if(Me=_.g=f,ie=rr(Me,I,!0,_)&&ie,ie=rr(Me,I,!1,_)&&ie,E)for(ge=0;ge<E.length;ge++)Me=_.g=E[ge],ie=rr(Me,I,!1,_)&&ie}jt.prototype.N=function(){if(jt.aa.N.call(this),this.i){var f=this.i,_;for(_ in f.g){for(var E=f.g[_],I=0;I<E.length;I++)De(E[I]);delete f.g[_],f.h--}}this.F=null},jt.prototype.K=function(f,_,E,I){return this.i.add(String(f),_,!1,E,I)},jt.prototype.L=function(f,_,E,I){return this.i.add(String(f),_,!0,E,I)};function rr(f,_,E,I){if(_=f.i.g[String(_)],!_)return!0;_=_.concat();for(var ie=!0,ge=0;ge<_.length;++ge){var Me=_[ge];if(Me&&!Me.da&&Me.capture==E){var gt=Me.listener,vr=Me.ha||Me.src;Me.fa&&rt(f.i,Me),ie=gt.call(vr,I)!==!1&&ie}}return ie&&!I.defaultPrevented}function Ar(f,_,E){if(typeof f=="function")E&&(f=y(f,E));else if(f&&typeof f.handleEvent=="function")f=y(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:h.setTimeout(f,_||0)}function As(f){f.g=Ar(()=>{f.g=null,f.i&&(f.i=!1,As(f))},f.l);const _=f.h;f.h=null,f.m.apply(null,_)}class xl extends V{constructor(_,E){super(),this.m=_,this.l=E,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:As(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vi(f){V.call(this),this.h=f,this.g={}}b(vi,V);var _i=[];function xi(f){Re(f.g,function(_,E){this.g.hasOwnProperty(E)&&hn(_)},f),f.g={}}vi.prototype.N=function(){vi.aa.N.call(this),xi(this)},vi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var mn=h.JSON.stringify,Ra=h.JSON.parse,Qi=class{stringify(f){return h.JSON.stringify(f,void 0)}parse(f){return h.JSON.parse(f,void 0)}};function Ca(){}Ca.prototype.h=null;function ba(f){return f.h||(f.h=f.i())}function Da(){}var ni={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ii(){X.call(this,"d")}b(ii,X);function yi(){X.call(this,"c")}b(yi,X);var Un={},Ss=null;function Ei(){return Ss=Ss||new jt}Un.La="serverreachability";function Na(f){X.call(this,Un.La,f)}b(Na,X);function Ti(f){const _=Ei();yt(_,new Na(_))}Un.STAT_EVENT="statevent";function yl(f,_){X.call(this,Un.STAT_EVENT,f),this.stat=_}b(yl,X);function zt(f){const _=Ei();yt(_,new yl(_,f))}Un.Ma="timingevent";function nr(f,_){X.call(this,Un.Ma,f),this.size=_}b(nr,X);function Yt(f,_){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){f()},_)}function gn(){this.g=!0}gn.prototype.xa=function(){this.g=!1};function ws(f,_,E,I,ie,ge){f.info(function(){if(f.g)if(ge)for(var Me="",gt=ge.split("&"),vr=0;vr<gt.length;vr++){var pt=gt[vr].split("=");if(1<pt.length){var wr=pt[0];pt=pt[1];var _r=wr.split("_");Me=2<=_r.length&&_r[1]=="type"?Me+(wr+"="+pt+"&"):Me+(wr+"=redacted&")}}else Me=null;else Me=ge;return"XMLHTTP REQ ("+I+") [attempt "+ie+"]: "+_+`
`+E+`
`+Me})}function Vo(f,_,E,I,ie,ge,Me){f.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+ie+"]: "+_+`
`+E+`
`+ge+" "+Me})}function C(f,_,E,I){f.info(function(){return"XMLHTTP TEXT ("+_+"): "+M(f,E)+(I?" "+I:"")})}function j(f,_){f.info(function(){return"TIMEOUT: "+_})}gn.prototype.info=function(){};function M(f,_){if(!f.g)return _;if(!_)return null;try{var E=JSON.parse(_);if(E){for(f=0;f<E.length;f++)if(Array.isArray(E[f])){var I=E[f];if(!(2>I.length)){var ie=I[1];if(Array.isArray(ie)&&!(1>ie.length)){var ge=ie[0];if(ge!="noop"&&ge!="stop"&&ge!="close")for(var Me=1;Me<ie.length;Me++)ie[Me]=""}}}}return mn(E)}catch{return _}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},U={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},H;function se(){}b(se,Ca),se.prototype.g=function(){return new XMLHttpRequest},se.prototype.i=function(){return{}},H=new se;function me(f,_,E,I){this.j=f,this.i=_,this.l=E,this.R=I||1,this.U=new vi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new re}function re(){this.i=null,this.g="",this.h=!1}var ue={},ce={};function be(f,_,E){f.L=1,f.v=bs(Rn(_)),f.m=E,f.P=!0,Ie(f,null)}function Ie(f,_){f.F=Date.now(),Le(f),f.A=Rn(f.v);var E=f.A,I=f.R;Array.isArray(I)||(I=[String(I)]),Ho(E.i,"t",I),f.C=0,E=f.j.J,f.h=new re,f.g=Gc(f.j,E?_:null,!f.m),0<f.O&&(f.M=new xl(y(f.Y,f,f.g),f.O)),_=f.U,E=f.g,I=f.ca;var ie="readystatechange";Array.isArray(ie)||(ie&&(_i[0]=ie.toString()),ie=_i);for(var ge=0;ge<ie.length;ge++){var Me=Bt(E,ie[ge],I||_.handleEvent,!1,_.h||_);if(!Me)break;_.g[Me.key]=Me}_=f.H?D(f.H):{},f.m?(f.u||(f.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,_)):(f.u="GET",f.g.ea(f.A,f.u,null,_)),Ti(),ws(f.i,f.u,f.A,f.l,f.R,f.m)}me.prototype.ca=function(f){f=f.target;const _=this.M;_&&Gn(f)==3?_.j():this.Y(f)},me.prototype.Y=function(f){try{if(f==this.g)e:{const _r=Gn(this.g);var _=this.g.Ba();const na=this.g.Z();if(!(3>_r)&&(_r!=3||this.g&&(this.h.h||this.g.oa()||Pc(this.g)))){this.J||_r!=4||_==7||(_==8||0>=na?Ti(3):Ti(2)),Et(this);var E=this.g.Z();this.X=E;t:if(Ue(this)){var I=Pc(this.g);f="";var ie=I.length,ge=Gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mt(this),dt(this);var Me="";break t}this.h.i=new h.TextDecoder}for(_=0;_<ie;_++)this.h.h=!0,f+=this.h.i.decode(I[_],{stream:!(ge&&_==ie-1)});I.length=0,this.h.g+=f,this.C=0,Me=this.h.g}else Me=this.g.oa();if(this.o=E==200,Vo(this.i,this.u,this.A,this.l,this.R,_r,E),this.o){if(this.T&&!this.K){t:{if(this.g){var gt,vr=this.g;if((gt=vr.g?vr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Z(gt)){var pt=gt;break t}}pt=null}if(E=pt)C(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wn(this,E);else{this.o=!1,this.s=3,zt(12),mt(this),dt(this);break e}}if(this.P){E=!0;let kr;for(;!this.J&&this.C<Me.length;)if(kr=Oe(this,Me),kr==ce){_r==4&&(this.s=4,zt(14),E=!1),C(this.i,this.l,null,"[Incomplete Response]");break}else if(kr==ue){this.s=4,zt(15),C(this.i,this.l,Me,"[Invalid Chunk]"),E=!1;break}else C(this.i,this.l,kr,null),wn(this,kr);if(Ue(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_r!=4||Me.length!=0||this.h.h||(this.s=1,zt(16),E=!1),this.o=this.o&&E,!E)C(this.i,this.l,Me,"[Invalid Chunked Response]"),mt(this),dt(this);else if(0<Me.length&&!this.W){this.W=!0;var wr=this.j;wr.g==this&&wr.ba&&!wr.M&&(wr.j.info("Great, no buffering proxy detected. Bytes received: "+Me.length),Ps(wr),wr.M=!0,zt(11))}}else C(this.i,this.l,Me,null),wn(this,Me);_r==4&&mt(this),this.o&&!this.J&&(_r==4?jc(this.j,this):(this.o=!1,Le(this)))}else yh(this.g),E==400&&0<Me.indexOf("Unknown SID")?(this.s=3,zt(12)):(this.s=0,zt(13)),mt(this),dt(this)}}}catch{}finally{}};function Ue(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Oe(f,_){var E=f.C,I=_.indexOf(`
`,E);return I==-1?ce:(E=Number(_.substring(E,I)),isNaN(E)?ue:(I+=1,I+E>_.length?ce:(_=_.slice(I,I+E),f.C=I+E,_)))}me.prototype.cancel=function(){this.J=!0,mt(this)};function Le(f){f.S=Date.now()+f.I,$e(f,f.I)}function $e(f,_){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Yt(y(f.ba,f),_)}function Et(f){f.B&&(h.clearTimeout(f.B),f.B=null)}me.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(j(this.i,this.A),this.L!=2&&(Ti(),zt(17)),mt(this),this.s=2,dt(this)):$e(this,this.S-f)};function dt(f){f.j.G==0||f.J||jc(f.j,f)}function mt(f){Et(f);var _=f.M;_&&typeof _.ma=="function"&&_.ma(),f.M=null,xi(f.U),f.g&&(_=f.g,f.g=null,_.abort(),_.ma())}function wn(f,_){try{var E=f.j;if(E.G!=0&&(E.g==f||an(E.h,f))){if(!f.K&&an(E.h,f)&&E.G==3){try{var I=E.Da.g.parse(_)}catch{I=null}if(Array.isArray(I)&&I.length==3){var ie=I;if(ie[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<f.F)Nl(E),bl(E);else break e;Ko(E),zt(18)}}else E.za=ie[1],0<E.za-E.T&&37500>ie[2]&&E.F&&E.v==0&&!E.C&&(E.C=Yt(y(E.Za,E),6e3));if(1>=Si(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else ra(E,11)}else if((f.K||E.g==f)&&Nl(E),!Z(_))for(ie=E.Da.g.parse(_),_=0;_<ie.length;_++){let pt=ie[_];if(E.T=pt[0],pt=pt[1],E.G==2)if(pt[0]=="c"){E.K=pt[1],E.ia=pt[2];const wr=pt[3];wr!=null&&(E.la=wr,E.j.info("VER="+E.la));const _r=pt[4];_r!=null&&(E.Aa=_r,E.j.info("SVER="+E.Aa));const na=pt[5];na!=null&&typeof na=="number"&&0<na&&(I=1.5*na,E.L=I,E.j.info("backChannelRequestTimeoutMs_="+I)),I=E;const kr=f.g;if(kr){const Oi=kr.g?kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oi){var ge=I.h;ge.g||Oi.indexOf("spdy")==-1&&Oi.indexOf("quic")==-1&&Oi.indexOf("h2")==-1||(ge.j=ge.l,ge.g=new Set,ge.h&&(El(ge,ge.h),ge.h=null))}if(I.D){const Qo=kr.g?kr.g.getResponseHeader("X-HTTP-Session-Id"):null;Qo&&(I.ya=Qo,Mt(I.I,I.D,Qo))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-f.F,E.j.info("Handshake RTT: "+E.R+"ms")),I=E;var Me=f;if(I.qa=Hc(I,I.J?I.ia:null,I.W),Me.K){sn(I.h,Me);var gt=Me,vr=I.L;vr&&(gt.I=vr),gt.B&&(Et(gt),Le(gt)),I.g=Me}else Bc(I);0<E.i.length&&Dl(E)}else pt[0]!="stop"&&pt[0]!="close"||ra(E,7);else E.G==3&&(pt[0]=="stop"||pt[0]=="close"?pt[0]=="stop"?ra(E,7):Xo(E):pt[0]!="noop"&&E.l&&E.l.ta(pt),E.v=0)}}Ti(4)}catch{}}var Ai=class{constructor(f,_){this.g=f,this.map=_}};function nn(f){this.l=f||10,h.PerformanceNavigationTiming?(f=h.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function pn(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Si(f){return f.h?1:f.g?f.g.size:0}function an(f,_){return f.h?f.h==_:f.g?f.g.has(_):!1}function El(f,_){f.g?f.g.add(_):f.h=_}function sn(f,_){f.h&&f.h==_?f.h=null:f.g&&f.g.has(_)&&f.g.delete(_)}nn.prototype.cancel=function(){if(this.i=Bo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Bo(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let _=f.i;for(const E of f.g.values())_=_.concat(E.D);return _}return S(f.i)}function ph(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(g(f)){for(var _=[],E=f.length,I=0;I<E;I++)_.push(f[I]);return _}_=[],E=0;for(I in f)_[E++]=f[I];return _}function Tl(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(g(f)||typeof f=="string"){var _=[];f=f.length;for(var E=0;E<f;E++)_.push(E);return _}_=[],E=0;for(const I in f)_[E++]=I;return _}}}function Uo(f,_){if(f.forEach&&typeof f.forEach=="function")f.forEach(_,void 0);else if(g(f)||typeof f=="string")Array.prototype.forEach.call(f,_,void 0);else for(var E=Tl(f),I=ph(f),ie=I.length,ge=0;ge<ie;ge++)_.call(void 0,I[ge],E&&E[ge],f)}var Rs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vh(f,_){if(f){f=f.split("&");for(var E=0;E<f.length;E++){var I=f[E].indexOf("="),ie=null;if(0<=I){var ge=f[E].substring(0,I);ie=f[E].substring(I+1)}else ge=f[E];_(ge,ie?decodeURIComponent(ie.replace(/\+/g," ")):"")}}}function lr(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof lr){this.h=f.h,Cs(this,f.j),this.o=f.o,this.g=f.g,Oa(this,f.s),this.l=f.l;var _=f.i,E=new Zi;E.i=_.i,_.g&&(E.g=new Map(_.g),E.h=_.h),$i(this,E),this.m=f.m}else f&&(_=String(f).match(Rs))?(this.h=!1,Cs(this,_[1]||"",!0),this.o=jn(_[2]||""),this.g=jn(_[3]||"",!0),Oa(this,_[4]),this.l=jn(_[5]||"",!0),$i(this,_[6]||"",!0),this.m=jn(_[7]||"")):(this.h=!1,this.i=new Zi(null,this.h))}lr.prototype.toString=function(){var f=[],_=this.j;_&&f.push(Ds(_,jo,!0),":");var E=this.g;return(E||_=="file")&&(f.push("//"),(_=this.o)&&f.push(Ds(_,jo,!0),"@"),f.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&f.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&f.push("/"),f.push(Ds(E,E.charAt(0)=="/"?_h:zo,!0))),(E=this.i.toString())&&f.push("?",E),(E=this.m)&&f.push("#",Ds(E,Al)),f.join("")};function Rn(f){return new lr(f)}function Cs(f,_,E){f.j=E?jn(_,!0):_,f.j&&(f.j=f.j.replace(/:$/,""))}function Oa(f,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);f.s=_}else f.s=null}function $i(f,_,E){_ instanceof Zi?(f.i=_,Mc(f.i,f.h)):(E||(_=Ds(_,xh)),f.i=new Zi(_,f.h))}function Mt(f,_,E){f.i.set(_,E)}function bs(f){return Mt(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function jn(f,_){return f?_?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Ds(f,_,E){return typeof f=="string"?(f=encodeURI(f).replace(_,kc),E&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function kc(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var jo=/[#\/\?@]/g,zo=/[#\?:]/g,_h=/[#\?]/g,xh=/[#\?@]/g,Al=/#/g;function Zi(f,_){this.h=this.g=null,this.i=f||null,this.j=!!_}function zn(f){f.g||(f.g=new Map,f.h=0,f.i&&vh(f.i,function(_,E){f.add(decodeURIComponent(_.replace(/\+/g," ")),E)}))}r=Zi.prototype,r.add=function(f,_){zn(this),this.i=null,f=wi(this,f);var E=this.g.get(f);return E||this.g.set(f,E=[]),E.push(_),this.h+=1,this};function Ji(f,_){zn(f),_=wi(f,_),f.g.has(_)&&(f.i=null,f.h-=f.g.get(_).length,f.g.delete(_))}function ea(f,_){return zn(f),_=wi(f,_),f.g.has(_)}r.forEach=function(f,_){zn(this),this.g.forEach(function(E,I){E.forEach(function(ie){f.call(_,ie,I,this)},this)},this)},r.na=function(){zn(this);const f=Array.from(this.g.values()),_=Array.from(this.g.keys()),E=[];for(let I=0;I<_.length;I++){const ie=f[I];for(let ge=0;ge<ie.length;ge++)E.push(_[I])}return E},r.V=function(f){zn(this);let _=[];if(typeof f=="string")ea(this,f)&&(_=_.concat(this.g.get(wi(this,f))));else{f=Array.from(this.g.values());for(let E=0;E<f.length;E++)_=_.concat(f[E])}return _},r.set=function(f,_){return zn(this),this.i=null,f=wi(this,f),ea(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[_]),this.h+=1,this},r.get=function(f,_){return f?(f=this.V(f),0<f.length?String(f[0]):_):_};function Ho(f,_,E){Ji(f,_),0<E.length&&(f.i=null,f.g.set(wi(f,_),S(E)),f.h+=E.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],_=Array.from(this.g.keys());for(var E=0;E<_.length;E++){var I=_[E];const ge=encodeURIComponent(String(I)),Me=this.V(I);for(I=0;I<Me.length;I++){var ie=ge;Me[I]!==""&&(ie+="="+encodeURIComponent(String(Me[I]))),f.push(ie)}}return this.i=f.join("&")};function wi(f,_){return _=String(_),f.j&&(_=_.toLowerCase()),_}function Mc(f,_){_&&!f.j&&(zn(f),f.i=null,f.g.forEach(function(E,I){var ie=I.toLowerCase();I!=ie&&(Ji(this,I),Ho(this,ie,E))},f)),f.j=_}function Ns(f,_){const E=new gn;if(h.Image){const I=new Image;I.onload=T(Hn,E,"TestLoadImage: loaded",!0,_,I),I.onerror=T(Hn,E,"TestLoadImage: error",!1,_,I),I.onabort=T(Hn,E,"TestLoadImage: abort",!1,_,I),I.ontimeout=T(Hn,E,"TestLoadImage: timeout",!1,_,I),h.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=f}else _(!1)}function ai(f,_){const E=new gn,I=new AbortController,ie=setTimeout(()=>{I.abort(),Hn(E,"TestPingServer: timeout",!1,_)},1e4);fetch(f,{signal:I.signal}).then(ge=>{clearTimeout(ie),ge.ok?Hn(E,"TestPingServer: ok",!0,_):Hn(E,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(ie),Hn(E,"TestPingServer: error",!1,_)})}function Hn(f,_,E,I,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),I(E)}catch{}}function Os(){this.g=new Qi}function Ri(f,_,E){const I=E||"";try{Uo(f,function(ie,ge){let Me=ie;m(ie)&&(Me=mn(ie)),_.push(I+ge+"="+encodeURIComponent(Me))})}catch(ie){throw _.push(I+"type="+encodeURIComponent("_badmap")),ie}}function Ia(f){this.l=f.Ub||null,this.j=f.eb||!1}b(Ia,Ca),Ia.prototype.g=function(){return new ta(this.l,this.j)},Ia.prototype.i=function(f){return function(){return f}}({});function ta(f,_){jt.call(this),this.D=f,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(ta,jt),r=ta.prototype,r.open=function(f,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=_,this.readyState=1,bi(this)},r.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(_.body=f),(this.D||h).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ci(this)),this.readyState=0},r.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,bi(this)),this.g&&(this.readyState=3,bi(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Go(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Go(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}r.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var _=f.value?f.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!f.done}))&&(this.response=this.responseText+=_)}f.done?Ci(this):bi(this),this.readyState==3&&Go(this)}},r.Ra=function(f){this.g&&(this.response=this.responseText=f,Ci(this))},r.Qa=function(f){this.g&&(this.response=f,Ci(this))},r.ga=function(){this.g&&Ci(this)};function Ci(f){f.readyState=4,f.l=null,f.j=null,f.v=null,bi(f)}r.setRequestHeader=function(f,_){this.u.append(f,_)},r.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],_=this.h.entries();for(var E=_.next();!E.done;)E=E.value,f.push(E[0]+": "+E[1]),E=_.next();return f.join(`\r
`)};function bi(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(ta.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function qo(f){let _="";return Re(f,function(E,I){_+=I,_+=":",_+=E,_+=`\r
`}),_}function Sr(f,_,E){e:{for(I in E){var I=!1;break e}I=!0}I||(E=qo(E),typeof f=="string"?E!=null&&encodeURIComponent(String(E)):Mt(f,_,E))}function Rt(f){jt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Rt,jt);var Sl=/^https?$/i,Is=["POST","PUT"];r=Rt.prototype,r.Ha=function(f){this.J=f},r.ea=function(f,_,E,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);_=_?_.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():H.g(),this.v=this.o?ba(this.o):ba(H),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(_,String(f),!0),this.B=!1}catch(ge){Fc(this,ge);return}if(f=E||"",E=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var ie in I)E.set(ie,I[ie]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const ge of I.keys())E.set(ge,I.get(ge));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(E.keys()).find(ge=>ge.toLowerCase()=="content-type"),ie=h.FormData&&f instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Is,_,void 0))||I||ie||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ge,Me]of E)this.g.setRequestHeader(ge,Me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ks(this),this.u=!0,this.g.send(f),this.u=!1}catch(ge){Fc(this,ge)}};function Fc(f,_){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=_,f.m=5,wl(f),Di(f)}function wl(f){f.A||(f.A=!0,yt(f,"complete"),yt(f,"error"))}r.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,yt(this,"complete"),yt(this,"abort"),Di(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Di(this,!0)),Rt.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Rl(this):this.bb())},r.bb=function(){Rl(this)};function Rl(f){if(f.h&&typeof u<"u"&&(!f.v[1]||Gn(f)!=4||f.Z()!=2)){if(f.u&&Gn(f)==4)Ar(f.Ea,0,f);else if(yt(f,"readystatechange"),Gn(f)==4){f.h=!1;try{const Me=f.Z();e:switch(Me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var E;if(!(E=_)){var I;if(I=Me===0){var ie=String(f.D).match(Rs)[1]||null;!ie&&h.self&&h.self.location&&(ie=h.self.location.protocol.slice(0,-1)),I=!Sl.test(ie?ie.toLowerCase():"")}E=I}if(E)yt(f,"complete"),yt(f,"success");else{f.m=6;try{var ge=2<Gn(f)?f.g.statusText:""}catch{ge=""}f.l=ge+" ["+f.Z()+"]",wl(f)}}finally{Di(f)}}}}function Di(f,_){if(f.g){ks(f);const E=f.g,I=f.v[0]?()=>{}:null;f.g=null,f.v=null,_||yt(f,"ready");try{E.onreadystatechange=I}catch{}}}function ks(f){f.I&&(h.clearTimeout(f.I),f.I=null)}r.isActive=function(){return!!this.g};function Gn(f){return f.g?f.g.readyState:0}r.Z=function(){try{return 2<Gn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(f){if(this.g){var _=this.g.responseText;return f&&_.indexOf(f)==0&&(_=_.substring(f.length)),Ra(_)}};function Pc(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function yh(f){const _={};f=(f.g&&2<=Gn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<f.length;I++){if(Z(f[I]))continue;var E=F(f[I]);const ie=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const ge=_[ie]||[];_[ie]=ge,ge.push(E)}N(_,function(I){return I.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ms(f,_,E){return E&&E.internalChannelParams&&E.internalChannelParams[f]||_}function Cl(f){this.Aa=0,this.i=[],this.j=new gn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ms("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ms("baseRetryDelayMs",5e3,f),this.cb=Ms("retryDelaySeedMs",1e4,f),this.Wa=Ms("forwardChannelMaxRetries",2,f),this.wa=Ms("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new nn(f&&f.concurrentRequestLimit),this.Da=new Os,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Cl.prototype,r.la=8,r.G=1,r.connect=function(f,_,E,I){zt(0),this.W=f,this.H=_||{},E&&I!==void 0&&(this.H.OSID=E,this.H.OAID=I),this.F=this.X,this.I=Hc(this,null,this.W),Dl(this)};function Xo(f){if(Lc(f),f.G==3){var _=f.U++,E=Rn(f.I);if(Mt(E,"SID",f.K),Mt(E,"RID",_),Mt(E,"TYPE","terminate"),Fs(f,E),_=new me(f,f.j,_),_.L=2,_.v=bs(Rn(E)),E=!1,h.navigator&&h.navigator.sendBeacon)try{E=h.navigator.sendBeacon(_.v.toString(),"")}catch{}!E&&h.Image&&(new Image().src=_.v,E=!0),E||(_.g=Gc(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Le(_)}zc(f)}function bl(f){f.g&&(Ps(f),f.g.cancel(),f.g=null)}function Lc(f){bl(f),f.u&&(h.clearTimeout(f.u),f.u=null),Nl(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&h.clearTimeout(f.s),f.s=null)}function Dl(f){if(!pn(f.h)&&!f.s){f.s=!0;var _=f.Ga;ye||W(),Pe||(ye(),Pe=!0),He.add(_,f),f.B=0}}function Eh(f,_){return Si(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=_.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Yt(y(f.Ga,f,_),Wo(f,f.B)),f.B++,!0)}r.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const ie=new me(this,this.j,f);let ge=this.o;if(this.S&&(ge?(ge=D(ge),k(ge,this.S)):ge=this.S),this.m!==null||this.O||(ie.H=ge,ge=null),this.P)e:{for(var _=0,E=0;E<this.i.length;E++){t:{var I=this.i[E];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(_+=I,4096<_){_=E;break e}if(_===4096||E===this.i.length-1){_=E+1;break e}}_=1e3}else _=1e3;_=Vc(this,ie,_),E=Rn(this.I),Mt(E,"RID",f),Mt(E,"CVER",22),this.D&&Mt(E,"X-HTTP-Session-Id",this.D),Fs(this,E),ge&&(this.O?_="headers="+encodeURIComponent(String(qo(ge)))+"&"+_:this.m&&Sr(E,this.m,ge)),El(this.h,ie),this.Ua&&Mt(E,"TYPE","init"),this.P?(Mt(E,"$req",_),Mt(E,"SID","null"),ie.T=!0,be(ie,E,null)):be(ie,E,_),this.G=2}}else this.G==3&&(f?Yo(this,f):this.i.length==0||pn(this.h)||Yo(this))};function Yo(f,_){var E;_?E=_.l:E=f.U++;const I=Rn(f.I);Mt(I,"SID",f.K),Mt(I,"RID",E),Mt(I,"AID",f.T),Fs(f,I),f.m&&f.o&&Sr(I,f.m,f.o),E=new me(f,f.j,E,f.B+1),f.m===null&&(E.H=f.o),_&&(f.i=_.D.concat(f.i)),_=Vc(f,E,1e3),E.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),El(f.h,E),be(E,I,_)}function Fs(f,_){f.H&&Re(f.H,function(E,I){Mt(_,I,E)}),f.l&&Uo({},function(E,I){Mt(_,I,E)})}function Vc(f,_,E){E=Math.min(f.i.length,E);var I=f.l?y(f.l.Na,f.l,f):null;e:{var ie=f.i;let ge=-1;for(;;){const Me=["count="+E];ge==-1?0<E?(ge=ie[0].g,Me.push("ofs="+ge)):ge=0:Me.push("ofs="+ge);let gt=!0;for(let vr=0;vr<E;vr++){let pt=ie[vr].g;const wr=ie[vr].map;if(pt-=ge,0>pt)ge=Math.max(0,ie[vr].g-100),gt=!1;else try{Ri(wr,Me,"req"+pt+"_")}catch{I&&I(wr)}}if(gt){I=Me.join("&");break e}}}return f=f.i.splice(0,E),_.D=f,I}function Bc(f){if(!f.g&&!f.u){f.Y=1;var _=f.Fa;ye||W(),Pe||(ye(),Pe=!0),He.add(_,f),f.v=0}}function Ko(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Yt(y(f.Fa,f),Wo(f,f.v)),f.v++,!0)}r.Fa=function(){if(this.u=null,Uc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Yt(y(this.ab,this),f)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,zt(10),bl(this),Uc(this))};function Ps(f){f.A!=null&&(h.clearTimeout(f.A),f.A=null)}function Uc(f){f.g=new me(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var _=Rn(f.qa);Mt(_,"RID","rpc"),Mt(_,"SID",f.K),Mt(_,"AID",f.T),Mt(_,"CI",f.F?"0":"1"),!f.F&&f.ja&&Mt(_,"TO",f.ja),Mt(_,"TYPE","xmlhttp"),Fs(f,_),f.m&&f.o&&Sr(_,f.m,f.o),f.L&&(f.g.I=f.L);var E=f.g;f=f.ia,E.L=1,E.v=bs(Rn(_)),E.m=null,E.P=!0,Ie(E,f)}r.Za=function(){this.C!=null&&(this.C=null,bl(this),Ko(this),zt(19))};function Nl(f){f.C!=null&&(h.clearTimeout(f.C),f.C=null)}function jc(f,_){var E=null;if(f.g==_){Nl(f),Ps(f),f.g=null;var I=2}else if(an(f.h,_))E=_.D,sn(f.h,_),I=1;else return;if(f.G!=0){if(_.o)if(I==1){E=_.m?_.m.length:0,_=Date.now()-_.F;var ie=f.B;I=Ei(),yt(I,new nr(I,E)),Dl(f)}else Bc(f);else if(ie=_.s,ie==3||ie==0&&0<_.X||!(I==1&&Eh(f,_)||I==2&&Ko(f)))switch(E&&0<E.length&&(_=f.h,_.i=_.i.concat(E)),ie){case 1:ra(f,5);break;case 4:ra(f,10);break;case 3:ra(f,6);break;default:ra(f,2)}}}function Wo(f,_){let E=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(E*=2),E*_}function ra(f,_){if(f.j.info("Error code "+_),_==2){var E=y(f.fb,f),I=f.Xa;const ie=!I;I=new lr(I||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Cs(I,"https"),bs(I),ie?Ns(I.toString(),E):ai(I.toString(),E)}else zt(2);f.G=0,f.l&&f.l.sa(_),zc(f),Lc(f)}r.fb=function(f){f?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function zc(f){if(f.G=0,f.ka=[],f.l){const _=Bo(f.h);(_.length!=0||f.i.length!=0)&&(w(f.ka,_),w(f.ka,f.i),f.h.i.length=0,S(f.i),f.i.length=0),f.l.ra()}}function Hc(f,_,E){var I=E instanceof lr?Rn(E):new lr(E);if(I.g!="")_&&(I.g=_+"."+I.g),Oa(I,I.s);else{var ie=h.location;I=ie.protocol,_=_?_+"."+ie.hostname:ie.hostname,ie=+ie.port;var ge=new lr(null);I&&Cs(ge,I),_&&(ge.g=_),ie&&Oa(ge,ie),E&&(ge.l=E),I=ge}return E=f.D,_=f.ya,E&&_&&Mt(I,E,_),Mt(I,"VER",f.la),Fs(f,I),I}function Gc(f,_,E){if(_&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=f.Ca&&!f.pa?new Rt(new Ia({eb:E})):new Rt(f.pa),_.Ha(f.J),_}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function qc(){}r=qc.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Ol(){}Ol.prototype.g=function(f,_){return new ln(f,_)};function ln(f,_){jt.call(this),this.g=new Cl(_),this.l=f,this.h=_&&_.messageUrlParams||null,f=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(f?f["X-WebChannel-Content-Type"]=_.messageContentType:f={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(f?f["X-WebChannel-Client-Profile"]=_.va:f={"X-WebChannel-Client-Profile":_.va}),this.g.S=f,(f=_&&_.Sb)&&!Z(f)&&(this.g.m=f),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!Z(_)&&(this.g.D=_,f=this.h,f!==null&&_ in f&&(f=this.h,_ in f&&delete f[_])),this.j=new Ni(this)}b(ln,jt),ln.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ln.prototype.close=function(){Xo(this.g)},ln.prototype.o=function(f){var _=this.g;if(typeof f=="string"){var E={};E.__data__=f,f=E}else this.u&&(E={},E.__data__=mn(f),f=E);_.i.push(new Ai(_.Ya++,f)),_.G==3&&Dl(_)},ln.prototype.N=function(){this.g.l=null,delete this.j,Xo(this.g),delete this.g,ln.aa.N.call(this)};function Xc(f){ii.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var _=f.__sm__;if(_){e:{for(const E in _){f=E;break e}f=void 0}(this.i=f)&&(f=this.i,_=_!==null&&f in _?_[f]:void 0),this.data=_}else this.data=f}b(Xc,ii);function Yc(){yi.call(this),this.status=1}b(Yc,yi);function Ni(f){this.g=f}b(Ni,qc),Ni.prototype.ua=function(){yt(this.g,"a")},Ni.prototype.ta=function(f){yt(this.g,new Xc(f))},Ni.prototype.sa=function(f){yt(this.g,new Yc)},Ni.prototype.ra=function(){yt(this.g,"b")},Ol.prototype.createWebChannel=Ol.prototype.g,ln.prototype.send=ln.prototype.o,ln.prototype.open=ln.prototype.m,ln.prototype.close=ln.prototype.close,t2=function(){return new Ol},e2=function(){return Ei()},Jy=Un,j1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,f0=L,U.COMPLETE="complete",Zy=U,Da.EventType=ni,ni.OPEN="a",ni.CLOSE="b",ni.ERROR="c",ni.MESSAGE="d",jt.prototype.listen=jt.prototype.K,Bu=Da,Rt.prototype.listenOnce=Rt.prototype.L,Rt.prototype.getLastError=Rt.prototype.Ka,Rt.prototype.getLastErrorCode=Rt.prototype.Ba,Rt.prototype.getStatus=Rt.prototype.Z,Rt.prototype.getResponseJson=Rt.prototype.Oa,Rt.prototype.getResponseText=Rt.prototype.oa,Rt.prototype.send=Rt.prototype.ea,Rt.prototype.setWithCredentials=Rt.prototype.Ha,$y=Rt}).apply(typeof Wf<"u"?Wf:typeof self<"u"?self:typeof window<"u"?window:{});const Z_="@firebase/firestore",J_="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$r.UNAUTHENTICATED=new $r(null),$r.GOOGLE_CREDENTIALS=new $r("google-credentials-uid"),$r.FIRST_PARTY=new $r("first-party-uid"),$r.MOCK_USER=new $r("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Do="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al=new Gy("@firebase/firestore");function uo(){return al.logLevel}function ze(r,...e){if(al.logLevel<=xt.DEBUG){const t=e.map(mm);al.debug(`Firestore (${Do}): ${r}`,...t)}}function Ea(r,...e){if(al.logLevel<=xt.ERROR){const t=e.map(mm);al.error(`Firestore (${Do}): ${r}`,...t)}}function us(r,...e){if(al.logLevel<=xt.WARN){const t=e.map(mm);al.warn(`Firestore (${Do}): ${r}`,...t)}}function mm(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(r,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,r2(r,i,t)}function r2(r,e,t){let i=`FIRESTORE (${Do}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ea(i),new Error(i)}function Ct(r,e,t,i){let s="Unexpected state";typeof t=="string"?s=t:i=t,r||r2(e,s,i)}function et(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class je extends bo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Nw{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t($r.UNAUTHENTICATED))}shutdown(){}}class Ow{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Iw{constructor(e){this.t=e,this.currentUser=$r.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ct(this.o===void 0,42304);let i=this.i;const s=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let o=new ls;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ls,e.enqueueRetryable(()=>s(this.currentUser))};const u=()=>{const g=o;e.enqueueRetryable(async()=>{await g.promise,await s(this.currentUser)})},h=g=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(g=>h(g)),setTimeout(()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?h(g):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ls)}},0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ct(typeof i.accessToken=="string",31837,{l:i}),new n2(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ct(e===null||typeof e=="string",2055,{h:e}),new $r(e)}}class kw{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=$r.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Mw{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new kw(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t($r.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ex{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Fw{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,gw(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ct(this.o===void 0,3512);const i=o=>{o.error!=null&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,ze("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};const s=o=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ex(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ct(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ex(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<r;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i2(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=Pw(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<t&&(i+=e.charAt(s[o]%62))}return i}}function st(r,e){return r<e?-1:r>e?1:0}function z1(r,e){let t=0;for(;t<r.length&&t<e.length;){const i=r.codePointAt(t),s=e.codePointAt(t);if(i!==s){if(i<128&&s<128)return st(i,s);{const o=i2(),u=Lw(o.encode(tx(r,t)),o.encode(tx(e,t)));return u!==0?u:st(i,s)}}t+=i>65535?2:1}return st(r.length,e.length)}function tx(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function Lw(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return st(r[t],e[t]);return st(r.length,e.length)}function To(r,e,t){return r.length===e.length&&r.every((i,s)=>t(i,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx="__name__";class Ui{constructor(e,t,i){t===void 0?t=0:t>e.length&&Qe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Qe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ui.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ui?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const o=Ui.compareSegments(e.get(s),t.get(s));if(o!==0)return o}return st(e.length,t.length)}static compareSegments(e,t){const i=Ui.isNumericId(e),s=Ui.isNumericId(t);return i&&!s?-1:!i&&s?1:i&&s?Ui.extractNumericId(e).compare(Ui.extractNumericId(t)):z1(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ss.fromString(e.substring(4,e.length-2))}}class Gt extends Ui{construct(e,t,i){return new Gt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new je(Ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(s=>s.length>0))}return new Gt(t)}static emptyPath(){return new Gt([])}}const Vw=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ur extends Ui{construct(e,t,i){return new Ur(e,t,i)}static isValidIdentifier(e){return Vw.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ur.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rx}static keyField(){return new Ur([rx])}static fromServerFormat(e){const t=[];let i="",s=0;const o=()=>{if(i.length===0)throw new je(Ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new je(Ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[s+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new je(Ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,s+=2}else h==="`"?(u=!u,s++):h!=="."||u?(i+=h,s++):(o(),s++)}if(o(),u)throw new je(Ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ur(t)}static emptyPath(){return new Ur([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.path=e}static fromPath(e){return new Ye(Gt.fromString(e))}static fromName(e){return new Ye(Gt.fromString(e).popFirst(5))}static empty(){return new Ye(Gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Gt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ye(new Gt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a2(r,e,t){if(!t)throw new je(Ae.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function Bw(r,e,t,i){if(e===!0&&i===!0)throw new je(Ae.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function nx(r){if(!Ye.isDocumentKey(r))throw new je(Ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function ix(r){if(Ye.isDocumentKey(r))throw new je(Ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function s2(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function Y0(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Qe(12329,{type:typeof r})}function ji(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new je(Ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Y0(r);throw new je(Ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(r,e){const t={typeString:r};return e&&(t.value=e),t}function xc(r,e){if(!s2(r))throw new je(Ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const s=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in r)){t=`JSON missing required field: '${i}'`;break}const u=r[i];if(s&&typeof u!==s){t=`JSON field '${i}' must be a ${s}.`;break}if(o!==void 0&&u!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new je(Ae.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ax=-62135596800,sx=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*sx);return new qt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new je(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new je(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ax)throw new je(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new je(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/sx}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xc(e,qt._jsonSchema))return new qt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ax;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qt._jsonSchemaVersion="firestore/timestamp/1.0",qt._jsonSchema={type:dr("string",qt._jsonSchemaVersion),seconds:dr("number"),nanoseconds:dr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{static fromTimestamp(e){return new Je(e)}static min(){return new Je(new qt(0,0))}static max(){return new Je(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac=-1;function Uw(r,e){const t=r.toTimestamp().seconds,i=r.toTimestamp().nanoseconds+1,s=Je.fromTimestamp(i===1e9?new qt(t+1,0):new qt(t,i));return new cs(s,Ye.empty(),e)}function jw(r){return new cs(r.readTime,r.key,ac)}class cs{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new cs(Je.min(),Ye.empty(),ac)}static max(){return new cs(Je.max(),Ye.empty(),ac)}}function zw(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=Ye.comparator(r.documentKey,e.documentKey),t!==0?t:st(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Gw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(r){if(r.code!==Ae.FAILED_PRECONDITION||r.message!==Hw)throw r;ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Qe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new we((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof we?t:we.resolve(t)}catch(t){return we.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):we.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):we.reject(t)}static resolve(e){return new we((t,i)=>{t(e)})}static reject(e){return new we((t,i)=>{i(e)})}static waitFor(e){return new we((t,i)=>{let s=0,o=0,u=!1;e.forEach(h=>{++s,h.next(()=>{++o,u&&o===s&&t()},g=>i(g))}),u=!0,o===s&&t()})}static or(e){let t=we.resolve(!1);for(const i of e)t=t.next(s=>s?we.resolve(s):i());return t}static forEach(e,t){const i=[];return e.forEach((s,o)=>{i.push(t.call(this,s,o))}),this.waitFor(i)}static mapArray(e,t){return new we((i,s)=>{const o=e.length,u=new Array(o);let h=0;for(let g=0;g<o;g++){const m=g;t(e[m]).next(v=>{u[m]=v,++h,h===o&&i(u)},v=>s(v))}})}static doWhile(e,t){return new we((i,s)=>{const o=()=>{e()===!0?t().next(()=>{o()},s):i()};o()})}}function qw(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Oo(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this._e(i),this.ae=i=>t.writeSequenceNumber(i))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}K0.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm=-1;function W0(r){return r==null}function E0(r){return r===0&&1/r==-1/0}function Xw(r){return typeof r=="number"&&Number.isInteger(r)&&!E0(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="";function Yw(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=lx(e)),e=Kw(r.get(t),e);return lx(e)}function Kw(r,e){let t=e;const i=r.length;for(let s=0;s<i;s++){const o=r.charAt(s);switch(o){case"\0":t+="";break;case l2:t+="";break;default:t+=o}}return t}function lx(r){return r+l2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function xs(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function o2(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,t){this.comparator=e,this.root=t||Br.EMPTY}insert(e,t){return new $t(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Br.BLACK,null,null))}remove(e){return new $t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Br.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qf(this.root,e,this.comparator,!0)}}class Qf{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Br{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??Br.RED,this.left=s??Br.EMPTY,this.right=o??Br.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,o){return new Br(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Br.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Br.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Br.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Br.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Qe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Qe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Qe(27949);return e+(this.isRed()?0:1)}}Br.EMPTY=null,Br.RED=!0,Br.BLACK=!1;Br.EMPTY=new class{constructor(){this.size=0}get key(){throw Qe(57766)}get value(){throw Qe(16141)}get color(){throw Qe(16727)}get left(){throw Qe(29726)}get right(){throw Qe(36894)}copy(e,t,i,s,o){return this}insert(e,t,i){return new Br(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this.comparator=e,this.data=new $t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ux(this.data.getIterator())}getIteratorFrom(e){return new ux(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof Tr)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Tr(this.comparator);return t.data=e,t}}class ux{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.fields=e,e.sort(Ur.comparator)}static empty(){return new Vn([])}unionWith(e){let t=new Tr(Ur.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Vn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return To(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new u2("Invalid base64 string: "+o):o}}(e);return new Gr(t)}static fromUint8Array(e){const t=function(s){let o="";for(let u=0;u<s.length;++u)o+=String.fromCharCode(s[u]);return o}(e);return new Gr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Gr.EMPTY_BYTE_STRING=new Gr("");const Ww=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fs(r){if(Ct(!!r,39018),typeof r=="string"){let e=0;const t=Ww.exec(r);if(Ct(!!t,46558,{timestamp:r}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(r);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:sr(r.seconds),nanos:sr(r.nanos)}}function sr(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function hs(r){return typeof r=="string"?Gr.fromBase64String(r):Gr.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2="server_timestamp",f2="__type__",h2="__previous_value__",d2="__local_write_time__";function vm(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[f2])===null||t===void 0?void 0:t.stringValue)===c2}function Q0(r){const e=r.mapValue.fields[h2];return vm(e)?Q0(e):e}function sc(r){const e=fs(r.mapValue.fields[d2].timestampValue);return new qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(e,t,i,s,o,u,h,g,m,v){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=g,this.useFetchStreams=m,this.isUsingEmulator=v}}const T0="(default)";class lc{constructor(e,t){this.projectId=e,this.database=t||T0}static empty(){return new lc("","")}get isDefaultDatabase(){return this.database===T0}isEqual(e){return e instanceof lc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2="__type__",$w="__max__",$f={mapValue:{}},g2="__vector__",A0="value";function ds(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?vm(r)?4:Jw(r)?9007199254740991:Zw(r)?10:11:Qe(28295,{value:r})}function Yi(r,e){if(r===e)return!0;const t=ds(r);if(t!==ds(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return sc(r).isEqual(sc(e));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const u=fs(s.timestampValue),h=fs(o.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(s,o){return hs(s.bytesValue).isEqual(hs(o.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(s,o){return sr(s.geoPointValue.latitude)===sr(o.geoPointValue.latitude)&&sr(s.geoPointValue.longitude)===sr(o.geoPointValue.longitude)}(r,e);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return sr(s.integerValue)===sr(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const u=sr(s.doubleValue),h=sr(o.doubleValue);return u===h?E0(u)===E0(h):isNaN(u)&&isNaN(h)}return!1}(r,e);case 9:return To(r.arrayValue.values||[],e.arrayValue.values||[],Yi);case 10:case 11:return function(s,o){const u=s.mapValue.fields||{},h=o.mapValue.fields||{};if(ox(u)!==ox(h))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(h[g]===void 0||!Yi(u[g],h[g])))return!1;return!0}(r,e);default:return Qe(52216,{left:r})}}function oc(r,e){return(r.values||[]).find(t=>Yi(t,e))!==void 0}function Ao(r,e){if(r===e)return 0;const t=ds(r),i=ds(e);if(t!==i)return st(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(r.booleanValue,e.booleanValue);case 2:return function(o,u){const h=sr(o.integerValue||o.doubleValue),g=sr(u.integerValue||u.doubleValue);return h<g?-1:h>g?1:h===g?0:isNaN(h)?isNaN(g)?0:-1:1}(r,e);case 3:return cx(r.timestampValue,e.timestampValue);case 4:return cx(sc(r),sc(e));case 5:return z1(r.stringValue,e.stringValue);case 6:return function(o,u){const h=hs(o),g=hs(u);return h.compareTo(g)}(r.bytesValue,e.bytesValue);case 7:return function(o,u){const h=o.split("/"),g=u.split("/");for(let m=0;m<h.length&&m<g.length;m++){const v=st(h[m],g[m]);if(v!==0)return v}return st(h.length,g.length)}(r.referenceValue,e.referenceValue);case 8:return function(o,u){const h=st(sr(o.latitude),sr(u.latitude));return h!==0?h:st(sr(o.longitude),sr(u.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return fx(r.arrayValue,e.arrayValue);case 10:return function(o,u){var h,g,m,v;const x=o.fields||{},y=u.fields||{},T=(h=x[A0])===null||h===void 0?void 0:h.arrayValue,b=(g=y[A0])===null||g===void 0?void 0:g.arrayValue,S=st(((m=T==null?void 0:T.values)===null||m===void 0?void 0:m.length)||0,((v=b==null?void 0:b.values)===null||v===void 0?void 0:v.length)||0);return S!==0?S:fx(T,b)}(r.mapValue,e.mapValue);case 11:return function(o,u){if(o===$f.mapValue&&u===$f.mapValue)return 0;if(o===$f.mapValue)return 1;if(u===$f.mapValue)return-1;const h=o.fields||{},g=Object.keys(h),m=u.fields||{},v=Object.keys(m);g.sort(),v.sort();for(let x=0;x<g.length&&x<v.length;++x){const y=z1(g[x],v[x]);if(y!==0)return y;const T=Ao(h[g[x]],m[v[x]]);if(T!==0)return T}return st(g.length,v.length)}(r.mapValue,e.mapValue);default:throw Qe(23264,{le:t})}}function cx(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return st(r,e);const t=fs(r),i=fs(e),s=st(t.seconds,i.seconds);return s!==0?s:st(t.nanos,i.nanos)}function fx(r,e){const t=r.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const o=Ao(t[s],i[s]);if(o)return o}return st(t.length,i.length)}function So(r){return H1(r)}function H1(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const i=fs(t);return`time(${i.seconds},${i.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return hs(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return Ye.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let i="[",s=!0;for(const o of t.values||[])s?s=!1:i+=",",i+=H1(o);return i+"]"}(r.arrayValue):"mapValue"in r?function(t){const i=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const u of i)o?o=!1:s+=",",s+=`${u}:${H1(t.fields[u])}`;return s+"}"}(r.mapValue):Qe(61005,{value:r})}function h0(r){switch(ds(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Q0(r);return e?16+h0(e):16;case 5:return 2*r.stringValue.length;case 6:return hs(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((s,o)=>s+h0(o),0)}(r.arrayValue);case 10:case 11:return function(i){let s=0;return xs(i.fields,(o,u)=>{s+=o.length+h0(u)}),s}(r.mapValue);default:throw Qe(13486,{value:r})}}function hx(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function G1(r){return!!r&&"integerValue"in r}function _m(r){return!!r&&"arrayValue"in r}function dx(r){return!!r&&"nullValue"in r}function mx(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function d0(r){return!!r&&"mapValue"in r}function Zw(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[m2])===null||t===void 0?void 0:t.stringValue)===g2}function Yu(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return xs(r.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Yu(i)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Yu(r.arrayValue.values[t]);return e}return Object.assign({},r)}function Jw(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===$w}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.value=e}static empty(){return new En({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!d0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yu(t)}setAll(e){let t=Ur.emptyPath(),i={},s=[];e.forEach((u,h)=>{if(!t.isImmediateParentOf(h)){const g=this.getFieldsMap(t);this.applyChanges(g,i,s),i={},s=[],t=h.popLast()}u?i[h.lastSegment()]=Yu(u):s.push(h.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,i,s)}delete(e){const t=this.field(e.popLast());d0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Yi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];d0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){xs(t,(s,o)=>e[s]=o);for(const s of i)delete e[s]}clone(){return new En(Yu(this.value))}}function p2(r){const e=[];return xs(r.fields,(t,i)=>{const s=new Ur([t]);if(d0(i)){const o=p2(i.mapValue).fields;if(o.length===0)e.push(s);else for(const u of o)e.push(s.child(u))}else e.push(s)}),new Vn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,t,i,s,o,u,h){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=o,this.data=u,this.documentState=h}static newInvalidDocument(e){return new Zr(e,0,Je.min(),Je.min(),Je.min(),En.empty(),0)}static newFoundDocument(e,t,i,s){return new Zr(e,1,t,Je.min(),i,s,0)}static newNoDocument(e,t){return new Zr(e,2,t,Je.min(),Je.min(),En.empty(),0)}static newUnknownDocument(e,t){return new Zr(e,3,t,Je.min(),Je.min(),En.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=En.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=En.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Zr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Zr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,t){this.position=e,this.inclusive=t}}function gx(r,e,t){let i=0;for(let s=0;s<r.position.length;s++){const o=e[s],u=r.position[s];if(o.field.isKeyField()?i=Ye.comparator(Ye.fromName(u.referenceValue),t.key):i=Ao(u,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function px(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Yi(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,t="asc"){this.field=e,this.dir=t}}function e3(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{}class hr extends v2{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new r3(e,t,i):t==="array-contains"?new a3(e,i):t==="in"?new s3(e,i):t==="not-in"?new l3(e,i):t==="array-contains-any"?new o3(e,i):new hr(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new n3(e,i):new i3(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ao(t,this.value)):t!==null&&ds(this.value)===ds(t)&&this.matchesComparison(Ao(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Qe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gi extends v2{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new gi(e,t)}matches(e){return _2(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function _2(r){return r.op==="and"}function x2(r){return t3(r)&&_2(r)}function t3(r){for(const e of r.filters)if(e instanceof gi)return!1;return!0}function q1(r){if(r instanceof hr)return r.field.canonicalString()+r.op.toString()+So(r.value);if(x2(r))return r.filters.map(e=>q1(e)).join(",");{const e=r.filters.map(t=>q1(t)).join(",");return`${r.op}(${e})`}}function y2(r,e){return r instanceof hr?function(i,s){return s instanceof hr&&i.op===s.op&&i.field.isEqual(s.field)&&Yi(i.value,s.value)}(r,e):r instanceof gi?function(i,s){return s instanceof gi&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((o,u,h)=>o&&y2(u,s.filters[h]),!0):!1}(r,e):void Qe(19439)}function E2(r){return r instanceof hr?function(t){return`${t.field.canonicalString()} ${t.op} ${So(t.value)}`}(r):r instanceof gi?function(t){return t.op.toString()+" {"+t.getFilters().map(E2).join(" ,")+"}"}(r):"Filter"}class r3 extends hr{constructor(e,t,i){super(e,t,i),this.key=Ye.fromName(i.referenceValue)}matches(e){const t=Ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class n3 extends hr{constructor(e,t){super(e,"in",t),this.keys=T2("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class i3 extends hr{constructor(e,t){super(e,"not-in",t),this.keys=T2("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function T2(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>Ye.fromName(i.referenceValue))}class a3 extends hr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return _m(t)&&oc(t.arrayValue,this.value)}}class s3 extends hr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&oc(this.value.arrayValue,t)}}class l3 extends hr{constructor(e,t){super(e,"not-in",t)}matches(e){if(oc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!oc(this.value.arrayValue,t)}}class o3 extends hr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!_m(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>oc(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,t=null,i=[],s=[],o=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=u,this.endAt=h,this.Pe=null}}function vx(r,e=null,t=[],i=[],s=null,o=null,u=null){return new u3(r,e,t,i,s,o,u)}function xm(r){const e=et(r);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>q1(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),W0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>So(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>So(i)).join(",")),e.Pe=t}return e.Pe}function ym(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!e3(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!y2(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!px(r.startAt,e.startAt)&&px(r.endAt,e.endAt)}function X1(r){return Ye.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,t=null,i=[],s=[],o=null,u="F",h=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=u,this.startAt=h,this.endAt=g,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function c3(r,e,t,i,s,o,u,h){return new Io(r,e,t,i,s,o,u,h)}function Em(r){return new Io(r)}function _x(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function A2(r){return r.collectionGroup!==null}function Ku(r){const e=et(r);if(e.Te===null){e.Te=[];const t=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new Tr(Ur.comparator);return u.filters.forEach(g=>{g.getFlattenedFilters().forEach(m=>{m.isInequality()&&(h=h.add(m.field))})}),h})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Te.push(new uc(o,i))}),t.has(Ur.keyField().canonicalString())||e.Te.push(new uc(Ur.keyField(),i))}return e.Te}function zi(r){const e=et(r);return e.Ie||(e.Ie=f3(e,Ku(r))),e.Ie}function f3(r,e){if(r.limitType==="F")return vx(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new uc(s.field,o)});const t=r.endAt?new S0(r.endAt.position,r.endAt.inclusive):null,i=r.startAt?new S0(r.startAt.position,r.startAt.inclusive):null;return vx(r.path,r.collectionGroup,e,r.filters,r.limit,t,i)}}function Y1(r,e){const t=r.filters.concat([e]);return new Io(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function K1(r,e,t){return new Io(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function $0(r,e){return ym(zi(r),zi(e))&&r.limitType===e.limitType}function S2(r){return`${xm(zi(r))}|lt:${r.limitType}`}function co(r){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(s=>E2(s)).join(", ")}]`),W0(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(s=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(s)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(s=>So(s)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(s=>So(s)).join(",")),`Target(${i})`}(zi(r))}; limitType=${r.limitType})`}function Z0(r,e){return e.isFoundDocument()&&function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Ye.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(r,e)&&function(i,s){for(const o of Ku(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(r,e)&&function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0}(r,e)&&function(i,s){return!(i.startAt&&!function(u,h,g){const m=gx(u,h,g);return u.inclusive?m<=0:m<0}(i.startAt,Ku(i),s)||i.endAt&&!function(u,h,g){const m=gx(u,h,g);return u.inclusive?m>=0:m>0}(i.endAt,Ku(i),s))}(r,e)}function h3(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function w2(r){return(e,t)=>{let i=!1;for(const s of Ku(r)){const o=d3(s,e,t);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function d3(r,e,t){const i=r.field.isKeyField()?Ye.comparator(e.key,t.key):function(o,u,h){const g=u.data.field(o),m=h.data.field(o);return g!==null&&m!==null?Ao(g,m):Qe(42886)}(r.field,e,t);switch(r.dir){case"asc":return i;case"desc":return-1*i;default:return Qe(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){xs(this.inner,(t,i)=>{for(const[s,o]of i)e(s,o)})}isEmpty(){return o2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m3=new $t(Ye.comparator);function Ta(){return m3}const R2=new $t(Ye.comparator);function Uu(...r){let e=R2;for(const t of r)e=e.insert(t.key,t);return e}function C2(r){let e=R2;return r.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function el(){return Wu()}function b2(){return Wu()}function Wu(){return new fl(r=>r.toString(),(r,e)=>r.isEqual(e))}const g3=new $t(Ye.comparator),p3=new Tr(Ye.comparator);function ht(...r){let e=p3;for(const t of r)e=e.add(t);return e}const v3=new Tr(st);function _3(){return v3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:E0(e)?"-0":e}}function D2(r){return{integerValue:""+r}}function x3(r,e){return Xw(e)?D2(e):Tm(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(){this._=void 0}}function y3(r,e,t){return r instanceof w0?function(s,o){const u={fields:{[f2]:{stringValue:c2},[d2]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&vm(o)&&(o=Q0(o)),o&&(u.fields[h2]=o),{mapValue:u}}(t,e):r instanceof cc?O2(r,e):r instanceof fc?I2(r,e):function(s,o){const u=N2(s,o),h=xx(u)+xx(s.Ee);return G1(u)&&G1(s.Ee)?D2(h):Tm(s.serializer,h)}(r,e)}function E3(r,e,t){return r instanceof cc?O2(r,e):r instanceof fc?I2(r,e):t}function N2(r,e){return r instanceof R0?function(i){return G1(i)||function(o){return!!o&&"doubleValue"in o}(i)}(e)?e:{integerValue:0}:null}class w0 extends J0{}class cc extends J0{constructor(e){super(),this.elements=e}}function O2(r,e){const t=k2(e);for(const i of r.elements)t.some(s=>Yi(s,i))||t.push(i);return{arrayValue:{values:t}}}class fc extends J0{constructor(e){super(),this.elements=e}}function I2(r,e){let t=k2(e);for(const i of r.elements)t=t.filter(s=>!Yi(s,i));return{arrayValue:{values:t}}}class R0 extends J0{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function xx(r){return sr(r.integerValue||r.doubleValue)}function k2(r){return _m(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function T3(r,e){return r.field.isEqual(e.field)&&function(i,s){return i instanceof cc&&s instanceof cc||i instanceof fc&&s instanceof fc?To(i.elements,s.elements,Yi):i instanceof R0&&s instanceof R0?Yi(i.Ee,s.Ee):i instanceof w0&&s instanceof w0}(r.transform,e.transform)}class A3{constructor(e,t){this.version=e,this.transformResults=t}}class di{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new di}static exists(e){return new di(void 0,e)}static updateTime(e){return new di(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function m0(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class eh{}function M2(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new Am(r.key,di.none()):new yc(r.key,r.data,di.none());{const t=r.data,i=En.empty();let s=new Tr(Ur.comparator);for(let o of e.fields)if(!s.has(o)){let u=t.field(o);u===null&&o.length>1&&(o=o.popLast(),u=t.field(o)),u===null?i.delete(o):i.set(o,u),s=s.add(o)}return new ys(r.key,i,new Vn(s.toArray()),di.none())}}function S3(r,e,t){r instanceof yc?function(s,o,u){const h=s.value.clone(),g=Ex(s.fieldTransforms,o,u.transformResults);h.setAll(g),o.convertToFoundDocument(u.version,h).setHasCommittedMutations()}(r,e,t):r instanceof ys?function(s,o,u){if(!m0(s.precondition,o))return void o.convertToUnknownDocument(u.version);const h=Ex(s.fieldTransforms,o,u.transformResults),g=o.data;g.setAll(F2(s)),g.setAll(h),o.convertToFoundDocument(u.version,g).setHasCommittedMutations()}(r,e,t):function(s,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,t)}function Qu(r,e,t,i){return r instanceof yc?function(o,u,h,g){if(!m0(o.precondition,u))return h;const m=o.value.clone(),v=Tx(o.fieldTransforms,g,u);return m.setAll(v),u.convertToFoundDocument(u.version,m).setHasLocalMutations(),null}(r,e,t,i):r instanceof ys?function(o,u,h,g){if(!m0(o.precondition,u))return h;const m=Tx(o.fieldTransforms,g,u),v=u.data;return v.setAll(F2(o)),v.setAll(m),u.convertToFoundDocument(u.version,v).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(x=>x.field))}(r,e,t,i):function(o,u,h){return m0(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h}(r,e,t)}function w3(r,e){let t=null;for(const i of r.fieldTransforms){const s=e.data.field(i.field),o=N2(i.transform,s||null);o!=null&&(t===null&&(t=En.empty()),t.set(i.field,o))}return t||null}function yx(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&To(i,s,(o,u)=>T3(o,u))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class yc extends eh{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ys extends eh{constructor(e,t,i,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function F2(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=r.data.field(t);e.set(t,i)}}),e}function Ex(r,e,t){const i=new Map;Ct(r.length===t.length,32656,{Ae:t.length,Re:r.length});for(let s=0;s<t.length;s++){const o=r[s],u=o.transform,h=e.data.field(o.field);i.set(o.field,E3(u,h,t[s]))}return i}function Tx(r,e,t){const i=new Map;for(const s of r){const o=s.transform,u=t.data.field(s.field);i.set(s.field,y3(o,u,e))}return i}class Am extends eh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class R3 extends eh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C3{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&S3(o,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Qu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Qu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=b2();return this.mutations.forEach(s=>{const o=e.get(s.key),u=o.overlayedDocument;let h=this.applyToLocalView(u,o.mutatedFields);h=t.has(s.key)?null:h;const g=M2(u,h);g!==null&&i.set(s.key,g),u.isValidDocument()||u.convertToNoDocument(Je.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ht())}isEqual(e){return this.batchId===e.batchId&&To(this.mutations,e.mutations,(t,i)=>yx(t,i))&&To(this.baseMutations,e.baseMutations,(t,i)=>yx(t,i))}}class Sm{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){Ct(e.mutations.length===i.length,58842,{Ve:e.mutations.length,me:i.length});let s=function(){return g3}();const o=e.mutations;for(let u=0;u<o.length;u++)s=s.insert(o[u].key,i[u].version);return new Sm(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D3{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fr,_t;function N3(r){switch(r){case Ae.OK:return Qe(64938);case Ae.CANCELLED:case Ae.UNKNOWN:case Ae.DEADLINE_EXCEEDED:case Ae.RESOURCE_EXHAUSTED:case Ae.INTERNAL:case Ae.UNAVAILABLE:case Ae.UNAUTHENTICATED:return!1;case Ae.INVALID_ARGUMENT:case Ae.NOT_FOUND:case Ae.ALREADY_EXISTS:case Ae.PERMISSION_DENIED:case Ae.FAILED_PRECONDITION:case Ae.ABORTED:case Ae.OUT_OF_RANGE:case Ae.UNIMPLEMENTED:case Ae.DATA_LOSS:return!0;default:return Qe(15467,{code:r})}}function P2(r){if(r===void 0)return Ea("GRPC error has no .code"),Ae.UNKNOWN;switch(r){case fr.OK:return Ae.OK;case fr.CANCELLED:return Ae.CANCELLED;case fr.UNKNOWN:return Ae.UNKNOWN;case fr.DEADLINE_EXCEEDED:return Ae.DEADLINE_EXCEEDED;case fr.RESOURCE_EXHAUSTED:return Ae.RESOURCE_EXHAUSTED;case fr.INTERNAL:return Ae.INTERNAL;case fr.UNAVAILABLE:return Ae.UNAVAILABLE;case fr.UNAUTHENTICATED:return Ae.UNAUTHENTICATED;case fr.INVALID_ARGUMENT:return Ae.INVALID_ARGUMENT;case fr.NOT_FOUND:return Ae.NOT_FOUND;case fr.ALREADY_EXISTS:return Ae.ALREADY_EXISTS;case fr.PERMISSION_DENIED:return Ae.PERMISSION_DENIED;case fr.FAILED_PRECONDITION:return Ae.FAILED_PRECONDITION;case fr.ABORTED:return Ae.ABORTED;case fr.OUT_OF_RANGE:return Ae.OUT_OF_RANGE;case fr.UNIMPLEMENTED:return Ae.UNIMPLEMENTED;case fr.DATA_LOSS:return Ae.DATA_LOSS;default:return Qe(39323,{code:r})}}(_t=fr||(fr={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3=new ss([4294967295,4294967295],0);function Ax(r){const e=i2().encode(r),t=new Qy;return t.update(e),new Uint8Array(t.digest())}function Sx(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new ss([t,i],0),new ss([s,o],0)]}class wm{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ju(`Invalid padding: ${t}`);if(i<0)throw new ju(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ju(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ju(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ss.fromNumber(this.fe)}pe(e,t,i){let s=e.add(t.multiply(ss.fromNumber(i)));return s.compare(O3)===1&&(s=new ss([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=Ax(e),[i,s]=Sx(t);for(let o=0;o<this.hashCount;o++){const u=this.pe(i,s,o);if(!this.ye(u))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new wm(o,s,t);return i.forEach(h=>u.insert(h)),u}insert(e){if(this.fe===0)return;const t=Ax(e),[i,s]=Sx(t);for(let o=0;o<this.hashCount;o++){const u=this.pe(i,s,o);this.we(u)}}we(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ju extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e,t,i,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Ec.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new th(Je.min(),s,new $t(st),Ta(),ht())}}class Ec{constructor(e,t,i,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ec(i,t,ht(),ht(),ht())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(e,t,i,s){this.Se=e,this.removedTargetIds=t,this.key=i,this.be=s}}class L2{constructor(e,t){this.targetId=e,this.De=t}}class V2{constructor(e,t,i=Gr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class wx{constructor(){this.ve=0,this.Ce=Rx(),this.Fe=Gr.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ht(),t=ht(),i=ht();return this.Ce.forEach((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:Qe(38017,{changeType:o})}}),new Ec(this.Fe,this.Me,e,t,i)}ke(){this.xe=!1,this.Ce=Rx()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Ct(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class I3{constructor(e){this.We=e,this.Ge=new Map,this.ze=Ta(),this.je=Zf(),this.Je=Zf(),this.He=new $t(st)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const i=this.tt(t);switch(e.state){case 0:this.nt(t)&&i.Be(e.resumeToken);break;case 1:i.Ue(),i.Oe||i.ke(),i.Be(e.resumeToken);break;case 2:i.Ue(),i.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(i.Ke(),i.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),i.Be(e.resumeToken));break;default:Qe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((i,s)=>{this.nt(s)&&t(s)})}it(e){const t=e.targetId,i=e.De.count,s=this.st(t);if(s){const o=s.target;if(X1(o))if(i===0){const u=new Ye(o.path);this.Xe(t,u,Zr.newNoDocument(u,Je.min()))}else Ct(i===1,20013,{expectedCount:i});else{const u=this.ot(t);if(u!==i){const h=this._t(e),g=h?this.ut(h,e,u):1;if(g!==0){this.rt(t);const m=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,m)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=t;let u,h;try{u=hs(i).toUint8Array()}catch(g){if(g instanceof u2)return us("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{h=new wm(u,s,o)}catch(g){return us(g instanceof ju?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return h.fe===0?null:h}ut(e,t,i){return t.De.count===i-this.ht(e,t.targetId)?0:2}ht(e,t){const i=this.We.getRemoteKeysForTarget(t);let s=0;return i.forEach(o=>{const u=this.We.lt(),h=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.Xe(t,o,null),s++)}),s}Pt(e){const t=new Map;this.Ge.forEach((o,u)=>{const h=this.st(u);if(h){if(o.current&&X1(h.target)){const g=new Ye(h.target.path);this.Tt(g).has(u)||this.It(u,g)||this.Xe(u,g,Zr.newNoDocument(g,e))}o.Ne&&(t.set(u,o.Le()),o.ke())}});let i=ht();this.Je.forEach((o,u)=>{let h=!0;u.forEachWhile(g=>{const m=this.st(g);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(i=i.add(o))}),this.ze.forEach((o,u)=>u.setReadTime(e));const s=new th(e,t,this.He,this.ze,i);return this.ze=Ta(),this.je=Zf(),this.Je=Zf(),this.He=new $t(st),s}Ze(e,t){if(!this.nt(e))return;const i=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,i),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,i){if(!this.nt(e))return;const s=this.tt(e);this.It(e,t)?s.qe(t,1):s.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),i&&(this.ze=this.ze.insert(t,i))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new wx,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Tr(st),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Tr(st),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||ze("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new wx),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Zf(){return new $t(Ye.comparator)}function Rx(){return new $t(Ye.comparator)}const k3={asc:"ASCENDING",desc:"DESCENDING"},M3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},F3={and:"AND",or:"OR"};class P3{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function W1(r,e){return r.useProto3Json||W0(e)?e:{value:e}}function C0(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function B2(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function L3(r,e){return C0(r,e.toTimestamp())}function Hi(r){return Ct(!!r,49232),Je.fromTimestamp(function(t){const i=fs(t);return new qt(i.seconds,i.nanos)}(r))}function Rm(r,e){return Q1(r,e).canonicalString()}function Q1(r,e){const t=function(s){return new Gt(["projects",s.projectId,"databases",s.database])}(r).child("documents");return e===void 0?t:t.child(e)}function U2(r){const e=Gt.fromString(r);return Ct(q2(e),10190,{key:e.toString()}),e}function $1(r,e){return Rm(r.databaseId,e.path)}function T1(r,e){const t=U2(e);if(t.get(1)!==r.databaseId.projectId)throw new je(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new je(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Ye(z2(t))}function j2(r,e){return Rm(r.databaseId,e)}function V3(r){const e=U2(r);return e.length===4?Gt.emptyPath():z2(e)}function Z1(r){return new Gt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function z2(r){return Ct(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function Cx(r,e,t){return{name:$1(r,e),fields:t.value.mapValue.fields}}function B3(r,e){let t;if("targetChange"in e){e.targetChange;const i=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Qe(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=function(m,v){return m.useProto3Json?(Ct(v===void 0||typeof v=="string",58123),Gr.fromBase64String(v||"")):(Ct(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),Gr.fromUint8Array(v||new Uint8Array))}(r,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&function(m){const v=m.code===void 0?Ae.UNKNOWN:P2(m.code);return new je(v,m.message||"")}(u);t=new V2(i,s,o,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=T1(r,i.document.name),o=Hi(i.document.updateTime),u=i.document.createTime?Hi(i.document.createTime):Je.min(),h=new En({mapValue:{fields:i.document.fields}}),g=Zr.newFoundDocument(s,o,u,h),m=i.targetIds||[],v=i.removedTargetIds||[];t=new g0(m,v,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=T1(r,i.document),o=i.readTime?Hi(i.readTime):Je.min(),u=Zr.newNoDocument(s,o),h=i.removedTargetIds||[];t=new g0([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=T1(r,i.document),o=i.removedTargetIds||[];t=new g0([],o,s,null)}else{if(!("filter"in e))return Qe(11601,{At:e});{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:o}=i,u=new D3(s,o),h=i.targetId;t=new L2(h,u)}}return t}function U3(r,e){let t;if(e instanceof yc)t={update:Cx(r,e.key,e.value)};else if(e instanceof Am)t={delete:$1(r,e.key)};else if(e instanceof ys)t={update:Cx(r,e.key,e.data),updateMask:W3(e.fieldMask)};else{if(!(e instanceof R3))return Qe(16599,{Rt:e.type});t={verify:$1(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(o,u){const h=u.transform;if(h instanceof w0)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof cc)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof fc)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof R0)return{fieldPath:u.field.canonicalString(),increment:h.Ee};throw Qe(20930,{transform:u.transform})}(0,i))),e.precondition.isNone||(t.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:L3(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Qe(27497)}(r,e.precondition)),t}function j3(r,e){return r&&r.length>0?(Ct(e!==void 0,14353),r.map(t=>function(s,o){let u=s.updateTime?Hi(s.updateTime):Hi(o);return u.isEqual(Je.min())&&(u=Hi(o)),new A3(u,s.transformResults||[])}(t,e))):[]}function z3(r,e){return{documents:[j2(r,e.path)]}}function H3(r,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=j2(r,s);const o=function(m){if(m.length!==0)return G2(gi.create(m,"and"))}(e.filters);o&&(t.structuredQuery.where=o);const u=function(m){if(m.length!==0)return m.map(v=>function(y){return{field:fo(y.field),direction:X3(y.dir)}}(v))}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const h=W1(r,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{Vt:t,parent:s}}function G3(r){let e=V3(r.parent);const t=r.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){Ct(i===1,65062);const v=t.from[0];v.allDescendants?s=v.collectionId:e=e.child(v.collectionId)}let o=[];t.where&&(o=function(x){const y=H2(x);return y instanceof gi&&x2(y)?y.getFilters():[y]}(t.where));let u=[];t.orderBy&&(u=function(x){return x.map(y=>function(b){return new uc(ho(b.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(y))}(t.orderBy));let h=null;t.limit&&(h=function(x){let y;return y=typeof x=="object"?x.value:x,W0(y)?null:y}(t.limit));let g=null;t.startAt&&(g=function(x){const y=!!x.before,T=x.values||[];return new S0(T,y)}(t.startAt));let m=null;return t.endAt&&(m=function(x){const y=!x.before,T=x.values||[];return new S0(T,y)}(t.endAt)),c3(e,s,u,o,h,"F",g,m)}function q3(r,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Qe(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function H2(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ho(t.unaryFilter.field);return hr.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=ho(t.unaryFilter.field);return hr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ho(t.unaryFilter.field);return hr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=ho(t.unaryFilter.field);return hr.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Qe(61313);default:return Qe(60726)}}(r):r.fieldFilter!==void 0?function(t){return hr.create(ho(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Qe(58110);default:return Qe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return gi.create(t.compositeFilter.filters.map(i=>H2(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Qe(1026)}}(t.compositeFilter.op))}(r):Qe(30097,{filter:r})}function X3(r){return k3[r]}function Y3(r){return M3[r]}function K3(r){return F3[r]}function fo(r){return{fieldPath:r.canonicalString()}}function ho(r){return Ur.fromServerFormat(r.fieldPath)}function G2(r){return r instanceof hr?function(t){if(t.op==="=="){if(mx(t.value))return{unaryFilter:{field:fo(t.field),op:"IS_NAN"}};if(dx(t.value))return{unaryFilter:{field:fo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(mx(t.value))return{unaryFilter:{field:fo(t.field),op:"IS_NOT_NAN"}};if(dx(t.value))return{unaryFilter:{field:fo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fo(t.field),op:Y3(t.op),value:t.value}}}(r):r instanceof gi?function(t){const i=t.getFilters().map(s=>G2(s));return i.length===1?i[0]:{compositeFilter:{op:K3(t.op),filters:i}}}(r):Qe(54877,{filter:r})}function W3(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function q2(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,t,i,s,o=Je.min(),u=Je.min(),h=Gr.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=g}withSequenceNumber(e){return new ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(e){this.gt=e}}function $3(r){const e=G3({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?K1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(){this.Dn=new J3}addToCollectionParentIndex(e,t){return this.Dn.add(t),we.resolve()}getCollectionParents(e,t){return we.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return we.resolve()}deleteFieldIndex(e,t){return we.resolve()}deleteAllFieldIndexes(e){return we.resolve()}createTargetIndexes(e,t){return we.resolve()}getDocumentsMatchingTarget(e,t){return we.resolve(null)}getIndexType(e,t){return we.resolve(0)}getFieldIndexes(e,t){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,t){return we.resolve(cs.min())}getMinOffsetFromCollectionGroup(e,t){return we.resolve(cs.min())}updateCollectionGroup(e,t,i){return we.resolve()}updateIndexEntries(e,t){return we.resolve()}}class J3{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new Tr(Gt.comparator),o=!s.has(i);return this.index[t]=s.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new Tr(Gt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},X2=41943040;class yn{static withCacheSize(e){return new yn(e,yn.DEFAULT_COLLECTION_PERCENTILE,yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yn.DEFAULT_COLLECTION_PERCENTILE=10,yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yn.DEFAULT=new yn(X2,yn.DEFAULT_COLLECTION_PERCENTILE,yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yn.DISABLED=new yn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new wo(0)}static ur(){return new wo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dx="LruGarbageCollector",eR=1048576;function Nx([r,e],[t,i]){const s=st(r,t);return s===0?st(e,i):s}class tR{constructor(e){this.Tr=e,this.buffer=new Tr(Nx),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Nx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class rR{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){ze(Dx,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Oo(t)?ze(Dx,"Ignoring IndexedDB error during garbage collection: ",t):await No(t)}await this.Rr(3e5)})}}class nR{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return we.resolve(K0.ue);const i=new tR(t);return this.Vr.forEachTarget(e,s=>i.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>i.Er(s))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ze("LruGarbageCollector","Garbage collection skipped; disabled"),we.resolve(bx)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bx):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let i,s,o,u,h,g,m;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(x=>(x>this.params.maximumSequenceNumbersToCollect?(ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),s=this.params.maximumSequenceNumbersToCollect):s=x,u=Date.now(),this.nthSequenceNumber(e,s))).next(x=>(i=x,h=Date.now(),this.removeTargets(e,i,t))).next(x=>(o=x,g=Date.now(),this.removeOrphanedDocuments(e,i))).next(x=>(m=Date.now(),uo()<=xt.DEBUG&&ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-v}ms
	Determined least recently used ${s} in `+(h-u)+`ms
	Removed ${o} targets in `+(g-h)+`ms
	Removed ${x} documents in `+(m-g)+`ms
Total Duration: ${m-v}ms`),we.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:x})))}}function iR(r,e){return new nR(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(){this.changes=new fl(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Zr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?we.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(i=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(i!==null&&Qu(i.mutation,s,Vn.empty(),qt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ht()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ht()){const s=el();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,i).next(o=>{let u=Uu();return o.forEach((h,g)=>{u=u.insert(h,g.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const i=el();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ht()))}populateOverlays(e,t,i){const s=[];return i.forEach(o=>{t.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((u,h)=>{t.set(u,h)})})}computeViews(e,t,i,s){let o=Ta();const u=Wu(),h=function(){return Wu()}();return t.forEach((g,m)=>{const v=i.get(m.key);s.has(m.key)&&(v===void 0||v.mutation instanceof ys)?o=o.insert(m.key,m):v!==void 0?(u.set(m.key,v.mutation.getFieldMask()),Qu(v.mutation,m,v.mutation.getFieldMask(),qt.now())):u.set(m.key,Vn.empty())}),this.recalculateAndSaveOverlays(e,o).next(g=>(g.forEach((m,v)=>u.set(m,v)),t.forEach((m,v)=>{var x;return h.set(m,new sR(v,(x=u.get(m))!==null&&x!==void 0?x:null))}),h))}recalculateAndSaveOverlays(e,t){const i=Wu();let s=new $t((u,h)=>u-h),o=ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const h of u)h.keys().forEach(g=>{const m=t.get(g);if(m===null)return;let v=i.get(g)||Vn.empty();v=h.applyToLocalView(m,v),i.set(g,v);const x=(s.get(h.batchId)||ht()).add(g);s=s.insert(h.batchId,x)})}).next(()=>{const u=[],h=s.getReverseIterator();for(;h.hasNext();){const g=h.getNext(),m=g.key,v=g.value,x=b2();v.forEach(y=>{if(!o.has(y)){const T=M2(t.get(y),i.get(y));T!==null&&x.set(y,T),o=o.add(y)}}),u.push(this.documentOverlayCache.saveOverlays(e,m,x))}return we.waitFor(u)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,s){return function(u){return Ye.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):A2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next(o=>{const u=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-o.size):we.resolve(el());let h=ac,g=o;return u.next(m=>we.forEach(m,(v,x)=>(h<x.largestBatchId&&(h=x.largestBatchId),o.get(v)?we.resolve():this.remoteDocumentCache.getEntry(e,v).next(y=>{g=g.insert(v,y)}))).next(()=>this.populateOverlays(e,m,o)).next(()=>this.computeViews(e,g,m,ht())).next(v=>({batchId:h,changes:C2(v)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ye(t)).next(i=>{let s=Uu();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const o=t.collectionGroup;let u=Uu();return this.indexManager.getCollectionParents(e,o).next(h=>we.forEach(h,g=>{const m=function(x,y){return new Io(y,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)}(t,g.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,i,s).next(v=>{v.forEach((x,y)=>{u=u.insert(x,y)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,t,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,s))).next(u=>{o.forEach((g,m)=>{const v=m.getKey();u.get(v)===null&&(u=u.insert(v,Zr.newInvalidDocument(v)))});let h=Uu();return u.forEach((g,m)=>{const v=o.get(g);v!==void 0&&Qu(v.mutation,m,Vn.empty(),qt.now()),Z0(t,m)&&(h=h.insert(g,m))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return we.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Hi(s.createTime)}}(t)),we.resolve()}getNamedQuery(e,t){return we.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(s){return{name:s.name,query:$3(s.bundledQuery),readTime:Hi(s.readTime)}}(t)),we.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(){this.overlays=new $t(Ye.comparator),this.kr=new Map}getOverlay(e,t){return we.resolve(this.overlays.get(t))}getOverlays(e,t){const i=el();return we.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((s,o)=>{this.wt(e,t,o)}),we.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.kr.get(i);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(i)),we.resolve()}getOverlaysForCollection(e,t,i){const s=el(),o=t.length+1,u=new Ye(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const g=h.getNext().value,m=g.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===o&&g.largestBatchId>i&&s.set(g.getKey(),g)}return we.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let o=new $t((m,v)=>m-v);const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let v=o.get(m.largestBatchId);v===null&&(v=el(),o=o.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}const h=el(),g=o.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach((m,v)=>h.set(m,v)),!(h.size()>=s)););return we.resolve(h)}wt(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const u=this.kr.get(s.largestBatchId).delete(i.key);this.kr.set(s.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new b3(t,i));let o=this.kr.get(t);o===void 0&&(o=ht(),this.kr.set(t,o)),this.kr.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(){this.sessionToken=Gr.EMPTY_BYTE_STRING}getSessionToken(e){return we.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,we.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(){this.qr=new Tr(Dr.Qr),this.$r=new Tr(Dr.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const i=new Dr(e,t);this.qr=this.qr.add(i),this.$r=this.$r.add(i)}Kr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new Dr(e,t))}Gr(e,t){e.forEach(i=>this.removeReference(i,t))}zr(e){const t=new Ye(new Gt([])),i=new Dr(t,e),s=new Dr(t,e+1),o=[];return this.$r.forEachInRange([i,s],u=>{this.Wr(u),o.push(u.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Ye(new Gt([])),i=new Dr(t,e),s=new Dr(t,e+1);let o=ht();return this.$r.forEachInRange([i,s],u=>{o=o.add(u.key)}),o}containsKey(e){const t=new Dr(e,0),i=this.qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Dr{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Ye.comparator(e.key,t.key)||st(e.Hr,t.Hr)}static Ur(e,t){return st(e.Hr,t.Hr)||Ye.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Tr(Dr.Qr)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new C3(o,t,i,s);this.mutationQueue.push(u);for(const h of s)this.Yr=this.Yr.add(new Dr(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return we.resolve(u)}lookupMutationBatch(e,t){return we.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.Xr(i),o=s<0?0:s;return we.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?pm:this.er-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Dr(t,0),s=new Dr(t,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([i,s],u=>{const h=this.Zr(u.Hr);o.push(h)}),we.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Tr(st);return t.forEach(s=>{const o=new Dr(s,0),u=new Dr(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,u],h=>{i=i.add(h.Hr)})}),we.resolve(this.ei(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let o=i;Ye.isDocumentKey(o)||(o=o.child(""));const u=new Dr(new Ye(o),0);let h=new Tr(st);return this.Yr.forEachWhile(g=>{const m=g.key.path;return!!i.isPrefixOf(m)&&(m.length===s&&(h=h.add(g.Hr)),!0)},u),we.resolve(this.ei(h))}ei(e){const t=[];return e.forEach(i=>{const s=this.Zr(i);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Ct(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Yr;return we.forEach(t.mutations,s=>{const o=new Dr(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=i})}rr(e){}containsKey(e,t){const i=new Dr(t,0),s=this.Yr.firstAfterOrEqual(i);return we.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e){this.ni=e,this.docs=function(){return new $t(Ye.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),o=s?s.size:0,u=this.ni(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return we.resolve(i?i.document.mutableCopy():Zr.newInvalidDocument(t))}getEntries(e,t){let i=Ta();return t.forEach(s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():Zr.newInvalidDocument(s))}),we.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let o=Ta();const u=t.path,h=new Ye(u.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(h);for(;g.hasNext();){const{key:m,value:{document:v}}=g.getNext();if(!u.isPrefixOf(m.path))break;m.path.length>u.length+1||zw(jw(v),i)<=0||(s.has(v.key)||Z0(t,v))&&(o=o.insert(v.key,v.mutableCopy()))}return we.resolve(o)}getAllFromCollectionGroup(e,t,i,s){Qe(9500)}ri(e,t){return we.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new dR(this)}getSize(e){return we.resolve(this.size)}}class dR extends aR{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?t.push(this.Or.addEntry(e,s)):this.Or.removeEntry(i)}),we.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e){this.persistence=e,this.ii=new fl(t=>xm(t),ym),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this.si=0,this.oi=new Cm,this.targetCount=0,this._i=wo.ar()}forEachTarget(e,t){return this.ii.forEach((i,s)=>t(s)),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.si&&(this.si=t),we.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new wo(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,we.resolve()}updateTargetData(e,t){return this.hr(t),we.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,t,i){let s=0;const o=[];return this.ii.forEach((u,h)=>{h.sequenceNumber<=t&&i.get(h.targetId)===null&&(this.ii.delete(u),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)}),we.waitFor(o).next(()=>s)}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,t){const i=this.ii.get(t)||null;return we.resolve(i)}addMatchingKeys(e,t,i){return this.oi.Kr(t,i),we.resolve()}removeMatchingKeys(e,t,i){this.oi.Gr(t,i);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach(u=>{o.push(s.markPotentiallyOrphaned(e,u))}),we.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),we.resolve()}getMatchingKeysForTargetId(e,t){const i=this.oi.Jr(t);return we.resolve(i)}containsKey(e,t){return we.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,t){this.ai={},this.overlays={},this.ui=new K0(0),this.ci=!1,this.ci=!0,this.li=new cR,this.referenceDelegate=e(this),this.hi=new mR(this),this.indexManager=new Z3,this.remoteDocumentCache=function(s){return new hR(s)}(i=>this.referenceDelegate.Pi(i)),this.serializer=new Q3(t),this.Ti=new oR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uR,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ai[e.toKey()];return i||(i=new fR(t,this.referenceDelegate),this.ai[e.toKey()]=i),i}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,i){ze("MemoryPersistence","Starting transaction:",e);const s=new gR(this.ui.next());return this.referenceDelegate.Ii(),i(s).next(o=>this.referenceDelegate.di(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Ei(e,t){return we.or(Object.values(this.ai).map(i=>()=>i.containsKey(e,t)))}}class gR extends Gw{constructor(e){super(),this.currentSequenceNumber=e}}class bm{constructor(e){this.persistence=e,this.Ai=new Cm,this.Ri=null}static Vi(e){return new bm(e)}get mi(){if(this.Ri)return this.Ri;throw Qe(60996)}addReference(e,t,i){return this.Ai.addReference(i,t),this.mi.delete(i.toString()),we.resolve()}removeReference(e,t,i){return this.Ai.removeReference(i,t),this.mi.add(i.toString()),we.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),we.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(s=>this.mi.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.mi.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.mi,i=>{const s=Ye.fromPath(i);return this.fi(e,s).next(o=>{o||t.removeEntry(s,Je.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(i=>{i?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return we.or([()=>we.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class b0{constructor(e,t){this.persistence=e,this.gi=new fl(i=>Yw(i.path),(i,s)=>i.isEqual(s)),this.garbageCollector=iR(this,t)}static Vi(e,t){return new b0(e,t)}Ii(){}di(e){return we.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}yr(e){let t=0;return this.gr(e,i=>{t++}).next(()=>t)}gr(e,t){return we.forEach(this.gi,(i,s)=>this.Sr(e,i,s).next(o=>o?we.resolve():t(s)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ri(e,u=>this.Sr(e,u,t).next(h=>{h||(i++,o.removeEntry(u,Je.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),we.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),we.resolve()}removeReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),we.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),we.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=h0(e.data.value)),t}Sr(e,t,i){return we.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.gi.get(t);return we.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.Is=i,this.ds=s}static Es(e,t){let i=ht(),s=ht();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new Dm(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return hS()?8:qw(cS())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,i,s){const o={result:null};return this.ps(e,t).next(u=>{o.result=u}).next(()=>{if(!o.result)return this.ys(e,t,s,i).next(u=>{o.result=u})}).next(()=>{if(o.result)return;const u=new pR;return this.ws(e,t,u).next(h=>{if(o.result=h,this.Rs)return this.Ss(e,t,u,h.size)})}).next(()=>o.result)}Ss(e,t,i,s){return i.documentReadCount<this.Vs?(uo()<=xt.DEBUG&&ze("QueryEngine","SDK will not create cache indexes for query:",co(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),we.resolve()):(uo()<=xt.DEBUG&&ze("QueryEngine","Query:",co(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.fs*s?(uo()<=xt.DEBUG&&ze("QueryEngine","The SDK decides to create cache indexes for query:",co(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zi(t))):we.resolve())}ps(e,t){if(_x(t))return we.resolve(null);let i=zi(t);return this.indexManager.getIndexType(e,i).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=K1(t,null,"F"),i=zi(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{const u=ht(...o);return this.gs.getDocuments(e,u).next(h=>this.indexManager.getMinOffset(e,i).next(g=>{const m=this.bs(t,h);return this.Ds(t,m,u,g.readTime)?this.ps(e,K1(t,null,"F")):this.vs(e,m,t,g)}))})))}ys(e,t,i,s){return _x(t)||s.isEqual(Je.min())?we.resolve(null):this.gs.getDocuments(e,i).next(o=>{const u=this.bs(t,o);return this.Ds(t,u,i,s)?we.resolve(null):(uo()<=xt.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),co(t)),this.vs(e,u,t,Uw(s,ac)).next(h=>h))})}bs(e,t){let i=new Tr(w2(e));return t.forEach((s,o)=>{Z0(e,o)&&(i=i.add(o))}),i}Ds(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}ws(e,t,i){return uo()<=xt.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",co(t)),this.gs.getDocumentsMatchingQuery(e,t,cs.min(),i)}vs(e,t,i,s){return this.gs.getDocumentsMatchingQuery(e,i,s).next(o=>(t.forEach(u=>{o=o.insert(u.key,u)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nm="LocalStore",_R=3e8;class xR{constructor(e,t,i,s){this.persistence=e,this.Cs=t,this.serializer=s,this.Fs=new $t(st),this.Ms=new fl(o=>xm(o),ym),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(i)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lR(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function yR(r,e,t,i){return new xR(r,e,t,i)}async function K2(r,e){const t=et(r);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,t.Ns(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{const u=[],h=[];let g=ht();for(const m of s){u.push(m.batchId);for(const v of m.mutations)g=g.add(v.key)}for(const m of o){h.push(m.batchId);for(const v of m.mutations)g=g.add(v.key)}return t.localDocuments.getDocuments(i,g).next(m=>({Bs:m,removedBatchIds:u,addedBatchIds:h}))})})}function ER(r,e){const t=et(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const s=e.batch.keys(),o=t.Os.newChangeBuffer({trackRemovals:!0});return function(h,g,m,v){const x=m.batch,y=x.keys();let T=we.resolve();return y.forEach(b=>{T=T.next(()=>v.getEntry(g,b)).next(S=>{const w=m.docVersions.get(b);Ct(w!==null,48541),S.version.compareTo(w)<0&&(x.applyToRemoteDocument(S,m),S.isValidDocument()&&(S.setReadTime(m.commitVersion),v.addEntry(S)))})}),T.next(()=>h.mutationQueue.removeMutationBatch(g,x))}(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(h){let g=ht();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(g=g.add(h.batch.mutations[m].key));return g}(e))).next(()=>t.localDocuments.getDocuments(i,s))})}function W2(r){const e=et(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function TR(r,e){const t=et(r),i=e.snapshotVersion;let s=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const u=t.Os.newChangeBuffer({trackRemovals:!0});s=t.Fs;const h=[];e.targetChanges.forEach((v,x)=>{const y=s.get(x);if(!y)return;h.push(t.hi.removeMatchingKeys(o,v.removedDocuments,x).next(()=>t.hi.addMatchingKeys(o,v.addedDocuments,x)));let T=y.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(x)!==null?T=T.withResumeToken(Gr.EMPTY_BYTE_STRING,Je.min()).withLastLimboFreeSnapshotVersion(Je.min()):v.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(v.resumeToken,i)),s=s.insert(x,T),function(S,w,G){return S.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=_R?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0}(y,T,v)&&h.push(t.hi.updateTargetData(o,T))});let g=Ta(),m=ht();if(e.documentUpdates.forEach(v=>{e.resolvedLimboDocuments.has(v)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,v))}),h.push(AR(o,u,e.documentUpdates).next(v=>{g=v.Ls,m=v.ks})),!i.isEqual(Je.min())){const v=t.hi.getLastRemoteSnapshotVersion(o).next(x=>t.hi.setTargetsMetadata(o,o.currentSequenceNumber,i));h.push(v)}return we.waitFor(h).next(()=>u.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,g,m)).next(()=>g)}).then(o=>(t.Fs=s,o))}function AR(r,e,t){let i=ht(),s=ht();return t.forEach(o=>i=i.add(o)),e.getEntries(r,i).next(o=>{let u=Ta();return t.forEach((h,g)=>{const m=o.get(h);g.isFoundDocument()!==m.isFoundDocument()&&(s=s.add(h)),g.isNoDocument()&&g.version.isEqual(Je.min())?(e.removeEntry(h,g.readTime),u=u.insert(h,g)):!m.isValidDocument()||g.version.compareTo(m.version)>0||g.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(g),u=u.insert(h,g)):ze(Nm,"Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",g.version)}),{Ls:u,ks:s}})}function SR(r,e){const t=et(r);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=pm),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function wR(r,e){const t=et(r);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return t.hi.getTargetData(i,e).next(o=>o?(s=o,we.resolve(s)):t.hi.allocateTargetId(i).next(u=>(s=new ts(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.hi.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=t.Fs.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(i.targetId,i),t.Ms.set(e,i.targetId)),i})}async function J1(r,e,t){const i=et(r),s=i.Fs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,u=>i.persistence.referenceDelegate.removeTarget(u,s))}catch(u){if(!Oo(u))throw u;ze(Nm,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Fs=i.Fs.remove(e),i.Ms.delete(s.target)}function Ox(r,e,t){const i=et(r);let s=Je.min(),o=ht();return i.persistence.runTransaction("Execute query","readwrite",u=>function(g,m,v){const x=et(g),y=x.Ms.get(v);return y!==void 0?we.resolve(x.Fs.get(y)):x.hi.getTargetData(m,v)}(i,u,zi(e)).next(h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,i.hi.getMatchingKeysForTargetId(u,h.targetId).next(g=>{o=g})}).next(()=>i.Cs.getDocumentsMatchingQuery(u,e,t?s:Je.min(),t?o:ht())).next(h=>(RR(i,h3(e),h),{documents:h,qs:o})))}function RR(r,e,t){let i=r.xs.get(e)||Je.min();t.forEach((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),r.xs.set(e,i)}class Ix{constructor(){this.activeTargetIds=_3()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class CR{constructor(){this.Fo=new Ix,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,i){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Ix,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx="ConnectivityMonitor";class Mx{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ze(kx,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ze(kx,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jf=null;function em(){return Jf===null?Jf=function(){return 268435456+Math.round(2147483648*Math.random())}():Jf++,"0x"+Jf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A1="RestConnection",DR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class NR{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${i}/databases/${s}`,this.Ko=this.databaseId.database===T0?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Wo(e,t,i,s,o){const u=em(),h=this.Go(e,t.toUriEncodedString());ze(A1,`Sending RPC '${e}' ${u}:`,h,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(g,s,o);const{host:m}=new URL(h),v=hm(m);return this.jo(e,h,g,i,v).then(x=>(ze(A1,`Received RPC '${e}' ${u}: `,x),x),x=>{throw us(A1,`RPC '${e}' ${u} failed with error: `,x,"url: ",h,"request:",i),x})}Jo(e,t,i,s,o,u){return this.Wo(e,t,i,s,o)}zo(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Do}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,o)=>e[o]=s),i&&i.headers.forEach((s,o)=>e[o]=s)}Go(e,t){const i=DR[e];return`${this.$o}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr="WebChannelConnection";class IR extends NR{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,i,s,o){const u=em();return new Promise((h,g)=>{const m=new $y;m.setWithCredentials(!0),m.listenOnce(Zy.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case f0.NO_ERROR:const x=m.getResponseJson();ze(Qr,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(x)),h(x);break;case f0.TIMEOUT:ze(Qr,`RPC '${e}' ${u} timed out`),g(new je(Ae.DEADLINE_EXCEEDED,"Request time out"));break;case f0.HTTP_ERROR:const y=m.getStatus();if(ze(Qr,`RPC '${e}' ${u} failed with status:`,y,"response text:",m.getResponseText()),y>0){let T=m.getResponseJson();Array.isArray(T)&&(T=T[0]);const b=T==null?void 0:T.error;if(b&&b.status&&b.message){const S=function(G){const Z=G.toLowerCase().replace(/_/g,"-");return Object.values(Ae).indexOf(Z)>=0?Z:Ae.UNKNOWN}(b.status);g(new je(S,b.message))}else g(new je(Ae.UNKNOWN,"Server responded with status "+m.getStatus()))}else g(new je(Ae.UNAVAILABLE,"Connection failed."));break;default:Qe(9055,{c_:e,streamId:u,l_:m.getLastErrorCode(),h_:m.getLastError()})}}finally{ze(Qr,`RPC '${e}' ${u} completed.`)}});const v=JSON.stringify(s);ze(Qr,`RPC '${e}' ${u} sending request:`,s),m.send(t,"POST",v,i,15)})}P_(e,t,i){const s=em(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=t2(),h=e2(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(g.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(g.useFetchStreams=!0),this.zo(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const v=o.join("");ze(Qr,`Creating RPC '${e}' stream ${s}: ${v}`,g);const x=u.createWebChannel(v,g);this.T_(x);let y=!1,T=!1;const b=new OR({Ho:w=>{T?ze(Qr,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(y||(ze(Qr,`Opening RPC '${e}' stream ${s} transport.`),x.open(),y=!0),ze(Qr,`RPC '${e}' stream ${s} sending:`,w),x.send(w))},Yo:()=>x.close()}),S=(w,G,Z)=>{w.listen(G,K=>{try{Z(K)}catch(ne){setTimeout(()=>{throw ne},0)}})};return S(x,Bu.EventType.OPEN,()=>{T||(ze(Qr,`RPC '${e}' stream ${s} transport opened.`),b.s_())}),S(x,Bu.EventType.CLOSE,()=>{T||(T=!0,ze(Qr,`RPC '${e}' stream ${s} transport closed`),b.__(),this.I_(x))}),S(x,Bu.EventType.ERROR,w=>{T||(T=!0,us(Qr,`RPC '${e}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),b.__(new je(Ae.UNAVAILABLE,"The operation could not be completed")))}),S(x,Bu.EventType.MESSAGE,w=>{var G;if(!T){const Z=w.data[0];Ct(!!Z,16349);const K=Z,ne=(K==null?void 0:K.error)||((G=K[0])===null||G===void 0?void 0:G.error);if(ne){ze(Qr,`RPC '${e}' stream ${s} received error:`,ne);const pe=ne.status;let Re=function(R){const k=fr[R];if(k!==void 0)return P2(k)}(pe),N=ne.message;Re===void 0&&(Re=Ae.INTERNAL,N="Unknown error status: "+pe+" with message "+ne.message),T=!0,b.__(new je(Re,N)),x.close()}else ze(Qr,`RPC '${e}' stream ${s} received:`,Z),b.a_(Z)}}),S(h,Jy.STAT_EVENT,w=>{w.stat===j1.PROXY?ze(Qr,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===j1.NOPROXY&&ze(Qr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{b.o_()},0),b}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function S1(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(r){return new P3(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e,t,i=1e3,s=1.5,o=6e4){this.Fi=e,this.timerId=t,this.d_=i,this.E_=s,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),i=Math.max(0,Date.now()-this.m_),s=Math.max(0,t-i);s>0&&ze("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="PersistentStream";class $2{constructor(e,t,i,s,o,u,h,g){this.Fi=e,this.w_=i,this.S_=s,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=g,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Q2(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===Ae.RESOURCE_EXHAUSTED?(Ea(t.toString()),Ea("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===Ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.b_===t&&this.W_(i,s)},i=>{e(()=>{const s=new je(Ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.G_(s)})})}W_(e,t){const i=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.e_(()=>{i(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{i(()=>this.G_(s))}),this.stream.onMessage(s=>{i(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return ze(Fx,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(ze(Fx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kR extends $2{constructor(e,t,i,s,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,u),this.serializer=o}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=B3(this.serializer,e),i=function(o){if(!("targetChange"in o))return Je.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?Je.min():u.readTime?Hi(u.readTime):Je.min()}(e);return this.listener.J_(t,i)}H_(e){const t={};t.database=Z1(this.serializer),t.addTarget=function(o,u){let h;const g=u.target;if(h=X1(g)?{documents:z3(o,g)}:{query:H3(o,g).Vt},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=B2(o,u.resumeToken);const m=W1(o,u.expectedCount);m!==null&&(h.expectedCount=m)}else if(u.snapshotVersion.compareTo(Je.min())>0){h.readTime=C0(o,u.snapshotVersion.toTimestamp());const m=W1(o,u.expectedCount);m!==null&&(h.expectedCount=m)}return h}(this.serializer,e);const i=q3(this.serializer,e);i&&(t.labels=i),this.k_(t)}Y_(e){const t={};t.database=Z1(this.serializer),t.removeTarget=e,this.k_(t)}}class MR extends $2{constructor(e,t,i,s,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,u),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Ct(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ct(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Ct(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=j3(e.writeResults,e.commitTime),i=Hi(e.commitTime);return this.listener.ta(i,t)}na(){const e={};e.database=Z1(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>U3(this.serializer,i))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{}class PR extends FR{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new je(Ae.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Wo(e,Q1(t,i),s,o,u)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new je(Ae.UNKNOWN,o.toString())})}Jo(e,t,i,s,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,h])=>this.connection.Jo(e,Q1(t,i),s,u,h,o)).catch(u=>{throw u.name==="FirebaseError"?(u.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new je(Ae.UNKNOWN,u.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class LR{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Ea(t),this._a=!1):ze("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl="RemoteStore";class VR{constructor(e,t,i,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(u=>{i.enqueueAndForget(async()=>{hl(this)&&(ze(sl,"Restarting streams for network reachability change."),await async function(g){const m=et(g);m.Ia.add(4),await Tc(m),m.Aa.set("Unknown"),m.Ia.delete(4),await nh(m)}(this))})}),this.Aa=new LR(i,s)}}async function nh(r){if(hl(r))for(const e of r.da)await e(!0)}async function Tc(r){for(const e of r.da)await e(!1)}function Z2(r,e){const t=et(r);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Mm(t)?km(t):ko(t).x_()&&Im(t,e))}function Om(r,e){const t=et(r),i=ko(t);t.Ta.delete(e),i.x_()&&J2(t,e),t.Ta.size===0&&(i.x_()?i.B_():hl(t)&&t.Aa.set("Unknown"))}function Im(r,e){if(r.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Je.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ko(r).H_(e)}function J2(r,e){r.Ra.$e(e),ko(r).Y_(e)}function km(r){r.Ra=new I3({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>r.Ta.get(e)||null,lt:()=>r.datastore.serializer.databaseId}),ko(r).start(),r.Aa.aa()}function Mm(r){return hl(r)&&!ko(r).M_()&&r.Ta.size>0}function hl(r){return et(r).Ia.size===0}function eE(r){r.Ra=void 0}async function BR(r){r.Aa.set("Online")}async function UR(r){r.Ta.forEach((e,t)=>{Im(r,e)})}async function jR(r,e){eE(r),Mm(r)?(r.Aa.la(e),km(r)):r.Aa.set("Unknown")}async function zR(r,e,t){if(r.Aa.set("Online"),e instanceof V2&&e.state===2&&e.cause)try{await async function(s,o){const u=o.cause;for(const h of o.targetIds)s.Ta.has(h)&&(await s.remoteSyncer.rejectListen(h,u),s.Ta.delete(h),s.Ra.removeTarget(h))}(r,e)}catch(i){ze(sl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await D0(r,i)}else if(e instanceof g0?r.Ra.Ye(e):e instanceof L2?r.Ra.it(e):r.Ra.et(e),!t.isEqual(Je.min()))try{const i=await W2(r.localStore);t.compareTo(i)>=0&&await function(o,u){const h=o.Ra.Pt(u);return h.targetChanges.forEach((g,m)=>{if(g.resumeToken.approximateByteSize()>0){const v=o.Ta.get(m);v&&o.Ta.set(m,v.withResumeToken(g.resumeToken,u))}}),h.targetMismatches.forEach((g,m)=>{const v=o.Ta.get(g);if(!v)return;o.Ta.set(g,v.withResumeToken(Gr.EMPTY_BYTE_STRING,v.snapshotVersion)),J2(o,g);const x=new ts(v.target,g,m,v.sequenceNumber);Im(o,x)}),o.remoteSyncer.applyRemoteEvent(h)}(r,t)}catch(i){ze(sl,"Failed to raise snapshot:",i),await D0(r,i)}}async function D0(r,e,t){if(!Oo(e))throw e;r.Ia.add(1),await Tc(r),r.Aa.set("Offline"),t||(t=()=>W2(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{ze(sl,"Retrying IndexedDB access"),await t(),r.Ia.delete(1),await nh(r)})}function tE(r,e){return e().catch(t=>D0(r,t,e))}async function ih(r){const e=et(r),t=ms(e);let i=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:pm;for(;HR(e);)try{const s=await SR(e.localStore,i);if(s===null){e.Pa.length===0&&t.B_();break}i=s.batchId,GR(e,s)}catch(s){await D0(e,s)}rE(e)&&nE(e)}function HR(r){return hl(r)&&r.Pa.length<10}function GR(r,e){r.Pa.push(e);const t=ms(r);t.x_()&&t.Z_&&t.X_(e.mutations)}function rE(r){return hl(r)&&!ms(r).M_()&&r.Pa.length>0}function nE(r){ms(r).start()}async function qR(r){ms(r).na()}async function XR(r){const e=ms(r);for(const t of r.Pa)e.X_(t.mutations)}async function YR(r,e,t){const i=r.Pa.shift(),s=Sm.from(i,e,t);await tE(r,()=>r.remoteSyncer.applySuccessfulWrite(s)),await ih(r)}async function KR(r,e){e&&ms(r).Z_&&await async function(i,s){if(function(u){return N3(u)&&u!==Ae.ABORTED}(s.code)){const o=i.Pa.shift();ms(i).N_(),await tE(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),await ih(i)}}(r,e),rE(r)&&nE(r)}async function Px(r,e){const t=et(r);t.asyncQueue.verifyOperationInProgress(),ze(sl,"RemoteStore received new credentials");const i=hl(t);t.Ia.add(3),await Tc(t),i&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await nh(t)}async function WR(r,e){const t=et(r);e?(t.Ia.delete(2),await nh(t)):e||(t.Ia.add(2),await Tc(t),t.Aa.set("Unknown"))}function ko(r){return r.Va||(r.Va=function(t,i,s){const o=et(t);return o.ia(),new kR(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(r.datastore,r.asyncQueue,{Zo:BR.bind(null,r),e_:UR.bind(null,r),n_:jR.bind(null,r),J_:zR.bind(null,r)}),r.da.push(async e=>{e?(r.Va.N_(),Mm(r)?km(r):r.Aa.set("Unknown")):(await r.Va.stop(),eE(r))})),r.Va}function ms(r){return r.ma||(r.ma=function(t,i,s){const o=et(t);return o.ia(),new MR(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(r.datastore,r.asyncQueue,{Zo:()=>Promise.resolve(),e_:qR.bind(null,r),n_:KR.bind(null,r),ea:XR.bind(null,r),ta:YR.bind(null,r)}),r.da.push(async e=>{e?(r.ma.N_(),await ih(r)):(await r.ma.stop(),r.Pa.length>0&&(ze(sl,`Stopping write stream with ${r.Pa.length} pending writes`),r.Pa=[]))})),r.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e,t,i,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new ls,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,o){const u=Date.now()+i,h=new Fm(e,t,u,s,o);return h.start(i),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new je(Ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pm(r,e){if(Ea("AsyncQueue",`${e}: ${r}`),Oo(r))return new je(Ae.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{static emptySet(e){return new vo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ye.comparator(t.key,i.key):(t,i)=>Ye.comparator(t.key,i.key),this.keyedMap=Uu(),this.sortedSet=new $t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof vo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new vo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(){this.fa=new $t(Ye.comparator)}track(e){const t=e.doc.key,i=this.fa.get(t);i?e.type!==0&&i.type===3?this.fa=this.fa.insert(t,e):e.type===3&&i.type!==1?this.fa=this.fa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.fa=this.fa.remove(t):e.type===1&&i.type===2?this.fa=this.fa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Qe(63341,{At:e,ga:i}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,i)=>{e.push(i)}),e}}class Ro{constructor(e,t,i,s,o,u,h,g,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=g,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,s,o){const u=[];return t.forEach(h=>{u.push({type:0,doc:h})}),new Ro(e,t,vo.emptySet(t),u,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class $R{constructor(){this.queries=Vx(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,i){const s=et(t),o=s.queries;s.queries=Vx(),o.forEach((u,h)=>{for(const g of h.wa)g.onError(i)})})(this,new je(Ae.ABORTED,"Firestore shutting down"))}}function Vx(){return new fl(r=>S2(r),$0)}async function iE(r,e){const t=et(r);let i=3;const s=e.query;let o=t.queries.get(s);o?!o.Sa()&&e.ba()&&(i=2):(o=new QR,i=e.ba()?0:1);try{switch(i){case 0:o.ya=await t.onListen(s,!0);break;case 1:o.ya=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(u){const h=Pm(u,`Initialization of query '${co(e.query)}' failed`);return void e.onError(h)}t.queries.set(s,o),o.wa.push(e),e.va(t.onlineState),o.ya&&e.Ca(o.ya)&&Lm(t)}async function aE(r,e){const t=et(r),i=e.query;let s=3;const o=t.queries.get(i);if(o){const u=o.wa.indexOf(e);u>=0&&(o.wa.splice(u,1),o.wa.length===0?s=e.ba()?0:1:!o.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function ZR(r,e){const t=et(r);let i=!1;for(const s of e){const o=s.query,u=t.queries.get(o);if(u){for(const h of u.wa)h.Ca(s)&&(i=!0);u.ya=s}}i&&Lm(t)}function JR(r,e,t){const i=et(r),s=i.queries.get(e);if(s)for(const o of s.wa)o.onError(t);i.queries.delete(e)}function Lm(r){r.Da.forEach(e=>{e.next()})}var tm,Bx;(Bx=tm||(tm={})).Fa="default",Bx.Cache="cache";class sE{constructor(e,t,i){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=i||{}}Ca(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new Ro(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const i=t!=="Offline";return(!this.options.ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Ro.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==tm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(e){this.key=e}}class oE{constructor(e){this.key=e}}class eC{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ht(),this.mutatedKeys=ht(),this.Xa=w2(e),this.eu=new vo(this.Xa)}get tu(){return this.Ha}nu(e,t){const i=t?t.ru:new Lx,s=t?t.eu:this.eu;let o=t?t.mutatedKeys:this.mutatedKeys,u=s,h=!1;const g=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,m=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((v,x)=>{const y=s.get(v),T=Z0(this.query,x)?x:null,b=!!y&&this.mutatedKeys.has(y.key),S=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let w=!1;y&&T?y.data.isEqual(T.data)?b!==S&&(i.track({type:3,doc:T}),w=!0):this.iu(y,T)||(i.track({type:2,doc:T}),w=!0,(g&&this.Xa(T,g)>0||m&&this.Xa(T,m)<0)&&(h=!0)):!y&&T?(i.track({type:0,doc:T}),w=!0):y&&!T&&(i.track({type:1,doc:y}),w=!0,(g||m)&&(h=!0)),w&&(T?(u=u.add(T),o=S?o.add(v):o.delete(v)):(u=u.delete(v),o=o.delete(v)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const v=this.query.limitType==="F"?u.last():u.first();u=u.delete(v.key),o=o.delete(v.key),i.track({type:1,doc:v})}return{eu:u,ru:i,Ds:h,mutatedKeys:o}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const u=e.ru.pa();u.sort((v,x)=>function(T,b){const S=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qe(20277,{At:w})}};return S(T)-S(b)}(v.type,x.type)||this.Xa(v.doc,x.doc)),this.su(i),s=s!=null&&s;const h=t&&!s?this.ou():[],g=this.Za.size===0&&this.current&&!s?1:0,m=g!==this.Ya;return this.Ya=g,u.length!==0||m?{snapshot:new Ro(this.query,e.eu,o,u,e.mutatedKeys,g===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),_u:h}:{_u:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Lx,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ht(),this.eu.forEach(i=>{this.au(i.key)&&(this.Za=this.Za.add(i.key))});const t=[];return e.forEach(i=>{this.Za.has(i)||t.push(new oE(i))}),this.Za.forEach(i=>{e.has(i)||t.push(new lE(i))}),t}uu(e){this.Ha=e.qs,this.Za=ht();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Ro.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Vm="SyncEngine";class tC{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class rC{constructor(e){this.key=e,this.lu=!1}}class nC{constructor(e,t,i,s,o,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.hu={},this.Pu=new fl(h=>S2(h),$0),this.Tu=new Map,this.Iu=new Set,this.du=new $t(Ye.comparator),this.Eu=new Map,this.Au=new Cm,this.Ru={},this.Vu=new Map,this.mu=wo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function iC(r,e,t=!0){const i=mE(r);let s;const o=i.Pu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.cu()):s=await uE(i,e,t,!0),s}async function aC(r,e){const t=mE(r);await uE(t,e,!0,!1)}async function uE(r,e,t,i){const s=await wR(r.localStore,zi(e)),o=s.targetId,u=r.sharedClientState.addLocalQueryTarget(o,t);let h;return i&&(h=await sC(r,e,o,u==="current",s.resumeToken)),r.isPrimaryClient&&t&&Z2(r.remoteStore,s),h}async function sC(r,e,t,i,s){r.gu=(x,y,T)=>async function(S,w,G,Z){let K=w.view.nu(G);K.Ds&&(K=await Ox(S.localStore,w.query,!1).then(({documents:N})=>w.view.nu(N,K)));const ne=Z&&Z.targetChanges.get(w.targetId),pe=Z&&Z.targetMismatches.get(w.targetId)!=null,Re=w.view.applyChanges(K,S.isPrimaryClient,ne,pe);return jx(S,w.targetId,Re._u),Re.snapshot}(r,x,y,T);const o=await Ox(r.localStore,e,!0),u=new eC(e,o.qs),h=u.nu(o.documents),g=Ec.createSynthesizedTargetChangeForCurrentChange(t,i&&r.onlineState!=="Offline",s),m=u.applyChanges(h,r.isPrimaryClient,g);jx(r,t,m._u);const v=new tC(e,t,u);return r.Pu.set(e,v),r.Tu.has(t)?r.Tu.get(t).push(e):r.Tu.set(t,[e]),m.snapshot}async function lC(r,e,t){const i=et(r),s=i.Pu.get(e),o=i.Tu.get(s.targetId);if(o.length>1)return i.Tu.set(s.targetId,o.filter(u=>!$0(u,e))),void i.Pu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await J1(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),t&&Om(i.remoteStore,s.targetId),rm(i,s.targetId)}).catch(No)):(rm(i,s.targetId),await J1(i.localStore,s.targetId,!0))}async function oC(r,e){const t=et(r),i=t.Pu.get(e),s=t.Tu.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Om(t.remoteStore,i.targetId))}async function uC(r,e,t){const i=pC(r);try{const s=await function(u,h){const g=et(u),m=qt.now(),v=h.reduce((T,b)=>T.add(b.key),ht());let x,y;return g.persistence.runTransaction("Locally write mutations","readwrite",T=>{let b=Ta(),S=ht();return g.Os.getEntries(T,v).next(w=>{b=w,b.forEach((G,Z)=>{Z.isValidDocument()||(S=S.add(G))})}).next(()=>g.localDocuments.getOverlayedDocuments(T,b)).next(w=>{x=w;const G=[];for(const Z of h){const K=w3(Z,x.get(Z.key).overlayedDocument);K!=null&&G.push(new ys(Z.key,K,p2(K.value.mapValue),di.exists(!0)))}return g.mutationQueue.addMutationBatch(T,m,G,h)}).next(w=>{y=w;const G=w.applyToLocalDocumentSet(x,S);return g.documentOverlayCache.saveOverlays(T,w.batchId,G)})}).then(()=>({batchId:y.batchId,changes:C2(x)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),function(u,h,g){let m=u.Ru[u.currentUser.toKey()];m||(m=new $t(st)),m=m.insert(h,g),u.Ru[u.currentUser.toKey()]=m}(i,s.batchId,t),await Ac(i,s.changes),await ih(i.remoteStore)}catch(s){const o=Pm(s,"Failed to persist write");t.reject(o)}}async function cE(r,e){const t=et(r);try{const i=await TR(t.localStore,e);e.targetChanges.forEach((s,o)=>{const u=t.Eu.get(o);u&&(Ct(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?u.lu=!0:s.modifiedDocuments.size>0?Ct(u.lu,14607):s.removedDocuments.size>0&&(Ct(u.lu,42227),u.lu=!1))}),await Ac(t,i,e)}catch(i){await No(i)}}function Ux(r,e,t){const i=et(r);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.Pu.forEach((o,u)=>{const h=u.view.va(e);h.snapshot&&s.push(h.snapshot)}),function(u,h){const g=et(u);g.onlineState=h;let m=!1;g.queries.forEach((v,x)=>{for(const y of x.wa)y.va(h)&&(m=!0)}),m&&Lm(g)}(i.eventManager,e),s.length&&i.hu.J_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function cC(r,e,t){const i=et(r);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Eu.get(e),o=s&&s.key;if(o){let u=new $t(Ye.comparator);u=u.insert(o,Zr.newNoDocument(o,Je.min()));const h=ht().add(o),g=new th(Je.min(),new Map,new $t(st),u,h);await cE(i,g),i.du=i.du.remove(o),i.Eu.delete(e),Bm(i)}else await J1(i.localStore,e,!1).then(()=>rm(i,e,t)).catch(No)}async function fC(r,e){const t=et(r),i=e.batch.batchId;try{const s=await ER(t.localStore,e);hE(t,i,null),fE(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ac(t,s)}catch(s){await No(s)}}async function hC(r,e,t){const i=et(r);try{const s=await function(u,h){const g=et(u);return g.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let v;return g.mutationQueue.lookupMutationBatch(m,h).next(x=>(Ct(x!==null,37113),v=x.keys(),g.mutationQueue.removeMutationBatch(m,x))).next(()=>g.mutationQueue.performConsistencyCheck(m)).next(()=>g.documentOverlayCache.removeOverlaysForBatchId(m,v,h)).next(()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v)).next(()=>g.localDocuments.getDocuments(m,v))})}(i.localStore,e);hE(i,e,t),fE(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ac(i,s)}catch(s){await No(s)}}function fE(r,e){(r.Vu.get(e)||[]).forEach(t=>{t.resolve()}),r.Vu.delete(e)}function hE(r,e,t){const i=et(r);let s=i.Ru[i.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),i.Ru[i.currentUser.toKey()]=s}}function rm(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const i of r.Tu.get(e))r.Pu.delete(i),t&&r.hu.pu(i,t);r.Tu.delete(e),r.isPrimaryClient&&r.Au.zr(e).forEach(i=>{r.Au.containsKey(i)||dE(r,i)})}function dE(r,e){r.Iu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(Om(r.remoteStore,t),r.du=r.du.remove(e),r.Eu.delete(t),Bm(r))}function jx(r,e,t){for(const i of t)i instanceof lE?(r.Au.addReference(i.key,e),dC(r,i)):i instanceof oE?(ze(Vm,"Document no longer in limbo: "+i.key),r.Au.removeReference(i.key,e),r.Au.containsKey(i.key)||dE(r,i.key)):Qe(19791,{yu:i})}function dC(r,e){const t=e.key,i=t.path.canonicalString();r.du.get(t)||r.Iu.has(i)||(ze(Vm,"New document in limbo: "+t),r.Iu.add(i),Bm(r))}function Bm(r){for(;r.Iu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Iu.values().next().value;r.Iu.delete(e);const t=new Ye(Gt.fromString(e)),i=r.mu.next();r.Eu.set(i,new rC(t)),r.du=r.du.insert(t,i),Z2(r.remoteStore,new ts(zi(Em(t.path)),i,"TargetPurposeLimboResolution",K0.ue))}}async function Ac(r,e,t){const i=et(r),s=[],o=[],u=[];i.Pu.isEmpty()||(i.Pu.forEach((h,g)=>{u.push(i.gu(g,e,t).then(m=>{var v;if((m||t)&&i.isPrimaryClient){const x=m?!m.fromCache:(v=t==null?void 0:t.targetChanges.get(g.targetId))===null||v===void 0?void 0:v.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(m){s.push(m);const x=Dm.Es(g.targetId,m);o.push(x)}}))}),await Promise.all(u),i.hu.J_(s),await async function(g,m){const v=et(g);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",x=>we.forEach(m,y=>we.forEach(y.Is,T=>v.persistence.referenceDelegate.addReference(x,y.targetId,T)).next(()=>we.forEach(y.ds,T=>v.persistence.referenceDelegate.removeReference(x,y.targetId,T)))))}catch(x){if(!Oo(x))throw x;ze(Nm,"Failed to update sequence numbers: "+x)}for(const x of m){const y=x.targetId;if(!x.fromCache){const T=v.Fs.get(y),b=T.snapshotVersion,S=T.withLastLimboFreeSnapshotVersion(b);v.Fs=v.Fs.insert(y,S)}}}(i.localStore,o))}async function mC(r,e){const t=et(r);if(!t.currentUser.isEqual(e)){ze(Vm,"User change. New user:",e.toKey());const i=await K2(t.localStore,e);t.currentUser=e,function(o,u){o.Vu.forEach(h=>{h.forEach(g=>{g.reject(new je(Ae.CANCELLED,u))})}),o.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ac(t,i.Bs)}}function gC(r,e){const t=et(r),i=t.Eu.get(e);if(i&&i.lu)return ht().add(i.key);{let s=ht();const o=t.Tu.get(e);if(!o)return s;for(const u of o){const h=t.Pu.get(u);s=s.unionWith(h.view.tu)}return s}}function mE(r){const e=et(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=cE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cC.bind(null,e),e.hu.J_=ZR.bind(null,e.eventManager),e.hu.pu=JR.bind(null,e.eventManager),e}function pC(r){const e=et(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hC.bind(null,e),e}class N0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return yR(this.persistence,new vR,e.initialUser,this.serializer)}Du(e){return new Y2(bm.Vi,this.serializer)}bu(e){return new CR}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}N0.provider={build:()=>new N0};class vC extends N0{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Ct(this.persistence.referenceDelegate instanceof b0,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new rR(i,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?yn.withCacheSize(this.cacheSizeBytes):yn.DEFAULT;return new Y2(i=>b0.Vi(i,t),this.serializer)}}class nm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Ux(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=mC.bind(null,this.syncEngine),await WR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $R}()}createDatastore(e){const t=rh(e.databaseInfo.databaseId),i=function(o){return new IR(o)}(e.databaseInfo);return function(o,u,h,g){return new PR(o,u,h,g)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,s,o,u,h){return new VR(i,s,o,u,h)}(this.localStore,this.datastore,e.asyncQueue,t=>Ux(this.syncEngine,t,0),function(){return Mx.C()?new Mx:new bR}())}createSyncEngine(e,t){return function(s,o,u,h,g,m,v){const x=new nC(s,o,u,h,g,m);return v&&(x.fu=!0),x}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const o=et(s);ze(sl,"RemoteStore shutting down."),o.Ia.add(5),await Tc(o),o.Ea.shutdown(),o.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}nm.provider={build:()=>new nm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Ea("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs="FirestoreClient";class _C{constructor(e,t,i,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=$r.UNAUTHENTICATED,this.clientId=gm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async u=>{ze(gs,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(i,u=>(ze(gs,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ls;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Pm(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function w1(r,e){r.asyncQueue.verifyOperationInProgress(),ze(gs,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let i=t.initialUser;r.setCredentialChangeListener(async s=>{i.isEqual(s)||(await K2(e.localStore,s),i=s)}),e.persistence.setDatabaseDeletedListener(()=>{us("Terminating Firestore due to IndexedDb database deletion"),r.terminate().then(()=>{ze("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{us("Terminating Firestore due to IndexedDb database deletion failed",s)})}),r._offlineComponents=e}async function zx(r,e){r.asyncQueue.verifyOperationInProgress();const t=await xC(r);ze(gs,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(i=>Px(e.remoteStore,i)),r.setAppCheckTokenChangeListener((i,s)=>Px(e.remoteStore,s)),r._onlineComponents=e}async function xC(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){ze(gs,"Using user provided OfflineComponentProvider");try{await w1(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===Ae.FAILED_PRECONDITION||s.code===Ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;us("Error using user provided cache. Falling back to memory cache: "+t),await w1(r,new N0)}}else ze(gs,"Using default OfflineComponentProvider"),await w1(r,new vC(void 0));return r._offlineComponents}async function pE(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(ze(gs,"Using user provided OnlineComponentProvider"),await zx(r,r._uninitializedComponentsProvider._online)):(ze(gs,"Using default OnlineComponentProvider"),await zx(r,new nm))),r._onlineComponents}function yC(r){return pE(r).then(e=>e.syncEngine)}async function im(r){const e=await pE(r),t=e.eventManager;return t.onListen=iC.bind(null,e.syncEngine),t.onUnlisten=lC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=aC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=oC.bind(null,e.syncEngine),t}function EC(r,e,t={}){const i=new ls;return r.asyncQueue.enqueueAndForget(async()=>function(o,u,h,g,m){const v=new gE({next:y=>{v.Ou(),u.enqueueAndForget(()=>aE(o,x)),y.fromCache&&g.source==="server"?m.reject(new je(Ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(y)},error:y=>m.reject(y)}),x=new sE(h,v,{includeMetadataChanges:!0,ka:!0});return iE(o,x)}(await im(r),r.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vE(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hx=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _E="firestore.googleapis.com",Gx=!0;class qx{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new je(Ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_E,this.ssl=Gx}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Gx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=X2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<eR)throw new je(Ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Bw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vE((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new je(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new je(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new je(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ah{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new je(Ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new je(Ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Nw;switch(i.type){case"firstParty":return new Mw(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new je(Ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=Hx.get(t);i&&(ze("ComponentProvider","Removing Datastore"),Hx.delete(t),i.terminate())}(this),Promise.resolve()}}function TC(r,e,t,i={}){var s;r=ji(r,ah);const o=hm(e),u=r._getSettings(),h=Object.assign(Object.assign({},u),{emulatorOptions:r._getEmulatorOptions()}),g=`${e}:${t}`;o&&(aS(`https://${g}`),uS("Firestore",!0)),u.host!==_E&&u.host!==g&&us("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m=Object.assign(Object.assign({},u),{host:g,ssl:o,emulatorOptions:i});if(!_0(m,h)&&(r._setSettings(m),i.mockUserToken)){let v,x;if(typeof i.mockUserToken=="string")v=i.mockUserToken,x=$r.MOCK_USER;else{v=sS(i.mockUserToken,(s=r._app)===null||s===void 0?void 0:s.options.projectId);const y=i.mockUserToken.sub||i.mockUserToken.user_id;if(!y)throw new je(Ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new $r(y)}r._authCredentials=new Ow(new n2(v,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Es(this.firestore,e,this._query)}}class mr{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new os(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mr(this.firestore,e,this._key)}toJSON(){return{type:mr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(xc(t,mr._jsonSchema))return new mr(e,i||null,new Ye(Gt.fromString(t.referencePath)))}}mr._jsonSchemaVersion="firestore/documentReference/1.0",mr._jsonSchema={type:dr("string",mr._jsonSchemaVersion),referencePath:dr("string")};class os extends Es{constructor(e,t,i){super(e,t,Em(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mr(this.firestore,null,new Ye(e))}withConverter(e){return new os(this.firestore,e,this._path)}}function Bi(r,e,...t){if(r=Xi(r),a2("collection","path",e),r instanceof ah){const i=Gt.fromString(e,...t);return ix(i),new os(r,null,i)}{if(!(r instanceof mr||r instanceof os))throw new je(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=r._path.child(Gt.fromString(e,...t));return ix(i),new os(r.firestore,null,i)}}function tl(r,e,...t){if(r=Xi(r),arguments.length===1&&(e=gm.newId()),a2("doc","path",e),r instanceof ah){const i=Gt.fromString(e,...t);return nx(i),new mr(r,null,new Ye(i))}{if(!(r instanceof mr||r instanceof os))throw new je(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=r._path.child(Gt.fromString(e,...t));return nx(i),new mr(r.firestore,r instanceof os?r.converter:null,new Ye(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx="AsyncQueue";class Yx{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Q2(this,"async_queue_retry"),this.oc=()=>{const i=S1();i&&ze(Xx,"Visibility state changed to "+i.visibilityState),this.F_.y_()},this._c=e;const t=S1();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=S1();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new ls;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Oo(e))throw e;ze(Xx,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(i=>{throw this.tc=i,this.nc=!1,Ea("INTERNAL UNHANDLED ERROR: ",Kx(i)),i}).then(i=>(this.nc=!1,i))));return this._c=t,t}enqueueAfterDelay(e,t,i){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const s=Fm.createAndSchedule(this,e,t,i,o=>this.lc(o));return this.ec.push(s),s}ac(){this.tc&&Qe(47125,{hc:Kx(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function Kx(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(r){return function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of i)if(o in s&&typeof s[o]=="function")return!0;return!1}(r,["next","error","complete"])}class ll extends ah{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new Yx,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Yx(e),this._firestoreClient=void 0,await e}}}function Sc(r,e){const t=typeof r=="object"?r:xw(),i=typeof r=="string"?r:T0,s=mw(t,"firestore").getImmediate({identifier:i});if(!s._initialized){const o=nS("firestore");o&&TC(s,...o)}return s}function Um(r){if(r._terminated)throw new je(Ae.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||AC(r),r._firestoreClient}function AC(r){var e,t,i;const s=r._freezeSettings(),o=function(h,g,m,v){return new Qw(h,g,m,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,vE(v.experimentalLongPollingOptions),v.useFetchStreams,v.isUsingEmulator)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,s);r._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(r._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),r._firestoreClient=new _C(r._authCredentials,r._appCheckCredentials,r._queue,o,r._componentsProvider&&function(h){const g=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(g),_online:g}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ti(Gr.fromBase64String(e))}catch(t){throw new je(Ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ti(Gr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ti._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xc(e,ti._jsonSchema))return ti.fromBase64String(e.bytes)}}ti._jsonSchemaVersion="firestore/bytes/1.0",ti._jsonSchema={type:dr("string",ti._jsonSchemaVersion),bytes:dr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new je(Ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ur(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new je(Ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new je(Ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Gi._jsonSchemaVersion}}static fromJSON(e){if(xc(e,Gi._jsonSchema))return new Gi(e.latitude,e.longitude)}}Gi._jsonSchemaVersion="firestore/geoPoint/1.0",Gi._jsonSchema={type:dr("string",Gi._jsonSchemaVersion),latitude:dr("number"),longitude:dr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:qi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xc(e,qi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new qi(e.vectorValues);throw new je(Ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qi._jsonSchemaVersion="firestore/vectorValue/1.0",qi._jsonSchema={type:dr("string",qi._jsonSchemaVersion),vectorValues:dr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC=/^__.*__$/;class wC{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new ys(e,this.data,this.fieldMask,t,this.fieldTransforms):new yc(e,this.data,t,this.fieldTransforms)}}class xE{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new ys(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function yE(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Qe(40011,{Ec:r})}}class zm{constructor(e,t,i,s,o,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new zm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:i,mc:!1});return s.fc(e),s}gc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:i,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return O0(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(yE(this.Ec)&&SC.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class RC{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||rh(e)}Dc(e,t,i,s=!1){return new zm({Ec:e,methodName:t,bc:i,path:Ur.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hm(r){const e=r._freezeSettings(),t=rh(r._databaseId);return new RC(r._databaseId,!!e.ignoreUndefinedProperties,t)}function CC(r,e,t,i,s,o={}){const u=r.Dc(o.merge||o.mergeFields?2:0,e,t,s);Gm("Data must be an object, but it was:",u,i);const h=EE(i,u);let g,m;if(o.merge)g=new Vn(u.fieldMask),m=u.fieldTransforms;else if(o.mergeFields){const v=[];for(const x of o.mergeFields){const y=am(e,x,t);if(!u.contains(y))throw new je(Ae.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);AE(v,y)||v.push(y)}g=new Vn(v),m=u.fieldTransforms.filter(x=>g.covers(x.field))}else g=null,m=u.fieldTransforms;return new wC(new En(h),g,m)}class lh extends jm{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lh}}function bC(r,e,t,i){const s=r.Dc(1,e,t);Gm("Data must be an object, but it was:",s,i);const o=[],u=En.empty();xs(i,(g,m)=>{const v=qm(e,g,t);m=Xi(m);const x=s.gc(v);if(m instanceof lh)o.push(v);else{const y=wc(m,x);y!=null&&(o.push(v),u.set(v,y))}});const h=new Vn(o);return new xE(u,h,s.fieldTransforms)}function DC(r,e,t,i,s,o){const u=r.Dc(1,e,t),h=[am(e,i,t)],g=[s];if(o.length%2!=0)throw new je(Ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<o.length;y+=2)h.push(am(e,o[y])),g.push(o[y+1]);const m=[],v=En.empty();for(let y=h.length-1;y>=0;--y)if(!AE(m,h[y])){const T=h[y];let b=g[y];b=Xi(b);const S=u.gc(T);if(b instanceof lh)m.push(T);else{const w=wc(b,S);w!=null&&(m.push(T),v.set(T,w))}}const x=new Vn(m);return new xE(v,x,u.fieldTransforms)}function NC(r,e,t,i=!1){return wc(t,r.Dc(i?4:3,e))}function wc(r,e){if(TE(r=Xi(r)))return Gm("Unsupported field value:",e,r),EE(r,e);if(r instanceof jm)return function(i,s){if(!yE(s.Ec))throw s.wc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(i,s){const o=[];let u=0;for(const h of i){let g=wc(h,s.yc(u));g==null&&(g={nullValue:"NULL_VALUE"}),o.push(g),u++}return{arrayValue:{values:o}}}(r,e)}return function(i,s){if((i=Xi(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return x3(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=qt.fromDate(i);return{timestampValue:C0(s.serializer,o)}}if(i instanceof qt){const o=new qt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:C0(s.serializer,o)}}if(i instanceof Gi)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ti)return{bytesValue:B2(s.serializer,i._byteString)};if(i instanceof mr){const o=s.databaseId,u=i.firestore._databaseId;if(!u.isEqual(o))throw s.wc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Rm(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof qi)return function(u,h){return{mapValue:{fields:{[m2]:{stringValue:g2},[A0]:{arrayValue:{values:u.toArray().map(m=>{if(typeof m!="number")throw h.wc("VectorValues must only contain numeric values.");return Tm(h.serializer,m)})}}}}}}(i,s);throw s.wc(`Unsupported field value: ${Y0(i)}`)}(r,e)}function EE(r,e){const t={};return o2(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xs(r,(i,s)=>{const o=wc(s,e.Vc(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function TE(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof qt||r instanceof Gi||r instanceof ti||r instanceof mr||r instanceof jm||r instanceof qi)}function Gm(r,e,t){if(!TE(t)||!s2(t)){const i=Y0(t);throw i==="an object"?e.wc(r+" a custom object"):e.wc(r+" "+i)}}function am(r,e,t){if((e=Xi(e))instanceof sh)return e._internalPath;if(typeof e=="string")return qm(r,e);throw O0("Field path arguments must be of type string or ",r,!1,void 0,t)}const OC=new RegExp("[~\\*/\\[\\]]");function qm(r,e,t){if(e.search(OC)>=0)throw O0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new sh(...e.split("."))._internalPath}catch{throw O0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function O0(r,e,t,i,s){const o=i&&!i.isEmpty(),u=s!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let g="";return(o||u)&&(g+=" (found",o&&(g+=` in field ${i}`),u&&(g+=` in document ${s}`),g+=")"),new je(Ae.INVALID_ARGUMENT,h+r+g)}function AE(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,t,i,s,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new mr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new IC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Xm("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class IC extends SE{data(){return super.data()}}function Xm(r,e){return typeof e=="string"?qm(r,e):e instanceof sh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wE(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new je(Ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ym{}class RE extends Ym{}function e0(r,e,...t){let i=[];e instanceof Ym&&i.push(e),i=i.concat(t),function(o){const u=o.filter(g=>g instanceof Wm).length,h=o.filter(g=>g instanceof Km).length;if(u>1||u>0&&h>0)throw new je(Ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const s of i)r=s._apply(r);return r}class Km extends RE{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Km(e,t,i)}_apply(e){const t=this._parse(e);return CE(e._query,t),new Es(e.firestore,e.converter,Y1(e._query,t))}_parse(e){const t=Hm(e.firestore);return function(o,u,h,g,m,v,x){let y;if(m.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new je(Ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){$x(x,v);const b=[];for(const S of x)b.push(Qx(g,o,S));y={arrayValue:{values:b}}}else y=Qx(g,o,x)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||$x(x,v),y=NC(h,u,x,v==="in"||v==="not-in");return hr.create(m,v,y)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Wm extends Ym{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Wm(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:gi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,o){let u=s;const h=o.getFlattenedFilters();for(const g of h)CE(u,g),u=Y1(u,g)}(e._query,t),new Es(e.firestore,e.converter,Y1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Qm extends RE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Qm(e,t)}_apply(e){const t=function(s,o,u){if(s.startAt!==null)throw new je(Ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new je(Ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new uc(o,u)}(e._query,this._field,this._direction);return new Es(e.firestore,e.converter,function(s,o){const u=s.explicitOrderBy.concat([o]);return new Io(s.path,s.collectionGroup,u,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function t0(r,e="asc"){const t=e,i=Xm("orderBy",r);return Qm._create(i,t)}function Qx(r,e,t){if(typeof(t=Xi(t))=="string"){if(t==="")throw new je(Ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!A2(e)&&t.indexOf("/")!==-1)throw new je(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Gt.fromString(t));if(!Ye.isDocumentKey(i))throw new je(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return hx(r,new Ye(i))}if(t instanceof mr)return hx(r,t._key);throw new je(Ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Y0(t)}.`)}function $x(r,e){if(!Array.isArray(r)||r.length===0)throw new je(Ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function CE(r,e){const t=function(s,o){for(const u of s)for(const h of u.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null}(r.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new je(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new je(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class kC{convertValue(e,t="none"){switch(ds(e)){case 0:return null;case 1:return e.booleanValue;case 2:return sr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(hs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Qe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return xs(e,(s,o)=>{i[s]=this.convertValue(o,t)}),i}convertVectorValue(e){var t,i,s;const o=(s=(i=(t=e.fields)===null||t===void 0?void 0:t[A0].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map(u=>sr(u.doubleValue));return new qi(o)}convertGeoPoint(e){return new Gi(sr(e.latitude),sr(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Q0(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(sc(e));default:return null}}convertTimestamp(e){const t=fs(e);return new qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Gt.fromString(e);Ct(q2(i),9688,{name:e});const s=new lc(i.get(1),i.get(3)),o=new Ye(i.popFirst(5));return s.isEqual(t)||Ea(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(r,e,t){let i;return i=r?r.toFirestore(e):e,i}class zu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class rl extends SE{constructor(e,t,i,s,o,u){super(e,t,i,s,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new p0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Xm("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new je(Ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=rl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}rl._jsonSchemaVersion="firestore/documentSnapshot/1.0",rl._jsonSchema={type:dr("string",rl._jsonSchemaVersion),bundleSource:dr("string","DocumentSnapshot"),bundleName:dr("string"),bundle:dr("string")};class p0 extends rl{data(e={}){return super.data(e)}}class nl{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new zu(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new p0(this._firestore,this._userDataWriter,i.key,i,new zu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new je(Ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let u=0;return s._snapshot.docChanges.map(h=>{const g=new p0(s._firestore,s._userDataWriter,h.doc.key,h.doc,new zu(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:g,oldIndex:-1,newIndex:u++}})}{let u=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(h=>o||h.type!==3).map(h=>{const g=new p0(s._firestore,s._userDataWriter,h.doc.key,h.doc,new zu(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let m=-1,v=-1;return h.type!==0&&(m=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),v=u.indexOf(h.doc.key)),{type:FC(h.type),doc:g,oldIndex:m,newIndex:v}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new je(Ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=nl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=gm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],s=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function FC(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qe(61501,{type:r})}}nl._jsonSchemaVersion="firestore/querySnapshot/1.0",nl._jsonSchema={type:dr("string",nl._jsonSchemaVersion),bundleSource:dr("string","QuerySnapshot"),bundleName:dr("string"),bundle:dr("string")};class $m extends kC{constructor(e){super(),this.firestore=e}convertBytes(e){return new ti(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new mr(this.firestore,null,t)}}function PC(r){r=ji(r,Es);const e=ji(r.firestore,ll),t=Um(e),i=new $m(e);return wE(r._query),EC(t,r._query).then(s=>new nl(e,i,r,s))}function LC(r,e,t,...i){r=ji(r,mr);const s=ji(r.firestore,ll),o=Hm(s);let u;return u=typeof(e=Xi(e))=="string"||e instanceof sh?DC(o,"updateDoc",r._key,e,t,i):bC(o,"updateDoc",r._key,e),Zm(s,[u.toMutation(r._key,di.exists(!0))])}function Hu(r){return Zm(ji(r.firestore,ll),[new Am(r._key,di.none())])}function Gu(r,e){const t=ji(r.firestore,ll),i=tl(r),s=MC(r.converter,e);return Zm(t,[CC(Hm(r.firestore),"addDoc",i._key,s,r.converter!==null,{}).toMutation(i._key,di.exists(!1))]).then(()=>i)}function r0(r,...e){var t,i,s;r=Xi(r);let o={includeMetadataChanges:!1,source:"default"},u=0;typeof e[u]!="object"||Wx(e[u])||(o=e[u++]);const h={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Wx(e[u])){const x=e[u];e[u]=(t=x.next)===null||t===void 0?void 0:t.bind(x),e[u+1]=(i=x.error)===null||i===void 0?void 0:i.bind(x),e[u+2]=(s=x.complete)===null||s===void 0?void 0:s.bind(x)}let g,m,v;if(r instanceof mr)m=ji(r.firestore,ll),v=Em(r._key.path),g={next:x=>{e[u]&&e[u](VC(m,r,x))},error:e[u+1],complete:e[u+2]};else{const x=ji(r,Es);m=ji(x.firestore,ll),v=x._query;const y=new $m(m);g={next:T=>{e[u]&&e[u](new nl(m,y,x,T))},error:e[u+1],complete:e[u+2]},wE(r._query)}return function(y,T,b,S){const w=new gE(S),G=new sE(T,w,b);return y.asyncQueue.enqueueAndForget(async()=>iE(await im(y),G)),()=>{w.Ou(),y.asyncQueue.enqueueAndForget(async()=>aE(await im(y),G))}}(Um(m),v,h,g)}function Zm(r,e){return function(i,s){const o=new ls;return i.asyncQueue.enqueueAndForget(async()=>uC(await yC(i),s,o)),o.promise}(Um(r),e)}function VC(r,e,t){const i=t.docs.get(e._key),s=new $m(r);return new rl(r,s,e._key,i,new zu(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Do=s})(_w),y0(new nc("firestore",(i,{instanceIdentifier:s,options:o})=>{const u=i.getProvider("app").getImmediate(),h=new ll(new Iw(i.getProvider("auth-internal")),new Fw(u,i.getProvider("app-check-internal")),function(m,v){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new je(Ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lc(m.options.projectId,v)}(u,s),u);return o=Object.assign({useFetchStreams:t},o),h._setSettings(o),h},"PUBLIC").setMultipleInstances(!0)),po(Z_,J_,e),po(Z_,J_,"esm2017")})();const BC=({className:r})=>z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),UC=({className:r})=>z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),R1=({className:r})=>z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),Rc=({className:r})=>z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),jC=({className:r})=>z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,viewBox:"0 0 24 24",fill:"currentColor",children:z.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.519 1.36h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),zC=({className:r})=>z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),bE=({className:r})=>z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),Zx=({className:r})=>z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),HC=({className:r})=>z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});var GC="firebase",qC="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */po(GC,qC,"app");const XC={apiKey:"AIzaSyD_XuFAVxqjFeN6tRzrPAxCDN8BaTmH7kw",authDomain:"kmrodado-1b15e.firebaseapp.com",projectId:"kmrodado-1b15e",storageBucket:"kmrodado-1b15e.firebasestorage.app",messagingSenderId:"846616835715",appId:"1:846616835715:web:1e379d474619f956c30db6",measurementId:"G-H2X1M0E2LL"},YC=Yy(XC),Zn=Sc(YC),KC=async()=>{const r=Sc();return(await PC(Bi(r,"checklistModel"))).docs.map(t=>({id:t.id,...t.data()}))},WC=async r=>{const e=Sc();return{id:(await Gu(Bi(e,"checklistModel"),{text:r})).id,text:r}},QC=async r=>{const e=Sc();await Hu(tl(e,"checklistModel",r))},$C=async(r,e)=>{const t=Sc(),i=tl(t,"checklistModel",r);await LC(i,{text:e})},DE=r=>{let t=r.replace(/[^a-zA-Z0-9]/g,"").toUpperCase().slice(0,7);return t.length>3&&(t=`${t.slice(0,3)}-${t.slice(3)}`),t},ZC=({isOpen:r,onClose:e,onAddDriver:t,drivers:i,onRemoveDriver:s})=>{const[o,u]=tt.useState(""),h=async()=>{o.trim()&&await t(o.trim())&&u("")};return r?z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",onClick:e,children:z.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md",onClick:g=>g.stopPropagation(),children:[z.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900 dark:text-white",children:"Gerenciar Motoristas"}),z.jsxs("div",{className:"mb-4",children:[z.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Motoristas Cadastrados"}),z.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:i.length===0?z.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Nenhum motorista cadastrado"}):i.map(g=>z.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded-md",children:[z.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:g.name}),z.jsx("button",{type:"button",onClick:()=>s(g.id),className:"p-1 text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300","aria-label":"Remover motorista",children:z.jsx(Rc,{className:"w-4 h-4"})})]},g.id))})]}),z.jsxs("div",{className:"border-t pt-4",children:[z.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adicionar Novo Motorista"}),z.jsxs("div",{className:"flex gap-2",children:[z.jsx("input",{type:"text",value:o,onChange:g=>u(g.target.value),placeholder:"Nome completo",className:"flex-1 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",onKeyPress:g=>g.key==="Enter"&&h()}),z.jsx("button",{type:"button",onClick:h,disabled:!o.trim(),className:"px-3 py-2.5 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 focus:ring-4 focus:ring-primary-300 dark:focus:ring-primary-800 disabled:opacity-50 disabled:cursor-not-allowed",children:"Adicionar"})]})]}),z.jsx("div",{className:"mt-6 flex justify-end",children:z.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700",children:"Fechar"})})]})}):null},JC=({isOpen:r,onClose:e,onAddVehicle:t,vehicles:i,onRemoveVehicle:s})=>{const[o,u]=tt.useState(""),h=async()=>{o.trim()&&await t(o.trim())&&u("")};return r?z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",onClick:e,children:z.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md",onClick:g=>g.stopPropagation(),children:[z.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900 dark:text-white",children:"Gerenciar Veículos"}),z.jsxs("div",{className:"mb-4",children:[z.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Veículos Cadastrados"}),z.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:i.length===0?z.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Nenhum veículo cadastrado"}):i.map(g=>z.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded-md",children:[z.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:g.name}),z.jsx("button",{type:"button",onClick:()=>s(g.id),className:"p-1 text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300","aria-label":"Remover veículo",children:z.jsx(Rc,{className:"w-4 h-4"})})]},g.id))})]}),z.jsxs("div",{className:"border-t pt-4",children:[z.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adicionar Novo Veículo"}),z.jsxs("div",{className:"flex gap-2",children:[z.jsx("input",{type:"text",value:o,onChange:g=>u(g.target.value),placeholder:"Nome do veículo",className:"flex-1 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",onKeyPress:g=>g.key==="Enter"&&h()}),z.jsx("button",{type:"button",onClick:h,disabled:!o.trim(),className:"px-3 py-2.5 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 focus:ring-4 focus:ring-primary-300 dark:focus:ring-primary-800 disabled:opacity-50 disabled:cursor-not-allowed",children:"Adicionar"})]})]}),z.jsx("div",{className:"mt-6 flex justify-end",children:z.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700",children:"Fechar"})})]})}):null},e6=({isOpen:r,onClose:e,onAddPlate:t,plates:i,onRemovePlate:s})=>{const[o,u]=tt.useState(""),h=m=>{const v=m.target.value;u(DE(v))},g=async()=>{o.replace(/[^a-zA-Z0-9]/g,"").length===7?await t(o.trim())&&u(""):alert("A placa deve ter exatamente 7 caracteres (3 letras + 4 números).")};return r?z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",onClick:e,children:z.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md",onClick:m=>m.stopPropagation(),children:[z.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900 dark:text-white",children:"Gerenciar Placas"}),z.jsxs("div",{className:"mb-4",children:[z.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Placas Cadastradas"}),z.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:i.length===0?z.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Nenhuma placa cadastrada"}):i.map(m=>z.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded-md",children:[z.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:m.number}),z.jsx("button",{type:"button",onClick:()=>s(m.id),className:"p-1 text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300","aria-label":"Remover placa",children:z.jsx(Rc,{className:"w-4 h-4"})})]},m.id))})]}),z.jsxs("div",{className:"border-t pt-4",children:[z.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adicionar Nova Placa"}),z.jsxs("div",{className:"flex gap-2",children:[z.jsx("input",{type:"text",value:o,onChange:h,placeholder:"ABC-1234 (7 caracteres)",maxLength:8,className:"flex-1 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",onKeyPress:m=>m.key==="Enter"&&g()}),z.jsx("button",{type:"button",onClick:g,disabled:o.replace(/[^a-zA-Z0-9]/g,"").length!==7,className:"px-3 py-2.5 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 focus:ring-4 focus:ring-primary-300 dark:focus:ring-primary-800 disabled:opacity-50 disabled:cursor-not-allowed",children:"Adicionar"})]})]}),z.jsx("div",{className:"mt-6 flex justify-end",children:z.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700",children:"Fechar"})})]})}):null},t6=({drivers:r,vehicles:e,plates:t,onAddTrip:i,onAddDriver:s,onRemoveDriver:o,onAddVehicle:u,onRemoveVehicle:h,onAddPlate:g,onRemovePlate:m})=>{const v=()=>{const de=new Date;return de.setMinutes(de.getMinutes()-de.getTimezoneOffset()),de.toISOString().slice(0,16)},[x,y]=tt.useState({driver:"",vehicle:"",plate:"",km:"",origin:"",destination:"",departureTime:v()}),[T,b]=tt.useState(!1),[S,w]=tt.useState(!1),[G,Z]=tt.useState(!1),[K,ne]=tt.useState(!1),[pe,Re]=tt.useState(!1),[N,D]=tt.useState([]),[R,k]=tt.useState(null),[F,B]=tt.useState("");tt.useEffect(()=>{(async()=>{const ve=await KC();D(ve.map(Ne=>({id:Ne.id,text:Ne.text,checked:!1})))})()},[]),tt.useEffect(()=>{K&&J(N.map(de=>({...de,checked:!1})))},[K,N]);const P=()=>{try{const de=localStorage.getItem("tripChecklist");if(de)return JSON.parse(de)}catch(de){console.error("Erro ao carregar checklist:",de)}return[{id:"1",text:"Verificar combustível",checked:!1},{id:"2",text:"Verificar pneus",checked:!1},{id:"3",text:"Verificar óleo",checked:!1},{id:"4",text:"Documentos do veículo",checked:!1},{id:"5",text:"CNH do motorista",checked:!1},{id:"6",text:"Rota planejada",checked:!1},{id:"7",text:"Meios de comunicação",checked:!1}]},qe=de=>{try{localStorage.setItem("tripChecklist",JSON.stringify(de))}catch(ve){console.error("Erro ao salvar checklist:",ve)}},[Be,J]=tt.useState(P),[ye,Pe]=tt.useState("");tt.useEffect(()=>{const de=P();J(de)},[]),tt.useEffect(()=>{(!r.some(ve=>ve.name===x.driver)||!x.driver)&&r.length>0?y(ve=>({...ve,driver:r[0].name})):r.length===0&&y(ve=>({...ve,driver:""}))},[r,x.driver]),tt.useEffect(()=>{(!e.some(ve=>ve.name===x.vehicle)||!x.vehicle)&&e.length>0?y(ve=>({...ve,vehicle:e[0].name})):e.length===0&&y(ve=>({...ve,vehicle:""}))},[e,x.vehicle]),tt.useEffect(()=>{(!t.some(ve=>ve.number===x.plate)||!x.plate)&&t.length>0?y(ve=>({...ve,plate:t[0].number})):t.length===0&&y(ve=>({...ve,plate:""}))},[t,x.plate]);const He=de=>{const{name:ve,value:Ne}=de.target;y(ve==="km"?De=>({...De,km:Ne.replace(/\D/g,"")}):ve==="plate"?De=>({...De,plate:DE(Ne)}):De=>({...De,[ve]:Ne}))},W=(de,ve)=>{J(Ne=>Ne.map(De=>De.id===de?{...De,checked:ve}:De))},xe=async()=>{if(ye.trim()){const de=await WC(ye.trim());D(ve=>[...ve,{id:de.id,text:de.text,checked:!1}]),Pe("")}},V=async de=>{await QC(de),D(ve=>ve.filter(Ne=>Ne.id!==de))},X=(de,ve)=>{k(de),B(ve)},q=async de=>{await $C(de,F),D(ve=>ve.map(Ne=>Ne.id===de?{...Ne,text:F}:Ne)),k(null),B("")},Q=()=>{k(null),B("")},oe=de=>{if(de.preventDefault(),!x.driver){alert("Por favor, selecione um motorista. Se não houver nenhum, adicione um primeiro.");return}if(!x.vehicle){alert("Por favor, selecione um veículo. Se não houver nenhum, adicione um primeiro.");return}if(!x.plate){alert("Por favor, selecione uma placa. Se não houver nenhuma, adicione uma primeiro.");return}i({...x,km:Number(x.km),checklist:Be}),y(Ne=>({...Ne,vehicle:"",plate:"",km:"",origin:"",destination:"",departureTime:v()}));const ve=Be.map(Ne=>({...Ne,checked:!1}));J(ve),qe(ve)};return z.jsxs(z.Fragment,{children:[z.jsx(ZC,{isOpen:T,onClose:()=>b(!1),onAddDriver:s,drivers:r,onRemoveDriver:o}),z.jsx(JC,{isOpen:S,onClose:()=>w(!1),onAddVehicle:u,vehicles:e,onRemoveVehicle:h}),z.jsx(e6,{isOpen:G,onClose:()=>Z(!1),onAddPlate:g,plates:t,onRemovePlate:m}),K&&z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",children:z.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 w-80 max-h-96 overflow-y-auto",children:z.jsxs("div",{className:"p-4",children:[z.jsxs("div",{className:"flex justify-between items-center mb-3",children:[z.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Checklist de Viagem"}),z.jsx("button",{onClick:()=>Re(!pe),className:"p-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200","aria-label":"Editar checklist",children:z.jsx(Zx,{className:"w-4 h-4"})})]}),pe&&z.jsx("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:z.jsxs("div",{className:"flex gap-2",children:[z.jsx("input",{type:"text",value:ye,onChange:de=>Pe(de.target.value),placeholder:"Adicionar novo item...",className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",onKeyPress:de=>de.key==="Enter"&&xe()}),z.jsx("button",{onClick:xe,className:"px-2 py-1 text-xs font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700",children:"+"})]})}),z.jsx("div",{className:"space-y-3",children:Be.map(de=>z.jsxs("div",{className:"flex items-center justify-between",children:[z.jsxs("div",{className:"flex items-center",children:[z.jsx("input",{type:"checkbox",id:`checklist-${de.id}`,checked:de.checked,onChange:ve=>W(de.id,ve.target.checked),className:"w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),R===de.id?z.jsxs(z.Fragment,{children:[z.jsx("input",{type:"text",value:F,onChange:ve=>B(ve.target.value),className:"border rounded px-1 py-0.5 text-sm",onKeyDown:ve=>{ve.key==="Enter"&&q(de.id),ve.key==="Escape"&&Q()},autoFocus:!0}),z.jsx("button",{onClick:()=>q(de.id),className:"ml-1 text-green-600",children:"Salvar"}),z.jsx("button",{onClick:Q,className:"ml-1 text-gray-500",children:"Cancelar"})]}):z.jsxs(z.Fragment,{children:[z.jsx("span",{children:de.text}),pe&&z.jsx("button",{onClick:()=>X(de.id,de.text),className:"ml-2 text-blue-600","aria-label":"Editar item do checklist",children:z.jsx(Zx,{className:"w-4 h-4 inline"})})]})]}),pe&&z.jsx("button",{onClick:()=>V(de.id),className:"p-1 text-red-500 hover:text-red-700","aria-label":"Remover item",children:z.jsx(Rc,{className:"w-3 h-3"})})]},de.id))}),z.jsxs("div",{className:"mt-4 flex justify-between",children:[z.jsx("button",{onClick:()=>ne(!1),className:"px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Fechar"}),z.jsx("button",{onClick:()=>{ne(!1)},className:"px-3 py-1.5 text-xs font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700",children:"Salvar Checklist"})]})]})})}),z.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8",children:z.jsxs("form",{onSubmit:oe,className:"space-y-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"driver",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Motorista"}),z.jsxs("div",{className:"flex items-center gap-2",children:[z.jsxs("select",{id:"driver",name:"driver",value:x.driver,onChange:He,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:!0,children:[r.length===0&&z.jsx("option",{value:"",disabled:!0,children:"Adicione um motorista..."}),r.map(de=>z.jsx("option",{value:de.name,children:de.name},de.id))]}),z.jsx("button",{type:"button",onClick:()=>b(!0),className:"p-2.5 text-primary-600 bg-primary-100 dark:bg-primary-900 dark:text-primary-300 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors flex-shrink-0","aria-label":"Gerenciar motoristas",children:z.jsx(R1,{className:"w-5 h-5"})})]})]}),z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"vehicle",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Veículo"}),z.jsxs("div",{className:"flex items-center gap-2",children:[z.jsxs("select",{id:"vehicle",name:"vehicle",value:x.vehicle,onChange:He,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:!0,children:[e.length===0&&z.jsx("option",{value:"",disabled:!0,children:"Adicione um veículo..."}),e.map(de=>z.jsx("option",{value:de.name,children:de.name},de.id))]}),z.jsx("button",{type:"button",onClick:()=>w(!0),className:"p-2.5 text-primary-600 bg-primary-100 dark:bg-primary-900 dark:text-primary-300 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors flex-shrink-0","aria-label":"Gerenciar veículos",children:z.jsx(R1,{className:"w-5 h-5"})})]})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"plate",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Placa"}),z.jsxs("div",{className:"flex items-center gap-2",children:[z.jsxs("select",{id:"plate",name:"plate",value:x.plate,onChange:He,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:!0,children:[t.length===0&&z.jsx("option",{value:"",disabled:!0,children:"Adicione uma placa..."}),t.map(de=>z.jsx("option",{value:de.number,children:de.number},de.id))]}),z.jsx("button",{type:"button",onClick:()=>Z(!0),className:"p-2.5 text-primary-600 bg-primary-100 dark:bg-primary-900 dark:text-primary-300 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors flex-shrink-0","aria-label":"Gerenciar placas",children:z.jsx(R1,{className:"w-5 h-5"})})]})]})]}),z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"km",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"KM"}),z.jsxs("div",{className:"relative",children:[z.jsx("input",{type:"text",pattern:"\\d*",id:"km",name:"km",value:x.km,onChange:He,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 pr-12 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",required:!0}),z.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-gray-500 dark:text-gray-400",children:"KM"})]})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"departureTime",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Hora da Saída"}),z.jsx("input",{type:"datetime-local",id:"departureTime",name:"departureTime",value:x.departureTime,onChange:He,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:[color-scheme:light]",required:!0})]})]}),z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"origin",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Origem"}),z.jsx("input",{type:"text",id:"origin",name:"origin",value:x.origin,onChange:He,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",required:!0})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"destination",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Destino"}),z.jsx("input",{type:"text",id:"destination",name:"destination",value:x.destination,onChange:He,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",required:!0})]})]}),z.jsxs("div",{className:"flex gap-2",children:[z.jsx("button",{type:"submit",className:"flex-1 text-white bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 transition-colors",children:"Adicionar Viagem"}),z.jsx("button",{type:"button",onClick:()=>ne(!0),className:"p-2.5 text-primary-600 bg-primary-100 dark:bg-primary-900 dark:text-primary-300 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors flex-shrink-0","aria-label":"Abrir checklist",children:z.jsx(bE,{className:"w-5 h-5"})})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var I0={};I0.version="0.18.5";var NE=1252,r6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],OE=function(r){r6.indexOf(r)!=-1&&(NE=r)};function n6(){OE(1252)}var hc=function(r){OE(r)};function i6(){hc(1200),n6()}var n0=function(e){return String.fromCharCode(e)},Jx=function(e){return String.fromCharCode(e)},k0,rs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function dc(r){for(var e="",t=0,i=0,s=0,o=0,u=0,h=0,g=0,m=0;m<r.length;)t=r.charCodeAt(m++),o=t>>2,i=r.charCodeAt(m++),u=(t&3)<<4|i>>4,s=r.charCodeAt(m++),h=(i&15)<<2|s>>6,g=s&63,isNaN(i)?h=g=64:isNaN(s)&&(g=64),e+=rs.charAt(o)+rs.charAt(u)+rs.charAt(h)+rs.charAt(g);return e}function Aa(r){var e="",t=0,i=0,s=0,o=0,u=0,h=0,g=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<r.length;)o=rs.indexOf(r.charAt(m++)),u=rs.indexOf(r.charAt(m++)),t=o<<2|u>>4,e+=String.fromCharCode(t),h=rs.indexOf(r.charAt(m++)),i=(u&15)<<4|h>>2,h!==64&&(e+=String.fromCharCode(i)),g=rs.indexOf(r.charAt(m++)),s=(h&3)<<6|g,g!==64&&(e+=String.fromCharCode(s));return e}var wt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),wa=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ol(r){return wt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function ey(r){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var fi=function(e){return wt?wa(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function oh(r){if(typeof ArrayBuffer>"u")return fi(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),i=0;i!=r.length;++i)t[i]=r.charCodeAt(i)&255;return e}function Cc(r){if(Array.isArray(r))return r.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function a6(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var jr=wt?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:wa(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var i=new Uint8Array(t),s=0;for(e=0,t=0;e<r.length;t+=s,++e)if(s=r[e].length,r[e]instanceof Uint8Array)i.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";i.set(new Uint8Array(r[e]),t)}return i}return[].concat.apply([],r.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function s6(r){for(var e=[],t=0,i=r.length+250,s=ol(r.length+255),o=0;o<r.length;++o){var u=r.charCodeAt(o);if(u<128)s[t++]=u;else if(u<2048)s[t++]=192|u>>6&31,s[t++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var h=r.charCodeAt(++o)&1023;s[t++]=240|u>>8&7,s[t++]=128|u>>2&63,s[t++]=128|h>>6&15|(u&3)<<4,s[t++]=128|h&63}else s[t++]=224|u>>12&15,s[t++]=128|u>>6&63,s[t++]=128|u&63;t>i&&(e.push(s.slice(0,t)),t=0,s=ol(65535),i=65530)}return e.push(s.slice(0,t)),jr(e)}var $u=/\u0000/g,i0=/[\u0001-\u0006]/g;function _o(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function hi(r,e){var t=""+r;return t.length>=e?t:er("0",e-t.length)+t}function Jm(r,e){var t=""+r;return t.length>=e?t:er(" ",e-t.length)+t}function M0(r,e){var t=""+r;return t.length>=e?t:t+er(" ",e-t.length)}function l6(r,e){var t=""+Math.round(r);return t.length>=e?t:er("0",e-t.length)+t}function o6(r,e){var t=""+r;return t.length>=e?t:er("0",e-t.length)+t}var ty=Math.pow(2,32);function so(r,e){if(r>ty||r<-ty)return l6(r,e);var t=Math.round(r);return o6(t,e)}function F0(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var ry=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],C1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function u6(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',r}var tr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},ny={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},c6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function P0(r,e,t){for(var i=r<0?-1:1,s=r*i,o=0,u=1,h=0,g=1,m=0,v=0,x=Math.floor(s);m<e&&(x=Math.floor(s),h=x*u+o,v=x*m+g,!(s-x<5e-8));)s=1/(s-x),o=u,u=h,g=m,m=v;if(v>e&&(m>e?(v=g,h=o):(v=m,h=u)),!t)return[0,i*h,v];var y=Math.floor(i*h/v);return[y,i*h-y*v,v]}function a0(r,e,t){if(r>2958465||r<0)return null;var i=r|0,s=Math.floor(86400*(r-i)),o=0,u=[],h={D:i,T:s,u:86400*(r-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),e&&e.date1904&&(i+=1462),h.u>.9999&&(h.u=0,++s==86400&&(h.T=s=0,++i,++h.D)),i===60)u=t?[1317,10,29]:[1900,2,29],o=3;else if(i===0)u=t?[1317,8,29]:[1900,1,0],o=6;else{i>60&&--i;var g=new Date(1900,0,1);g.setDate(g.getDate()+i-1),u=[g.getFullYear(),g.getMonth()+1,g.getDate()],o=g.getDay(),i<60&&(o=(o+6)%7),t&&(o=v6(g,u))}return h.y=u[0],h.m=u[1],h.d=u[2],h.S=s%60,s=Math.floor(s/60),h.M=s%60,s=Math.floor(s/60),h.H=s,h.q=o,h}var IE=new Date(1899,11,31,0,0,0),f6=IE.getTime(),h6=new Date(1900,2,1,0,0,0);function kE(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=h6&&(t+=24*60*60*1e3),(t-(f6+(r.getTimezoneOffset()-IE.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function eg(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function d6(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function m6(r){var e=r<0?12:11,t=eg(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function g6(r){var e=eg(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function p6(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=m6(r):e===10?t=r.toFixed(10).substr(0,12):t=g6(r),eg(d6(t.toUpperCase()))}function sm(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):p6(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return ps(14,kE(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function v6(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function _6(r,e,t,i){var s="",o=0,u=0,h=t.y,g,m=0;switch(r){case 98:h=t.y+543;case 121:switch(e.length){case 1:case 2:g=h%100,m=2;break;default:g=h%1e4,m=4;break}break;case 109:switch(e.length){case 1:case 2:g=t.m,m=e.length;break;case 3:return C1[t.m-1][1];case 5:return C1[t.m-1][0];default:return C1[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:g=t.d,m=e.length;break;case 3:return ry[t.q][0];default:return ry[t.q][1]}break;case 104:switch(e.length){case 1:case 2:g=1+(t.H+11)%12,m=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:g=t.H,m=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:g=t.M,m=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?hi(t.S,e.length):(i>=2?u=i===3?1e3:100:u=i===1?10:1,o=Math.round(u*(t.S+t.u)),o>=60*u&&(o=0),e==="s"?o===0?"0":""+o/u:(s=hi(o,2+i),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":g=t.D*24+t.H;break;case"[m]":case"[mm]":g=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":g=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}m=e.length===3?1:2;break;case 101:g=h,m=1;break}var v=m>0?hi(g,m):"";return v}function ns(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,i=r.substr(0,t);t!=r.length;t+=e)i+=(i.length>0?",":"")+r.substr(t,e);return i}var ME=/%/g;function x6(r,e,t){var i=e.replace(ME,""),s=e.length-i.length;return va(r,i,t*Math.pow(10,2*s))+er("%",s)}function y6(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return va(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function FE(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+FE(r,-e);var s=r.indexOf(".");s===-1&&(s=r.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(e/Math.pow(10,o)).toPrecision(i+1+(s+o)%s),t.indexOf("e")===-1){var u=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+o):t+="E+"+(u-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,m,v){return g+m+v.substr(0,(s+o)%s)+"."+v.substr(o)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var PE=/# (\?+)( ?)\/( ?)(\d+)/;function E6(r,e,t){var i=parseInt(r[4],10),s=Math.round(e*i),o=Math.floor(s/i),u=s-o*i,h=i;return t+(o===0?"":""+o)+" "+(u===0?er(" ",r[1].length+1+r[4].length):Jm(u,r[1].length)+r[2]+"/"+r[3]+hi(h,r[4].length))}function T6(r,e,t){return t+(e===0?"":""+e)+er(" ",r[1].length+2+r[4].length)}var LE=/^#*0*\.([0#]+)/,VE=/\).*[0#]/,BE=/\(###\) ###\\?-####/;function un(r){for(var e="",t,i=0;i!=r.length;++i)switch(t=r.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function iy(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function ay(r,e){var t=r-Math.floor(r),i=Math.pow(10,e);return e<(""+Math.round(t*i)).length?0:Math.round(t*i)}function A6(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function S6(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Jn(r,e,t){if(r.charCodeAt(0)===40&&!e.match(VE)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Jn("n",i,t):"("+Jn("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return y6(r,e,t);if(e.indexOf("%")!==-1)return x6(r,e,t);if(e.indexOf("E")!==-1)return FE(e,t);if(e.charCodeAt(0)===36)return"$"+Jn(r,e.substr(e.charAt(1)==" "?2:1),t);var s,o,u,h,g=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+so(g,e.length);if(e.match(/^[#?]+$/))return s=so(t,0),s==="0"&&(s=""),s.length>e.length?s:un(e.substr(0,e.length-s.length))+s;if(o=e.match(PE))return E6(o,g,m);if(e.match(/^#+0+$/))return m+so(g,e.length-e.indexOf("0"));if(o=e.match(LE))return s=iy(t,o[1].length).replace(/^([^\.]+)$/,"$1."+un(o[1])).replace(/\.$/,"."+un(o[1])).replace(/\.(\d*)$/,function(b,S){return"."+S+er("0",un(o[1]).length-S.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+iy(g,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+ns(so(g,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Jn(r,e,-t):ns(""+(Math.floor(t)+A6(t,o[1].length)))+"."+hi(ay(t,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Jn(r,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=_o(Jn(r,e.replace(/[\\-]/g,""),t)),u=0,_o(_o(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return u<s.length?s.charAt(u++):b==="0"?"0":""}));if(e.match(BE))return s=Jn(r,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var v="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),h=P0(g,Math.pow(10,u)-1,!1),s=""+m,v=va("n",o[1],h[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),s+=v+o[2]+"/"+o[3],v=M0(h[2],u),v.length<o[4].length&&(v=un(o[4].substr(o[4].length-v.length))+v),s+=v,s;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),h=P0(g,Math.pow(10,u)-1,!0),m+(h[0]||(h[1]?"":"0"))+" "+(h[1]?Jm(h[1],u)+o[2]+"/"+o[3]+M0(h[2],u):er(" ",2*u+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return s=so(t,0),e.length<=s.length?s:un(e.substr(0,e.length-s.length))+s;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=s.indexOf(".");var x=e.indexOf(".")-u,y=e.length-s.length-x;return un(e.substr(0,x)+s+e.substr(e.length-y))}if(o=e.match(/^00,000\.([#0]*0)$/))return u=ay(t,o[1].length),t<0?"-"+Jn(r,e,-t):ns(S6(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?hi(0,3-b.length):"")+b})+"."+hi(u,o[1].length);switch(e){case"###,##0.00":return Jn(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var T=ns(so(g,0));return T!=="0"?m+T:"";case"###,###.00":return Jn(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Jn(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function w6(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return va(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function R6(r,e,t){var i=e.replace(ME,""),s=e.length-i.length;return va(r,i,t*Math.pow(10,2*s))+er("%",s)}function UE(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+UE(r,-e);var s=r.indexOf(".");s===-1&&(s=r.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(e/Math.pow(10,o)).toPrecision(i+1+(s+o)%s),!t.match(/[Ee]/)){var u=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+o):t+="E+"+(u-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,m,v){return g+m+v.substr(0,(s+o)%s)+"."+v.substr(o)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Li(r,e,t){if(r.charCodeAt(0)===40&&!e.match(VE)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Li("n",i,t):"("+Li("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return w6(r,e,t);if(e.indexOf("%")!==-1)return R6(r,e,t);if(e.indexOf("E")!==-1)return UE(e,t);if(e.charCodeAt(0)===36)return"$"+Li(r,e.substr(e.charAt(1)==" "?2:1),t);var s,o,u,h,g=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+hi(g,e.length);if(e.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>e.length?s:un(e.substr(0,e.length-s.length))+s;if(o=e.match(PE))return T6(o,g,m);if(e.match(/^#+0+$/))return m+hi(g,e.length-e.indexOf("0"));if(o=e.match(LE))return s=(""+t).replace(/^([^\.]+)$/,"$1."+un(o[1])).replace(/\.$/,"."+un(o[1])),s=s.replace(/\.(\d*)$/,function(b,S){return"."+S+er("0",un(o[1]).length-S.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+ns(""+g);if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Li(r,e,-t):ns(""+t)+"."+er("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Li(r,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=_o(Li(r,e.replace(/[\\-]/g,""),t)),u=0,_o(_o(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return u<s.length?s.charAt(u++):b==="0"?"0":""}));if(e.match(BE))return s=Li(r,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var v="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),h=P0(g,Math.pow(10,u)-1,!1),s=""+m,v=va("n",o[1],h[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),s+=v+o[2]+"/"+o[3],v=M0(h[2],u),v.length<o[4].length&&(v=un(o[4].substr(o[4].length-v.length))+v),s+=v,s;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),h=P0(g,Math.pow(10,u)-1,!0),m+(h[0]||(h[1]?"":"0"))+" "+(h[1]?Jm(h[1],u)+o[2]+"/"+o[3]+M0(h[2],u):er(" ",2*u+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return s=""+t,e.length<=s.length?s:un(e.substr(0,e.length-s.length))+s;if(o=e.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=s.indexOf(".");var x=e.indexOf(".")-u,y=e.length-s.length-x;return un(e.substr(0,x)+s+e.substr(e.length-y))}if(o=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Li(r,e,-t):ns(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?hi(0,3-b.length):"")+b})+"."+hi(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var T=ns(""+g);return T!=="0"?m+T:"";default:if(e.match(/\.[0#?]*$/))return Li(r,e.slice(0,e.lastIndexOf(".")),t)+un(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function va(r,e,t){return(t|0)===t?Li(r,e,t):Jn(r,e,t)}function C6(r){for(var e=[],t=!1,i=0,s=0;i<r.length;++i)switch(r.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=r.substr(s,i-s),s=i+1}if(e[e.length]=r.substr(s),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var jE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zE(r){for(var e=0,t="",i="";e<r.length;)switch(t=r.charAt(e)){case"G":F0(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(i=t;r.charAt(e++)!=="]"&&e<r.length;)i+=r.charAt(e);if(i.match(jE))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function b6(r,e,t,i){for(var s=[],o="",u=0,h="",g="t",m,v,x,y="H";u<r.length;)switch(h=r.charAt(u)){case"G":if(!F0(r,u))throw new Error("unrecognized character "+h+" in "+r);s[s.length]={t:"G",v:"General"},u+=7;break;case'"':for(o="";(x=r.charCodeAt(++u))!==34&&u<r.length;)o+=String.fromCharCode(x);s[s.length]={t:"t",v:o},++u;break;case"\\":var T=r.charAt(++u),b=T==="("||T===")"?T:"t";s[s.length]={t:b,v:T},++u;break;case"_":s[s.length]={t:"t",v:" "},u+=2;break;case"@":s[s.length]={t:"T",v:e},++u;break;case"B":case"b":if(r.charAt(u+1)==="1"||r.charAt(u+1)==="2"){if(m==null&&(m=a0(e,t,r.charAt(u+1)==="2"),m==null))return"";s[s.length]={t:"X",v:r.substr(u,2)},g=h,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||m==null&&(m=a0(e,t),m==null))return"";for(o=h;++u<r.length&&r.charAt(u).toLowerCase()===h;)o+=h;h==="m"&&g.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=y),s[s.length]={t:h,v:o},g=h;break;case"A":case"a":case"上":var S={t:h,v:h};if(m==null&&(m=a0(e,t)),r.substr(u,3).toUpperCase()==="A/P"?(m!=null&&(S.v=m.H>=12?"P":"A"),S.t="T",y="h",u+=3):r.substr(u,5).toUpperCase()==="AM/PM"?(m!=null&&(S.v=m.H>=12?"PM":"AM"),S.t="T",u+=5,y="h"):r.substr(u,5).toUpperCase()==="上午/下午"?(m!=null&&(S.v=m.H>=12?"下午":"上午"),S.t="T",u+=5,y="h"):(S.t="t",++u),m==null&&S.t==="T")return"";s[s.length]=S,g=h;break;case"[":for(o=h;r.charAt(u++)!=="]"&&u<r.length;)o+=r.charAt(u);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(jE)){if(m==null&&(m=a0(e,t),m==null))return"";s[s.length]={t:"Z",v:o.toLowerCase()},g=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",zE(r)||(s[s.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=h;++u<r.length&&(h=r.charAt(u))==="0";)o+=h;s[s.length]={t:"s",v:o};break}case"0":case"#":for(o=h;++u<r.length&&"0#?.,E+-%".indexOf(h=r.charAt(u))>-1;)o+=h;s[s.length]={t:"n",v:o};break;case"?":for(o=h;r.charAt(++u)===h;)o+=h;s[s.length]={t:h,v:o},g=h;break;case"*":++u,(r.charAt(u)==" "||r.charAt(u)=="*")&&++u;break;case"(":case")":s[s.length]={t:i===1?"t":h,v:h},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=h;u<r.length&&"0123456789".indexOf(r.charAt(++u))>-1;)o+=r.charAt(u);s[s.length]={t:"D",v:o};break;case" ":s[s.length]={t:h,v:h},++u;break;case"$":s[s.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+r);s[s.length]={t:"t",v:h},++u;break}var w=0,G=0,Z;for(u=s.length-1,g="t";u>=0;--u)switch(s[u].t){case"h":case"H":s[u].t=y,g="h",w<1&&(w=1);break;case"s":(Z=s[u].v.match(/\.0+$/))&&(G=Math.max(G,Z[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":g=s[u].t;break;case"m":g==="s"&&(s[u].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[u].v.match(/[Hh]/)&&(w=1),w<2&&s[u].v.match(/[Mm]/)&&(w=2),w<3&&s[u].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var K="",ne;for(u=0;u<s.length;++u)switch(s[u].t){case"t":case"T":case" ":case"D":break;case"X":s[u].v="",s[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[u].v=_6(s[u].t.charCodeAt(0),s[u].v,m,G),s[u].t="t";break;case"n":case"?":for(ne=u+1;s[ne]!=null&&((h=s[ne].t)==="?"||h==="D"||(h===" "||h==="t")&&s[ne+1]!=null&&(s[ne+1].t==="?"||s[ne+1].t==="t"&&s[ne+1].v==="/")||s[u].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(s[ne].v==="/"||s[ne].v===" "&&s[ne+1]!=null&&s[ne+1].t=="?"));)s[u].v+=s[ne].v,s[ne]={v:"",t:";"},++ne;K+=s[u].v,u=ne-1;break;case"G":s[u].t="t",s[u].v=sm(e,t);break}var pe="",Re,N;if(K.length>0){K.charCodeAt(0)==40?(Re=e<0&&K.charCodeAt(0)===45?-e:e,N=va("n",K,Re)):(Re=e<0&&i>1?-e:e,N=va("n",K,Re),Re<0&&s[0]&&s[0].t=="t"&&(N=N.substr(1),s[0].v="-"+s[0].v)),ne=N.length-1;var D=s.length;for(u=0;u<s.length;++u)if(s[u]!=null&&s[u].t!="t"&&s[u].v.indexOf(".")>-1){D=u;break}var R=s.length;if(D===s.length&&N.indexOf("E")===-1){for(u=s.length-1;u>=0;--u)s[u]==null||"n?".indexOf(s[u].t)===-1||(ne>=s[u].v.length-1?(ne-=s[u].v.length,s[u].v=N.substr(ne+1,s[u].v.length)):ne<0?s[u].v="":(s[u].v=N.substr(0,ne+1),ne=-1),s[u].t="t",R=u);ne>=0&&R<s.length&&(s[R].v=N.substr(0,ne+1)+s[R].v)}else if(D!==s.length&&N.indexOf("E")===-1){for(ne=N.indexOf(".")-1,u=D;u>=0;--u)if(!(s[u]==null||"n?".indexOf(s[u].t)===-1)){for(v=s[u].v.indexOf(".")>-1&&u===D?s[u].v.indexOf(".")-1:s[u].v.length-1,pe=s[u].v.substr(v+1);v>=0;--v)ne>=0&&(s[u].v.charAt(v)==="0"||s[u].v.charAt(v)==="#")&&(pe=N.charAt(ne--)+pe);s[u].v=pe,s[u].t="t",R=u}for(ne>=0&&R<s.length&&(s[R].v=N.substr(0,ne+1)+s[R].v),ne=N.indexOf(".")+1,u=D;u<s.length;++u)if(!(s[u]==null||"n?(".indexOf(s[u].t)===-1&&u!==D)){for(v=s[u].v.indexOf(".")>-1&&u===D?s[u].v.indexOf(".")+1:0,pe=s[u].v.substr(0,v);v<s[u].v.length;++v)ne<N.length&&(pe+=N.charAt(ne++));s[u].v=pe,s[u].t="t",R=u}}}for(u=0;u<s.length;++u)s[u]!=null&&"n?".indexOf(s[u].t)>-1&&(Re=i>1&&e<0&&u>0&&s[u-1].v==="-"?-e:e,s[u].v=va(s[u].t,s[u].v,Re),s[u].t="t");var k="";for(u=0;u!==s.length;++u)s[u]!=null&&(k+=s[u].v);return k}var sy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ly(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function D6(r,e){var t=C6(r),i=t.length,s=t[i-1].indexOf("@");if(i<4&&s>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var u=t[0].match(sy),h=t[1].match(sy);return ly(e,u)?[i,t[0]]:ly(e,h)?[i,t[1]]:[i,t[u!=null&&h!=null?2:1]]}return[i,o]}function ps(r,e,t){t==null&&(t={});var i="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?i=t.dateNF:i=r;break;case"number":r==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:tr)[r],i==null&&(i=t.table&&t.table[ny[r]]||tr[ny[r]]),i==null&&(i=c6[r]||"General");break}if(F0(i,0))return sm(e,t);e instanceof Date&&(e=kE(e,t.date1904));var s=D6(i,e);if(F0(s[1]))return sm(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return b6(s[1],e,t,s[0])}function HE(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(tr[t]==null){e<0&&(e=t);continue}if(tr[t]==r){e=t;break}}e<0&&(e=391)}return tr[e]=r,e}function uh(r){for(var e=0;e!=392;++e)r[e]!==void 0&&HE(r[e],e)}function ch(){tr=u6()}var GE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function N6(r){var e=typeof r=="number"?tr[r]:r;return e=e.replace(GE,"(\\d+)"),new RegExp("^"+e+"$")}function O6(r,e,t){var i=-1,s=-1,o=-1,u=-1,h=-1,g=-1;(e.match(GE)||[]).forEach(function(x,y){var T=parseInt(t[y+1],10);switch(x.toLowerCase().charAt(0)){case"y":i=T;break;case"d":o=T;break;case"h":u=T;break;case"s":g=T;break;case"m":u>=0?h=T:s=T;break}}),g>=0&&h==-1&&s>=0&&(h=s,s=-1);var m=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var v=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return u==-1&&h==-1&&g==-1?m:i==-1&&s==-1&&o==-1?v:m+"T"+v}var I6=function(){var r={};r.version="1.2.0";function e(){for(var N=0,D=new Array(256),R=0;R!=256;++R)N=R,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,D[R]=N;return typeof Int32Array<"u"?new Int32Array(D):D}var t=e();function i(N){var D=0,R=0,k=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(k=0;k!=256;++k)F[k]=N[k];for(k=0;k!=256;++k)for(R=N[k],D=256+k;D<4096;D+=256)R=F[D]=R>>>8^N[R&255];var B=[];for(k=1;k!=16;++k)B[k-1]=typeof Int32Array<"u"?F.subarray(k*256,k*256+256):F.slice(k*256,k*256+256);return B}var s=i(t),o=s[0],u=s[1],h=s[2],g=s[3],m=s[4],v=s[5],x=s[6],y=s[7],T=s[8],b=s[9],S=s[10],w=s[11],G=s[12],Z=s[13],K=s[14];function ne(N,D){for(var R=D^-1,k=0,F=N.length;k<F;)R=R>>>8^t[(R^N.charCodeAt(k++))&255];return~R}function pe(N,D){for(var R=D^-1,k=N.length-15,F=0;F<k;)R=K[N[F++]^R&255]^Z[N[F++]^R>>8&255]^G[N[F++]^R>>16&255]^w[N[F++]^R>>>24]^S[N[F++]]^b[N[F++]]^T[N[F++]]^y[N[F++]]^x[N[F++]]^v[N[F++]]^m[N[F++]]^g[N[F++]]^h[N[F++]]^u[N[F++]]^o[N[F++]]^t[N[F++]];for(k+=15;F<k;)R=R>>>8^t[(R^N[F++])&255];return~R}function Re(N,D){for(var R=D^-1,k=0,F=N.length,B=0,P=0;k<F;)B=N.charCodeAt(k++),B<128?R=R>>>8^t[(R^B)&255]:B<2048?(R=R>>>8^t[(R^(192|B>>6&31))&255],R=R>>>8^t[(R^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,P=N.charCodeAt(k++)&1023,R=R>>>8^t[(R^(240|B>>8&7))&255],R=R>>>8^t[(R^(128|B>>2&63))&255],R=R>>>8^t[(R^(128|P>>6&15|(B&3)<<4))&255],R=R>>>8^t[(R^(128|P&63))&255]):(R=R>>>8^t[(R^(224|B>>12&15))&255],R=R>>>8^t[(R^(128|B>>6&63))&255],R=R>>>8^t[(R^(128|B&63))&255]);return~R}return r.table=t,r.bstr=ne,r.buf=pe,r.str=Re,r}(),Vt=function(){var e={};e.version="1.2.1";function t(C,j){for(var M=C.split("/"),L=j.split("/"),U=0,H=0,se=Math.min(M.length,L.length);U<se;++U){if(H=M[U].length-L[U].length)return H;if(M[U]!=L[U])return M[U]<L[U]?-1:1}return M.length-L.length}function i(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:i(C.slice(0,-1));var j=C.lastIndexOf("/");return j===-1?C:C.slice(0,j+1)}function s(C){if(C.charAt(C.length-1)=="/")return s(C.slice(0,-1));var j=C.lastIndexOf("/");return j===-1?C:C.slice(j+1)}function o(C,j){typeof j=="string"&&(j=new Date(j));var M=j.getHours();M=M<<6|j.getMinutes(),M=M<<5|j.getSeconds()>>>1,C.write_shift(2,M);var L=j.getFullYear()-1980;L=L<<4|j.getMonth()+1,L=L<<5|j.getDate(),C.write_shift(2,L)}function u(C){var j=C.read_shift(2)&65535,M=C.read_shift(2)&65535,L=new Date,U=M&31;M>>>=5;var H=M&15;M>>>=4,L.setMilliseconds(0),L.setFullYear(M+1980),L.setMonth(H-1),L.setDate(U);var se=j&31;j>>>=5;var me=j&63;return j>>>=6,L.setHours(j),L.setMinutes(me),L.setSeconds(se<<1),L}function h(C){Fn(C,0);for(var j={},M=0;C.l<=C.length-4;){var L=C.read_shift(2),U=C.read_shift(2),H=C.l+U,se={};switch(L){case 21589:M=C.read_shift(1),M&1&&(se.mtime=C.read_shift(4)),U>5&&(M&2&&(se.atime=C.read_shift(4)),M&4&&(se.ctime=C.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}C.l=H,j[L]=se}return j}var g;function m(){return g||(g={})}function v(C,j){if(C[0]==80&&C[1]==75)return Da(C,j);if((C[0]|32)==109&&(C[1]|32)==105)return yl(C,j);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var M=3,L=512,U=0,H=0,se=0,me=0,re=0,ue=[],ce=C.slice(0,512);Fn(ce,0);var be=x(ce);switch(M=be[0],M){case 3:L=512;break;case 4:L=4096;break;case 0:if(be[1]==0)return Da(C,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}L!==512&&(ce=C.slice(0,L),Fn(ce,28));var Ie=C.slice(0,L);y(ce,M);var Ue=ce.read_shift(4,"i");if(M===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);ce.l+=4,se=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),me=ce.read_shift(4,"i"),U=ce.read_shift(4,"i"),re=ce.read_shift(4,"i"),H=ce.read_shift(4,"i");for(var Oe=-1,Le=0;Le<109&&(Oe=ce.read_shift(4,"i"),!(Oe<0));++Le)ue[Le]=Oe;var $e=T(C,L);w(re,H,$e,L,ue);var Et=Z($e,se,ue,L);Et[se].name="!Directory",U>0&&me!==P&&(Et[me].name="!MiniFAT"),Et[ue[0]].name="!FAT",Et.fat_addrs=ue,Et.ssz=L;var dt={},mt=[],wn=[],Ai=[];K(se,Et,$e,mt,U,dt,wn,me),b(wn,Ai,mt),mt.shift();var nn={FileIndex:wn,FullPaths:Ai};return j&&j.raw&&(nn.raw={header:Ie,sectors:$e}),nn}function x(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(qe,"Header Signature: "),C.l+=16;var j=C.read_shift(2,"u");return[C.read_shift(2,"u"),j]}function y(C,j){var M=9;switch(C.l+=2,M=C.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function T(C,j){for(var M=Math.ceil(C.length/j)-1,L=[],U=1;U<M;++U)L[U-1]=C.slice(U*j,(U+1)*j);return L[M-1]=C.slice(M*j),L}function b(C,j,M){for(var L=0,U=0,H=0,se=0,me=0,re=M.length,ue=[],ce=[];L<re;++L)ue[L]=ce[L]=L,j[L]=M[L];for(;me<ce.length;++me)L=ce[me],U=C[L].L,H=C[L].R,se=C[L].C,ue[L]===L&&(U!==-1&&ue[U]!==U&&(ue[L]=ue[U]),H!==-1&&ue[H]!==H&&(ue[L]=ue[H])),se!==-1&&(ue[se]=L),U!==-1&&L!=ue[L]&&(ue[U]=ue[L],ce.lastIndexOf(U)<me&&ce.push(U)),H!==-1&&L!=ue[L]&&(ue[H]=ue[L],ce.lastIndexOf(H)<me&&ce.push(H));for(L=1;L<re;++L)ue[L]===L&&(H!==-1&&ue[H]!==H?ue[L]=ue[H]:U!==-1&&ue[U]!==U&&(ue[L]=ue[U]));for(L=1;L<re;++L)if(C[L].type!==0){if(me=L,me!=ue[me])do me=ue[me],j[L]=j[me]+"/"+j[L];while(me!==0&&ue[me]!==-1&&me!=ue[me]);ue[L]=-1}for(j[0]+="/",L=1;L<re;++L)C[L].type!==2&&(j[L]+="/")}function S(C,j,M){for(var L=C.start,U=C.size,H=[],se=L;M&&U>0&&se>=0;)H.push(j.slice(se*B,se*B+B)),U-=B,se=Js(M,se*4);return H.length===0?_e(0):jr(H).slice(0,C.size)}function w(C,j,M,L,U){var H=P;if(C===P){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var se=M[C],me=(L>>>2)-1;if(!se)return;for(var re=0;re<me&&(H=Js(se,re*4))!==P;++re)U.push(H);w(Js(se,L-4),j-1,M,L,U)}}function G(C,j,M,L,U){var H=[],se=[];U||(U=[]);var me=L-1,re=0,ue=0;for(re=j;re>=0;){U[re]=!0,H[H.length]=re,se.push(C[re]);var ce=M[Math.floor(re*4/L)];if(ue=re*4&me,L<4+ue)throw new Error("FAT boundary crossed: "+re+" 4 "+L);if(!C[ce])break;re=Js(C[ce],ue)}return{nodes:H,data:gy([se])}}function Z(C,j,M,L){var U=C.length,H=[],se=[],me=[],re=[],ue=L-1,ce=0,be=0,Ie=0,Ue=0;for(ce=0;ce<U;++ce)if(me=[],Ie=ce+j,Ie>=U&&(Ie-=U),!se[Ie]){re=[];var Oe=[];for(be=Ie;be>=0;){Oe[be]=!0,se[be]=!0,me[me.length]=be,re.push(C[be]);var Le=M[Math.floor(be*4/L)];if(Ue=be*4&ue,L<4+Ue)throw new Error("FAT boundary crossed: "+be+" 4 "+L);if(!C[Le]||(be=Js(C[Le],Ue),Oe[be]))break}H[Ie]={nodes:me,data:gy([re])}}return H}function K(C,j,M,L,U,H,se,me){for(var re=0,ue=L.length?2:0,ce=j[C].data,be=0,Ie=0,Ue;be<ce.length;be+=128){var Oe=ce.slice(be,be+128);Fn(Oe,64),Ie=Oe.read_shift(2),Ue=ag(Oe,0,Ie-ue),L.push(Ue);var Le={name:Ue,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},$e=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);$e!==0&&(Le.ct=ne(Oe,Oe.l-8));var Et=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);Et!==0&&(Le.mt=ne(Oe,Oe.l-8)),Le.start=Oe.read_shift(4,"i"),Le.size=Oe.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=P,Le.name=""),Le.type===5?(re=Le.start,U>0&&re!==P&&(j[re].name="!StreamData")):Le.size>=4096?(Le.storage="fat",j[Le.start]===void 0&&(j[Le.start]=G(M,Le.start,j.fat_addrs,j.ssz)),j[Le.start].name=Le.name,Le.content=j[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:re!==P&&Le.start!==P&&j[re]&&(Le.content=S(Le,j[re].data,(j[me]||{}).data))),Le.content&&Fn(Le.content,0),H[Ue]=Le,se.push(Le)}}function ne(C,j){return new Date((Ln(C,j+4)/1e7*Math.pow(2,32)+Ln(C,j)/1e7-11644473600)*1e3)}function pe(C,j){return m(),v(g.readFileSync(C),j)}function Re(C,j){var M=j&&j.type;switch(M||wt&&Buffer.isBuffer(C)&&(M="buffer"),M||"base64"){case"file":return pe(C,j);case"base64":return v(fi(Aa(C)),j);case"binary":return v(fi(C),j)}return v(C,j)}function N(C,j){var M=j||{},L=M.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=L+"/",C.FileIndex[0]={name:L,type:5}),M.CLSID&&(C.FileIndex[0].clsid=M.CLSID),D(C)}function D(C){var j="Sh33tJ5";if(!Vt.find(C,"/"+j)){var M=_e(4);M[0]=55,M[1]=M[3]=50,M[2]=54,C.FileIndex.push({name:j,type:2,content:M,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+j),R(C)}}function R(C,j){N(C);for(var M=!1,L=!1,U=C.FullPaths.length-1;U>=0;--U){var H=C.FileIndex[U];switch(H.type){case 0:L?M=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(H.R*H.L*H.C)&&(M=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!j)){var se=new Date(1987,1,19),me=0,re=Object.create?Object.create(null):{},ue=[];for(U=0;U<C.FullPaths.length;++U)re[C.FullPaths[U]]=!0,C.FileIndex[U].type!==0&&ue.push([C.FullPaths[U],C.FileIndex[U]]);for(U=0;U<ue.length;++U){var ce=i(ue[U][0]);L=re[ce],L||(ue.push([ce,{name:s(ce).replace("/",""),type:1,clsid:J,ct:se,mt:se,content:null}]),re[ce]=!0)}for(ue.sort(function(Ue,Oe){return t(Ue[0],Oe[0])}),C.FullPaths=[],C.FileIndex=[],U=0;U<ue.length;++U)C.FullPaths[U]=ue[U][0],C.FileIndex[U]=ue[U][1];for(U=0;U<ue.length;++U){var be=C.FileIndex[U],Ie=C.FullPaths[U];if(be.name=s(Ie).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||J,U===0)be.C=ue.length>1?1:-1,be.size=0,be.type=5;else if(Ie.slice(-1)=="/"){for(me=U+1;me<ue.length&&i(C.FullPaths[me])!=Ie;++me);for(be.C=me>=ue.length?-1:me,me=U+1;me<ue.length&&i(C.FullPaths[me])!=i(Ie);++me);be.R=me>=ue.length?-1:me,be.type=1}else i(C.FullPaths[U+1]||"")==i(Ie)&&(be.R=U+1),be.type=2}}}function k(C,j){var M=j||{};if(M.fileType=="mad")return zt(C,M);switch(R(C),M.fileType){case"zip":return ii(C,M)}var L=function(Ue){for(var Oe=0,Le=0,$e=0;$e<Ue.FileIndex.length;++$e){var Et=Ue.FileIndex[$e];if(Et.content){var dt=Et.content.length;dt>0&&(dt<4096?Oe+=dt+63>>6:Le+=dt+511>>9)}}for(var mt=Ue.FullPaths.length+3>>2,wn=Oe+7>>3,Ai=Oe+127>>7,nn=wn+Le+mt+Ai,pn=nn+127>>7,Si=pn<=109?0:Math.ceil((pn-109)/127);nn+pn+Si+127>>7>pn;)Si=++pn<=109?0:Math.ceil((pn-109)/127);var an=[1,Si,pn,Ai,mt,Le,Oe,0];return Ue.FileIndex[0].size=Oe<<6,an[7]=(Ue.FileIndex[0].start=an[0]+an[1]+an[2]+an[3]+an[4]+an[5])+(an[6]+7>>3),an}(C),U=_e(L[7]<<9),H=0,se=0;{for(H=0;H<8;++H)U.write_shift(1,Be[H]);for(H=0;H<8;++H)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),H=0;H<3;++H)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,L[2]),U.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:P),U.write_shift(4,L[3]),U.write_shift(-4,L[1]?L[0]-1:P),U.write_shift(4,L[1]),H=0;H<109;++H)U.write_shift(-4,H<L[2]?L[1]+H:-1)}if(L[1])for(se=0;se<L[1];++se){for(;H<236+se*127;++H)U.write_shift(-4,H<L[2]?L[1]+H:-1);U.write_shift(-4,se===L[1]-1?P:se+1)}var me=function(Ue){for(se+=Ue;H<se-1;++H)U.write_shift(-4,H+1);Ue&&(++H,U.write_shift(-4,P))};for(se=H=0,se+=L[1];H<se;++H)U.write_shift(-4,ye.DIFSECT);for(se+=L[2];H<se;++H)U.write_shift(-4,ye.FATSECT);me(L[3]),me(L[4]);for(var re=0,ue=0,ce=C.FileIndex[0];re<C.FileIndex.length;++re)ce=C.FileIndex[re],ce.content&&(ue=ce.content.length,!(ue<4096)&&(ce.start=se,me(ue+511>>9)));for(me(L[6]+7>>3);U.l&511;)U.write_shift(-4,ye.ENDOFCHAIN);for(se=H=0,re=0;re<C.FileIndex.length;++re)ce=C.FileIndex[re],ce.content&&(ue=ce.content.length,!(!ue||ue>=4096)&&(ce.start=se,me(ue+63>>6)));for(;U.l&511;)U.write_shift(-4,ye.ENDOFCHAIN);for(H=0;H<L[4]<<2;++H){var be=C.FullPaths[H];if(!be||be.length===0){for(re=0;re<17;++re)U.write_shift(4,0);for(re=0;re<3;++re)U.write_shift(4,-1);for(re=0;re<12;++re)U.write_shift(4,0);continue}ce=C.FileIndex[H],H===0&&(ce.start=ce.size?ce.start-1:P);var Ie=H===0&&M.root||ce.name;if(ue=2*(Ie.length+1),U.write_shift(64,Ie,"utf16le"),U.write_shift(2,ue),U.write_shift(1,ce.type),U.write_shift(1,ce.color),U.write_shift(-4,ce.L),U.write_shift(-4,ce.R),U.write_shift(-4,ce.C),ce.clsid)U.write_shift(16,ce.clsid,"hex");else for(re=0;re<4;++re)U.write_shift(4,0);U.write_shift(4,ce.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,ce.start),U.write_shift(4,ce.size),U.write_shift(4,0)}for(H=1;H<C.FileIndex.length;++H)if(ce=C.FileIndex[H],ce.size>=4096)if(U.l=ce.start+1<<9,wt&&Buffer.isBuffer(ce.content))ce.content.copy(U,U.l,0,ce.size),U.l+=ce.size+511&-512;else{for(re=0;re<ce.size;++re)U.write_shift(1,ce.content[re]);for(;re&511;++re)U.write_shift(1,0)}for(H=1;H<C.FileIndex.length;++H)if(ce=C.FileIndex[H],ce.size>0&&ce.size<4096)if(wt&&Buffer.isBuffer(ce.content))ce.content.copy(U,U.l,0,ce.size),U.l+=ce.size+63&-64;else{for(re=0;re<ce.size;++re)U.write_shift(1,ce.content[re]);for(;re&63;++re)U.write_shift(1,0)}if(wt)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function F(C,j){var M=C.FullPaths.map(function(re){return re.toUpperCase()}),L=M.map(function(re){var ue=re.split("/");return ue[ue.length-(re.slice(-1)=="/"?2:1)]}),U=!1;j.charCodeAt(0)===47?(U=!0,j=M[0].slice(0,-1)+j):U=j.indexOf("/")!==-1;var H=j.toUpperCase(),se=U===!0?M.indexOf(H):L.indexOf(H);if(se!==-1)return C.FileIndex[se];var me=!H.match(i0);for(H=H.replace($u,""),me&&(H=H.replace(i0,"!")),se=0;se<M.length;++se)if((me?M[se].replace(i0,"!"):M[se]).replace($u,"")==H||(me?L[se].replace(i0,"!"):L[se]).replace($u,"")==H)return C.FileIndex[se];return null}var B=64,P=-2,qe="d0cf11e0a1b11ae1",Be=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",ye={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:qe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Pe(C,j,M){m();var L=k(C,M);g.writeFileSync(j,L)}function He(C){for(var j=new Array(C.length),M=0;M<C.length;++M)j[M]=String.fromCharCode(C[M]);return j.join("")}function W(C,j){var M=k(C,j);switch(j&&j.type||"buffer"){case"file":return m(),g.writeFileSync(j.filename,M),M;case"binary":return typeof M=="string"?M:He(M);case"base64":return dc(typeof M=="string"?M:He(M));case"buffer":if(wt)return Buffer.isBuffer(M)?M:wa(M);case"array":return typeof M=="string"?fi(M):M}return M}var xe;function V(C){try{var j=C.InflateRaw,M=new j;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)xe=C;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function X(C,j){if(!xe)return Ca(C,j);var M=xe.InflateRaw,L=new M,U=L._processChunk(C.slice(C.l),L._finishFlushFlag);return C.l+=L.bytesRead,U}function q(C){return xe?xe.deflateRawSync(C):As(C)}var Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(C){var j=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(j>>16|j>>8|j)&255}for(var Ne=typeof Uint8Array<"u",De=Ne?new Uint8Array(256):[],ut=0;ut<256;++ut)De[ut]=ve(ut);function rt(C,j){var M=De[C&255];return j<=8?M>>>8-j:(M=M<<8|De[C>>8&255],j<=16?M>>>16-j:(M=M<<8|De[C>>16&255],M>>>24-j))}function Wt(C,j){var M=j&7,L=j>>>3;return(C[L]|(M<=6?0:C[L+1]<<8))>>>M&3}function lt(C,j){var M=j&7,L=j>>>3;return(C[L]|(M<=5?0:C[L+1]<<8))>>>M&7}function tn(C,j){var M=j&7,L=j>>>3;return(C[L]|(M<=4?0:C[L+1]<<8))>>>M&15}function Bt(C,j){var M=j&7,L=j>>>3;return(C[L]|(M<=3?0:C[L+1]<<8))>>>M&31}function Ve(C,j){var M=j&7,L=j>>>3;return(C[L]|(M<=1?0:C[L+1]<<8))>>>M&127}function Xr(C,j,M){var L=j&7,U=j>>>3,H=(1<<M)-1,se=C[U]>>>L;return M<8-L||(se|=C[U+1]<<8-L,M<16-L)||(se|=C[U+2]<<16-L,M<24-L)||(se|=C[U+3]<<24-L),se&H}function rn(C,j,M){var L=j&7,U=j>>>3;return L<=5?C[U]|=(M&7)<<L:(C[U]|=M<<L&255,C[U+1]=(M&7)>>8-L),j+3}function hn(C,j,M){var L=j&7,U=j>>>3;return M=(M&1)<<L,C[U]|=M,j+1}function dn(C,j,M){var L=j&7,U=j>>>3;return M<<=L,C[U]|=M&255,M>>>=8,C[U+1]=M,j+8}function _l(C,j,M){var L=j&7,U=j>>>3;return M<<=L,C[U]|=M&255,M>>>=8,C[U+1]=M&255,C[U+2]=M>>>8,j+16}function pi(C,j){var M=C.length,L=2*M>j?2*M:j+5,U=0;if(M>=j)return C;if(wt){var H=ey(L);if(C.copy)C.copy(H);else for(;U<C.length;++U)H[U]=C[U];return H}else if(Ne){var se=new Uint8Array(L);if(se.set)se.set(C);else for(;U<M;++U)se[U]=C[U];return se}return C.length=L,C}function Yr(C){for(var j=new Array(C),M=0;M<C;++M)j[M]=0;return j}function Wi(C,j,M){var L=1,U=0,H=0,se=0,me=0,re=C.length,ue=Ne?new Uint16Array(32):Yr(32);for(H=0;H<32;++H)ue[H]=0;for(H=re;H<M;++H)C[H]=0;re=C.length;var ce=Ne?new Uint16Array(re):Yr(re);for(H=0;H<re;++H)ue[U=C[H]]++,L<U&&(L=U),ce[H]=0;for(ue[0]=0,H=1;H<=L;++H)ue[H+16]=me=me+ue[H-1]<<1;for(H=0;H<re;++H)me=C[H],me!=0&&(ce[H]=ue[me+16]++);var be=0;for(H=0;H<re;++H)if(be=C[H],be!=0)for(me=rt(ce[H],L)>>L-be,se=(1<<L+4-be)-1;se>=0;--se)j[me|se<<be]=be&15|H<<4;return L}var jt=Ne?new Uint16Array(512):Yr(512),yt=Ne?new Uint16Array(32):Yr(32);if(!Ne){for(var rr=0;rr<512;++rr)jt[rr]=0;for(rr=0;rr<32;++rr)yt[rr]=0}(function(){for(var C=[],j=0;j<32;j++)C.push(5);Wi(C,yt,32);var M=[];for(j=0;j<=143;j++)M.push(8);for(;j<=255;j++)M.push(9);for(;j<=279;j++)M.push(7);for(;j<=287;j++)M.push(8);Wi(M,jt,288)})();var Ar=function(){for(var j=Ne?new Uint8Array(32768):[],M=0,L=0;M<de.length-1;++M)for(;L<de[M+1];++L)j[L]=M;for(;L<32768;++L)j[L]=29;var U=Ne?new Uint8Array(259):[];for(M=0,L=0;M<oe.length-1;++M)for(;L<oe[M+1];++L)U[L]=M;function H(me,re){for(var ue=0;ue<me.length;){var ce=Math.min(65535,me.length-ue),be=ue+ce==me.length;for(re.write_shift(1,+be),re.write_shift(2,ce),re.write_shift(2,~ce&65535);ce-- >0;)re[re.l++]=me[ue++]}return re.l}function se(me,re){for(var ue=0,ce=0,be=Ne?new Uint16Array(32768):[];ce<me.length;){var Ie=Math.min(65535,me.length-ce);if(Ie<10){for(ue=rn(re,ue,+(ce+Ie==me.length)),ue&7&&(ue+=8-(ue&7)),re.l=ue/8|0,re.write_shift(2,Ie),re.write_shift(2,~Ie&65535);Ie-- >0;)re[re.l++]=me[ce++];ue=re.l*8;continue}ue=rn(re,ue,+(ce+Ie==me.length)+2);for(var Ue=0;Ie-- >0;){var Oe=me[ce];Ue=(Ue<<5^Oe)&32767;var Le=-1,$e=0;if((Le=be[Ue])&&(Le|=ce&-32768,Le>ce&&(Le-=32768),Le<ce))for(;me[Le+$e]==me[ce+$e]&&$e<250;)++$e;if($e>2){Oe=U[$e],Oe<=22?ue=dn(re,ue,De[Oe+1]>>1)-1:(dn(re,ue,3),ue+=5,dn(re,ue,De[Oe-23]>>5),ue+=3);var Et=Oe<8?0:Oe-4>>2;Et>0&&(_l(re,ue,$e-oe[Oe]),ue+=Et),Oe=j[ce-Le],ue=dn(re,ue,De[Oe]>>3),ue-=3;var dt=Oe<4?0:Oe-2>>1;dt>0&&(_l(re,ue,ce-Le-de[Oe]),ue+=dt);for(var mt=0;mt<$e;++mt)be[Ue]=ce&32767,Ue=(Ue<<5^me[ce])&32767,++ce;Ie-=$e-1}else Oe<=143?Oe=Oe+48:ue=hn(re,ue,1),ue=dn(re,ue,De[Oe]),be[Ue]=ce&32767,++ce}ue=dn(re,ue,0)-1}return re.l=(ue+7)/8|0,re.l}return function(re,ue){return re.length<8?H(re,ue):se(re,ue)}}();function As(C){var j=_e(50+Math.floor(C.length*1.1)),M=Ar(C,j);return j.slice(0,M)}var xl=Ne?new Uint16Array(32768):Yr(32768),vi=Ne?new Uint16Array(32768):Yr(32768),_i=Ne?new Uint16Array(128):Yr(128),xi=1,mn=1;function Ra(C,j){var M=Bt(C,j)+257;j+=5;var L=Bt(C,j)+1;j+=5;var U=tn(C,j)+4;j+=4;for(var H=0,se=Ne?new Uint8Array(19):Yr(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,ue=Ne?new Uint8Array(8):Yr(8),ce=Ne?new Uint8Array(8):Yr(8),be=se.length,Ie=0;Ie<U;++Ie)se[Q[Ie]]=H=lt(C,j),re<H&&(re=H),ue[H]++,j+=3;var Ue=0;for(ue[0]=0,Ie=1;Ie<=re;++Ie)ce[Ie]=Ue=Ue+ue[Ie-1]<<1;for(Ie=0;Ie<be;++Ie)(Ue=se[Ie])!=0&&(me[Ie]=ce[Ue]++);var Oe=0;for(Ie=0;Ie<be;++Ie)if(Oe=se[Ie],Oe!=0){Ue=De[me[Ie]]>>8-Oe;for(var Le=(1<<7-Oe)-1;Le>=0;--Le)_i[Ue|Le<<Oe]=Oe&7|Ie<<3}var $e=[];for(re=1;$e.length<M+L;)switch(Ue=_i[Ve(C,j)],j+=Ue&7,Ue>>>=3){case 16:for(H=3+Wt(C,j),j+=2,Ue=$e[$e.length-1];H-- >0;)$e.push(Ue);break;case 17:for(H=3+lt(C,j),j+=3;H-- >0;)$e.push(0);break;case 18:for(H=11+Ve(C,j),j+=7;H-- >0;)$e.push(0);break;default:$e.push(Ue),re<Ue&&(re=Ue);break}var Et=$e.slice(0,M),dt=$e.slice(M);for(Ie=M;Ie<286;++Ie)Et[Ie]=0;for(Ie=L;Ie<30;++Ie)dt[Ie]=0;return xi=Wi(Et,xl,286),mn=Wi(dt,vi,30),j}function Qi(C,j){if(C[0]==3&&!(C[1]&3))return[ol(j),2];for(var M=0,L=0,U=ey(j||1<<18),H=0,se=U.length>>>0,me=0,re=0;(L&1)==0;){if(L=lt(C,M),M+=3,L>>>1)L>>1==1?(me=9,re=5):(M=Ra(C,M),me=xi,re=mn);else{M&7&&(M+=8-(M&7));var ue=C[M>>>3]|C[(M>>>3)+1]<<8;if(M+=32,ue>0)for(!j&&se<H+ue&&(U=pi(U,H+ue),se=U.length);ue-- >0;)U[H++]=C[M>>>3],M+=8;continue}for(;;){!j&&se<H+32767&&(U=pi(U,H+32767),se=U.length);var ce=Xr(C,M,me),be=L>>>1==1?jt[ce]:xl[ce];if(M+=be&15,be>>>=4,(be>>>8&255)===0)U[H++]=be;else{if(be==256)break;be-=257;var Ie=be<8?0:be-4>>2;Ie>5&&(Ie=0);var Ue=H+oe[be];Ie>0&&(Ue+=Xr(C,M,Ie),M+=Ie),ce=Xr(C,M,re),be=L>>>1==1?yt[ce]:vi[ce],M+=be&15,be>>>=4;var Oe=be<4?0:be-2>>1,Le=de[be];for(Oe>0&&(Le+=Xr(C,M,Oe),M+=Oe),!j&&se<Ue&&(U=pi(U,Ue+100),se=U.length);H<Ue;)U[H]=U[H-Le],++H}}}return j?[U,M+7>>>3]:[U.slice(0,H),M+7>>>3]}function Ca(C,j){var M=C.slice(C.l||0),L=Qi(M,j);return C.l+=L[1],L[0]}function ba(C,j){if(C)typeof console<"u"&&console.error(j);else throw new Error(j)}function Da(C,j){var M=C;Fn(M,0);var L=[],U=[],H={FileIndex:L,FullPaths:U};N(H,{root:j.root});for(var se=M.length-4;(M[se]!=80||M[se+1]!=75||M[se+2]!=5||M[se+3]!=6)&&se>=0;)--se;M.l=se+4,M.l+=4;var me=M.read_shift(2);M.l+=6;var re=M.read_shift(4);for(M.l=re,se=0;se<me;++se){M.l+=20;var ue=M.read_shift(4),ce=M.read_shift(4),be=M.read_shift(2),Ie=M.read_shift(2),Ue=M.read_shift(2);M.l+=8;var Oe=M.read_shift(4),Le=h(M.slice(M.l+be,M.l+be+Ie));M.l+=be+Ie+Ue;var $e=M.l;M.l=Oe+4,ni(M,ue,ce,H,Le),M.l=$e}return H}function ni(C,j,M,L,U){C.l+=2;var H=C.read_shift(2),se=C.read_shift(2),me=u(C);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var re=C.read_shift(4),ue=C.read_shift(4),ce=C.read_shift(4),be=C.read_shift(2),Ie=C.read_shift(2),Ue="",Oe=0;Oe<be;++Oe)Ue+=String.fromCharCode(C[C.l++]);if(Ie){var Le=h(C.slice(C.l,C.l+Ie));(Le[21589]||{}).mt&&(me=Le[21589].mt),((U||{})[21589]||{}).mt&&(me=U[21589].mt)}C.l+=Ie;var $e=C.slice(C.l,C.l+ue);switch(se){case 8:$e=X(C,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var Et=!1;H&8&&(re=C.read_shift(4),re==134695760&&(re=C.read_shift(4),Et=!0),ue=C.read_shift(4),ce=C.read_shift(4)),ue!=j&&ba(Et,"Bad compressed size: "+j+" != "+ue),ce!=M&&ba(Et,"Bad uncompressed size: "+M+" != "+ce),Yt(L,Ue,$e,{unsafe:!0,mt:me})}function ii(C,j){var M=j||{},L=[],U=[],H=_e(1),se=M.compression?8:0,me=0,re=0,ue=0,ce=0,be=0,Ie=C.FullPaths[0],Ue=Ie,Oe=C.FileIndex[0],Le=[],$e=0;for(re=1;re<C.FullPaths.length;++re)if(Ue=C.FullPaths[re].slice(Ie.length),Oe=C.FileIndex[re],!(!Oe.size||!Oe.content||Ue=="Sh33tJ5")){var Et=ce,dt=_e(Ue.length);for(ue=0;ue<Ue.length;++ue)dt.write_shift(1,Ue.charCodeAt(ue)&127);dt=dt.slice(0,dt.l),Le[be]=I6.buf(Oe.content,0);var mt=Oe.content;se==8&&(mt=q(mt)),H=_e(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,me),H.write_shift(2,se),Oe.mt?o(H,Oe.mt):H.write_shift(4,0),H.write_shift(-4,Le[be]),H.write_shift(4,mt.length),H.write_shift(4,Oe.content.length),H.write_shift(2,dt.length),H.write_shift(2,0),ce+=H.length,L.push(H),ce+=dt.length,L.push(dt),ce+=mt.length,L.push(mt),H=_e(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,me),H.write_shift(2,se),H.write_shift(4,0),H.write_shift(-4,Le[be]),H.write_shift(4,mt.length),H.write_shift(4,Oe.content.length),H.write_shift(2,dt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,Et),$e+=H.l,U.push(H),$e+=dt.length,U.push(dt),++be}return H=_e(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,be),H.write_shift(2,be),H.write_shift(4,$e),H.write_shift(4,ce),H.write_shift(2,0),jr([jr(L),jr(U),H])}var yi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Un(C,j){if(C.ctype)return C.ctype;var M=C.name||"",L=M.match(/\.([^\.]+)$/);return L&&yi[L[1]]||j&&(L=(M=j).match(/[\.\\]([^\.\\])+$/),L&&yi[L[1]])?yi[L[1]]:"application/octet-stream"}function Ss(C){for(var j=dc(C),M=[],L=0;L<j.length;L+=76)M.push(j.slice(L,L+76));return M.join(`\r
`)+`\r
`}function Ei(C){var j=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var ce=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],L=j.split(`\r
`),U=0;U<L.length;++U){var H=L[U];if(H.length==0){M.push("");continue}for(var se=0;se<H.length;){var me=76,re=H.slice(se,se+me);re.charAt(me-1)=="="?me--:re.charAt(me-2)=="="?me-=2:re.charAt(me-3)=="="&&(me-=3),re=H.slice(se,se+me),se+=me,se<H.length&&(re+="="),M.push(re)}}return M.join(`\r
`)}function Na(C){for(var j=[],M=0;M<C.length;++M){for(var L=C[M];M<=C.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+C[++M];j.push(L)}for(var U=0;U<j.length;++U)j[U]=j[U].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return fi(j.join(`\r
`))}function Ti(C,j,M){for(var L="",U="",H="",se,me=0;me<10;++me){var re=j[me];if(!re||re.match(/^\s*$/))break;var ue=re.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":L=ue[2].trim();break;case"content-type":H=ue[2].trim();break;case"content-transfer-encoding":U=ue[2].trim();break}}switch(++me,U.toLowerCase()){case"base64":se=fi(Aa(j.slice(me).join("")));break;case"quoted-printable":se=Na(j.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var ce=Yt(C,L.slice(M.length),se,{unsafe:!0});H&&(ce.ctype=H)}function yl(C,j){if(He(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=j&&j.root||"",L=(wt&&Buffer.isBuffer(C)?C.toString("binary"):He(C)).split(`\r
`),U=0,H="";for(U=0;U<L.length;++U)if(H=L[U],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),M||(M=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),H.slice(0,M.length)!=M););var se=(L[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var me="--"+(se[1]||""),re=[],ue=[],ce={FileIndex:re,FullPaths:ue};N(ce);var be,Ie=0;for(U=0;U<L.length;++U){var Ue=L[U];Ue!==me&&Ue!==me+"--"||(Ie++&&Ti(ce,L.slice(be,U),M),be=U)}return ce}function zt(C,j){var M=j||{},L=M.boundary||"SheetJS";L="------="+L;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],H=C.FullPaths[0],se=H,me=C.FileIndex[0],re=1;re<C.FullPaths.length;++re)if(se=C.FullPaths[re].slice(H.length),me=C.FileIndex[re],!(!me.size||!me.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($e){return"_x"+$e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($e){return"_u"+$e.charCodeAt(0).toString(16)+"_"});for(var ue=me.content,ce=wt&&Buffer.isBuffer(ue)?ue.toString("binary"):He(ue),be=0,Ie=Math.min(1024,ce.length),Ue=0,Oe=0;Oe<=Ie;++Oe)(Ue=ce.charCodeAt(Oe))>=32&&Ue<128&&++be;var Le=be>=Ie*4/5;U.push(L),U.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+se),U.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),U.push("Content-Type: "+Un(me,se)),U.push(""),U.push(Le?Ei(ce):Ss(ce))}return U.push(L+`--\r
`),U.join(`\r
`)}function nr(C){var j={};return N(j,C),j}function Yt(C,j,M,L){var U=L&&L.unsafe;U||N(C);var H=!U&&Vt.find(C,j);if(!H){var se=C.FullPaths[0];j.slice(0,se.length)==se?se=j:(se.slice(-1)!="/"&&(se+="/"),se=(se+j).replace("//","/")),H={name:s(j),type:2},C.FileIndex.push(H),C.FullPaths.push(se),U||Vt.utils.cfb_gc(C)}return H.content=M,H.size=M?M.length:0,L&&(L.CLSID&&(H.clsid=L.CLSID),L.mt&&(H.mt=L.mt),L.ct&&(H.ct=L.ct)),H}function gn(C,j){N(C);var M=Vt.find(C,j);if(M){for(var L=0;L<C.FileIndex.length;++L)if(C.FileIndex[L]==M)return C.FileIndex.splice(L,1),C.FullPaths.splice(L,1),!0}return!1}function ws(C,j,M){N(C);var L=Vt.find(C,j);if(L){for(var U=0;U<C.FileIndex.length;++U)if(C.FileIndex[U]==L)return C.FileIndex[U].name=s(M),C.FullPaths[U]=M,!0}return!1}function Vo(C){R(C,!0)}return e.find=F,e.read=Re,e.parse=v,e.write=W,e.writeFile=Pe,e.utils={cfb_new:nr,cfb_add:Yt,cfb_del:gn,cfb_mov:ws,cfb_gc:Vo,ReadShift:Ju,CheckField:oT,prep_blob:Fn,bconcat:jr,use_zlib:V,_deflateRaw:As,_inflateRaw:Ca,consts:ye},e}();function k6(r){return typeof r=="string"?oh(r):Array.isArray(r)?a6(r):r}function bc(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=oh(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var i=t=="utf8"?gc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,r);if(typeof Blob<"u"){var s=new Blob([k6(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,r);if(typeof saveAs<"u")return saveAs(s,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:r,saveAs:!0});var u=document.createElement("a");if(u.download!=null)return u.download=r,u.href=o,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(r);return h.open("w"),h.encoding="binary",Array.isArray(e)&&(e=Cc(e)),h.write(e),h.close(),e}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+r)}function qr(r){for(var e=Object.keys(r),t=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(r,e[i])&&t.push(e[i]);return t}function oy(r,e){for(var t=[],i=qr(r),s=0;s!==i.length;++s)t[r[i[s]][e]]==null&&(t[r[i[s]][e]]=i[s]);return t}function tg(r){for(var e=[],t=qr(r),i=0;i!==t.length;++i)e[r[t[i]]]=t[i];return e}function fh(r){for(var e=[],t=qr(r),i=0;i!==t.length;++i)e[r[t[i]]]=parseInt(t[i],10);return e}function M6(r){for(var e=[],t=qr(r),i=0;i!==t.length;++i)e[r[t[i]]]==null&&(e[r[t[i]]]=[]),e[r[t[i]]].push(t[i]);return e}var L0=new Date(1899,11,30,0,0,0);function An(r,e){var t=r.getTime(),i=L0.getTime()+(r.getTimezoneOffset()-L0.getTimezoneOffset())*6e4;return(t-i)/(24*60*60*1e3)}var qE=new Date,F6=L0.getTime()+(qE.getTimezoneOffset()-L0.getTimezoneOffset())*6e4,uy=qE.getTimezoneOffset();function XE(r){var e=new Date;return e.setTime(r*24*60*60*1e3+F6),e.getTimezoneOffset()!==uy&&e.setTime(e.getTime()+(e.getTimezoneOffset()-uy)*6e4),e}var cy=new Date("2017-02-19T19:06:09.000Z"),YE=isNaN(cy.getFullYear())?new Date("2/19/17"):cy,P6=YE.getFullYear()==2017;function fn(r,e){var t=new Date(r);if(P6)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(YE.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return r.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var s=r.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return r.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function hh(r,e){if(wt&&Buffer.isBuffer(r))return r.toString("binary");if(typeof TextDecoder<"u")try{var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return t[o]||o})}catch{}for(var i=[],s=0;s!=r.length;++s)i.push(String.fromCharCode(r[s]));return i.join("")}function Sn(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Sn(r[t]));return e}function er(r,e){for(var t="";t.length<e;)t+=r;return t}function _a(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,i=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,o){return t=-t,o}),!isNaN(e=Number(i)))?e/t:e}var L6=["january","february","march","april","may","june","july","august","september","october","november","december"];function mc(r){var e=new Date(r),t=new Date(NaN),i=e.getYear(),s=e.getMonth(),o=e.getDate();if(isNaN(o))return t;var u=r.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&L6.indexOf(u)==-1)return t}else if(u.match(/[a-z]/))return t;return i<0||i>8099?t:(s>0||o>1)&&i!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}function it(r,e,t){if(r.FullPaths){if(typeof t=="string"){var i;return wt?i=wa(t):i=s6(t),Vt.utils.cfb_add(r,e,i)}Vt.utils.cfb_add(r,e,t)}else r.file(e,t)}function rg(){return Vt.utils.cfb_new()}var pr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,V6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ng=tg(V6),ig=/[&<>'"]/g,B6=/[\u0000-\u0008\u000b-\u001f]/g;function It(r){var e=r+"";return e.replace(ig,function(t){return ng[t]}).replace(B6,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function fy(r){return It(r).replace(/ /g,"_x0020_")}var KE=/[\u0000-\u001f]/g;function U6(r){var e=r+"";return e.replace(ig,function(t){return ng[t]}).replace(/\n/g,"<br/>").replace(KE,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function j6(r){var e=r+"";return e.replace(ig,function(t){return ng[t]}).replace(KE,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function z6(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function H6(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function b1(r){for(var e="",t=0,i=0,s=0,o=0,u=0,h=0;t<r.length;){if(i=r.charCodeAt(t++),i<128){e+=String.fromCharCode(i);continue}if(s=r.charCodeAt(t++),i>191&&i<224){u=(i&31)<<6,u|=s&63,e+=String.fromCharCode(u);continue}if(o=r.charCodeAt(t++),i<240){e+=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63);continue}u=r.charCodeAt(t++),h=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536,e+=String.fromCharCode(55296+(h>>>10&1023)),e+=String.fromCharCode(56320+(h&1023))}return e}function hy(r){var e=ol(2*r.length),t,i,s=1,o=0,u=0,h;for(i=0;i<r.length;i+=s)s=1,(h=r.charCodeAt(i))<128?t=h:h<224?(t=(h&31)*64+(r.charCodeAt(i+1)&63),s=2):h<240?(t=(h&15)*4096+(r.charCodeAt(i+1)&63)*64+(r.charCodeAt(i+2)&63),s=3):(s=4,t=(h&7)*262144+(r.charCodeAt(i+1)&63)*4096+(r.charCodeAt(i+2)&63)*64+(r.charCodeAt(i+3)&63),t-=65536,u=55296+(t>>>10&1023),t=56320+(t&1023)),u!==0&&(e[o++]=u&255,e[o++]=u>>>8,u=0),e[o++]=t%256,e[o++]=t>>>8;return e.slice(0,o).toString("ucs2")}function dy(r){return wa(r,"binary").toString("utf8")}var s0="foo bar bazâð£",Zu=wt&&(dy(s0)==b1(s0)&&dy||hy(s0)==b1(s0)&&hy)||b1,gc=wt?function(r){return wa(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,i=0,s=0;t<r.length;)switch(i=r.charCodeAt(t++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=r.charCodeAt(t++)-56320+(i<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},G6=function(){var r=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<r.length;++s)i=i.replace(r[s][0],r[s][1]);return i}}(),WE=/(^\s|\s$|\n)/;function zr(r,e){return"<"+r+(e.match(WE)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function pc(r){return qr(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function ke(r,e,t){return"<"+r+(t!=null?pc(t):"")+(e!=null?(e.match(WE)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function lm(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function q6(r,e){switch(typeof r){case"string":var t=ke("vt:lpwstr",It(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return ke((r|0)==r?"vt:i4":"vt:r8",It(String(r)));case"boolean":return ke("vt:bool",r?"true":"false")}if(r instanceof Date)return ke("vt:filetime",lm(r));throw new Error("Unable to serialize "+r)}var Nr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Mo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function X6(r,e){for(var t=1-2*(r[e+7]>>>7),i=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),s=r[e+6]&15,o=5;o>=0;--o)s=s*256+r[e+o];return i==2047?s==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),t*Math.pow(2,i-52)*s)}function Y6(r,e,t){var i=(e<0||1/e==-1/0?1:0)<<7,s=0,o=0,u=i?-e:e;isFinite(u)?u==0?s=o=0:(s=Math.floor(Math.log(u)/Math.LN2),o=u*Math.pow(2,52-s),s<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?s=-1022:(o-=Math.pow(2,52),s+=1023)):(s=2047,o=isNaN(e)?26985:0);for(var h=0;h<=5;++h,o/=256)r[t+h]=o&255;r[t+6]=(s&15)<<4|o&15,r[t+7]=s>>4|i}var my=function(r){for(var e=[],t=10240,i=0;i<r[0].length;++i)if(r[0][i])for(var s=0,o=r[0][i].length;s<o;s+=t)e.push.apply(e,r[0][i].slice(s,s+t));return e},gy=wt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:wa(e)})):my(r)}:my,py=function(r,e,t){for(var i=[],s=e;s<t;s+=2)i.push(String.fromCharCode(qu(r,s)));return i.join("").replace($u,"")},ag=wt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace($u,""):py(r,e,t)}:py,vy=function(r,e,t){for(var i=[],s=e;s<e+t;++s)i.push(("0"+r[s].toString(16)).slice(-2));return i.join("")},QE=wt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):vy(r,e,t)}:vy,_y=function(r,e,t){for(var i=[],s=e;s<t;s++)i.push(String.fromCharCode(mo(r,s)));return i.join("")},Dc=wt?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):_y(e,t,i)}:_y,$E=function(r,e){var t=Ln(r,e);return t>0?Dc(r,e+4,e+4+t-1):""},ZE=$E,JE=function(r,e){var t=Ln(r,e);return t>0?Dc(r,e+4,e+4+t-1):""},eT=JE,tT=function(r,e){var t=2*Ln(r,e);return t>0?Dc(r,e+4,e+4+t-1):""},rT=tT,nT=function(e,t){var i=Ln(e,t);return i>0?ag(e,t+4,t+4+i):""},iT=nT,aT=function(r,e){var t=Ln(r,e);return t>0?Dc(r,e+4,e+4+t):""},sT=aT,lT=function(r,e){return X6(r,e)},V0=lT,sg=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};wt&&(ZE=function(e,t){if(!Buffer.isBuffer(e))return $E(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},eT=function(e,t){if(!Buffer.isBuffer(e))return JE(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},rT=function(e,t){if(!Buffer.isBuffer(e))return tT(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},iT=function(e,t){if(!Buffer.isBuffer(e))return nT(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},sT=function(e,t){if(!Buffer.isBuffer(e))return aT(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},V0=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):lT(e,t)},sg=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var mo=function(r,e){return r[e]},qu=function(r,e){return r[e+1]*256+r[e]},K6=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},Ln=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},Js=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},W6=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function Ju(r,e){var t="",i,s,o=[],u,h,g,m;switch(e){case"dbcs":if(m=this.l,wt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(g=0;g<r;++g)t+=String.fromCharCode(qu(this,m)),m+=2;r*=2;break;case"utf8":t=Dc(this,this.l,this.l+r);break;case"utf16le":r*=2,t=ag(this,this.l,this.l+r);break;case"wstr":return Ju.call(this,r,"dbcs");case"lpstr-ansi":t=ZE(this,this.l),r=4+Ln(this,this.l);break;case"lpstr-cp":t=eT(this,this.l),r=4+Ln(this,this.l);break;case"lpwstr":t=rT(this,this.l),r=4+2*Ln(this,this.l);break;case"lpp4":r=4+Ln(this,this.l),t=iT(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Ln(this,this.l),t=sT(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(u=mo(this,this.l+r++))!==0;)o.push(n0(u));t=o.join("");break;case"_wstr":for(r=0,t="";(u=qu(this,this.l+r))!==0;)o.push(n0(u)),r+=2;r+=2,t=o.join("");break;case"dbcs-cont":for(t="",m=this.l,g=0;g<r;++g){if(this.lens&&this.lens.indexOf(m)!==-1)return u=mo(this,m),this.l=m+1,h=Ju.call(this,r-g,u?"dbcs-cont":"sbcs-cont"),o.join("")+h;o.push(n0(qu(this,m))),m+=2}t=o.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,g=0;g!=r;++g){if(this.lens&&this.lens.indexOf(m)!==-1)return u=mo(this,m),this.l=m+1,h=Ju.call(this,r-g,u?"dbcs-cont":"sbcs-cont"),o.join("")+h;o.push(n0(mo(this,m))),m+=1}t=o.join("");break;default:switch(r){case 1:return i=mo(this,this.l),this.l++,i;case 2:return i=(e==="i"?K6:qu)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(i=(r>0?Js:W6)(this,this.l),this.l+=4,i):(s=Ln(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return r==8?s=V0(this,this.l):s=V0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;r=8;case 16:t=QE(this,this.l,r);break}}return this.l+=r,t}var Q6=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},$6=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},Z6=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function J6(r,e,t){var i=0,s=0;if(t==="dbcs"){for(s=0;s!=e.length;++s)Z6(this,e.charCodeAt(s),this.l+2*s);i=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;i=e.length}else if(t==="hex"){for(;s<r;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+r,this.length);for(s=0;s<Math.min(e.length,r);++s){var u=e.charCodeAt(s);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(r){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,Q6(this,e,this.l);break;case 8:if(i=8,t==="f"){Y6(this,e,this.l);break}case 16:break;case-4:i=4,$6(this,e,this.l);break}return this.l+=i,this}function oT(r,e){var t=QE(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function Fn(r,e){r.l=e,r.read_shift=Ju,r.chk=oT,r.write_shift=J6}function Ki(r,e){r.l+=e}function _e(r){var e=ol(r);return Fn(e,0),e}function Tn(){var r=[],e=wt?256:2048,t=function(m){var v=_e(m);return Fn(v,0),v},i=t(e),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&r.push(i),i=null)},o=function(m){return i&&m<i.length-i.l?i:(s(),i=t(Math.max(m+1,e)))},u=function(){return s(),jr(r)},h=function(m){s(),i=m,i.l==null&&(i.l=i.length),o(e)};return{next:o,push:h,end:u,_bufs:r}}function Ce(r,e,t,i){var s=+e,o;if(!isNaN(s)){i||(i=X8[s].p||(t||[]).length||0),o=1+(s>=128?1:0)+1,i>=128&&++o,i>=16384&&++o,i>=2097152&&++o;var u=r.next(o);s<=127?u.write_shift(1,s):(u.write_shift(1,(s&127)+128),u.write_shift(1,s>>7));for(var h=0;h!=4;++h)if(i>=128)u.write_shift(1,(i&127)+128),i>>=7;else{u.write_shift(1,i);break}i>0&&sg(t)&&r.push(t)}}function ec(r,e,t){var i=Sn(r);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function xy(r,e,t){var i=Sn(r);return i.s=ec(i.s,e.s,t),i.e=ec(i.e,e.s,t),i}function tc(r,e){if(r.cRel&&r.c<0)for(r=Sn(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Sn(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=kt(r);return!r.cRel&&r.cRel!=null&&(t=rb(t)),!r.rRel&&r.rRel!=null&&(t=eb(t)),t}function D1(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Jr(r.s.c)+":"+(r.e.cRel?"":"$")+Jr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Hr(r.s.r)+":"+(r.e.rRel?"":"$")+Hr(r.e.r):tc(r.s,e.biff)+":"+tc(r.e,e.biff)}function lg(r){return parseInt(tb(r),10)-1}function Hr(r){return""+(r+1)}function eb(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function tb(r){return r.replace(/\$(\d+)$/,"$1")}function og(r){for(var e=nb(r),t=0,i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}function Jr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function rb(r){return r.replace(/^([A-Z])/,"$$$1")}function nb(r){return r.replace(/^\$([A-Z])/,"$1")}function ib(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Or(r){for(var e=0,t=0,i=0;i<r.length;++i){var s=r.charCodeAt(i);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:e-1}}function kt(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function Bn(r){var e=r.indexOf(":");return e==-1?{s:Or(r),e:Or(r)}:{s:Or(r.slice(0,e)),e:Or(r.slice(e+1))}}function gr(r,e){return typeof e>"u"||typeof e=="number"?gr(r.s,r.e):(typeof r!="string"&&(r=kt(r)),typeof e!="string"&&(e=kt(e)),r==e?r:r+":"+e)}function Xt(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,s=0,o=r.length;for(t=0;i<o&&!((s=r.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(e.s.c=--t,t=0;i<o&&!((s=r.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;if(e.s.r=--t,i===o||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,t=0;i!=o&&!((s=r.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(e.e.c=--t,t=0;i!=o&&!((s=r.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;return e.e.r=--t,e}function yy(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=ps(r.z,t?An(e):e)}catch{}try{return r.w=ps((r.XF||{}).numFmtId||(t?14:0),t?An(e):e)}catch{return""+e}}function Sa(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Nc[r.v]||r.v:e==null?yy(r,r.v):yy(r,e))}function dl(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",i={};return i[t]=r,{SheetNames:[t],Sheets:i}}function uT(r,e,t){var i=t||{},s=r?Array.isArray(r):i.dense,o=r||(s?[]:{}),u=0,h=0;if(o&&i.origin!=null){if(typeof i.origin=="number")u=i.origin;else{var g=typeof i.origin=="string"?Or(i.origin):i.origin;u=g.r,h=g.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var v=Xt(o["!ref"]);m.s.c=v.s.c,m.s.r=v.s.r,m.e.c=Math.max(m.e.c,v.e.c),m.e.r=Math.max(m.e.r,v.e.r),u==-1&&(m.e.r=u=v.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[x].length;++y)if(!(typeof e[x][y]>"u")){var T={v:e[x][y]},b=u+x,S=h+y;if(m.s.r>b&&(m.s.r=b),m.s.c>S&&(m.s.c=S),m.e.r<b&&(m.e.r=b),m.e.c<S&&(m.e.c=S),e[x][y]&&typeof e[x][y]=="object"&&!Array.isArray(e[x][y])&&!(e[x][y]instanceof Date))T=e[x][y];else if(Array.isArray(T.v)&&(T.f=e[x][y][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(i.nullError)T.t="e",T.v=0;else if(i.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=i.dateNF||tr[14],i.cellDates?(T.t="d",T.w=ps(T.z,An(T.v))):(T.t="n",T.v=An(T.v),T.w=ps(T.z,T.v))):T.t="s";if(s)o[b]||(o[b]=[]),o[b][S]&&o[b][S].z&&(T.z=o[b][S].z),o[b][S]=T;else{var w=kt({c:S,r:b});o[w]&&o[w].z&&(T.z=o[w].z),o[w]=T}}}return m.s.c<1e7&&(o["!ref"]=gr(m)),o}function Fo(r,e){return uT(null,r,e)}function ab(r){return r.read_shift(4,"i")}function mi(r,e){return e||(e=_e(4)),e.write_shift(4,r),e}function en(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function Ir(r,e){var t=!1;return e==null&&(t=!0,e=_e(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function sb(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function lb(r,e){return e||(e=_e(4)),e.write_shift(2,0),e.write_shift(2,0),e}function ug(r,e){var t=r.l,i=r.read_shift(1),s=en(r),o=[],u={t:s,h:s};if((i&1)!==0){for(var h=r.read_shift(4),g=0;g!=h;++g)o.push(sb(r));u.r=o}else u.r=[{ich:0,ifnt:0}];return r.l=t+e,u}function ob(r,e){var t=!1;return e==null&&(t=!0,e=_e(15+4*r.t.length)),e.write_shift(1,0),Ir(r.t,e),t?e.slice(0,e.l):e}var ub=ug;function cb(r,e){var t=!1;return e==null&&(t=!0,e=_e(23+4*r.t.length)),e.write_shift(1,1),Ir(r.t,e),e.write_shift(4,1),lb({},e),t?e.slice(0,e.l):e}function ri(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function ml(r,e){return e==null&&(e=_e(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function gl(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function pl(r,e){return e==null&&(e=_e(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var fb=en,cT=Ir;function cg(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function B0(r,e){var t=!1;return e==null&&(t=!0,e=_e(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var hb=en,om=cg,fg=B0;function fT(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,i=e[0]&2;r.l+=4;var s=i===0?V0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Js(e,0)>>2;return t?s/100:s}function hT(r,e){e==null&&(e=_e(4));var t=0,i=0,s=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?i=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(i=1,t=1),i)e.write_shift(-4,((t?s:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function dT(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function db(r,e){return e||(e=_e(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var vl=dT,Po=db;function Lo(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function ul(r,e){return(e||_e(8)).write_shift(8,r,"f")}function mb(r){var e={},t=r.read_shift(1),i=t>>>1,s=r.read_shift(1),o=r.read_shift(2,"i"),u=r.read_shift(1),h=r.read_shift(1),g=r.read_shift(1);switch(r.l++,i){case 0:e.auto=1;break;case 1:e.index=s;var m=Ab[s];m&&(e.rgb=Oy(m));break;case 2:e.rgb=Oy([u,h,g]);break;case 3:e.theme=s;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function U0(r,e){if(e||(e=_e(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var i=r.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),e.write_shift(1,parseInt(i.slice(0,2),16)),e.write_shift(1,parseInt(i.slice(2,4),16)),e.write_shift(1,parseInt(i.slice(4,6),16)),e.write_shift(1,255)}return e}function gb(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function pb(r,e){e||(e=_e(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var mT=2,Mn=3,l0=11,j0=19,o0=64,vb=65,_b=71,xb=4108,yb=4126,Vr=80,Ey={1:{n:"CodePage",t:mT},2:{n:"Category",t:Vr},3:{n:"PresentationFormat",t:Vr},4:{n:"ByteCount",t:Mn},5:{n:"LineCount",t:Mn},6:{n:"ParagraphCount",t:Mn},7:{n:"SlideCount",t:Mn},8:{n:"NoteCount",t:Mn},9:{n:"HiddenCount",t:Mn},10:{n:"MultimediaClipCount",t:Mn},11:{n:"ScaleCrop",t:l0},12:{n:"HeadingPairs",t:xb},13:{n:"TitlesOfParts",t:yb},14:{n:"Manager",t:Vr},15:{n:"Company",t:Vr},16:{n:"LinksUpToDate",t:l0},17:{n:"CharacterCount",t:Mn},19:{n:"SharedDoc",t:l0},22:{n:"HyperlinksChanged",t:l0},23:{n:"AppVersion",t:Mn,p:"version"},24:{n:"DigSig",t:vb},26:{n:"ContentType",t:Vr},27:{n:"ContentStatus",t:Vr},28:{n:"Language",t:Vr},29:{n:"Version",t:Vr},255:{},2147483648:{n:"Locale",t:j0},2147483651:{n:"Behavior",t:j0},1919054434:{}},Ty={1:{n:"CodePage",t:mT},2:{n:"Title",t:Vr},3:{n:"Subject",t:Vr},4:{n:"Author",t:Vr},5:{n:"Keywords",t:Vr},6:{n:"Comments",t:Vr},7:{n:"Template",t:Vr},8:{n:"LastAuthor",t:Vr},9:{n:"RevNumber",t:Vr},10:{n:"EditTime",t:o0},11:{n:"LastPrinted",t:o0},12:{n:"CreatedDate",t:o0},13:{n:"ModifiedDate",t:o0},14:{n:"PageCount",t:Mn},15:{n:"WordCount",t:Mn},16:{n:"CharCount",t:Mn},17:{n:"Thumbnail",t:_b},18:{n:"Application",t:Vr},19:{n:"DocSecurity",t:Mn},255:{},2147483648:{n:"Locale",t:j0},2147483651:{n:"Behavior",t:j0},1919054434:{}};function Eb(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Tb=Eb([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ab=Sn(Tb),Nc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Sb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},u0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function gT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pT(r,e){var t=M6(Sb),i=[],s;i[i.length]=pr,i[i.length]=ke("Types",null,{xmlns:Nr.CT,"xmlns:xsd":Nr.xsd,"xmlns:xsi":Nr.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return ke("Default",null,{Extension:g[0],ContentType:g[1]})}));var o=function(g){r[g]&&r[g].length>0&&(s=r[g][0],i[i.length]=ke("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:u0[g][e.bookType]||u0[g].xlsx}))},u=function(g){(r[g]||[]).forEach(function(m){i[i.length]=ke("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:u0[g][e.bookType]||u0[g].xlsx})})},h=function(g){(r[g]||[]).forEach(function(m){i[i.length]=ke("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:t[g][0]})})};return o("workbooks"),u("sheets"),u("charts"),h("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),u("metadata"),h("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var At={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vT(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function xo(r){var e=[pr,ke("Relationships",null,{xmlns:Nr.RELS})];return qr(r["!id"]).forEach(function(t){e[e.length]=ke("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ot(r,e,t,i,s,o){if(s||(s={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,s.Id="rId"+e,s.Type=i,s.Target=t,[At.HLINK,At.XPATH,At.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),r["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][s.Id]=s,r[("/"+s.Target).replace("//","/")]=s,e}function wb(r){var e=[pr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Ay(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Rb(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Cb(r){var e=[pr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(Ay(r[t][0],r[t][1])),e.push(Rb("",r[t][0]));return e.push(Ay("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function _T(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+I0.version+"</meta:generator></office:meta></office:document-meta>"}var il=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function N1(r,e,t,i,s){s[r]!=null||e==null||e===""||(s[r]=e,e=It(e),i[i.length]=t?ke(r,e,t):zr(r,e))}function xT(r,e){var t=e||{},i=[pr,ke("cp:coreProperties",null,{"xmlns:cp":Nr.CORE_PROPS,"xmlns:dc":Nr.dc,"xmlns:dcterms":Nr.dcterms,"xmlns:dcmitype":Nr.dcmitype,"xmlns:xsi":Nr.xsi})],s={};if(!r&&!t.Props)return i.join("");r&&(r.CreatedDate!=null&&N1("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:lm(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s),r.ModifiedDate!=null&&N1("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:lm(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s));for(var o=0;o!=il.length;++o){var u=il[o],h=t.Props&&t.Props[u[1]]!=null?t.Props[u[1]]:r?r[u[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&N1(u[0],h,null,i,s)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var yo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],yT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ET(r){var e=[],t=ke;return r||(r={}),r.Application="SheetJS",e[e.length]=pr,e[e.length]=ke("Properties",null,{xmlns:Nr.EXT_PROPS,"xmlns:vt":Nr.vt}),yo.forEach(function(i){if(r[i[1]]!==void 0){var s;switch(i[2]){case"string":s=It(String(r[i[1]]));break;case"bool":s=r[i[1]]?"true":"false";break}s!==void 0&&(e[e.length]=t(i[0],s))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(i){return"<vt:lpstr>"+It(i)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function TT(r){var e=[pr,ke("Properties",null,{xmlns:Nr.CUST_PROPS,"xmlns:vt":Nr.vt})];if(!r)return e.join("");var t=1;return qr(r).forEach(function(s){++t,e[e.length]=ke("property",q6(r[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:It(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Sy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function bb(r,e){var t=[];return qr(Sy).map(function(i){for(var s=0;s<il.length;++s)if(il[s][1]==i)return il[s];for(s=0;s<yo.length;++s)if(yo[s][1]==i)return yo[s];throw i}).forEach(function(i){if(r[i[1]]!=null){var s=e&&e.Props&&e.Props[i[1]]!=null?e.Props[i[1]]:r[i[1]];switch(i[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(zr(Sy[i[1]]||i[1],s))}}),ke("DocumentProperties",t.join(""),{xmlns:Pn.o})}function Db(r,e){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",s=[];return r&&qr(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)){for(var u=0;u<il.length;++u)if(o==il[u][1])return;for(u=0;u<yo.length;++u)if(o==yo[u][1])return;for(u=0;u<t.length;++u)if(o==t[u])return;var h=r[o],g="string";typeof h=="number"?(g="float",h=String(h)):h===!0||h===!1?(g="boolean",h=h?"1":"0"):h=String(h),s.push(ke(fy(o),h,{"dt:dt":g}))}}),e&&qr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(r&&Object.prototype.hasOwnProperty.call(r,o))){var u=e[o],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u instanceof Date?(h="dateTime.tz",u=u.toISOString()):u=String(u),s.push(ke(fy(o),u,{"dt:dt":h}))}}),"<"+i+' xmlns="'+Pn.o+'">'+s.join("")+"</"+i+">"}function Nb(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,i=t%Math.pow(2,32),s=(t-i)/Math.pow(2,32);i*=1e7,s*=1e7;var o=i/Math.pow(2,32)|0;o>0&&(i=i%Math.pow(2,32),s+=o);var u=_e(8);return u.write_shift(4,i),u.write_shift(4,s),u}function wy(r,e){var t=_e(4),i=_e(4);switch(t.write_shift(4,r==80?31:r),r){case 3:i.write_shift(-4,e);break;case 5:i=_e(8),i.write_shift(8,e,"f");break;case 11:i.write_shift(4,e?1:0);break;case 64:i=Nb(e);break;case 31:case 80:for(i=_e(4+2*(e.length+1)+(e.length%2?0:2)),i.write_shift(4,e.length+1),i.write_shift(0,e,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return jr([t,i])}var AT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Ob(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function Ry(r,e,t){var i=_e(8),s=[],o=[],u=8,h=0,g=_e(8),m=_e(8);if(g.write_shift(4,2),g.write_shift(4,1200),m.write_shift(4,1),o.push(g),s.push(m),u+=8+g.length,!e){m=_e(8),m.write_shift(4,0),s.unshift(m);var v=[_e(4)];for(v[0].write_shift(4,r.length),h=0;h<r.length;++h){var x=r[h][0];for(g=_e(8+2*(x.length+1)+(x.length%2?0:2)),g.write_shift(4,h+2),g.write_shift(4,x.length+1),g.write_shift(0,x,"dbcs");g.l!=g.length;)g.write_shift(1,0);v.push(g)}g=jr(v),o.unshift(g),u+=8+g.length}for(h=0;h<r.length;++h)if(!(e&&!e[r[h][0]])&&!(AT.indexOf(r[h][0])>-1||yT.indexOf(r[h][0])>-1)&&r[h][1]!=null){var y=r[h][1],T=0;if(e){T=+e[r[h][0]];var b=t[T];if(b.p=="version"&&typeof y=="string"){var S=y.split(".");y=(+S[0]<<16)+(+S[1]||0)}g=wy(b.t,y)}else{var w=Ob(y);w==-1&&(w=31,y=String(y)),g=wy(w,y)}o.push(g),m=_e(8),m.write_shift(4,e?T:2+h),s.push(m),u+=8+g.length}var G=8*(o.length+1);for(h=0;h<o.length;++h)s[h].write_shift(4,G),G+=o[h].length;return i.write_shift(4,u),i.write_shift(4,o.length),jr([i].concat(s).concat(o))}function Cy(r,e,t,i,s,o){var u=_e(s?68:48),h=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,Vt.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,s?2:1),u.write_shift(16,e,"hex"),u.write_shift(4,s?68:48);var g=Ry(r,t,i);if(h.push(g),s){var m=Ry(s,null,null);u.write_shift(16,o,"hex"),u.write_shift(4,68+g.length),h.push(m)}return jr(h)}function Ib(r,e){e||(e=_e(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function kb(r,e){return r.read_shift(e)===1}function cn(r,e){return e||(e=_e(2)),e.write_shift(2,+!!r),e}function ST(r){return r.read_shift(2,"u")}function ei(r,e){return e||(e=_e(2)),e.write_shift(2,r),e}function wT(r,e,t){return t||(t=_e(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function RT(r,e,t){var i=r.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=r.read_shift(1);o&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var u=i?r.read_shift(i,s):"";return u}function Mb(r){var e=r.t||"",t=_e(3);t.write_shift(2,e.length),t.write_shift(1,1);var i=_e(2*e.length);i.write_shift(2*e.length,e,"utf16le");var s=[t,i];return jr(s)}function Fb(r,e,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var s=r.read_shift(1);return s===0?i=r.read_shift(e,"sbcs-cont"):i=r.read_shift(e,"dbcs-cont"),i}function Pb(r,e,t){var i=r.read_shift(t&&t.biff==2?1:2);return i===0?(r.l++,""):Fb(r,i,t)}function Lb(r,e,t){if(t.biff>5)return Pb(r,e,t);var i=r.read_shift(1);return i===0?(r.l++,""):r.read_shift(i,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function CT(r,e,t){return t||(t=_e(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function by(r,e){e||(e=_e(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function Vb(r){var e=_e(512),t=0,i=r.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var s=i.indexOf("#"),o=s>-1?31:23;switch(i.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var u=[8,6815827,6619237,4849780,83];for(t=0;t<u.length;++t)e.write_shift(4,u[t]);if(o==28)i=i.slice(1),by(i,e);else if(o&2){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<u.length;++t)e.write_shift(1,parseInt(u[t],16));var h=s>-1?i.slice(0,s):i;for(e.write_shift(4,2*(h.length+1)),t=0;t<h.length;++t)e.write_shift(2,h.charCodeAt(t));e.write_shift(2,0),o&8&&by(s>-1?i.slice(s+1):"",e)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<u.length;++t)e.write_shift(1,parseInt(u[t],16));for(var g=0;i.slice(g*3,g*3+3)=="../"||i.slice(g*3,g*3+3)=="..\\";)++g;for(e.write_shift(2,g),e.write_shift(4,i.length-3*g+1),t=0;t<i.length-3*g;++t)e.write_shift(1,i.charCodeAt(t+3*g)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function cl(r,e,t,i){return i||(i=_e(6)),i.write_shift(2,r),i.write_shift(2,e),i.write_shift(2,t||0),i}function Bb(r,e,t){var i=t.biff>8?4:2,s=r.read_shift(i),o=r.read_shift(i,"i"),u=r.read_shift(i,"i");return[s,o,u]}function Ub(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2);return{s:{c:i,r:e},e:{c:s,r:t}}}function bT(r,e){return e||(e=_e(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function hg(r,e,t){var i=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,s=8;break;case"biff4":i=4,s=6;break;case"biff3":i=3,s=6;break;case"biff2":i=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=_e(s);return o.write_shift(2,i),o.write_shift(2,e),s>4&&o.write_shift(2,29282),s>6&&o.write_shift(2,1997),s>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function jb(r,e){var t=!e||e.biff==8,i=_e(t?112:54);for(i.write_shift(e.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function zb(r,e){var t=!e||e.biff>=8?2:1,i=_e(8+t*r.name.length);i.write_shift(4,r.pos),i.write_shift(1,r.hs||0),i.write_shift(1,r.dt),i.write_shift(1,r.name.length),e.biff>=8&&i.write_shift(1,1),i.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var s=i.slice(0,i.l);return s.l=i.l,s}function Hb(r,e){var t=_e(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var i=[],s=0;s<r.length;++s)i[s]=Mb(r[s]);var o=jr([t].concat(i));return o.parts=[t.length].concat(i.map(function(u){return u.length})),o}function Gb(){var r=_e(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function qb(r){var e=_e(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Xb(r,e){var t=r.name||"Arial",i=e&&e.biff==5,s=i?15+t.length:16+2*t.length,o=_e(s);return o.write_shift(2,r.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),i||o.write_shift(1,1),o.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),o}function Yb(r,e,t,i){var s=_e(10);return cl(r,e,i,s),s.write_shift(4,t),s}function Kb(r,e,t,i,s){var o=!s||s.biff==8,u=_e(8+ +o+(1+o)*t.length);return cl(r,e,i,u),u.write_shift(2,t.length),o&&u.write_shift(1,1),u.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),u}function Wb(r,e,t,i){var s=t&&t.biff==5;i||(i=_e(s?3+e.length:5+2*e.length)),i.write_shift(2,r),i.write_shift(s?1:2,e.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var o=i.length>i.l?i.slice(0,i.l):i;return o.l==null&&(o.l=o.length),o}function Qb(r,e){var t=e.biff==8||!e.biff?4:2,i=_e(2*t+6);return i.write_shift(t,r.s.r),i.write_shift(t,r.e.r+1),i.write_shift(2,r.s.c),i.write_shift(2,r.e.c+1),i.write_shift(2,0),i}function Dy(r,e,t,i){var s=t&&t.biff==5;i||(i=_e(s?16:20)),i.write_shift(2,0),r.style?(i.write_shift(2,r.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,r.numFmtId||0),i.write_shift(2,e<<4));var o=0;return r.numFmtId>0&&s&&(o|=1024),i.write_shift(4,o),i.write_shift(4,0),s||i.write_shift(4,0),i.write_shift(2,0),i}function $b(r){var e=_e(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Zb(r,e,t,i,s,o){var u=_e(8);return cl(r,e,i,u),wT(t,o,u),u}function Jb(r,e,t,i){var s=_e(14);return cl(r,e,i,s),ul(t,s),s}function eD(r,e,t){if(t.biff<8)return tD(r,e,t);for(var i=[],s=r.l+e,o=r.read_shift(t.biff>8?4:2);o--!==0;)i.push(Bb(r,t.biff>8?12:6,t));if(r.l!=s)throw new Error("Bad ExternSheet: "+r.l+" != "+s);return i}function tD(r,e,t){r[r.l+1]==3&&r[r.l]++;var i=RT(r,e,t);return i.charCodeAt(0)==3?i.slice(1):i}function rD(r){var e=_e(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)bT(r[t],e);return e}function nD(r){var e=_e(24),t=Or(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(i[s],16));return jr([e,Vb(r[1])])}function iD(r){var e=r[1].Tooltip,t=_e(10+2*(e.length+1));t.write_shift(2,2048);var i=Or(r[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var s=0;s<e.length;++s)t.write_shift(2,e.charCodeAt(s));return t.write_shift(2,0),t}function aD(r){return r||(r=_e(4)),r.write_shift(2,1),r.write_shift(2,1),r}function sD(r,e,t){if(!t.cellStyles)return Ki(r,e);var i=t&&t.biff>=12?4:2,s=r.read_shift(i),o=r.read_shift(i),u=r.read_shift(i),h=r.read_shift(i),g=r.read_shift(2);i==2&&(r.l+=2);var m={s,e:o,w:u,ixfe:h,flags:g};return(t.biff>=5||!t.biff)&&(m.level=g>>8&7),m}function lD(r,e){var t=_e(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var i=0;return r.hidden&&(i|=1),t.write_shift(1,i),i=r.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function oD(r){for(var e=_e(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}function uD(r,e,t){var i=_e(15);return Ic(i,r,e),i.write_shift(8,t,"f"),i}function cD(r,e,t){var i=_e(9);return Ic(i,r,e),i.write_shift(2,t),i}var fD=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=tg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(h,g){var m=[],v=ol(1);switch(g.type){case"base64":v=fi(Aa(h));break;case"binary":v=fi(h);break;case"buffer":case"array":v=h;break}Fn(v,0);var x=v.read_shift(1),y=!!(x&136),T=!1,b=!1;switch(x){case 2:break;case 3:break;case 48:T=!0,y=!0;break;case 49:T=!0,y=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var S=0,w=521;x==2&&(S=v.read_shift(2)),v.l+=3,x!=2&&(S=v.read_shift(4)),S>1048576&&(S=1e6),x!=2&&(w=v.read_shift(2));var G=v.read_shift(2),Z=g.codepage||1252;x!=2&&(v.l+=16,v.read_shift(1),v[v.l]!==0&&(Z=r[v[v.l]]),v.l+=1,v.l+=2),b&&(v.l+=36);for(var K=[],ne={},pe=Math.min(v.length,x==2?521:w-10-(T?264:0)),Re=b?32:11;v.l<pe&&v[v.l]!=13;)switch(ne={},ne.name=k0.utils.decode(Z,v.slice(v.l,v.l+Re)).replace(/[\u0000\r\n].*$/g,""),v.l+=Re,ne.type=String.fromCharCode(v.read_shift(1)),x!=2&&!b&&(ne.offset=v.read_shift(4)),ne.len=v.read_shift(1),x==2&&(ne.offset=v.read_shift(2)),ne.dec=v.read_shift(1),ne.name.length&&K.push(ne),x!=2&&(v.l+=b?13:14),ne.type){case"B":(!T||ne.len!=8)&&g.WTF&&console.log("Skipping "+ne.name+":"+ne.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+ne.name+":"+ne.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ne.type)}if(v[v.l]!==13&&(v.l=w-1),v.read_shift(1)!==13)throw new Error("DBF Terminator not found "+v.l+" "+v[v.l]);v.l=w;var N=0,D=0;for(m[0]=[],D=0;D!=K.length;++D)m[0][D]=K[D].name;for(;S-- >0;){if(v[v.l]===42){v.l+=G;continue}for(++v.l,m[++N]=[],D=0,D=0;D!=K.length;++D){var R=v.slice(v.l,v.l+K[D].len);v.l+=K[D].len,Fn(R,0);var k=k0.utils.decode(Z,R);switch(K[D].type){case"C":k.trim().length&&(m[N][D]=k.replace(/\s+$/,""));break;case"D":k.length===8?m[N][D]=new Date(+k.slice(0,4),+k.slice(4,6)-1,+k.slice(6,8)):m[N][D]=k;break;case"F":m[N][D]=parseFloat(k.trim());break;case"+":case"I":m[N][D]=b?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(k.trim().toUpperCase()){case"Y":case"T":m[N][D]=!0;break;case"N":case"F":m[N][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+k+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));m[N][D]="##MEMO##"+(b?parseInt(k.trim(),10):R.read_shift(4));break;case"N":k=k.replace(/\u0000/g,"").trim(),k&&k!="."&&(m[N][D]=+k||0);break;case"@":m[N][D]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":m[N][D]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":m[N][D]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[N][D]=-R.read_shift(-8,"f");break;case"B":if(T&&K[D].len==8){m[N][D]=R.read_shift(8,"f");break}case"G":case"P":R.l+=K[D].len;break;case"0":if(K[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+K[D].type)}}}if(x!=2&&v.l<v.length&&v[v.l++]!=26)throw new Error("DBF EOF Marker missing "+(v.l-1)+" of "+v.length+" "+v[v.l-1].toString(16));return g&&g.sheetRows&&(m=m.slice(0,g.sheetRows)),g.DBF=K,m}function i(h,g){var m=g||{};m.dateNF||(m.dateNF="yyyymmdd");var v=Fo(t(h,m),m);return v["!cols"]=m.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete m.DBF,v}function s(h,g){try{return dl(i(h,g),g)}catch(m){if(g&&g.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function u(h,g){var m=g||{};if(+m.codepage>=0&&hc(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var v=Tn(),x=X0(h,{header:1,raw:!0,cellDates:!0}),y=x[0],T=x.slice(1),b=h["!cols"]||[],S=0,w=0,G=0,Z=1;for(S=0;S<y.length;++S){if(((b[S]||{}).DBF||{}).name){y[S]=b[S].DBF.name,++G;continue}if(y[S]!=null){if(++G,typeof y[S]=="number"&&(y[S]=y[S].toString(10)),typeof y[S]!="string")throw new Error("DBF Invalid column name "+y[S]+" |"+typeof y[S]+"|");if(y.indexOf(y[S])!==S){for(w=0;w<1024;++w)if(y.indexOf(y[S]+"_"+w)==-1){y[S]+="_"+w;break}}}}var K=Xt(h["!ref"]),ne=[],pe=[],Re=[];for(S=0;S<=K.e.c-K.s.c;++S){var N="",D="",R=0,k=[];for(w=0;w<T.length;++w)T[w][S]!=null&&k.push(T[w][S]);if(k.length==0||y[S]==null){ne[S]="?";continue}for(w=0;w<k.length;++w){switch(typeof k[w]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=k[w]instanceof Date?"D":"C";break;default:D="C"}R=Math.max(R,String(k[w]).length),N=N&&N!=D?"C":D}R>250&&(R=250),D=((b[S]||{}).DBF||{}).type,D=="C"&&b[S].DBF.len>R&&(R=b[S].DBF.len),N=="B"&&D=="N"&&(N="N",Re[S]=b[S].DBF.dec,R=b[S].DBF.len),pe[S]=N=="C"||D=="N"?R:o[N]||0,Z+=pe[S],ne[S]=N}var F=v.next(32);for(F.write_shift(4,318902576),F.write_shift(4,T.length),F.write_shift(2,296+32*G),F.write_shift(2,Z),S=0;S<4;++S)F.write_shift(4,0);for(F.write_shift(4,0|(+e[NE]||3)<<8),S=0,w=0;S<y.length;++S)if(y[S]!=null){var B=v.next(32),P=(y[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,P,"sbcs"),B.write_shift(1,ne[S]=="?"?"C":ne[S],"sbcs"),B.write_shift(4,w),B.write_shift(1,pe[S]||o[ne[S]]||0),B.write_shift(1,Re[S]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),w+=pe[S]||o[ne[S]]||0}var qe=v.next(264);for(qe.write_shift(4,13),S=0;S<65;++S)qe.write_shift(4,0);for(S=0;S<T.length;++S){var Be=v.next(Z);for(Be.write_shift(1,0),w=0;w<y.length;++w)if(y[w]!=null)switch(ne[w]){case"L":Be.write_shift(1,T[S][w]==null?63:T[S][w]?84:70);break;case"B":Be.write_shift(8,T[S][w]||0,"f");break;case"N":var J="0";for(typeof T[S][w]=="number"&&(J=T[S][w].toFixed(Re[w]||0)),G=0;G<pe[w]-J.length;++G)Be.write_shift(1,32);Be.write_shift(1,J,"sbcs");break;case"D":T[S][w]?(Be.write_shift(4,("0000"+T[S][w].getFullYear()).slice(-4),"sbcs"),Be.write_shift(2,("00"+(T[S][w].getMonth()+1)).slice(-2),"sbcs"),Be.write_shift(2,("00"+T[S][w].getDate()).slice(-2),"sbcs")):Be.write_shift(8,"00000000","sbcs");break;case"C":var ye=String(T[S][w]!=null?T[S][w]:"").slice(0,pe[w]);for(Be.write_shift(1,ye,"sbcs"),G=0;G<pe[w]-ye.length;++G)Be.write_shift(1,32);break}}return v.next(1).write_shift(1,26),v.end()}return{to_workbook:s,to_sheet:i,from_sheet:u}}(),hD=function(){var r={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+qr(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(y,T){var b=r[T];return typeof b=="number"?Jx(b):b},i=function(y,T,b){var S=T.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return S==59?y:Jx(S)};r["|"]=254;function s(y,T){switch(T.type){case"base64":return o(Aa(y),T);case"binary":return o(y,T);case"buffer":return o(wt&&Buffer.isBuffer(y)?y.toString("binary"):Cc(y),T);case"array":return o(hh(y),T)}throw new Error("Unrecognized type "+T.type)}function o(y,T){var b=y.split(/[\n\r]+/),S=-1,w=-1,G=0,Z=0,K=[],ne=[],pe=null,Re={},N=[],D=[],R=[],k=0,F;for(+T.codepage>=0&&hc(+T.codepage);G!==b.length;++G){k=0;var B=b[G].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,t),P=B.replace(/;;/g,"\0").split(";").map(function(Q){return Q.replace(/\u0000/g,";")}),qe=P[0],Be;if(B.length>0)switch(qe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&ne.push(B.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,ye=!1,Pe=!1,He=!1,W=-1,xe=-1;for(Z=1;Z<P.length;++Z)switch(P[Z].charAt(0)){case"A":break;case"X":w=parseInt(P[Z].slice(1))-1,ye=!0;break;case"Y":for(S=parseInt(P[Z].slice(1))-1,ye||(w=0),F=K.length;F<=S;++F)K[F]=[];break;case"K":Be=P[Z].slice(1),Be.charAt(0)==='"'?Be=Be.slice(1,Be.length-1):Be==="TRUE"?Be=!0:Be==="FALSE"?Be=!1:isNaN(_a(Be))?isNaN(mc(Be).getDate())||(Be=fn(Be)):(Be=_a(Be),pe!==null&&zE(pe)&&(Be=XE(Be))),J=!0;break;case"E":He=!0;var V=cN(P[Z].slice(1),{r:S,c:w});K[S][w]=[K[S][w],V];break;case"S":Pe=!0,K[S][w]=[K[S][w],"S5S"];break;case"G":break;case"R":W=parseInt(P[Z].slice(1))-1;break;case"C":xe=parseInt(P[Z].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+B)}if(J&&(K[S][w]&&K[S][w].length==2?K[S][w][0]=Be:K[S][w]=Be,pe=null),Pe){if(He)throw new Error("SYLK shared formula cannot have own formula");var X=W>-1&&K[W][xe];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");K[S][w][1]=fN(X[1],{r:S-W,c:w-xe})}break;case"F":var q=0;for(Z=1;Z<P.length;++Z)switch(P[Z].charAt(0)){case"X":w=parseInt(P[Z].slice(1))-1,++q;break;case"Y":for(S=parseInt(P[Z].slice(1))-1,F=K.length;F<=S;++F)K[F]=[];break;case"M":k=parseInt(P[Z].slice(1))/20;break;case"F":break;case"G":break;case"P":pe=ne[parseInt(P[Z].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=P[Z].slice(1).split(" "),F=parseInt(R[0],10);F<=parseInt(R[1],10);++F)k=parseInt(R[2],10),D[F-1]=k===0?{hidden:!0}:{wch:k},dg(D[F-1]);break;case"C":w=parseInt(P[Z].slice(1))-1,D[w]||(D[w]={});break;case"R":S=parseInt(P[Z].slice(1))-1,N[S]||(N[S]={}),k>0?(N[S].hpt=k,N[S].hpx=kT(k)):k===0&&(N[S].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+B)}q<1&&(pe=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+B)}}return N.length>0&&(Re["!rows"]=N),D.length>0&&(Re["!cols"]=D),T&&T.sheetRows&&(K=K.slice(0,T.sheetRows)),[K,Re]}function u(y,T){var b=s(y,T),S=b[0],w=b[1],G=Fo(S,T);return qr(w).forEach(function(Z){G[Z]=w[Z]}),G}function h(y,T){return dl(u(y,T),T)}function g(y,T,b,S){var w="C;Y"+(b+1)+";X"+(S+1)+";K";switch(y.t){case"n":w+=y.v||0,y.f&&!y.F&&(w+=";E"+gg(y.f,{r:b,c:S}));break;case"b":w+=y.v?"TRUE":"FALSE";break;case"e":w+=y.w||y.v;break;case"d":w+='"'+(y.w||y.v)+'"';break;case"s":w+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function m(y,T){T.forEach(function(b,S){var w="F;W"+(S+1)+" "+(S+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=z0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=H0(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&y.push(w)})}function v(y,T){T.forEach(function(b,S){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*G0(b.hpx)+";"),w.length>2&&y.push(w+"R"+(S+1))})}function x(y,T){var b=["ID;PWXL;N;E"],S=[],w=Xt(y["!ref"]),G,Z=Array.isArray(y),K=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),y["!cols"]&&m(b,y["!cols"]),y["!rows"]&&v(b,y["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var ne=w.s.r;ne<=w.e.r;++ne)for(var pe=w.s.c;pe<=w.e.c;++pe){var Re=kt({r:ne,c:pe});G=Z?(y[ne]||[])[pe]:y[Re],!(!G||G.v==null&&(!G.f||G.F))&&S.push(g(G,y,ne,pe))}return b.join(K)+K+S.join(K)+K+"E"+K}return{to_workbook:h,to_sheet:u,from_sheet:x}}(),dD=function(){function r(o,u){switch(u.type){case"base64":return e(Aa(o),u);case"binary":return e(o,u);case"buffer":return e(wt&&Buffer.isBuffer(o)?o.toString("binary"):Cc(o),u);case"array":return e(hh(o),u)}throw new Error("Unrecognized type "+u.type)}function e(o,u){for(var h=o.split(`
`),g=-1,m=-1,v=0,x=[];v!==h.length;++v){if(h[v].trim()==="BOT"){x[++g]=[],m=0;continue}if(!(g<0)){var y=h[v].trim().split(","),T=y[0],b=y[1];++v;for(var S=h[v]||"";(S.match(/["]/g)||[]).length&1&&v<h.length-1;)S+=`
`+h[++v];switch(S=S.trim(),+T){case-1:if(S==="BOT"){x[++g]=[],m=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?x[g][m]=!0:S==="FALSE"?x[g][m]=!1:isNaN(_a(b))?isNaN(mc(b).getDate())?x[g][m]=b:x[g][m]=fn(b):x[g][m]=_a(b),++m;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),x[g][m++]=S!==""?S:null;break}if(S==="EOD")break}}return u&&u.sheetRows&&(x=x.slice(0,u.sheetRows)),x}function t(o,u){return Fo(r(o,u),u)}function i(o,u){return dl(t(o,u),u)}var s=function(){var o=function(g,m,v,x,y){g.push(m),g.push(v+","+x),g.push('"'+y.replace(/"/g,'""')+'"')},u=function(g,m,v,x){g.push(m+","+v),g.push(m==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(g){var m=[],v=Xt(g["!ref"]),x,y=Array.isArray(g);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,v.e.r-v.s.r+1,""),o(m,"TUPLES",0,v.e.c-v.s.c+1,""),o(m,"DATA",0,0,"");for(var T=v.s.r;T<=v.e.r;++T){u(m,-1,0,"BOT");for(var b=v.s.c;b<=v.e.c;++b){var S=kt({r:T,c:b});if(x=y?(g[T]||[])[b]:g[S],!x){u(m,1,0,"");continue}switch(x.t){case"n":var w=x.w;!w&&x.v!=null&&(w=x.v),w==null?x.f&&!x.F?u(m,1,0,"="+x.f):u(m,1,0,""):u(m,0,w,"V");break;case"b":u(m,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":u(m,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=ps(x.z||tr[14],An(fn(x.v)))),u(m,0,x.w,"V");break;default:u(m,1,0,"")}}}u(m,-1,0,"EOD");var G=`\r
`,Z=m.join(G);return Z}}();return{to_workbook:i,to_sheet:t,from_sheet:s}}(),DT=function(){function r(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(x,y){for(var T=x.split(`
`),b=-1,S=-1,w=0,G=[];w!==T.length;++w){var Z=T[w].trim().split(":");if(Z[0]==="cell"){var K=Or(Z[1]);if(G.length<=K.r)for(b=G.length;b<=K.r;++b)G[b]||(G[b]=[]);switch(b=K.r,S=K.c,Z[2]){case"t":G[b][S]=r(Z[3]);break;case"v":G[b][S]=+Z[3];break;case"vtf":var ne=Z[Z.length-1];case"vtc":switch(Z[3]){case"nl":G[b][S]=!!+Z[4];break;default:G[b][S]=+Z[4];break}Z[2]=="vtf"&&(G[b][S]=[G[b][S],ne])}}}return y&&y.sheetRows&&(G=G.slice(0,y.sheetRows)),G}function i(x,y){return Fo(t(x,y),y)}function s(x,y){return dl(i(x,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function m(x){if(!x||!x["!ref"])return"";for(var y=[],T=[],b,S="",w=Bn(x["!ref"]),G=Array.isArray(x),Z=w.s.r;Z<=w.e.r;++Z)for(var K=w.s.c;K<=w.e.c;++K)if(S=kt({r:Z,c:K}),b=G?(x[Z]||[])[K]:x[S],!(!b||b.v==null||b.t==="z")){switch(T=["cell",S,"t"],b.t){case"s":case"str":T.push(e(b.v));break;case"n":b.f?(T[2]="vtf",T[3]="n",T[4]=b.v,T[5]=e(b.f)):(T[2]="v",T[3]=b.v);break;case"b":T[2]="vt"+(b.f?"f":"c"),T[3]="nl",T[4]=b.v?"1":"0",T[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var ne=An(fn(b.v));T[2]="vtc",T[3]="nd",T[4]=""+ne,T[5]=b.w||ps(b.z||tr[14],ne);break;case"e":continue}y.push(T.join(":"))}return y.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function v(x){return[o,u,h,u,m(x),g].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:v}}(),mD=function(){function r(v,x,y,T,b){b.raw?x[y][T]=v:v===""||(v==="TRUE"?x[y][T]=!0:v==="FALSE"?x[y][T]=!1:isNaN(_a(v))?isNaN(mc(v).getDate())?x[y][T]=v:x[y][T]=fn(v):x[y][T]=_a(v))}function e(v,x){var y=x||{},T=[];if(!v||v.length===0)return T;for(var b=v.split(/[\r\n]/),S=b.length-1;S>=0&&b[S].length===0;)--S;for(var w=10,G=0,Z=0;Z<=S;++Z)G=b[Z].indexOf(" "),G==-1?G=b[Z].length:G++,w=Math.max(w,G);for(Z=0;Z<=S;++Z){T[Z]=[];var K=0;for(r(b[Z].slice(0,w).trim(),T,Z,K,y),K=1;K<=(b[Z].length-w)/10+1;++K)r(b[Z].slice(w+(K-1)*10,w+K*10).trim(),T,Z,K,y)}return y.sheetRows&&(T=T.slice(0,y.sheetRows)),T}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(v){for(var x={},y=!1,T=0,b=0;T<v.length;++T)(b=v.charCodeAt(T))==34?y=!y:!y&&b in t&&(x[b]=(x[b]||0)+1);b=[];for(T in x)Object.prototype.hasOwnProperty.call(x,T)&&b.push([x[T],T]);if(!b.length){x=i;for(T in x)Object.prototype.hasOwnProperty.call(x,T)&&b.push([x[T],T])}return b.sort(function(S,w){return S[0]-w[0]||i[S[1]]-i[w[1]]}),t[b.pop()[1]]||44}function o(v,x){var y=x||{},T="",b=y.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};v.slice(0,4)=="sep="?v.charCodeAt(5)==13&&v.charCodeAt(6)==10?(T=v.charAt(4),v=v.slice(7)):v.charCodeAt(5)==13||v.charCodeAt(5)==10?(T=v.charAt(4),v=v.slice(6)):T=s(v.slice(0,1024)):y&&y.FS?T=y.FS:T=s(v.slice(0,1024));var w=0,G=0,Z=0,K=0,ne=0,pe=T.charCodeAt(0),Re=!1,N=0,D=v.charCodeAt(0);v=v.replace(/\r\n/mg,`
`);var R=y.dateNF!=null?N6(y.dateNF):null;function k(){var F=v.slice(K,ne),B={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)B.t="z";else if(y.raw)B.t="s",B.v=F;else if(F.trim().length===0)B.t="s",B.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(B.t="s",B.v=F.slice(2,-1).replace(/""/g,'"')):hN(F)?(B.t="n",B.f=F.slice(1)):(B.t="s",B.v=F);else if(F=="TRUE")B.t="b",B.v=!0;else if(F=="FALSE")B.t="b",B.v=!1;else if(!isNaN(Z=_a(F)))B.t="n",y.cellText!==!1&&(B.w=F),B.v=Z;else if(!isNaN(mc(F).getDate())||R&&F.match(R)){B.z=y.dateNF||tr[14];var P=0;R&&F.match(R)&&(F=O6(F,y.dateNF,F.match(R)||[]),P=1),y.cellDates?(B.t="d",B.v=fn(F,P)):(B.t="n",B.v=An(fn(F,P))),y.cellText!==!1&&(B.w=ps(B.z,B.v instanceof Date?An(B.v):B.v)),y.cellNF||delete B.z}else B.t="s",B.v=F;if(B.t=="z"||(y.dense?(b[w]||(b[w]=[]),b[w][G]=B):b[kt({c:G,r:w})]=B),K=ne+1,D=v.charCodeAt(K),S.e.c<G&&(S.e.c=G),S.e.r<w&&(S.e.r=w),N==pe)++G;else if(G=0,++w,y.sheetRows&&y.sheetRows<=w)return!0}e:for(;ne<v.length;++ne)switch(N=v.charCodeAt(ne)){case 34:D===34&&(Re=!Re);break;case pe:case 10:case 13:if(!Re&&k())break e;break}return ne-K>0&&k(),b["!ref"]=gr(S),b}function u(v,x){return!(x&&x.PRN)||x.FS||v.slice(0,4)=="sep="||v.indexOf("	")>=0||v.indexOf(",")>=0||v.indexOf(";")>=0?o(v,x):Fo(e(v,x),x)}function h(v,x){var y="",T=x.type=="string"?[0,0,0,0]:RI(v,x);switch(x.type){case"base64":y=Aa(v);break;case"binary":y=v;break;case"buffer":x.codepage==65001?y=v.toString("utf8"):x.codepage&&typeof k0<"u"||(y=wt&&Buffer.isBuffer(v)?v.toString("binary"):Cc(v));break;case"array":y=hh(v);break;case"string":y=v;break;default:throw new Error("Unrecognized type "+x.type)}return T[0]==239&&T[1]==187&&T[2]==191?y=Zu(y.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?y=Zu(y):x.type=="binary"&&typeof k0<"u",y.slice(0,19)=="socialcalc:version:"?DT.to_sheet(x.type=="string"?y:Zu(y),x):u(y,x)}function g(v,x){return dl(h(v,x),x)}function m(v){for(var x=[],y=Xt(v["!ref"]),T,b=Array.isArray(v),S=y.s.r;S<=y.e.r;++S){for(var w=[],G=y.s.c;G<=y.e.c;++G){var Z=kt({r:S,c:G});if(T=b?(v[S]||[])[G]:v[Z],!T||T.v==null){w.push("          ");continue}for(var K=(T.w||(Sa(T),T.w)||"").slice(0,10);K.length<10;)K+=" ";w.push(K+(G===0?" ":""))}x.push(w.join(""))}return x.join(`
`)}return{to_workbook:g,to_sheet:h,from_sheet:m}}(),Ny=function(){function r(V,X,q){if(V){Fn(V,V.l||0);for(var Q=q.Enum||W;V.l<V.length;){var oe=V.read_shift(2),de=Q[oe]||Q[65535],ve=V.read_shift(2),Ne=V.l+ve,De=de.f&&de.f(V,ve,q);if(V.l=Ne,X(De,de,oe))return}}}function e(V,X){switch(X.type){case"base64":return t(fi(Aa(V)),X);case"binary":return t(fi(V),X);case"buffer":case"array":return t(V,X)}throw"Unsupported type "+X.type}function t(V,X){if(!V)return V;var q=X||{},Q=q.dense?[]:{},oe="Sheet1",de="",ve=0,Ne={},De=[],ut=[],rt={s:{r:0,c:0},e:{r:0,c:0}},Wt=q.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)q.Enum=W,r(V,function(Ve,Xr,rn){switch(rn){case 0:q.vers=Ve,Ve>=4096&&(q.qpro=!0);break;case 6:rt=Ve;break;case 204:Ve&&(de=Ve);break;case 222:de=Ve;break;case 15:case 51:q.qpro||(Ve[1].v=Ve[1].v.slice(1));case 13:case 14:case 16:rn==14&&(Ve[2]&112)==112&&(Ve[2]&15)>1&&(Ve[2]&15)<15&&(Ve[1].z=q.dateNF||tr[14],q.cellDates&&(Ve[1].t="d",Ve[1].v=XE(Ve[1].v))),q.qpro&&Ve[3]>ve&&(Q["!ref"]=gr(rt),Ne[oe]=Q,De.push(oe),Q=q.dense?[]:{},rt={s:{r:0,c:0},e:{r:0,c:0}},ve=Ve[3],oe=de||"Sheet"+(ve+1),de="");var hn=q.dense?(Q[Ve[0].r]||[])[Ve[0].c]:Q[kt(Ve[0])];if(hn){hn.t=Ve[1].t,hn.v=Ve[1].v,Ve[1].z!=null&&(hn.z=Ve[1].z),Ve[1].f!=null&&(hn.f=Ve[1].f);break}q.dense?(Q[Ve[0].r]||(Q[Ve[0].r]=[]),Q[Ve[0].r][Ve[0].c]=Ve[1]):Q[kt(Ve[0])]=Ve[1];break}},q);else if(V[2]==26||V[2]==14)q.Enum=xe,V[2]==14&&(q.qpro=!0,V.l=0),r(V,function(Ve,Xr,rn){switch(rn){case 204:oe=Ve;break;case 22:Ve[1].v=Ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ve[3]>ve&&(Q["!ref"]=gr(rt),Ne[oe]=Q,De.push(oe),Q=q.dense?[]:{},rt={s:{r:0,c:0},e:{r:0,c:0}},ve=Ve[3],oe="Sheet"+(ve+1)),Wt>0&&Ve[0].r>=Wt)break;q.dense?(Q[Ve[0].r]||(Q[Ve[0].r]=[]),Q[Ve[0].r][Ve[0].c]=Ve[1]):Q[kt(Ve[0])]=Ve[1],rt.e.c<Ve[0].c&&(rt.e.c=Ve[0].c),rt.e.r<Ve[0].r&&(rt.e.r=Ve[0].r);break;case 27:Ve[14e3]&&(ut[Ve[14e3][0]]=Ve[14e3][1]);break;case 1537:ut[Ve[0]]=Ve[1],Ve[0]==ve&&(oe=Ve[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(Q["!ref"]=gr(rt),Ne[de||oe]=Q,De.push(de||oe),!ut.length)return{SheetNames:De,Sheets:Ne};for(var lt={},tn=[],Bt=0;Bt<ut.length;++Bt)Ne[De[Bt]]?(tn.push(ut[Bt]||De[Bt]),lt[ut[Bt]]=Ne[ut[Bt]]||Ne[De[Bt]]):(tn.push(ut[Bt]),lt[ut[Bt]]={"!ref":"A1"});return{SheetNames:tn,Sheets:lt}}function i(V,X){var q=X||{};if(+q.codepage>=0&&hc(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var Q=Tn(),oe=Xt(V["!ref"]),de=Array.isArray(V),ve=[];Fe(Q,0,o(1030)),Fe(Q,6,g(oe));for(var Ne=Math.min(oe.e.r,8191),De=oe.s.r;De<=Ne;++De)for(var ut=Hr(De),rt=oe.s.c;rt<=oe.e.c;++rt){De===oe.s.r&&(ve[rt]=Jr(rt));var Wt=ve[rt]+ut,lt=de?(V[De]||[])[rt]:V[Wt];if(!(!lt||lt.t=="z"))if(lt.t=="n")(lt.v|0)==lt.v&&lt.v>=-32768&&lt.v<=32767?Fe(Q,13,T(De,rt,lt.v)):Fe(Q,14,S(De,rt,lt.v));else{var tn=Sa(lt);Fe(Q,15,x(De,rt,tn.slice(0,239)))}}return Fe(Q,1),Q.end()}function s(V,X){var q=X||{};if(+q.codepage>=0&&hc(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var Q=Tn();Fe(Q,0,u(V));for(var oe=0,de=0;oe<V.SheetNames.length;++oe)(V.Sheets[V.SheetNames[oe]]||{})["!ref"]&&Fe(Q,27,He(V.SheetNames[oe],de++));var ve=0;for(oe=0;oe<V.SheetNames.length;++oe){var Ne=V.Sheets[V.SheetNames[oe]];if(!(!Ne||!Ne["!ref"])){for(var De=Xt(Ne["!ref"]),ut=Array.isArray(Ne),rt=[],Wt=Math.min(De.e.r,8191),lt=De.s.r;lt<=Wt;++lt)for(var tn=Hr(lt),Bt=De.s.c;Bt<=De.e.c;++Bt){lt===De.s.r&&(rt[Bt]=Jr(Bt));var Ve=rt[Bt]+tn,Xr=ut?(Ne[lt]||[])[Bt]:Ne[Ve];if(!(!Xr||Xr.t=="z"))if(Xr.t=="n")Fe(Q,23,k(lt,Bt,ve,Xr.v));else{var rn=Sa(Xr);Fe(Q,22,N(lt,Bt,ve,rn.slice(0,239)))}}++ve}}return Fe(Q,1),Q.end()}function o(V){var X=_e(2);return X.write_shift(2,V),X}function u(V){var X=_e(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var q=0,Q=0,oe=0,de=0;de<V.SheetNames.length;++de){var ve=V.SheetNames[de],Ne=V.Sheets[ve];if(!(!Ne||!Ne["!ref"])){++oe;var De=Bn(Ne["!ref"]);q<De.e.r&&(q=De.e.r),Q<De.e.c&&(Q=De.e.c)}}return q>8191&&(q=8191),X.write_shift(2,q),X.write_shift(1,oe),X.write_shift(1,Q),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function h(V,X,q){var Q={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&q.qpro?(Q.s.c=V.read_shift(1),V.l++,Q.s.r=V.read_shift(2),Q.e.c=V.read_shift(1),V.l++,Q.e.r=V.read_shift(2),Q):(Q.s.c=V.read_shift(2),Q.s.r=V.read_shift(2),X==12&&q.qpro&&(V.l+=2),Q.e.c=V.read_shift(2),Q.e.r=V.read_shift(2),X==12&&q.qpro&&(V.l+=2),Q.s.c==65535&&(Q.s.c=Q.e.c=Q.s.r=Q.e.r=0),Q)}function g(V){var X=_e(8);return X.write_shift(2,V.s.c),X.write_shift(2,V.s.r),X.write_shift(2,V.e.c),X.write_shift(2,V.e.r),X}function m(V,X,q){var Q=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(Q[0].c=V.read_shift(1),Q[3]=V.read_shift(1),Q[0].r=V.read_shift(2),V.l+=2):(Q[2]=V.read_shift(1),Q[0].c=V.read_shift(2),Q[0].r=V.read_shift(2)),Q}function v(V,X,q){var Q=V.l+X,oe=m(V,X,q);if(oe[1].t="s",q.vers==20768){V.l++;var de=V.read_shift(1);return oe[1].v=V.read_shift(de,"utf8"),oe}return q.qpro&&V.l++,oe[1].v=V.read_shift(Q-V.l,"cstr"),oe}function x(V,X,q){var Q=_e(7+q.length);Q.write_shift(1,255),Q.write_shift(2,X),Q.write_shift(2,V),Q.write_shift(1,39);for(var oe=0;oe<Q.length;++oe){var de=q.charCodeAt(oe);Q.write_shift(1,de>=128?95:de)}return Q.write_shift(1,0),Q}function y(V,X,q){var Q=m(V,X,q);return Q[1].v=V.read_shift(2,"i"),Q}function T(V,X,q){var Q=_e(7);return Q.write_shift(1,255),Q.write_shift(2,X),Q.write_shift(2,V),Q.write_shift(2,q,"i"),Q}function b(V,X,q){var Q=m(V,X,q);return Q[1].v=V.read_shift(8,"f"),Q}function S(V,X,q){var Q=_e(13);return Q.write_shift(1,255),Q.write_shift(2,X),Q.write_shift(2,V),Q.write_shift(8,q,"f"),Q}function w(V,X,q){var Q=V.l+X,oe=m(V,X,q);if(oe[1].v=V.read_shift(8,"f"),q.qpro)V.l=Q;else{var de=V.read_shift(2);ne(V.slice(V.l,V.l+de),oe),V.l+=de}return oe}function G(V,X,q){var Q=X&32768;return X&=-32769,X=(Q?V:0)+(X>=8192?X-16384:X),(Q?"":"$")+(q?Jr(X):Hr(X))}var Z={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},K=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ne(V,X){Fn(V,0);for(var q=[],Q=0,oe="",de="",ve="",Ne="";V.l<V.length;){var De=V[V.l++];switch(De){case 0:q.push(V.read_shift(8,"f"));break;case 1:de=G(X[0].c,V.read_shift(2),!0),oe=G(X[0].r,V.read_shift(2),!1),q.push(de+oe);break;case 2:{var ut=G(X[0].c,V.read_shift(2),!0),rt=G(X[0].r,V.read_shift(2),!1);de=G(X[0].c,V.read_shift(2),!0),oe=G(X[0].r,V.read_shift(2),!1),q.push(ut+rt+":"+de+oe)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(V.read_shift(2));break;case 6:{for(var Wt="";De=V[V.l++];)Wt+=String.fromCharCode(De);q.push('"'+Wt.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Ne=q.pop(),ve=q.pop(),q.push(["AND","OR"][De-20]+"("+ve+","+Ne+")");break;default:if(De<32&&K[De])Ne=q.pop(),ve=q.pop(),q.push(ve+K[De]+Ne);else if(Z[De]){if(Q=Z[De][1],Q==69&&(Q=V[V.l++]),Q>q.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+q.join("|")+"|");return}var lt=q.slice(-Q);q.length-=Q,q.push(Z[De][0]+"("+lt.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}q.length==1?X[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function pe(V){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=V.read_shift(2),X[3]=V[V.l++],X[0].c=V[V.l++],X}function Re(V,X){var q=pe(V);return q[1].t="s",q[1].v=V.read_shift(X-4,"cstr"),q}function N(V,X,q,Q){var oe=_e(6+Q.length);oe.write_shift(2,V),oe.write_shift(1,q),oe.write_shift(1,X),oe.write_shift(1,39);for(var de=0;de<Q.length;++de){var ve=Q.charCodeAt(de);oe.write_shift(1,ve>=128?95:ve)}return oe.write_shift(1,0),oe}function D(V,X){var q=pe(V);q[1].v=V.read_shift(2);var Q=q[1].v>>1;if(q[1].v&1)switch(Q&7){case 0:Q=(Q>>3)*5e3;break;case 1:Q=(Q>>3)*500;break;case 2:Q=(Q>>3)/20;break;case 3:Q=(Q>>3)/200;break;case 4:Q=(Q>>3)/2e3;break;case 5:Q=(Q>>3)/2e4;break;case 6:Q=(Q>>3)/16;break;case 7:Q=(Q>>3)/64;break}return q[1].v=Q,q}function R(V,X){var q=pe(V),Q=V.read_shift(4),oe=V.read_shift(4),de=V.read_shift(2);if(de==65535)return Q===0&&oe===3221225472?(q[1].t="e",q[1].v=15):Q===0&&oe===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var ve=de&32768;return de=(de&32767)-16446,q[1].v=(1-ve*2)*(oe*Math.pow(2,de+32)+Q*Math.pow(2,de)),q}function k(V,X,q,Q){var oe=_e(14);if(oe.write_shift(2,V),oe.write_shift(1,q),oe.write_shift(1,X),Q==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var de=0,ve=0,Ne=0,De=0;return Q<0&&(de=1,Q=-Q),ve=Math.log2(Q)|0,Q/=Math.pow(2,ve-31),De=Q>>>0,(De&2147483648)==0&&(Q/=2,++ve,De=Q>>>0),Q-=De,De|=2147483648,De>>>=0,Q*=Math.pow(2,32),Ne=Q>>>0,oe.write_shift(4,Ne),oe.write_shift(4,De),ve+=16383+(de?32768:0),oe.write_shift(2,ve),oe}function F(V,X){var q=R(V);return V.l+=X-14,q}function B(V,X){var q=pe(V),Q=V.read_shift(4);return q[1].v=Q>>6,q}function P(V,X){var q=pe(V),Q=V.read_shift(8,"f");return q[1].v=Q,q}function qe(V,X){var q=P(V);return V.l+=X-10,q}function Be(V,X){return V[V.l+X-1]==0?V.read_shift(X,"cstr"):""}function J(V,X){var q=V[V.l++];q>X-1&&(q=X-1);for(var Q="";Q.length<q;)Q+=String.fromCharCode(V[V.l++]);return Q}function ye(V,X,q){if(!(!q.qpro||X<21)){var Q=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var oe=V.read_shift(X-21,"cstr");return[Q,oe]}}function Pe(V,X){for(var q={},Q=V.l+X;V.l<Q;){var oe=V.read_shift(2);if(oe==14e3){for(q[oe]=[0,""],q[oe][0]=V.read_shift(2);V[V.l];)q[oe][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return q}function He(V,X){var q=_e(5+V.length);q.write_shift(2,14e3),q.write_shift(2,X);for(var Q=0;Q<V.length;++Q){var oe=V.charCodeAt(Q);q[q.l++]=oe>127?95:oe}return q[q.l++]=0,q}var W={0:{n:"BOF",f:ST},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:v},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:v},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Be},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Re},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:qe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Be},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ye},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:e}}(),gD=/^\s|\s$|[\t\n\r]/;function NT(r,e){if(!e.bookSST)return"";var t=[pr];t[t.length]=ke("sst",null,{xmlns:Mo[0],count:r.Count,uniqueCount:r.Unique});for(var i=0;i!=r.length;++i)if(r[i]!=null){var s=r[i],o="<si>";s.r?o+=s.r:(o+="<t",s.t||(s.t=""),s.t.match(gD)&&(o+=' xml:space="preserve"'),o+=">"+It(s.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function pD(r){return[r.read_shift(4),r.read_shift(4)]}function vD(r,e){return e||(e=_e(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var _D=ob;function xD(r){var e=Tn();Ce(e,159,vD(r));for(var t=0;t<r.length;++t)Ce(e,19,_D(r[t]));return Ce(e,160),e.end()}function yD(r){for(var e=[],t=r.split(""),i=0;i<t.length;++i)e[i]=t[i].charCodeAt(0);return e}function OT(r){var e=0,t,i=yD(r),s=i.length+1,o,u,h,g,m;for(t=ol(s),t[0]=i.length,o=1;o!=s;++o)t[o]=i[o-1];for(o=s-1;o>=0;--o)u=t[o],h=(e&16384)===0?0:1,g=e<<1&32767,m=h|g,e=m^u;return e^52811}var ED=function(){function r(s,o){switch(o.type){case"base64":return e(Aa(s),o);case"binary":return e(s,o);case"buffer":return e(wt&&Buffer.isBuffer(s)?s.toString("binary"):Cc(s),o);case"array":return e(hh(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){var u=o||{},h=u.dense?[]:{},g=s.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(v,x){Array.isArray(h)&&(h[x]=[]);for(var y=/\\\w+\b/g,T=0,b,S=-1;b=y.exec(v);){switch(b[0]){case"\\cell":var w=v.slice(T,y.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++S,w.length){var G={v:w,t:"s"};Array.isArray(h)?h[x][S]=G:h[kt({r:x,c:S})]=G}break}T=y.lastIndex}S>m.e.c&&(m.e.c=S)}),h["!ref"]=gr(m),h}function t(s,o){return dl(r(s,o),o)}function i(s){for(var o=["{\\rtf1\\ansi"],u=Xt(s["!ref"]),h,g=Array.isArray(s),m=u.s.r;m<=u.e.r;++m){o.push("\\trowd\\trautofit1");for(var v=u.s.c;v<=u.e.c;++v)o.push("\\cellx"+(v+1));for(o.push("\\pard\\intbl"),v=u.s.c;v<=u.e.c;++v){var x=kt({r:m,c:v});h=g?(s[m]||[])[v]:s[x],!(!h||h.v==null&&(!h.f||h.F))&&(o.push(" "+(h.w||(Sa(h),h.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:i}}();function Oy(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}var TD=6,xa=TD;function z0(r){return Math.floor((r+Math.round(128/xa)/256)*xa)}function H0(r){return Math.floor((r-5)/xa*100+.5)/100}function um(r){return Math.round((r*xa+5)/xa*256)/256}function dg(r){r.width?(r.wpx=z0(r.width),r.wch=H0(r.wpx),r.MDW=xa):r.wpx?(r.wch=H0(r.wpx),r.width=um(r.wch),r.MDW=xa):typeof r.wch=="number"&&(r.width=um(r.wch),r.wpx=z0(r.width),r.MDW=xa),r.customWidth&&delete r.customWidth}var AD=96,IT=AD;function G0(r){return r*96/IT}function kT(r){return r*IT/96}function SD(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)r[i]!=null&&(e[e.length]=ke("numFmt",null,{numFmtId:i,formatCode:It(r[i])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ke("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function wD(r){var e=[];return e[e.length]=ke("cellXfs",null),r.forEach(function(t){e[e.length]=ke("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ke("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function MT(r,e){var t=[pr,ke("styleSheet",null,{xmlns:Mo[0],"xmlns:vt":Nr.vt})],i;return r.SSF&&(i=SD(r.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=wD(e.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function RD(r,e){var t=r.read_shift(2),i=en(r);return[t,i]}function CD(r,e,t){t||(t=_e(6+4*e.length)),t.write_shift(2,r),Ir(e,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function bD(r,e,t){var i={};i.sz=r.read_shift(2)/20;var s=gb(r);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var o=r.read_shift(2);switch(o===700&&(i.bold=1),r.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var u=r.read_shift(1);u!=0&&(i.underline=u);var h=r.read_shift(1);h>0&&(i.family=h);var g=r.read_shift(1);switch(g>0&&(i.charset=g),r.l++,i.color=mb(r),r.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=en(r),i}function DD(r,e){e||(e=_e(25+4*32)),e.write_shift(2,r.sz*20),pb(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),U0(r.color,e);var i=0;return i=2,e.write_shift(1,i),Ir(r.name,e),e.length>e.l?e.slice(0,e.l):e}var ND=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],O1,OD=Ki;function Iy(r,e){e||(e=_e(4*3+8*7+16*1)),O1||(O1=tg(ND));var t=O1[r.patternType];t==null&&(t=40),e.write_shift(4,t);var i=0;if(t!=40)for(U0({auto:1},e),U0({auto:1},e);i<12;++i)e.write_shift(4,0);else{for(;i<4;++i)e.write_shift(4,0);for(;i<12;++i)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function ID(r,e){var t=r.l+e,i=r.read_shift(2),s=r.read_shift(2);return r.l=t,{ixfe:i,numFmtId:s}}function FT(r,e,t){t||(t=_e(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Vu(r,e){return e||(e=_e(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var kD=Ki;function MD(r,e){return e||(e=_e(51)),e.write_shift(1,0),Vu(null,e),Vu(null,e),Vu(null,e),Vu(null,e),Vu(null,e),e.length>e.l?e.slice(0,e.l):e}function FD(r,e){return e||(e=_e(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),B0(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function PD(r,e,t){var i=_e(2052);return i.write_shift(4,r),B0(e,i),B0(t,i),i.length>i.l?i.slice(0,i.l):i}function LD(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)e[s]!=null&&++t}),t!=0&&(Ce(r,615,mi(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)e[s]!=null&&Ce(r,44,CD(s,e[s]))}),Ce(r,616))}}function VD(r){var e=1;Ce(r,611,mi(e)),Ce(r,43,DD({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(r,612)}function BD(r){var e=2;Ce(r,603,mi(e)),Ce(r,45,Iy({patternType:"none"})),Ce(r,45,Iy({patternType:"gray125"})),Ce(r,604)}function UD(r){var e=1;Ce(r,613,mi(e)),Ce(r,46,MD()),Ce(r,614)}function jD(r){var e=1;Ce(r,626,mi(e)),Ce(r,47,FT({numFmtId:0},65535)),Ce(r,627)}function zD(r,e){Ce(r,617,mi(e.length)),e.forEach(function(t){Ce(r,47,FT(t,0))}),Ce(r,618)}function HD(r){var e=1;Ce(r,619,mi(e)),Ce(r,48,FD({xfId:0,name:"Normal"})),Ce(r,620)}function GD(r){var e=0;Ce(r,505,mi(e)),Ce(r,506)}function qD(r){var e=0;Ce(r,508,PD(e,"TableStyleMedium9","PivotStyleMedium4")),Ce(r,509)}function XD(r,e){var t=Tn();return Ce(t,278),LD(t,r.SSF),VD(t),BD(t),UD(t),jD(t),zD(t,e.cellXfs),HD(t),GD(t),qD(t),Ce(t,279),t.end()}function PT(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[pr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function YD(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:en(r)}}function KD(r){var e=_e(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),Ir(r.name,e),e.slice(0,e.l)}function WD(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function QD(r){var e=_e(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function $D(r,e){var t=_e(8+2*e.length);return t.write_shift(4,r),Ir(e,t),t.slice(0,t.l)}function ZD(r){return r.l+=4,r.read_shift(4)!=0}function JD(r,e){var t=_e(8);return t.write_shift(4,r),t.write_shift(4,1),t}function eN(){var r=Tn();return Ce(r,332),Ce(r,334,mi(1)),Ce(r,335,KD({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(r,336),Ce(r,339,$D(1,"XLDAPR")),Ce(r,52),Ce(r,35,mi(514)),Ce(r,4096,mi(0)),Ce(r,4097,ei(1)),Ce(r,36),Ce(r,53),Ce(r,340),Ce(r,337,JD(1)),Ce(r,51,QD([[1,0]])),Ce(r,338),Ce(r,333),r.end()}function LT(){var r=[pr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function tN(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=kt(t);var i=r.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}var go=1024;function VT(r,e){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[ke("xml",null,{"xmlns:v":Pn.v,"xmlns:o":Pn.o,"xmlns:x":Pn.x,"xmlns:mv":Pn.mv}).replace(/\/>/,">"),ke("o:shapelayout",ke("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),ke("v:shapetype",[ke("v:stroke",null,{joinstyle:"miter"}),ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];go<r*1e3;)go+=1e3;return e.forEach(function(o){var u=Or(o[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var g=h.type=="gradient"?ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=ke("v:fill",g,h),v={on:"t",obscured:"t"};++go,s=s.concat(["<v:shape"+pc({id:"_x0000_s"+go,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,ke("v:shadow",null,v),ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",zr("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),zr("x:AutoFill","False"),zr("x:Row",String(u.r)),zr("x:Column",String(u.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function BT(r){var e=[pr,ke("comments",null,{xmlns:Mo[0]})],t=[];return e.push("<authors>"),r.forEach(function(i){i[1].forEach(function(s){var o=It(s.a);t.indexOf(o)==-1&&(t.push(o),e.push("<author>"+o+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(i){var s=0,o=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?s=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(g){g.a&&(s=t.indexOf(It(g.a))),o.push(g.t||"")}),e.push('<comment ref="'+i[0]+'" authorId="'+s+'"><text>'),o.length<=1)e.push(zr("t",It(o[0]||"")));else{for(var u=`Comment:
    `+o[0]+`
`,h=1;h<o.length;++h)u+=`Reply:
    `+o[h]+`
`;e.push(zr("t",It(u)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function rN(r,e,t){var i=[pr,ke("ThreadedComments",null,{xmlns:Nr.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(s){var o="";(s[1]||[]).forEach(function(u,h){if(!u.T){delete u.ID;return}u.a&&e.indexOf(u.a)==-1&&e.push(u.a);var g={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};h==0?o=g.id:g.parentId=o,u.ID=g.id,u.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(u.a)).slice(-12)+"}"),i.push(ke("threadedComment",zr("text",u.t||""),g))})}),i.push("</ThreadedComments>"),i.join("")}function nN(r){var e=[pr,ke("personList",null,{xmlns:Nr.TCMNT,"xmlns:x":Mo[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,i){e.push(ke("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function iN(r){var e={};e.iauthor=r.read_shift(4);var t=vl(r);return e.rfx=t.s,e.ref=kt(t.s),r.l+=16,e}function aN(r,e){return e==null&&(e=_e(36)),e.write_shift(4,r[1].iauthor),Po(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var sN=en;function lN(r){return Ir(r.slice(0,54))}function oN(r){var e=Tn(),t=[];return Ce(e,628),Ce(e,630),r.forEach(function(i){i[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),Ce(e,632,lN(s.a)))})}),Ce(e,631),Ce(e,633),r.forEach(function(i){i[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var o={s:Or(i[0]),e:Or(i[0])};Ce(e,635,aN([o,s])),s.t&&s.t.length>0&&Ce(e,637,cb(s)),Ce(e,636),delete s.iauthor})}),Ce(e,634),Ce(e,629),e.end()}function uN(r,e){e.FullPaths.forEach(function(t,i){if(i!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Vt.utils.cfb_add(r,s,e.FileIndex[i].content)}})}var UT=["xlsb","xlsm","xlam","biff8","xla"],cN=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(i,s,o,u){var h=!1,g=!1;o.length==0?g=!0:o.charAt(0)=="["&&(g=!0,o=o.slice(1,-1)),u.length==0?h=!0:u.charAt(0)=="["&&(h=!0,u=u.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,v=u.length>0?parseInt(u,10)|0:0;return h?v+=e.c:--v,g?m+=e.r:--m,s+(h?"":"$")+Jr(v)+(g?"":"$")+Hr(m)}return function(s,o){return e=o,s.replace(r,t)}}(),mg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gg=function(){return function(e,t){return e.replace(mg,function(i,s,o,u,h,g){var m=og(u)-(o?0:t.c),v=lg(g)-(h?0:t.r),x=v==0?"":h?v+1:"["+v+"]",y=m==0?"":o?m+1:"["+m+"]";return s+"R"+x+"C"+y})}}();function fN(r,e){return r.replace(mg,function(t,i,s,o,u,h){return i+(s=="$"?s+o:Jr(og(o)+e.c))+(u=="$"?u+h:Hr(lg(h)+e.r))})}function hN(r){return r.length!=1}function cr(r){r.l+=1}function vs(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function jT(r,e,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return zT(r);t.biff==12&&(i=4)}var s=r.read_shift(i),o=r.read_shift(i),u=vs(r),h=vs(r);return{s:{r:s,c:u[0],cRel:u[1],rRel:u[2]},e:{r:o,c:h[0],cRel:h[1],rRel:h[2]}}}function zT(r){var e=vs(r),t=vs(r),i=r.read_shift(1),s=r.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function dN(r,e,t){if(t.biff<8)return zT(r);var i=r.read_shift(t.biff==12?4:2),s=r.read_shift(t.biff==12?4:2),o=vs(r),u=vs(r);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function HT(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return mN(r);var i=r.read_shift(t&&t.biff==12?4:2),s=vs(r);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function mN(r){var e=vs(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function gN(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function pN(r,e,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return vN(r);var s=r.read_shift(i>=12?4:2),o=r.read_shift(2),u=(o&16384)>>14,h=(o&32768)>>15;if(o&=16383,h==1)for(;s>524287;)s-=1048576;if(u==1)for(;o>8191;)o=o-16384;return{r:s,c:o,cRel:u,rRel:h}}function vN(r){var e=r.read_shift(2),t=r.read_shift(1),i=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),s==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:s,rRel:i}}function _N(r,e,t){var i=(r[r.l++]&96)>>5,s=jT(r,t.biff>=2&&t.biff<=5?6:8,t);return[i,s]}function xN(r,e,t){var i=(r[r.l++]&96)>>5,s=r.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:r.l+=12,o=6;break;case 12:o=12;break}var u=jT(r,o,t);return[i,s,u]}function yN(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function EN(r,e,t){var i=(r[r.l++]&96)>>5,s=r.read_shift(2),o=8;if(t)switch(t.biff){case 5:r.l+=12,o=6;break;case 12:o=12;break}return r.l+=o,[i,s]}function TN(r,e,t){var i=(r[r.l++]&96)>>5,s=dN(r,e-1,t);return[i,s]}function AN(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[i]}function ky(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function SN(r,e,t){r.l+=2;for(var i=r.read_shift(t&&t.biff==2?1:2),s=[],o=0;o<=i;++o)s.push(r.read_shift(t&&t.biff==2?1:2));return s}function wN(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function RN(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function CN(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function bN(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[i]}function GT(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function DN(r){return r.read_shift(2),GT(r)}function NN(r){return r.read_shift(2),GT(r)}function ON(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var s=HT(r,0,t);return[i,s]}function IN(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var s=pN(r,0,t);return[i,s]}function kN(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var s=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var o=HT(r,0,t);return[i,s,o]}function MN(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var s=r.read_shift(t&&t.biff<=3?1:2);return[MO[s],YT[s],i]}function FN(r,e,t){var i=r[r.l++],s=r.read_shift(1),o=t&&t.biff<=3?[i==88?-1:0,r.read_shift(1)]:PN(r);return[s,(o[0]===0?YT:kO)[o[1]]]}function PN(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function LN(r,e,t){r.l+=t&&t.biff==2?3:4}function VN(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var i=r.read_shift(2),s=r.read_shift(t&&t.biff==2?1:2);return[i,s]}function BN(r){return r.l++,Nc[r.read_shift(1)]}function UN(r){return r.l++,r.read_shift(2)}function jN(r){return r.l++,r.read_shift(1)!==0}function zN(r){return r.l++,Lo(r)}function HN(r,e,t){return r.l++,RT(r,e-1,t)}function GN(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=kb(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Nc[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=Lo(r);break;case 2:t[1]=Lb(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function qN(r,e,t){for(var i=r.read_shift(t.biff==12?4:2),s=[],o=0;o!=i;++o)s.push((t.biff==12?vl:Ub)(r));return s}function XN(r,e,t){var i=0,s=0;t.biff==12?(i=r.read_shift(4),s=r.read_shift(4)):(s=1+r.read_shift(1),i=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--s==0&&(s=256));for(var o=0,u=[];o!=i&&(u[o]=[]);++o)for(var h=0;h!=s;++h)u[o][h]=GN(r,t.biff);return u}function YN(r,e,t){var i=r.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,o=r.read_shift(s);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[i,0,o]}function KN(r,e,t){if(t.biff==5)return WN(r);var i=r.read_shift(1)>>>5&3,s=r.read_shift(2),o=r.read_shift(4);return[i,s,o]}function WN(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var i=r.read_shift(2);return r.l+=12,[e,t,i]}function QN(r,e,t){var i=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var s=r.read_shift(t&&t.biff==2?1:2);return[i,s]}function $N(r,e,t){var i=r.read_shift(1)>>>5&3,s=r.read_shift(t&&t.biff==2?1:2);return[i,s]}function ZN(r,e,t){var i=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[i]}function JN(r,e,t){var i=(r[r.l++]&96)>>5,s=r.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return r.l+=o,[i,s]}var eO=Ki,tO=Ki,rO=Ki;function Oc(r,e,t){return r.l+=2,[gN(r)]}function pg(r){return r.l+=6,[]}var nO=Oc,iO=pg,aO=pg,sO=Oc;function qT(r){return r.l+=2,[ST(r),r.read_shift(2)&1]}var lO=Oc,oO=qT,uO=pg,cO=Oc,fO=Oc,hO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function dO(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(4),s=r.read_shift(2),o=r.read_shift(2),u=hO[t>>2&31];return{ixti:e,coltype:t&3,rt:u,idx:i,c:s,C:o}}function mO(r){return r.l+=2,[r.read_shift(4)]}function gO(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function pO(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function vO(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function _O(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function xO(r){return r.l+=4,[0,0]}var My={1:{n:"PtgExp",f:VN},2:{n:"PtgTbl",f:rO},3:{n:"PtgAdd",f:cr},4:{n:"PtgSub",f:cr},5:{n:"PtgMul",f:cr},6:{n:"PtgDiv",f:cr},7:{n:"PtgPower",f:cr},8:{n:"PtgConcat",f:cr},9:{n:"PtgLt",f:cr},10:{n:"PtgLe",f:cr},11:{n:"PtgEq",f:cr},12:{n:"PtgGe",f:cr},13:{n:"PtgGt",f:cr},14:{n:"PtgNe",f:cr},15:{n:"PtgIsect",f:cr},16:{n:"PtgUnion",f:cr},17:{n:"PtgRange",f:cr},18:{n:"PtgUplus",f:cr},19:{n:"PtgUminus",f:cr},20:{n:"PtgPercent",f:cr},21:{n:"PtgParen",f:cr},22:{n:"PtgMissArg",f:cr},23:{n:"PtgStr",f:HN},26:{n:"PtgSheet",f:gO},27:{n:"PtgEndSheet",f:pO},28:{n:"PtgErr",f:BN},29:{n:"PtgBool",f:jN},30:{n:"PtgInt",f:UN},31:{n:"PtgNum",f:zN},32:{n:"PtgArray",f:AN},33:{n:"PtgFunc",f:MN},34:{n:"PtgFuncVar",f:FN},35:{n:"PtgName",f:YN},36:{n:"PtgRef",f:ON},37:{n:"PtgArea",f:_N},38:{n:"PtgMemArea",f:QN},39:{n:"PtgMemErr",f:eO},40:{n:"PtgMemNoMem",f:tO},41:{n:"PtgMemFunc",f:$N},42:{n:"PtgRefErr",f:ZN},43:{n:"PtgAreaErr",f:yN},44:{n:"PtgRefN",f:IN},45:{n:"PtgAreaN",f:TN},46:{n:"PtgMemAreaN",f:vO},47:{n:"PtgMemNoMemN",f:_O},57:{n:"PtgNameX",f:KN},58:{n:"PtgRef3d",f:kN},59:{n:"PtgArea3d",f:xN},60:{n:"PtgRefErr3d",f:JN},61:{n:"PtgAreaErr3d",f:EN},255:{}},yO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},EO={1:{n:"PtgElfLel",f:qT},2:{n:"PtgElfRw",f:cO},3:{n:"PtgElfCol",f:nO},6:{n:"PtgElfRwV",f:fO},7:{n:"PtgElfColV",f:sO},10:{n:"PtgElfRadical",f:lO},11:{n:"PtgElfRadicalS",f:uO},13:{n:"PtgElfColS",f:iO},15:{n:"PtgElfColSV",f:aO},16:{n:"PtgElfRadicalLel",f:oO},25:{n:"PtgList",f:dO},29:{n:"PtgSxName",f:mO},255:{}},TO={0:{n:"PtgAttrNoop",f:xO},1:{n:"PtgAttrSemi",f:bN},2:{n:"PtgAttrIf",f:RN},4:{n:"PtgAttrChoose",f:SN},8:{n:"PtgAttrGoto",f:wN},16:{n:"PtgAttrSum",f:LN},32:{n:"PtgAttrBaxcel",f:ky},33:{n:"PtgAttrBaxcel",f:ky},64:{n:"PtgAttrSpace",f:DN},65:{n:"PtgAttrSpaceSemi",f:NN},128:{n:"PtgAttrIfError",f:CN},255:{}};function AO(r,e,t,i){if(i.biff<8)return Ki(r,e);for(var s=r.l+e,o=[],u=0;u!==t.length;++u)switch(t[u][0]){case"PtgArray":t[u][1]=XN(r,0,i),o.push(t[u][1]);break;case"PtgMemArea":t[u][2]=qN(r,t[u][1],i),o.push(t[u][2]);break;case"PtgExp":i&&i.biff==12&&(t[u][1][1]=r.read_shift(4),o.push(t[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[u][0]}return e=s-r.l,e!==0&&o.push(Ki(r,e)),o}function SO(r,e,t){for(var i=r.l+e,s,o,u=[];i!=r.l;)e=i-r.l,o=r[r.l],s=My[o]||My[yO[o]],(o===24||o===25)&&(s=(o===24?EO:TO)[r[r.l+1]]),!s||!s.f?Ki(r,e):u.push([s.n,s.f(r,e,t)]);return u}function wO(r){for(var e=[],t=0;t<r.length;++t){for(var i=r[t],s=[],o=0;o<i.length;++o){var u=i[o];if(u)switch(u[0]){case 2:s.push('"'+u[1].replace(/"/g,'""')+'"');break;default:s.push(u[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var RO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function CO(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function XT(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var i=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!i)return"SH33TJSERR1";var s="";if(t.biff>8)switch(r[i[0]][0]){case 357:return s=i[1]==-1?"#REF":r.SheetNames[i[1]],i[1]==i[2]?s:s+":"+r.SheetNames[i[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[i[0]][0];case 355:default:return"SH33TJSSRC"+r[i[0]][0]}switch(r[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":r.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+r.SheetNames[i[2]];case 14849:return r[i[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return r[i[0]][0][3]?(s=i[1]==-1?"#REF":r[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+r[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Fy(r,e,t){var i=XT(r,e,t);return i=="#REF"?i:CO(i,t)}function Co(r,e,t,i,s){var o=s&&s.biff||8,u={s:{c:0,r:0}},h=[],g,m,v,x=0,y=0,T,b="";if(!r[0]||!r[0][0])return"";for(var S=-1,w="",G=0,Z=r[0].length;G<Z;++G){var K=r[0][G];switch(K[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=h.pop(),m=h.pop(),S>=0){switch(r[0][S][1][0]){case 0:w=er(" ",r[0][S][1][1]);break;case 1:w=er("\r",r[0][S][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][S][1][0])}m=m+w,S=-1}h.push(m+RO[K[0]]+g);break;case"PtgIsect":g=h.pop(),m=h.pop(),h.push(m+" "+g);break;case"PtgUnion":g=h.pop(),m=h.pop(),h.push(m+","+g);break;case"PtgRange":g=h.pop(),m=h.pop(),h.push(m+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":v=ec(K[1][1],u,s),h.push(tc(v,o));break;case"PtgRefN":v=t?ec(K[1][1],t,s):K[1][1],h.push(tc(v,o));break;case"PtgRef3d":x=K[1][1],v=ec(K[1][2],u,s),b=Fy(i,x,s),h.push(b+"!"+tc(v,o));break;case"PtgFunc":case"PtgFuncVar":var ne=K[1][0],pe=K[1][1];ne||(ne=0),ne&=127;var Re=ne==0?[]:h.slice(-ne);h.length-=ne,pe==="User"&&(pe=Re.shift()),h.push(pe+"("+Re.join(",")+")");break;case"PtgBool":h.push(K[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(K[1]);break;case"PtgNum":h.push(String(K[1]));break;case"PtgStr":h.push('"'+K[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(K[1]);break;case"PtgAreaN":T=xy(K[1][1],t?{s:t}:u,s),h.push(D1(T,s));break;case"PtgArea":T=xy(K[1][1],u,s),h.push(D1(T,s));break;case"PtgArea3d":x=K[1][1],T=K[1][2],b=Fy(i,x,s),h.push(b+"!"+D1(T,s));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=K[1][2];var N=(i.names||[])[y-1]||(i[0]||[])[y],D=N?N.Name:"SH33TJSNAME"+String(y);D&&D.slice(0,6)=="_xlfn."&&!s.xlfn&&(D=D.slice(6)),h.push(D);break;case"PtgNameX":var R=K[1][1];y=K[1][2];var k;if(s.biff<=5)R<0&&(R=-R),i[R]&&(k=i[R][y]);else{var F="";if(((i[R]||[])[0]||[])[0]==14849||(((i[R]||[])[0]||[])[0]==1025?i[R][y]&&i[R][y].itab>0&&(F=i.SheetNames[i[R][y].itab-1]+"!"):F=i.SheetNames[y-1]+"!"),i[R]&&i[R][y])F+=i[R][y].Name;else if(i[0]&&i[0][y])F+=i[0][y].Name;else{var B=(XT(i,R,s)||"").split(";;");B[y-1]?F=B[y-1]:F+="SH33TJSERRX"}h.push(F);break}k||(k={Name:"SH33TJSERRY"}),h.push(k.Name);break;case"PtgParen":var P="(",qe=")";if(S>=0){switch(w="",r[0][S][1][0]){case 2:P=er(" ",r[0][S][1][1])+P;break;case 3:P=er("\r",r[0][S][1][1])+P;break;case 4:qe=er(" ",r[0][S][1][1])+qe;break;case 5:qe=er("\r",r[0][S][1][1])+qe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][S][1][0])}S=-1}h.push(P+h.pop()+qe);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":v={c:K[1][1],r:K[1][0]};var Be={c:t.c,r:t.r};if(i.sharedf[kt(v)]){var J=i.sharedf[kt(v)];h.push(Co(J,u,Be,i,s))}else{var ye=!1;for(g=0;g!=i.arrayf.length;++g)if(m=i.arrayf[g],!(v.c<m[0].s.c||v.c>m[0].e.c)&&!(v.r<m[0].s.r||v.r>m[0].e.r)){h.push(Co(m[1],u,Be,i,s)),ye=!0;break}ye||h.push(K[1])}break;case"PtgArray":h.push("{"+wO(K[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=G;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+K[1].idx+"[#"+K[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(K));default:throw new Error("Unrecognized Formula Token: "+String(K))}var Pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&S>=0&&Pe.indexOf(r[0][G][0])==-1){K=r[0][S];var He=!0;switch(K[1][0]){case 4:He=!1;case 0:w=er(" ",K[1][1]);break;case 5:He=!1;case 1:w=er("\r",K[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+K[1][0])}h.push((He?w:"")+h.pop()+(He?"":w)),S=-1}}if(h.length>1&&s.WTF)throw new Error("bad formula stack");return h[0]}function bO(r){if(r==null){var e=_e(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return ul(r);return ul(0)}function DO(r,e,t,i,s){var o=cl(e,t,s),u=bO(r.v),h=_e(6),g=33;h.write_shift(2,g),h.write_shift(4,0);for(var m=_e(r.bf.length),v=0;v<r.bf.length;++v)m[v]=r.bf[v];var x=jr([o,u,h,m]);return x}function dh(r,e,t){var i=r.read_shift(4),s=SO(r,i,t),o=r.read_shift(4),u=o>0?AO(r,o,s,t):null;return[s,u]}var NO=dh,mh=dh,OO=dh,IO=dh,kO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},YT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},MO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function FO(r){var e="of:="+r.replace(mg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function PO(r){return r.replace(/\./,"!")}var rc=typeof Map<"u";function vg(r,e,t){var i=0,s=r.length;if(t){if(rc?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var o=rc?t.get(e):t[e];i<o.length;++i)if(r[o[i]].t===e)return r.Count++,o[i]}}else for(;i<s;++i)if(r[i].t===e)return r.Count++,i;return r[s]={t:e},r.Count++,r.Unique++,t&&(rc?(t.has(e)||t.set(e,[]),t.get(e).push(s)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(s))),s}function gh(r,e){var t={min:r+1,max:r+1},i=-1;return e.MDW&&(xa=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?i=H0(e.wpx):e.wch!=null&&(i=e.wch),i>-1?(t.width=um(i),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function KT(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function Ts(r,e,t){var i=t.revssf[e.z!=null?e.z:"General"],s=60,o=r.length;if(i==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){HE(e.z,s),t.ssf[s]=e.z,t.revssf[e.z]=i=s;break}}for(s=0;s!=o;++s)if(r[s].numFmtId===i)return s;return r[o]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function LO(r,e,t){if(r&&r["!ref"]){var i=Xt(r["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function VO(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+gr(r[t])+'"/>';return e+"</mergeCells>"}function BO(r,e,t,i,s){var o=!1,u={},h=null;if(i.bookType!=="xlsx"&&e.vbaraw){var g=e.SheetNames[t];try{e.Workbook&&(g=e.Workbook.Sheets[t].CodeName||g)}catch{}o=!0,u.codeName=gc(It(g))}if(r&&r["!outline"]){var m={summaryBelow:1,summaryRight:1};r["!outline"].above&&(m.summaryBelow=0),r["!outline"].left&&(m.summaryRight=0),h=(h||"")+ke("outlinePr",null,m)}!o&&!h||(s[s.length]=ke("sheetPr",h,u))}var UO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],jO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function zO(r){var e={sheet:1};return UO.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),jO.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=OT(r.password).toString(16).toUpperCase()),ke("sheetProtection",null,e)}function HO(r){return KT(r),ke("pageMargins",null,r)}function GO(r,e){for(var t=["<cols>"],i,s=0;s!=e.length;++s)(i=e[s])&&(t[t.length]=ke("col",null,gh(s,i)));return t[t.length]="</cols>",t.join("")}function qO(r,e,t,i){var s=typeof r.ref=="string"?r.ref:gr(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,u=Bn(s);u.s.r==u.e.r&&(u.e.r=Bn(e["!ref"]).e.r,s=gr(u));for(var h=0;h<o.length;++h){var g=o[h];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==i){g.Ref="'"+t.SheetNames[i]+"'!"+s;break}}return h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+s}),ke("autoFilter",null,{ref:s})}function XO(r,e,t,i){var s={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),ke("sheetViews",ke("sheetView",null,s),{})}function YO(r,e,t,i){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var s="",o=r.t,u=r.v;if(r.t!=="z")switch(r.t){case"b":s=r.v?"1":"0";break;case"n":s=""+r.v;break;case"e":s=Nc[r.v];break;case"d":i&&i.cellDates?s=fn(r.v,-1).toISOString():(r=Sn(r),r.t="n",s=""+(r.v=An(fn(r.v)))),typeof r.z>"u"&&(r.z=tr[14]);break;default:s=r.v;break}var h=zr("v",It(s)),g={r:e},m=Ts(i.cellXfs,r,i);switch(m!==0&&(g.s=m),r.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){h=zr("v",""+vg(i.Strings,r.v,i.revStrings)),g.t="s";break}g.t="str";break}if(r.t!=o&&(r.t=o,r.v=u),typeof r.f=="string"&&r.f){var v=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;h=ke("f",It(r.f),v)+(r.v!=null?h:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(g.cm=1),ke("c",h,g)}function KO(r,e,t,i){var s=[],o=[],u=Xt(r["!ref"]),h="",g,m="",v=[],x=0,y=0,T=r["!rows"],b=Array.isArray(r),S={r:m},w,G=-1;for(y=u.s.c;y<=u.e.c;++y)v[y]=Jr(y);for(x=u.s.r;x<=u.e.r;++x){for(o=[],m=Hr(x),y=u.s.c;y<=u.e.c;++y){g=v[y]+m;var Z=b?(r[x]||[])[y]:r[g];Z!==void 0&&(h=YO(Z,g,r,e))!=null&&o.push(h)}(o.length>0||T&&T[x])&&(S={r:m},T&&T[x]&&(w=T[x],w.hidden&&(S.hidden=1),G=-1,w.hpx?G=G0(w.hpx):w.hpt&&(G=w.hpt),G>-1&&(S.ht=G,S.customHeight=1),w.level&&(S.outlineLevel=w.level)),s[s.length]=ke("row",o.join(""),S))}if(T)for(;x<T.length;++x)T&&T[x]&&(S={r:x+1},w=T[x],w.hidden&&(S.hidden=1),G=-1,w.hpx?G=G0(w.hpx):w.hpt&&(G=w.hpt),G>-1&&(S.ht=G,S.customHeight=1),w.level&&(S.outlineLevel=w.level),s[s.length]=ke("row","",S));return s.join("")}function WT(r,e,t,i){var s=[pr,ke("worksheet",null,{xmlns:Mo[0],"xmlns:r":Nr.r})],o=t.SheetNames[r],u=0,h="",g=t.Sheets[o];g==null&&(g={});var m=g["!ref"]||"A1",v=Xt(m);if(v.e.c>16383||v.e.r>1048575){if(e.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");v.e.c=Math.min(v.e.c,16383),v.e.r=Math.min(v.e.c,1048575),m=gr(v)}i||(i={}),g["!comments"]=[];var x=[];BO(g,t,r,e,s),s[s.length]=ke("dimension",null,{ref:m}),s[s.length]=XO(g,e,r,t),e.sheetFormat&&(s[s.length]=ke("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(s[s.length]=GO(g,g["!cols"])),s[u=s.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(h=KO(g,e),h.length>0&&(s[s.length]=h)),s.length>u+1&&(s[s.length]="</sheetData>",s[u]=s[u].replace("/>",">")),g["!protect"]&&(s[s.length]=zO(g["!protect"])),g["!autofilter"]!=null&&(s[s.length]=qO(g["!autofilter"],g,t,r)),g["!merges"]!=null&&g["!merges"].length>0&&(s[s.length]=VO(g["!merges"]));var y=-1,T,b=-1;return g["!links"].length>0&&(s[s.length]="<hyperlinks>",g["!links"].forEach(function(S){S[1].Target&&(T={ref:S[0]},S[1].Target.charAt(0)!="#"&&(b=Ot(i,-1,It(S[1].Target).replace(/#.*$/,""),At.HLINK),T["r:id"]="rId"+b),(y=S[1].Target.indexOf("#"))>-1&&(T.location=It(S[1].Target.slice(y+1))),S[1].Tooltip&&(T.tooltip=It(S[1].Tooltip)),s[s.length]=ke("hyperlink",null,T))}),s[s.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(s[s.length]=HO(g["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=zr("ignoredErrors",ke("ignoredError",null,{numberStoredAsText:1,sqref:m}))),x.length>0&&(b=Ot(i,-1,"../drawings/drawing"+(r+1)+".xml",At.DRAW),s[s.length]=ke("drawing",null,{"r:id":"rId"+b}),g["!drawing"]=x),g["!comments"].length>0&&(b=Ot(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",At.VML),s[s.length]=ke("legacyDrawing",null,{"r:id":"rId"+b}),g["!legacy"]=b),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function WO(r,e){var t={},i=r.l+e;t.r=r.read_shift(4),r.l+=4;var s=r.read_shift(2);r.l+=1;var o=r.read_shift(1);return r.l=i,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=s/20),t}function QO(r,e,t){var i=_e(145),s=(t["!rows"]||[])[r]||{};i.write_shift(4,r),i.write_shift(4,0);var o=320;s.hpx?o=G0(s.hpx)*20:s.hpt&&(o=s.hpt*20),i.write_shift(2,o),i.write_shift(1,0);var u=0;s.level&&(u|=s.level),s.hidden&&(u|=16),(s.hpx||s.hpt)&&(u|=32),i.write_shift(1,u),i.write_shift(1,0);var h=0,g=i.l;i.l+=4;for(var m={r,c:0},v=0;v<16;++v)if(!(e.s.c>v+1<<10||e.e.c<v<<10)){for(var x=-1,y=-1,T=v<<10;T<v+1<<10;++T){m.c=T;var b=Array.isArray(t)?(t[m.r]||[])[m.c]:t[kt(m)];b&&(x<0&&(x=T),y=T)}x<0||(++h,i.write_shift(4,x),i.write_shift(4,y))}var S=i.l;return i.l=g,i.write_shift(4,h),i.l=S,i.length>i.l?i.slice(0,i.l):i}function $O(r,e,t,i){var s=QO(i,t,e);(s.length>17||(e["!rows"]||[])[i])&&Ce(r,0,s)}var ZO=vl,JO=Po;function e5(){}function t5(r,e){var t={},i=r[r.l];return++r.l,t.above=!(i&64),t.left=!(i&128),r.l+=18,t.name=fb(r),t}function r5(r,e,t){t==null&&(t=_e(84+4*r.length));var i=192;e&&(e.above&&(i&=-65),e.left&&(i&=-129)),t.write_shift(1,i);for(var s=1;s<3;++s)t.write_shift(1,0);return U0({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),cT(r,t),t.slice(0,t.l)}function n5(r){var e=ri(r);return[e]}function i5(r,e,t){return t==null&&(t=_e(8)),ml(e,t)}function a5(r){var e=gl(r);return[e]}function s5(r,e,t){return t==null&&(t=_e(4)),pl(e,t)}function l5(r){var e=ri(r),t=r.read_shift(1);return[e,t,"b"]}function o5(r,e,t){return t==null&&(t=_e(9)),ml(e,t),t.write_shift(1,r.v?1:0),t}function u5(r){var e=gl(r),t=r.read_shift(1);return[e,t,"b"]}function c5(r,e,t){return t==null&&(t=_e(5)),pl(e,t),t.write_shift(1,r.v?1:0),t}function f5(r){var e=ri(r),t=r.read_shift(1);return[e,t,"e"]}function h5(r,e,t){return t==null&&(t=_e(9)),ml(e,t),t.write_shift(1,r.v),t}function d5(r){var e=gl(r),t=r.read_shift(1);return[e,t,"e"]}function m5(r,e,t){return t==null&&(t=_e(8)),pl(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function g5(r){var e=ri(r),t=r.read_shift(4);return[e,t,"s"]}function p5(r,e,t){return t==null&&(t=_e(12)),ml(e,t),t.write_shift(4,e.v),t}function v5(r){var e=gl(r),t=r.read_shift(4);return[e,t,"s"]}function _5(r,e,t){return t==null&&(t=_e(8)),pl(e,t),t.write_shift(4,e.v),t}function x5(r){var e=ri(r),t=Lo(r);return[e,t,"n"]}function y5(r,e,t){return t==null&&(t=_e(16)),ml(e,t),ul(r.v,t),t}function E5(r){var e=gl(r),t=Lo(r);return[e,t,"n"]}function T5(r,e,t){return t==null&&(t=_e(12)),pl(e,t),ul(r.v,t),t}function A5(r){var e=ri(r),t=fT(r);return[e,t,"n"]}function S5(r,e,t){return t==null&&(t=_e(12)),ml(e,t),hT(r.v,t),t}function w5(r){var e=gl(r),t=fT(r);return[e,t,"n"]}function R5(r,e,t){return t==null&&(t=_e(8)),pl(e,t),hT(r.v,t),t}function C5(r){var e=ri(r),t=ug(r);return[e,t,"is"]}function b5(r){var e=ri(r),t=en(r);return[e,t,"str"]}function D5(r,e,t){return t==null&&(t=_e(12+4*r.v.length)),ml(e,t),Ir(r.v,t),t.length>t.l?t.slice(0,t.l):t}function N5(r){var e=gl(r),t=en(r);return[e,t,"str"]}function O5(r,e,t){return t==null&&(t=_e(8+4*r.v.length)),pl(e,t),Ir(r.v,t),t.length>t.l?t.slice(0,t.l):t}function I5(r,e,t){var i=r.l+e,s=ri(r);s.r=t["!row"];var o=r.read_shift(1),u=[s,o,"b"];if(t.cellFormula){r.l+=2;var h=mh(r,i-r.l,t);u[3]=Co(h,null,s,t.supbooks,t)}else r.l=i;return u}function k5(r,e,t){var i=r.l+e,s=ri(r);s.r=t["!row"];var o=r.read_shift(1),u=[s,o,"e"];if(t.cellFormula){r.l+=2;var h=mh(r,i-r.l,t);u[3]=Co(h,null,s,t.supbooks,t)}else r.l=i;return u}function M5(r,e,t){var i=r.l+e,s=ri(r);s.r=t["!row"];var o=Lo(r),u=[s,o,"n"];if(t.cellFormula){r.l+=2;var h=mh(r,i-r.l,t);u[3]=Co(h,null,s,t.supbooks,t)}else r.l=i;return u}function F5(r,e,t){var i=r.l+e,s=ri(r);s.r=t["!row"];var o=en(r),u=[s,o,"str"];if(t.cellFormula){r.l+=2;var h=mh(r,i-r.l,t);u[3]=Co(h,null,s,t.supbooks,t)}else r.l=i;return u}var P5=vl,L5=Po;function V5(r,e){return e==null&&(e=_e(4)),e.write_shift(4,r),e}function B5(r,e){var t=r.l+e,i=vl(r),s=cg(r),o=en(r),u=en(r),h=en(r);r.l=t;var g={rfx:i,relId:s,loc:o,display:h};return u&&(g.Tooltip=u),g}function U5(r,e){var t=_e(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));Po({s:Or(r[0]),e:Or(r[0])},t),fg("rId"+e,t);var i=r[1].Target.indexOf("#"),s=i==-1?"":r[1].Target.slice(i+1);return Ir(s||"",t),Ir(r[1].Tooltip||"",t),Ir("",t),t.slice(0,t.l)}function j5(){}function z5(r,e,t){var i=r.l+e,s=dT(r),o=r.read_shift(1),u=[s];if(u[2]=o,t.cellFormula){var h=NO(r,i-r.l,t);u[1]=h}else r.l=i;return u}function H5(r,e,t){var i=r.l+e,s=vl(r),o=[s];if(t.cellFormula){var u=IO(r,i-r.l,t);o[1]=u,r.l=i}else r.l=i;return o}function G5(r,e,t){t==null&&(t=_e(18));var i=gh(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof i.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),t.write_shift(2,s),t}var QT=["left","right","top","bottom","header","footer"];function q5(r){var e={};return QT.forEach(function(t){e[t]=Lo(r)}),e}function X5(r,e){return e==null&&(e=_e(6*8)),KT(r),QT.forEach(function(t){ul(r[t],e)}),e}function Y5(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function K5(r,e,t){t==null&&(t=_e(30));var i=924;return(((e||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function W5(r){var e=_e(24);return e.write_shift(4,4),e.write_shift(4,1),Po(r,e),e}function Q5(r,e){return e==null&&(e=_e(16*4+2)),e.write_shift(2,r.password?OT(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function $5(){}function Z5(){}function J5(r,e,t,i,s,o,u){if(e.v===void 0)return!1;var h="";switch(e.t){case"b":h=e.v?"1":"0";break;case"d":e=Sn(e),e.z=e.z||tr[14],e.v=An(fn(e.v)),e.t="n";break;case"n":case"e":h=""+e.v;break;default:h=e.v;break}var g={r:t,c:i};switch(g.s=Ts(s.cellXfs,e,s),e.l&&o["!links"].push([kt(g),e.l]),e.c&&o["!comments"].push([kt(g),e.c]),e.t){case"s":case"str":return s.bookSST?(h=vg(s.Strings,e.v,s.revStrings),g.t="s",g.v=h,u?Ce(r,18,_5(e,g)):Ce(r,7,p5(e,g))):(g.t="str",u?Ce(r,17,O5(e,g)):Ce(r,6,D5(e,g))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?u?Ce(r,13,R5(e,g)):Ce(r,2,S5(e,g)):u?Ce(r,16,T5(e,g)):Ce(r,5,y5(e,g)),!0;case"b":return g.t="b",u?Ce(r,15,c5(e,g)):Ce(r,4,o5(e,g)),!0;case"e":return g.t="e",u?Ce(r,14,m5(e,g)):Ce(r,3,h5(e,g)),!0}return u?Ce(r,12,s5(e,g)):Ce(r,1,i5(e,g)),!0}function e8(r,e,t,i){var s=Xt(e["!ref"]||"A1"),o,u="",h=[];Ce(r,145);var g=Array.isArray(e),m=s.e.r;e["!rows"]&&(m=Math.max(s.e.r,e["!rows"].length-1));for(var v=s.s.r;v<=m;++v){u=Hr(v),$O(r,e,s,v);var x=!1;if(v<=s.e.r)for(var y=s.s.c;y<=s.e.c;++y){v===s.s.r&&(h[y]=Jr(y)),o=h[y]+u;var T=g?(e[v]||[])[y]:e[o];if(!T){x=!1;continue}x=J5(r,T,v,y,i,e,x)}}Ce(r,146)}function t8(r,e){!e||!e["!merges"]||(Ce(r,177,V5(e["!merges"].length)),e["!merges"].forEach(function(t){Ce(r,176,L5(t))}),Ce(r,178))}function r8(r,e){!e||!e["!cols"]||(Ce(r,390),e["!cols"].forEach(function(t,i){t&&Ce(r,60,G5(i,t))}),Ce(r,391))}function n8(r,e){!e||!e["!ref"]||(Ce(r,648),Ce(r,649,W5(Xt(e["!ref"]))),Ce(r,650))}function i8(r,e,t){e["!links"].forEach(function(i){if(i[1].Target){var s=Ot(t,-1,i[1].Target.replace(/#.*$/,""),At.HLINK);Ce(r,494,U5(i,s))}}),delete e["!links"]}function a8(r,e,t,i){if(e["!comments"].length>0){var s=Ot(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",At.VML);Ce(r,551,fg("rId"+s)),e["!legacy"]=s}}function s8(r,e,t,i){if(e["!autofilter"]){var s=e["!autofilter"],o=typeof s.ref=="string"?s.ref:gr(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var u=t.Workbook.Names,h=Bn(o);h.s.r==h.e.r&&(h.e.r=Bn(e["!ref"]).e.r,o=gr(h));for(var g=0;g<u.length;++g){var m=u[g];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==i){m.Ref="'"+t.SheetNames[i]+"'!"+o;break}}g==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+o}),Ce(r,161,Po(Xt(o))),Ce(r,162)}}function l8(r,e,t){Ce(r,133),Ce(r,137,K5(e,t)),Ce(r,138),Ce(r,134)}function o8(r,e){e["!protect"]&&Ce(r,535,Q5(e["!protect"]))}function u8(r,e,t,i){var s=Tn(),o=t.SheetNames[r],u=t.Sheets[o]||{},h=o;try{t&&t.Workbook&&(h=t.Workbook.Sheets[r].CodeName||h)}catch{}var g=Xt(u["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(e.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],Ce(s,129),(t.vbaraw||u["!outline"])&&Ce(s,147,r5(h,u["!outline"])),Ce(s,148,JO(g)),l8(s,u,t.Workbook),r8(s,u),e8(s,u,r,e),o8(s,u),s8(s,u,t,r),t8(s,u),i8(s,u,i),u["!margins"]&&Ce(s,476,X5(u["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&n8(s,u),a8(s,u,r,i),Ce(s,130),s.end()}function c8(r,e){r.l+=10;var t=en(r);return{name:t}}var f8=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function h8(r){return!r.Workbook||!r.Workbook.WBProps?"false":H6(r.Workbook.WBProps.date1904)?"true":"false"}var d8="][*?/\\".split("");function $T(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return d8.forEach(function(i){if(r.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function m8(r,e,t){r.forEach(function(i,s){$T(i);for(var o=0;o<s;++o)if(i==r[o])throw new Error("Duplicate Sheet Name: "+i);if(t){var u=e&&e[s]&&e[s].CodeName||i;if(u.charCodeAt(0)==95&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}function g8(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];m8(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)LO(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}function ZT(r){var e=[pr];e[e.length]=ke("workbook",null,{xmlns:Mo[0],"xmlns:r":Nr.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(f8.forEach(function(h){r.Workbook.WBProps[h[0]]!=null&&r.Workbook.WBProps[h[0]]!=h[1]&&(i[h[0]]=r.Workbook.WBProps[h[0]])}),r.Workbook.WBProps.CodeName&&(i.codeName=r.Workbook.WBProps.CodeName,delete i.CodeName)),e[e.length]=ke("workbookPr",null,i);var s=r.Workbook&&r.Workbook.Sheets||[],o=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=r.SheetNames.length&&!(!s[o]||!s[o].Hidden);++o);o==r.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=r.SheetNames.length;++o){var u={name:It(r.SheetNames[o].slice(0,31))};if(u.sheetId=""+(o+1),u["r:id"]="rId"+(o+1),s[o])switch(s[o].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden";break}e[e.length]=ke("sheet",null,u)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(h){var g={name:h.Name};h.Comment&&(g.comment=h.Comment),h.Sheet!=null&&(g.localSheetId=""+h.Sheet),h.Hidden&&(g.hidden="1"),h.Ref&&(e[e.length]=ke("definedName",It(h.Ref),g))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function p8(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=om(r),t.name=en(r),t}function v8(r,e){return e||(e=_e(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),fg(r.strRelID,e),Ir(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function _8(r,e){var t={},i=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var s=e>8?en(r):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function x8(r,e){e||(e=_e(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),cT(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function y8(r,e,t){var i=r.l+e;r.l+=4,r.l+=1;var s=r.read_shift(4),o=hb(r),u=OO(r,0,t),h=cg(r);r.l=i;var g={Name:o,Ptg:u};return s<268435455&&(g.Sheet=s),h&&(g.Comment=h),g}function E8(r,e){Ce(r,143);for(var t=0;t!=e.SheetNames.length;++t){var i=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,s={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ce(r,156,v8(s))}Ce(r,144)}function T8(r,e){e||(e=_e(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Ir("SheetJS",e),Ir(I0.version,e),Ir(I0.version,e),Ir("7262",e),e.length>e.l?e.slice(0,e.l):e}function A8(r,e){e||(e=_e(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function S8(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,i=0,s=-1,o=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&s==-1?s=i:t[i].Hidden==1&&o==-1&&(o=i);o>s||(Ce(r,135),Ce(r,158,A8(s)),Ce(r,136))}}function w8(r,e){var t=Tn();return Ce(t,131),Ce(t,128,T8()),Ce(t,153,x8(r.Workbook&&r.Workbook.WBProps||null)),S8(t,r),E8(t,r),Ce(t,132),t.end()}function R8(r,e,t){return(e.slice(-4)===".bin"?w8:ZT)(r)}function C8(r,e,t,i,s){return(e.slice(-4)===".bin"?u8:WT)(r,t,i,s)}function b8(r,e,t){return(e.slice(-4)===".bin"?XD:MT)(r,t)}function D8(r,e,t){return(e.slice(-4)===".bin"?xD:NT)(r,t)}function N8(r,e,t){return(e.slice(-4)===".bin"?oN:BT)(r)}function O8(r){return(r.slice(-4)===".bin"?eN:LT)()}function I8(r,e){var t=[];return r.Props&&t.push(bb(r.Props,e)),r.Custprops&&t.push(Db(r.Props,r.Custprops)),t.join("")}function k8(){return""}function M8(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(i,s){var o=[];o.push(ke("NumberFormat",null,{"ss:Format":It(tr[i.numFmtId])}));var u={"ss:ID":"s"+(21+s)};t.push(ke("Style",o.join(""),u))}),ke("Styles",t.join(""))}function JT(r){return ke("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+gg(r.Ref,{r:0,c:0})})}function F8(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],i=0;i<e.length;++i){var s=e[i];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(JT(s)))}return ke("Names",t.join(""))}function P8(r,e,t,i){if(!r||!((i||{}).Workbook||{}).Names)return"";for(var s=i.Workbook.Names,o=[],u=0;u<s.length;++u){var h=s[u];h.Sheet==t&&(h.Name.match(/^_xlfn\./)||o.push(JT(h)))}return o.join("")}function L8(r,e,t,i){if(!r)return"";var s=[];if(r["!margins"]&&(s.push("<PageSetup>"),r["!margins"].header&&s.push(ke("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&s.push(ke("Footer",null,{"x:Margin":r["!margins"].footer})),s.push(ke("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),s.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)s.push(ke("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(i.Workbook.Sheets[o]&&!i.Workbook.Sheets[o].Hidden);++o);o==t&&s.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),r["!protect"]&&(s.push(zr("ProtectContents","True")),r["!protect"].objects&&s.push(zr("ProtectObjects","True")),r["!protect"].scenarios&&s.push(zr("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?s.push(zr("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&s.push(zr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){r["!protect"][u[0]]&&s.push("<"+u[1]+"/>")})),s.length==0?"":ke("WorksheetOptions",s.join(""),{xmlns:Pn.x})}function V8(r){return r.map(function(e){var t=z6(e.t||""),i=ke("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return ke("Comment",i,{"ss:Author":e.a})}).join("")}function B8(r,e,t,i,s,o,u){if(!r||r.v==null&&r.f==null)return"";var h={};if(r.f&&(h["ss:Formula"]="="+It(gg(r.f,u))),r.F&&r.F.slice(0,e.length)==e){var g=Or(r.F.slice(e.length+1));h["ss:ArrayRange"]="RC:R"+(g.r==u.r?"":"["+(g.r-u.r)+"]")+"C"+(g.c==u.c?"":"["+(g.c-u.c)+"]")}if(r.l&&r.l.Target&&(h["ss:HRef"]=It(r.l.Target),r.l.Tooltip&&(h["x:HRefScreenTip"]=It(r.l.Tooltip))),t["!merges"])for(var m=t["!merges"],v=0;v!=m.length;++v)m[v].s.c!=u.c||m[v].s.r!=u.r||(m[v].e.c>m[v].s.c&&(h["ss:MergeAcross"]=m[v].e.c-m[v].s.c),m[v].e.r>m[v].s.r&&(h["ss:MergeDown"]=m[v].e.r-m[v].s.r));var x="",y="";switch(r.t){case"z":if(!i.sheetStubs)return"";break;case"n":x="Number",y=String(r.v);break;case"b":x="Boolean",y=r.v?"1":"0";break;case"e":x="Error",y=Nc[r.v];break;case"d":x="DateTime",y=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||tr[14]);break;case"s":x="String",y=j6(r.v||"");break}var T=Ts(i.cellXfs,r,i);h["ss:StyleID"]="s"+(21+T),h["ss:Index"]=u.c+1;var b=r.v!=null?y:"",S=r.t=="z"?"":'<Data ss:Type="'+x+'">'+b+"</Data>";return(r.c||[]).length>0&&(S+=V8(r.c)),ke("Cell",S,h)}function U8(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=kT(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function j8(r,e,t,i){if(!r["!ref"])return"";var s=Xt(r["!ref"]),o=r["!merges"]||[],u=0,h=[];r["!cols"]&&r["!cols"].forEach(function(w,G){dg(w);var Z=!!w.width,K=gh(G,w),ne={"ss:Index":G+1};Z&&(ne["ss:Width"]=z0(K.width)),w.hidden&&(ne["ss:Hidden"]="1"),h.push(ke("Column",null,ne))});for(var g=Array.isArray(r),m=s.s.r;m<=s.e.r;++m){for(var v=[U8(m,(r["!rows"]||[])[m])],x=s.s.c;x<=s.e.c;++x){var y=!1;for(u=0;u!=o.length;++u)if(!(o[u].s.c>x)&&!(o[u].s.r>m)&&!(o[u].e.c<x)&&!(o[u].e.r<m)){(o[u].s.c!=x||o[u].s.r!=m)&&(y=!0);break}if(!y){var T={r:m,c:x},b=kt(T),S=g?(r[m]||[])[x]:r[b];v.push(B8(S,b,r,e,t,i,T))}}v.push("</Row>"),v.length>2&&h.push(v.join(""))}return h.join("")}function z8(r,e,t){var i=[],s=t.SheetNames[r],o=t.Sheets[s],u=o?P8(o,e,r,t):"";return u.length>0&&i.push("<Names>"+u+"</Names>"),u=o?j8(o,e,r,t):"",u.length>0&&i.push("<Table>"+u+"</Table>"),i.push(L8(o,e,r,t)),i.join("")}function H8(r,e){e||(e={}),r.SSF||(r.SSF=Sn(tr)),r.SSF&&(ch(),uh(r.SSF),e.revssf=fh(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],Ts(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(I8(r,e)),t.push(k8()),t.push(""),t.push("");for(var i=0;i<r.SheetNames.length;++i)t.push(ke("Worksheet",z8(i,e,r),{"ss:Name":It(r.SheetNames[i])}));return t[2]=M8(r,e),t[3]=F8(r),pr+ke("Workbook",t.join(""),{xmlns:Pn.ss,"xmlns:o":Pn.o,"xmlns:x":Pn.x,"xmlns:ss":Pn.ss,"xmlns:dt":Pn.dt,"xmlns:html":Pn.html})}var I1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function G8(r,e){var t=[],i=[],s=[],o=0,u,h=oy(Ey,"n"),g=oy(Ty,"n");if(r.Props)for(u=qr(r.Props),o=0;o<u.length;++o)(Object.prototype.hasOwnProperty.call(h,u[o])?t:Object.prototype.hasOwnProperty.call(g,u[o])?i:s).push([u[o],r.Props[u[o]]]);if(r.Custprops)for(u=qr(r.Custprops),o=0;o<u.length;++o)Object.prototype.hasOwnProperty.call(r.Props||{},u[o])||(Object.prototype.hasOwnProperty.call(h,u[o])?t:Object.prototype.hasOwnProperty.call(g,u[o])?i:s).push([u[o],r.Custprops[u[o]]]);var m=[];for(o=0;o<s.length;++o)AT.indexOf(s[o][0])>-1||yT.indexOf(s[o][0])>-1||s[o][1]!=null&&m.push(s[o]);i.length&&Vt.utils.cfb_add(e,"/SummaryInformation",Cy(i,I1.SI,g,Ty)),(t.length||m.length)&&Vt.utils.cfb_add(e,"/DocumentSummaryInformation",Cy(t,I1.DSI,h,Ey,m.length?m:null,I1.UDI))}function q8(r,e){var t=e||{},i=Vt.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Vt.utils.cfb_add(i,s,eA(r,t)),t.biff==8&&(r.Props||r.Custprops)&&G8(r,i),t.biff==8&&r.vbaraw&&uN(i,Vt.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),i}var X8={0:{f:WO},1:{f:n5},2:{f:A5},3:{f:f5},4:{f:l5},5:{f:x5},6:{f:b5},7:{f:g5},8:{f:F5},9:{f:M5},10:{f:I5},11:{f:k5},12:{f:a5},13:{f:w5},14:{f:d5},15:{f:u5},16:{f:E5},17:{f:N5},18:{f:v5},19:{f:ug},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:y8},40:{},42:{},43:{f:bD},44:{f:RD},45:{f:OD},46:{f:kD},47:{f:ID},48:{},49:{f:ab},50:{},51:{f:WD},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:sD},62:{f:C5},63:{f:tN},64:{f:$5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ki,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Y5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:t5},148:{f:ZO,p:16},151:{f:j5},152:{},153:{f:_8},154:{},155:{},156:{f:p8},157:{},158:{},159:{T:1,f:pD},160:{T:-1},161:{T:1,f:vl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:P5},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:YD},336:{T:-1},337:{f:ZD,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:om},357:{},358:{},359:{},360:{T:1},361:{},362:{f:eD},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:z5},427:{f:H5},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:q5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:e5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:B5},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:om},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:sN},633:{T:1},634:{T:-1},635:{T:1,f:iN},636:{T:-1},637:{f:ub},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:c8},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Z5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Fe(r,e,t,i){var s=e;if(!isNaN(s)){var o=i||(t||[]).length||0,u=r.next(4);u.write_shift(2,s),u.write_shift(2,o),o>0&&sg(t)&&r.push(t)}}function Y8(r,e,t,i){var s=(t||[]).length||0;if(s<=8224)return Fe(r,e,t,s);var o=e;if(!isNaN(o)){for(var u=t.parts||[],h=0,g=0,m=0;m+(u[h]||8224)<=8224;)m+=u[h]||8224,h++;var v=r.next(4);for(v.write_shift(2,o),v.write_shift(2,m),r.push(t.slice(g,g+m)),g+=m;g<s;){for(v=r.next(4),v.write_shift(2,60),m=0;m+(u[h]||8224)<=8224;)m+=u[h]||8224,h++;v.write_shift(2,m),r.push(t.slice(g,g+m)),g+=m}}}function Ic(r,e,t){return r||(r=_e(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function K8(r,e,t,i){var s=_e(9);return Ic(s,r,e),wT(t,i||"b",s),s}function W8(r,e,t){var i=_e(8+2*t.length);return Ic(i,r,e),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function Q8(r,e,t,i){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?An(fn(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Fe(r,2,cD(t,i,s)):Fe(r,3,uD(t,i,s));return;case"b":case"e":Fe(r,5,K8(t,i,e.v,e.t));return;case"s":case"str":Fe(r,4,W8(t,i,(e.v||"").slice(0,255)));return}Fe(r,1,Ic(null,t,i))}function $8(r,e,t,i){var s=Array.isArray(e),o=Xt(e["!ref"]||"A1"),u,h="",g=[];if(o.e.c>255||o.e.r>16383){if(i.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),u=gr(o)}for(var m=o.s.r;m<=o.e.r;++m){h=Hr(m);for(var v=o.s.c;v<=o.e.c;++v){m===o.s.r&&(g[v]=Jr(v)),u=g[v]+h;var x=s?(e[m]||[])[v]:e[u];x&&Q8(r,x,m,v)}}}function Z8(r,e){for(var t=e||{},i=Tn(),s=0,o=0;o<r.SheetNames.length;++o)r.SheetNames[o]==t.sheet&&(s=o);if(s==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Fe(i,t.biff==4?1033:t.biff==3?521:9,hg(r,16,t)),$8(i,r.Sheets[r.SheetNames[s]],s,t),Fe(i,10),i.end()}function J8(r,e,t){Fe(r,49,Xb({sz:12,name:"Arial"},t))}function eI(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)e[s]!=null&&Fe(r,1054,Wb(s,e[s],t))})}function tI(r,e){var t=_e(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Fe(r,2151,t),t=_e(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),bT(Xt(e["!ref"]||"A1"),t),t.write_shift(4,4),Fe(r,2152,t)}function rI(r,e){for(var t=0;t<16;++t)Fe(r,224,Dy({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(i){Fe(r,224,Dy(i,0,e))})}function nI(r,e){for(var t=0;t<e["!links"].length;++t){var i=e["!links"][t];Fe(r,440,nD(i)),i[1].Tooltip&&Fe(r,2048,iD(i))}delete e["!links"]}function iI(r,e){if(e){var t=0;e.forEach(function(i,s){++t<=256&&i&&Fe(r,125,lD(gh(s,i),s))})}}function aI(r,e,t,i,s){var o=16+Ts(s.cellXfs,e,s);if(e.v==null&&!e.bf){Fe(r,513,cl(t,i,o));return}if(e.bf)Fe(r,6,DO(e,t,i,s,o));else switch(e.t){case"d":case"n":var u=e.t=="d"?An(fn(e.v)):e.v;Fe(r,515,Jb(t,i,u,o));break;case"b":case"e":Fe(r,517,Zb(t,i,e.v,o,s,e.t));break;case"s":case"str":if(s.bookSST){var h=vg(s.Strings,e.v,s.revStrings);Fe(r,253,Yb(t,i,h,o))}else Fe(r,516,Kb(t,i,(e.v||"").slice(0,255),o,s));break;default:Fe(r,513,cl(t,i,o))}}function sI(r,e,t){var i=Tn(),s=t.SheetNames[r],o=t.Sheets[s]||{},u=(t||{}).Workbook||{},h=(u.Sheets||[])[r]||{},g=Array.isArray(o),m=e.biff==8,v,x="",y=[],T=Xt(o["!ref"]||"A1"),b=m?65536:16384;if(T.e.c>255||T.e.r>=b){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,b-1)}Fe(i,2057,hg(t,16,e)),Fe(i,13,ei(1)),Fe(i,12,ei(100)),Fe(i,15,cn(!0)),Fe(i,17,cn(!1)),Fe(i,16,ul(.001)),Fe(i,95,cn(!0)),Fe(i,42,cn(!1)),Fe(i,43,cn(!1)),Fe(i,130,ei(1)),Fe(i,128,$b()),Fe(i,131,cn(!1)),Fe(i,132,cn(!1)),m&&iI(i,o["!cols"]),Fe(i,512,Qb(T,e)),m&&(o["!links"]=[]);for(var S=T.s.r;S<=T.e.r;++S){x=Hr(S);for(var w=T.s.c;w<=T.e.c;++w){S===T.s.r&&(y[w]=Jr(w)),v=y[w]+x;var G=g?(o[S]||[])[w]:o[v];G&&(aI(i,G,S,w,e),m&&G.l&&o["!links"].push([v,G.l]))}}var Z=h.CodeName||h.name||s;return m&&Fe(i,574,qb((u.Views||[])[0])),m&&(o["!merges"]||[]).length&&Fe(i,229,rD(o["!merges"])),m&&nI(i,o),Fe(i,442,CT(Z)),m&&tI(i,o),Fe(i,10),i.end()}function lI(r,e,t){var i=Tn(),s=(r||{}).Workbook||{},o=s.Sheets||[],u=s.WBProps||{},h=t.biff==8,g=t.biff==5;if(Fe(i,2057,hg(r,5,t)),t.bookType=="xla"&&Fe(i,135),Fe(i,225,h?ei(1200):null),Fe(i,193,Ib(2)),g&&Fe(i,191),g&&Fe(i,192),Fe(i,226),Fe(i,92,jb("SheetJS",t)),Fe(i,66,ei(h?1200:1252)),h&&Fe(i,353,ei(0)),h&&Fe(i,448),Fe(i,317,oD(r.SheetNames.length)),h&&r.vbaraw&&Fe(i,211),h&&r.vbaraw){var m=u.CodeName||"ThisWorkbook";Fe(i,442,CT(m))}Fe(i,156,ei(17)),Fe(i,25,cn(!1)),Fe(i,18,cn(!1)),Fe(i,19,ei(0)),h&&Fe(i,431,cn(!1)),h&&Fe(i,444,ei(0)),Fe(i,61,Gb()),Fe(i,64,cn(!1)),Fe(i,141,ei(0)),Fe(i,34,cn(h8(r)=="true")),Fe(i,14,cn(!0)),h&&Fe(i,439,cn(!1)),Fe(i,218,ei(0)),J8(i,r,t),eI(i,r.SSF,t),rI(i,t),h&&Fe(i,352,cn(!1));var v=i.end(),x=Tn();h&&Fe(x,140,aD()),h&&t.Strings&&Y8(x,252,Hb(t.Strings)),Fe(x,10);var y=x.end(),T=Tn(),b=0,S=0;for(S=0;S<r.SheetNames.length;++S)b+=(h?12:11)+(h?2:1)*r.SheetNames[S].length;var w=v.length+b+y.length;for(S=0;S<r.SheetNames.length;++S){var G=o[S]||{};Fe(T,133,zb({pos:w,hs:G.Hidden||0,dt:0,name:r.SheetNames[S]},t)),w+=e[S].length}var Z=T.end();if(b!=Z.length)throw new Error("BS8 "+b+" != "+Z.length);var K=[];return v.length&&K.push(v),Z.length&&K.push(Z),y.length&&K.push(y),jr(K)}function oI(r,e){var t=e||{},i=[];r&&!r.SSF&&(r.SSF=Sn(tr)),r&&r.SSF&&(ch(),uh(r.SSF),t.revssf=fh(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,_g(t),t.cellXfs=[],Ts(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var s=0;s<r.SheetNames.length;++s)i[i.length]=sI(s,t,r);return i.unshift(lI(r,i,t)),jr(i)}function eA(r,e){for(var t=0;t<=r.SheetNames.length;++t){var i=r.Sheets[r.SheetNames[t]];if(!(!i||!i["!ref"])){var s=Bn(i["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return oI(r,e);case 4:case 3:case 2:return Z8(r,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function uI(r,e,t,i){for(var s=r["!merges"]||[],o=[],u=e.s.c;u<=e.e.c;++u){for(var h=0,g=0,m=0;m<s.length;++m)if(!(s[m].s.r>t||s[m].s.c>u)&&!(s[m].e.r<t||s[m].e.c<u)){if(s[m].s.r<t||s[m].s.c<u){h=-1;break}h=s[m].e.r-s[m].s.r+1,g=s[m].e.c-s[m].s.c+1;break}if(!(h<0)){var v=kt({r:t,c:u}),x=i.dense?(r[t]||[])[u]:r[v],y=x&&x.v!=null&&(x.h||U6(x.w||(Sa(x),x.w)||""))||"",T={};h>1&&(T.rowspan=h),g>1&&(T.colspan=g),i.editable?y='<span contenteditable="true">'+y+"</span>":x&&(T["data-t"]=x&&x.t||"z",x.v!=null&&(T["data-v"]=x.v),x.z!=null&&(T["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x.l.Target+'">'+y+"</a>")),T.id=(i.id||"sjs")+"-"+v,o.push(ke("td",y,T))}}var b="<tr>";return b+o.join("")+"</tr>"}var cI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fI="</body></html>";function hI(r,e,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function tA(r,e){var t=e||{},i=t.header!=null?t.header:cI,s=t.footer!=null?t.footer:fI,o=[i],u=Bn(r["!ref"]);t.dense=Array.isArray(r),o.push(hI(r,u,t));for(var h=u.s.r;h<=u.e.r;++h)o.push(uI(r,u,h,t));return o.push("</table>"+s),o.join("")}function rA(r,e,t){var i=t||{},s=0,o=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var u=typeof i.origin=="string"?Or(i.origin):i.origin;s=u.r,o=u.c}var h=e.getElementsByTagName("tr"),g=Math.min(i.sheetRows||1e7,h.length),m={s:{r:0,c:0},e:{r:s,c:o}};if(r["!ref"]){var v=Bn(r["!ref"]);m.s.r=Math.min(m.s.r,v.s.r),m.s.c=Math.min(m.s.c,v.s.c),m.e.r=Math.max(m.e.r,v.e.r),m.e.c=Math.max(m.e.c,v.e.c),s==-1&&(m.e.r=s=v.e.r+1)}var x=[],y=0,T=r["!rows"]||(r["!rows"]=[]),b=0,S=0,w=0,G=0,Z=0,K=0;for(r["!cols"]||(r["!cols"]=[]);b<h.length&&S<g;++b){var ne=h[b];if(Py(ne)){if(i.display)continue;T[S]={hidden:!0}}var pe=ne.children;for(w=G=0;w<pe.length;++w){var Re=pe[w];if(!(i.display&&Py(Re))){var N=Re.hasAttribute("data-v")?Re.getAttribute("data-v"):Re.hasAttribute("v")?Re.getAttribute("v"):G6(Re.innerHTML),D=Re.getAttribute("data-z")||Re.getAttribute("z");for(y=0;y<x.length;++y){var R=x[y];R.s.c==G+o&&R.s.r<S+s&&S+s<=R.e.r&&(G=R.e.c+1-o,y=-1)}K=+Re.getAttribute("colspan")||1,((Z=+Re.getAttribute("rowspan")||1)>1||K>1)&&x.push({s:{r:S+s,c:G+o},e:{r:S+s+(Z||1)-1,c:G+o+(K||1)-1}});var k={t:"s",v:N},F=Re.getAttribute("data-t")||Re.getAttribute("t")||"";N!=null&&(N.length==0?k.t=F||"z":i.raw||N.trim().length==0||F=="s"||(N==="TRUE"?k={t:"b",v:!0}:N==="FALSE"?k={t:"b",v:!1}:isNaN(_a(N))?isNaN(mc(N).getDate())||(k={t:"d",v:fn(N)},i.cellDates||(k={t:"n",v:An(k.v)}),k.z=i.dateNF||tr[14]):k={t:"n",v:_a(N)})),k.z===void 0&&D!=null&&(k.z=D);var B="",P=Re.getElementsByTagName("A");if(P&&P.length)for(var qe=0;qe<P.length&&!(P[qe].hasAttribute("href")&&(B=P[qe].getAttribute("href"),B.charAt(0)!="#"));++qe);B&&B.charAt(0)!="#"&&(k.l={Target:B}),i.dense?(r[S+s]||(r[S+s]=[]),r[S+s][G+o]=k):r[kt({c:G+o,r:S+s})]=k,m.e.c<G+o&&(m.e.c=G+o),G+=K}}++S}return x.length&&(r["!merges"]=(r["!merges"]||[]).concat(x)),m.e.r=Math.max(m.e.r,S-1+s),r["!ref"]=gr(m),S>=g&&(r["!fullref"]=gr((m.e.r=h.length-b+S-1+s,m))),r}function nA(r,e){var t=e||{},i=t.dense?[]:{};return rA(i,r,e)}function dI(r,e){return dl(nA(r,e),e)}function Py(r){var e="",t=mI(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function mI(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var gI=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+pc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return pr+e}}(),Ly=function(){var r=function(o){return It(o).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(o,u,h){var g=[];g.push('      <table:table table:name="'+It(u.SheetNames[h])+`" table:style-name="ta1">
`);var m=0,v=0,x=Bn(o["!ref"]||"A1"),y=o["!merges"]||[],T=0,b=Array.isArray(o);if(o["!cols"])for(v=0;v<=x.e.c;++v)g.push("        <table:table-column"+(o["!cols"][v]?' table:style-name="co'+o["!cols"][v].ods+'"':"")+`></table:table-column>
`);var S="",w=o["!rows"]||[];for(m=0;m<x.s.r;++m)S=w[m]?' table:style-name="ro'+w[m].ods+'"':"",g.push("        <table:table-row"+S+`></table:table-row>
`);for(;m<=x.e.r;++m){for(S=w[m]?' table:style-name="ro'+w[m].ods+'"':"",g.push("        <table:table-row"+S+`>
`),v=0;v<x.s.c;++v)g.push(e);for(;v<=x.e.c;++v){var G=!1,Z={},K="";for(T=0;T!=y.length;++T)if(!(y[T].s.c>v)&&!(y[T].s.r>m)&&!(y[T].e.c<v)&&!(y[T].e.r<m)){(y[T].s.c!=v||y[T].s.r!=m)&&(G=!0),Z["table:number-columns-spanned"]=y[T].e.c-y[T].s.c+1,Z["table:number-rows-spanned"]=y[T].e.r-y[T].s.r+1;break}if(G){g.push(t);continue}var ne=kt({r:m,c:v}),pe=b?(o[m]||[])[v]:o[ne];if(pe&&pe.f&&(Z["table:formula"]=It(FO(pe.f)),pe.F&&pe.F.slice(0,ne.length)==ne)){var Re=Bn(pe.F);Z["table:number-matrix-columns-spanned"]=Re.e.c-Re.s.c+1,Z["table:number-matrix-rows-spanned"]=Re.e.r-Re.s.r+1}if(!pe){g.push(e);continue}switch(pe.t){case"b":K=pe.v?"TRUE":"FALSE",Z["office:value-type"]="boolean",Z["office:boolean-value"]=pe.v?"true":"false";break;case"n":K=pe.w||String(pe.v||0),Z["office:value-type"]="float",Z["office:value"]=pe.v||0;break;case"s":case"str":K=pe.v==null?"":pe.v,Z["office:value-type"]="string";break;case"d":K=pe.w||fn(pe.v).toISOString(),Z["office:value-type"]="date",Z["office:date-value"]=fn(pe.v).toISOString(),Z["table:style-name"]="ce1";break;default:g.push(e);continue}var N=r(K);if(pe.l&&pe.l.Target){var D=pe.l.Target;D=D.charAt(0)=="#"?"#"+PO(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),N=ke("text:a",N,{"xlink:href":D.replace(/&/g,"&amp;")})}g.push("          "+ke("table:table-cell",ke("text:p",N,{}),Z)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},s=function(o,u){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var h=0;u.SheetNames.map(function(m){return u.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var v=0;v<m["!cols"].length;++v)if(m["!cols"][v]){var x=m["!cols"][v];if(x.width==null&&x.wpx==null&&x.wch==null)continue;dg(x),x.ods=h;var y=m["!cols"][v].wpx+"px";o.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),o.push(`  </style:style>
`),++h}}});var g=0;u.SheetNames.map(function(m){return u.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var v=0;v<m["!rows"].length;++v)if(m["!rows"][v]){m["!rows"][v].ods=g;var x=m["!rows"][v].hpx+"px";o.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),o.push(`  </style:style>
`),++g}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(u,h){var g=[pr],m=pc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),v=pc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+m+v+`>
`),g.push(_T().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+m+`>
`),s(g,u),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var x=0;x!=u.SheetNames.length;++x)g.push(i(u.Sheets[u.SheetNames[x]],u,x));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}}();function iA(r,e){if(e.bookType=="fods")return Ly(r,e);var t=rg(),i="",s=[],o=[];return i="mimetype",it(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",it(t,i,Ly(r,e)),s.push([i,"text/xml"]),o.push([i,"ContentFile"]),i="styles.xml",it(t,i,gI(r,e)),s.push([i,"text/xml"]),o.push([i,"StylesFile"]),i="meta.xml",it(t,i,pr+_T()),s.push([i,"text/xml"]),o.push([i,"MetadataFile"]),i="manifest.rdf",it(t,i,Cb(o)),s.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",it(t,i,wb(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function q0(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function pI(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):fi(gc(r))}function vI(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var i=0;i<e.length;++i)if(r[t+i]!=e[i])continue e;return!0}return!1}function _s(r){var e=r.reduce(function(s,o){return s+o.length},0),t=new Uint8Array(e),i=0;return r.forEach(function(s){t.set(s,i),i+=s.length}),t}function _I(r,e,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,i-6176);r[e+15]|=i>>7,r[e+14]|=(i&127)<<1;for(var o=0;s>=1;++o,s/=256)r[e+o]=s&255;r[e+15]|=t>=0?0:128}function vc(r,e){var t=e?e[0]:0,i=r[t]&127;e:if(r[t++]>=128&&(i|=(r[t]&127)<<7,r[t++]<128||(i|=(r[t]&127)<<14,r[t++]<128)||(i|=(r[t]&127)<<21,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),i}function Nt(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Eo(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function Er(r){for(var e=[],t=[0];t[0]<r.length;){var i=t[0],s=vc(r,t),o=s&7;s=Math.floor(s/8);var u=0,h;if(s==0)break;switch(o){case 0:{for(var g=t[0];r[t[0]++]>=128;);h=r.slice(g,t[0])}break;case 5:u=4,h=r.slice(t[0],t[0]+u),t[0]+=u;break;case 1:u=8,h=r.slice(t[0],t[0]+u),t[0]+=u;break;case 2:u=vc(r,t),h=r.slice(t[0],t[0]+u),t[0]+=u;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(s," at offset ").concat(i))}var m={data:h,type:o};e[s]==null?e[s]=[m]:e[s].push(m)}return e}function Lr(r){var e=[];return r.forEach(function(t,i){t.forEach(function(s){s.data&&(e.push(Nt(i*8+s.type)),s.type==2&&e.push(Nt(s.data.length)),e.push(s.data))})}),_s(e)}function ui(r){for(var e,t=[],i=[0];i[0]<r.length;){var s=vc(r,i),o=Er(r.slice(i[0],i[0]+s));i[0]+=s;var u={id:Eo(o[1][0].data),messages:[]};o[2].forEach(function(h){var g=Er(h.data),m=Eo(g[3][0].data);u.messages.push({meta:g,data:r.slice(i[0],i[0]+m)}),i[0]+=m}),(e=o[3])!=null&&e[0]&&(u.merge=Eo(o[3][0].data)>>>0>0),t.push(u)}return t}function lo(r){var e=[];return r.forEach(function(t){var i=[];i[1]=[{data:Nt(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:Nt(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(u){s.push(u.data),u.meta[3]=[{type:0,data:Nt(u.data.length)}],i[2].push({data:Lr(u.meta),type:2})});var o=Lr(i);e.push(Nt(o.length)),e.push(o),s.forEach(function(u){return e.push(u)})}),_s(e)}function xI(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],i=vc(e,t),s=[];t[0]<e.length;){var o=e[t[0]]&3;if(o==0){var u=e[t[0]++]>>2;if(u<60)++u;else{var h=u-59;u=e[t[0]],h>1&&(u|=e[t[0]+1]<<8),h>2&&(u|=e[t[0]+2]<<16),h>3&&(u|=e[t[0]+3]<<24),u>>>=0,u++,t[0]+=h}s.push(e.slice(t[0],t[0]+u)),t[0]+=u;continue}else{var g=0,m=0;if(o==1?(m=(e[t[0]]>>2&7)+4,g=(e[t[0]++]&224)<<3,g|=e[t[0]++]):(m=(e[t[0]++]>>2)+1,o==2?(g=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(g=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),s=[_s(s)],g==0)throw new Error("Invalid offset 0");if(g>s[0].length)throw new Error("Invalid offset beyond length");if(m>=g)for(s.push(s[0].slice(-g)),m-=g;m>=s[s.length-1].length;)s.push(s[s.length-1]),m-=s[s.length-1].length;s.push(s[0].slice(-g,-g+m))}}var v=_s(s);if(v.length!=i)throw new Error("Unexpected length: ".concat(v.length," != ").concat(i));return v}function ci(r){for(var e=[],t=0;t<r.length;){var i=r[t++],s=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(xI(i,r.slice(t,t+s))),t+=s}if(t!==r.length)throw new Error("data is not a valid framed stream!");return _s(e)}function oo(r){for(var e=[],t=0;t<r.length;){var i=Math.min(r.length-t,268435455),s=new Uint8Array(4);e.push(s);var o=Nt(i),u=o.length;e.push(o),i<=60?(u++,e.push(new Uint8Array([i-1<<2]))):i<=256?(u+=2,e.push(new Uint8Array([240,i-1&255]))):i<=65536?(u+=3,e.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(u+=4,e.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(u+=5,e.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),e.push(r.slice(t,t+i)),u+=i,s[0]=0,s[1]=u&255,s[2]=u>>8&255,s[3]=u>>16&255,t+=i}return _s(e)}function k1(r,e){var t=new Uint8Array(32),i=q0(t),s=12,o=0;switch(t[0]=5,r.t){case"n":t[1]=2,_I(t,s,r.v),o|=1,s+=16;break;case"b":t[1]=6,i.setFloat64(s,r.v?1:0,!0),o|=2,s+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,i.setUint32(s,e.indexOf(r.v),!0),o|=8,s+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(8,o,!0),t.slice(0,s)}function M1(r,e){var t=new Uint8Array(32),i=q0(t),s=12,o=0;switch(t[0]=3,r.t){case"n":t[2]=2,i.setFloat64(s,r.v,!0),o|=32,s+=8;break;case"b":t[2]=6,i.setFloat64(s,r.v?1:0,!0),o|=32,s+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,i.setUint32(s,e.indexOf(r.v),!0),o|=16,s+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(4,o,!0),t.slice(0,s)}function es(r){var e=Er(r);return vc(e[1][0].data)}function yI(r,e,t){var i,s,o,u;if(!((i=r[6])!=null&&i[0])||!((s=r[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var h=((u=(o=r[8])==null?void 0:o[0])==null?void 0:u.data)&&Eo(r[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var g=0,m=q0(r[7][0].data),v=0,x=[],y=q0(r[4][0].data),T=0,b=[],S=0;S<e.length;++S){if(e[S]==null){m.setUint16(S*2,65535,!0),y.setUint16(S*2,65535);continue}m.setUint16(S*2,v,!0),y.setUint16(S*2,T,!0);var w,G;switch(typeof e[S]){case"string":w=k1({t:"s",v:e[S]},t),G=M1({t:"s",v:e[S]},t);break;case"number":w=k1({t:"n",v:e[S]},t),G=M1({t:"n",v:e[S]},t);break;case"boolean":w=k1({t:"b",v:e[S]},t),G=M1({t:"b",v:e[S]},t);break;default:throw new Error("Unsupported value "+e[S])}x.push(w),v+=w.length,b.push(G),T+=G.length,++g}for(r[2][0].data=Nt(g);S<r[7][0].data.length/2;++S)m.setUint16(S*2,65535,!0),y.setUint16(S*2,65535,!0);return r[6][0].data=_s(x),r[3][0].data=_s(b),g}function EI(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=Bn(t["!ref"]);i.s.r=i.s.c=0;var s=!1;i.e.c>9&&(s=!0,i.e.c=9),i.e.r>49&&(s=!0,i.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(gr(i)));var o=X0(t,{range:i,header:1}),u=["~Sh33tJ5~"];o.forEach(function(X){return X.forEach(function(q){typeof q=="string"&&u.push(q)})});var h={},g=[],m=Vt.read(e.numbers,{type:"base64"});m.FileIndex.map(function(X,q){return[X,m.FullPaths[q]]}).forEach(function(X){var q=X[0],Q=X[1];if(q.type==2&&q.name.match(/\.iwa/)){var oe=q.content,de=ci(oe),ve=ui(de);ve.forEach(function(Ne){g.push(Ne.id),h[Ne.id]={deps:[],location:Q,type:Eo(Ne.messages[0].meta[1][0].data)}})}}),g.sort(function(X,q){return X-q});var v=g.filter(function(X){return X>1}).map(function(X){return[X,Nt(X)]});m.FileIndex.map(function(X,q){return[X,m.FullPaths[q]]}).forEach(function(X){var q=X[0];if(X[1],!!q.name.match(/\.iwa/)){var Q=ui(ci(q.content));Q.forEach(function(oe){oe.messages.forEach(function(de){v.forEach(function(ve){oe.messages.some(function(Ne){return Eo(Ne.meta[1][0].data)!=11006&&vI(Ne.data,ve[1])})&&h[ve[0]].deps.push(oe.id)})})})}});for(var x=Vt.find(m,h[1].location),y=ui(ci(x.content)),T,b=0;b<y.length;++b){var S=y[b];S.id==1&&(T=S)}var w=es(Er(T.messages[0].data)[1][0].data);for(x=Vt.find(m,h[w].location),y=ui(ci(x.content)),b=0;b<y.length;++b)S=y[b],S.id==w&&(T=S);for(w=es(Er(T.messages[0].data)[2][0].data),x=Vt.find(m,h[w].location),y=ui(ci(x.content)),b=0;b<y.length;++b)S=y[b],S.id==w&&(T=S);for(w=es(Er(T.messages[0].data)[2][0].data),x=Vt.find(m,h[w].location),y=ui(ci(x.content)),b=0;b<y.length;++b)S=y[b],S.id==w&&(T=S);var G=Er(T.messages[0].data);{G[6][0].data=Nt(i.e.r+1),G[7][0].data=Nt(i.e.c+1);var Z=es(G[46][0].data),K=Vt.find(m,h[Z].location),ne=ui(ci(K.content));{for(var pe=0;pe<ne.length&&ne[pe].id!=Z;++pe);if(ne[pe].id!=Z)throw"Bad ColumnRowUIDMapArchive";var Re=Er(ne[pe].messages[0].data);Re[1]=[],Re[2]=[],Re[3]=[];for(var N=0;N<=i.e.c;++N){var D=[];D[1]=D[2]=[{type:0,data:Nt(N+420690)}],Re[1].push({type:2,data:Lr(D)}),Re[2].push({type:0,data:Nt(N)}),Re[3].push({type:0,data:Nt(N)})}Re[4]=[],Re[5]=[],Re[6]=[];for(var R=0;R<=i.e.r;++R)D=[],D[1]=D[2]=[{type:0,data:Nt(R+726270)}],Re[4].push({type:2,data:Lr(D)}),Re[5].push({type:0,data:Nt(R)}),Re[6].push({type:0,data:Nt(R)});ne[pe].messages[0].data=Lr(Re)}K.content=oo(lo(ne)),K.size=K.content.length,delete G[46];var k=Er(G[4][0].data);{k[7][0].data=Nt(i.e.r+1);var F=Er(k[1][0].data),B=es(F[2][0].data);K=Vt.find(m,h[B].location),ne=ui(ci(K.content));{if(ne[0].id!=B)throw"Bad HeaderStorageBucket";var P=Er(ne[0].messages[0].data);for(R=0;R<o.length;++R){var qe=Er(P[2][0].data);qe[1][0].data=Nt(R),qe[4][0].data=Nt(o[R].length),P[2][R]={type:P[2][0].type,data:Lr(qe)}}ne[0].messages[0].data=Lr(P)}K.content=oo(lo(ne)),K.size=K.content.length;var Be=es(k[2][0].data);K=Vt.find(m,h[Be].location),ne=ui(ci(K.content));{if(ne[0].id!=Be)throw"Bad HeaderStorageBucket";for(P=Er(ne[0].messages[0].data),N=0;N<=i.e.c;++N)qe=Er(P[2][0].data),qe[1][0].data=Nt(N),qe[4][0].data=Nt(i.e.r+1),P[2][N]={type:P[2][0].type,data:Lr(qe)};ne[0].messages[0].data=Lr(P)}K.content=oo(lo(ne)),K.size=K.content.length;var J=es(k[4][0].data);(function(){for(var X=Vt.find(m,h[J].location),q=ui(ci(X.content)),Q,oe=0;oe<q.length;++oe){var de=q[oe];de.id==J&&(Q=de)}var ve=Er(Q.messages[0].data);{ve[3]=[];var Ne=[];u.forEach(function(rt,Wt){Ne[1]=[{type:0,data:Nt(Wt)}],Ne[2]=[{type:0,data:Nt(1)}],Ne[3]=[{type:2,data:pI(rt)}],ve[3].push({type:2,data:Lr(Ne)})})}Q.messages[0].data=Lr(ve);var De=lo(q),ut=oo(De);X.content=ut,X.size=X.content.length})();var ye=Er(k[3][0].data);{var Pe=ye[1][0];delete ye[2];var He=Er(Pe.data);{var W=es(He[2][0].data);(function(){for(var X=Vt.find(m,h[W].location),q=ui(ci(X.content)),Q,oe=0;oe<q.length;++oe){var de=q[oe];de.id==W&&(Q=de)}var ve=Er(Q.messages[0].data);{delete ve[6],delete ye[7];var Ne=new Uint8Array(ve[5][0].data);ve[5]=[];for(var De=0,ut=0;ut<=i.e.r;++ut){var rt=Er(Ne);De+=yI(rt,o[ut],u),rt[1][0].data=Nt(ut),ve[5].push({data:Lr(rt),type:2})}ve[1]=[{type:0,data:Nt(i.e.c+1)}],ve[2]=[{type:0,data:Nt(i.e.r+1)}],ve[3]=[{type:0,data:Nt(De)}],ve[4]=[{type:0,data:Nt(i.e.r+1)}]}Q.messages[0].data=Lr(ve);var Wt=lo(q),lt=oo(Wt);X.content=lt,X.size=X.content.length})()}Pe.data=Lr(He)}k[3][0].data=Lr(ye)}G[4][0].data=Lr(k)}T.messages[0].data=Lr(G);var xe=lo(y),V=oo(xe);return x.content=V,x.size=x.content.length,m}function TI(r){return function(t){for(var i=0;i!=r.length;++i){var s=r[i];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function _g(r){TI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function AI(r,e){return e.bookType=="ods"?iA(r,e):e.bookType=="numbers"?EI(r,e):e.bookType=="xlsb"?SI(r,e):wI(r,e)}function SI(r,e){go=1024,r&&!r.SSF&&(r.SSF=Sn(tr)),r&&r.SSF&&(ch(),uh(r.SSF),e.revssf=fh(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,rc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",i=UT.indexOf(e.bookType)>-1,s=gT();_g(e=e||{});var o=rg(),u="",h=0;if(e.cellXfs=[],Ts(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),u="docProps/core.xml",it(o,u,xT(r.Props,e)),s.coreprops.push(u),Ot(e.rels,2,u,At.CORE_PROPS),u="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var g=[],m=0;m<r.SheetNames.length;++m)(r.Workbook.Sheets[m]||{}).Hidden!=2&&g.push(r.SheetNames[m]);r.Props.SheetNames=g}for(r.Props.Worksheets=r.Props.SheetNames.length,it(o,u,ET(r.Props)),s.extprops.push(u),Ot(e.rels,3,u,At.EXT_PROPS),r.Custprops!==r.Props&&qr(r.Custprops||{}).length>0&&(u="docProps/custom.xml",it(o,u,TT(r.Custprops)),s.custprops.push(u),Ot(e.rels,4,u,At.CUST_PROPS)),h=1;h<=r.SheetNames.length;++h){var v={"!id":{}},x=r.Sheets[r.SheetNames[h-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:u="xl/worksheets/sheet"+h+"."+t,it(o,u,C8(h-1,u,e,r,v)),s.sheets.push(u),Ot(e.wbrels,-1,"worksheets/sheet"+h+"."+t,At.WS[0])}if(x){var T=x["!comments"],b=!1,S="";T&&T.length>0&&(S="xl/comments"+h+"."+t,it(o,S,N8(T,S)),s.comments.push(S),Ot(v,-1,"../comments"+h+"."+t,At.CMNT),b=!0),x["!legacy"]&&b&&it(o,"xl/drawings/vmlDrawing"+h+".vml",VT(h,x["!comments"])),delete x["!comments"],delete x["!legacy"]}v["!id"].rId1&&it(o,vT(u),xo(v))}return e.Strings!=null&&e.Strings.length>0&&(u="xl/sharedStrings."+t,it(o,u,D8(e.Strings,u,e)),s.strs.push(u),Ot(e.wbrels,-1,"sharedStrings."+t,At.SST)),u="xl/workbook."+t,it(o,u,R8(r,u)),s.workbooks.push(u),Ot(e.rels,1,u,At.WB),u="xl/theme/theme1.xml",it(o,u,PT(r.Themes,e)),s.themes.push(u),Ot(e.wbrels,-1,"theme/theme1.xml",At.THEME),u="xl/styles."+t,it(o,u,b8(r,u,e)),s.styles.push(u),Ot(e.wbrels,-1,"styles."+t,At.STY),r.vbaraw&&i&&(u="xl/vbaProject.bin",it(o,u,r.vbaraw),s.vba.push(u),Ot(e.wbrels,-1,"vbaProject.bin",At.VBA)),u="xl/metadata."+t,it(o,u,O8(u)),s.metadata.push(u),Ot(e.wbrels,-1,"metadata."+t,At.XLMETA),it(o,"[Content_Types].xml",pT(s,e)),it(o,"_rels/.rels",xo(e.rels)),it(o,"xl/_rels/workbook."+t+".rels",xo(e.wbrels)),delete e.revssf,delete e.ssf,o}function wI(r,e){go=1024,r&&!r.SSF&&(r.SSF=Sn(tr)),r&&r.SSF&&(ch(),uh(r.SSF),e.revssf=fh(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,rc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",i=UT.indexOf(e.bookType)>-1,s=gT();_g(e=e||{});var o=rg(),u="",h=0;if(e.cellXfs=[],Ts(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),u="docProps/core.xml",it(o,u,xT(r.Props,e)),s.coreprops.push(u),Ot(e.rels,2,u,At.CORE_PROPS),u="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var g=[],m=0;m<r.SheetNames.length;++m)(r.Workbook.Sheets[m]||{}).Hidden!=2&&g.push(r.SheetNames[m]);r.Props.SheetNames=g}r.Props.Worksheets=r.Props.SheetNames.length,it(o,u,ET(r.Props)),s.extprops.push(u),Ot(e.rels,3,u,At.EXT_PROPS),r.Custprops!==r.Props&&qr(r.Custprops||{}).length>0&&(u="docProps/custom.xml",it(o,u,TT(r.Custprops)),s.custprops.push(u),Ot(e.rels,4,u,At.CUST_PROPS));var v=["SheetJ5"];for(e.tcid=0,h=1;h<=r.SheetNames.length;++h){var x={"!id":{}},y=r.Sheets[r.SheetNames[h-1]],T=(y||{})["!type"]||"sheet";switch(T){case"chart":default:u="xl/worksheets/sheet"+h+"."+t,it(o,u,WT(h-1,e,r,x)),s.sheets.push(u),Ot(e.wbrels,-1,"worksheets/sheet"+h+"."+t,At.WS[0])}if(y){var b=y["!comments"],S=!1,w="";if(b&&b.length>0){var G=!1;b.forEach(function(Z){Z[1].forEach(function(K){K.T==!0&&(G=!0)})}),G&&(w="xl/threadedComments/threadedComment"+h+"."+t,it(o,w,rN(b,v,e)),s.threadedcomments.push(w),Ot(x,-1,"../threadedComments/threadedComment"+h+"."+t,At.TCMNT)),w="xl/comments"+h+"."+t,it(o,w,BT(b)),s.comments.push(w),Ot(x,-1,"../comments"+h+"."+t,At.CMNT),S=!0}y["!legacy"]&&S&&it(o,"xl/drawings/vmlDrawing"+h+".vml",VT(h,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&it(o,vT(u),xo(x))}return e.Strings!=null&&e.Strings.length>0&&(u="xl/sharedStrings."+t,it(o,u,NT(e.Strings,e)),s.strs.push(u),Ot(e.wbrels,-1,"sharedStrings."+t,At.SST)),u="xl/workbook."+t,it(o,u,ZT(r)),s.workbooks.push(u),Ot(e.rels,1,u,At.WB),u="xl/theme/theme1.xml",it(o,u,PT(r.Themes,e)),s.themes.push(u),Ot(e.wbrels,-1,"theme/theme1.xml",At.THEME),u="xl/styles."+t,it(o,u,MT(r,e)),s.styles.push(u),Ot(e.wbrels,-1,"styles."+t,At.STY),r.vbaraw&&i&&(u="xl/vbaProject.bin",it(o,u,r.vbaraw),s.vba.push(u),Ot(e.wbrels,-1,"vbaProject.bin",At.VBA)),u="xl/metadata."+t,it(o,u,LT()),s.metadata.push(u),Ot(e.wbrels,-1,"metadata."+t,At.XLMETA),v.length>1&&(u="xl/persons/person.xml",it(o,u,nN(v)),s.people.push(u),Ot(e.wbrels,-1,"persons/person.xml",At.PEOPLE)),it(o,"[Content_Types].xml",pT(s,e)),it(o,"_rels/.rels",xo(e.rels)),it(o,"xl/_rels/workbook."+t+".rels",xo(e.wbrels)),delete e.revssf,delete e.ssf,o}function RI(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=Aa(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function aA(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return bc(e.file,Vt.write(r,{type:wt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Vt.write(r,e)}function CI(r,e){var t=Sn(e||{}),i=AI(r,t);return bI(i,t)}function bI(r,e){var t={},i=wt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=i;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+e.type)}var s=r.FullPaths?Vt.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(oh(s))}return e.password&&typeof encrypt_agile<"u"?aA(encrypt_agile(s,e.password),e):e.type==="file"?bc(e.file,s):e.type=="string"?Zu(s):s}function DI(r,e){var t=e||{},i=q8(r,t);return aA(i,t)}function Vi(r,e,t){t||(t="");var i=t+r;switch(e.type){case"base64":return dc(gc(i));case"binary":return gc(i);case"string":return r;case"file":return bc(e.file,i,"utf8");case"buffer":return wt?wa(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Vi(i,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function NI(r,e){switch(e.type){case"base64":return dc(r);case"binary":return r;case"string":return r;case"file":return bc(e.file,r,"binary");case"buffer":return wt?wa(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function c0(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",i=0;i<r.length;++i)t+=String.fromCharCode(r[i]);return e.type=="base64"?dc(t):e.type=="string"?Zu(t):t;case"file":return bc(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function sA(r,e){i6(),g8(r);var t=Sn(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=sA(r,t);return t.type="array",oh(i)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=r.SheetNames.indexOf(t.sheet),!r.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Vi(H8(r,t),t);case"slk":case"sylk":return Vi(hD.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"htm":case"html":return Vi(tA(r.Sheets[r.SheetNames[s]],t),t);case"txt":return NI(lA(r.Sheets[r.SheetNames[s]],t),t);case"csv":return Vi(xg(r.Sheets[r.SheetNames[s]],t),t,"\uFEFF");case"dif":return Vi(dD.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"dbf":return c0(fD.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"prn":return Vi(mD.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"rtf":return Vi(ED.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"eth":return Vi(DT.from_sheet(r.Sheets[r.SheetNames[s]],t),t);case"fods":return Vi(iA(r,t),t);case"wk1":return c0(Ny.sheet_to_wk1(r.Sheets[r.SheetNames[s]],t),t);case"wk3":return c0(Ny.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),c0(eA(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),DI(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return CI(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function OI(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function II(r,e,t){var i={};return i.type="file",i.file=e,OI(i),sA(r,i)}function kI(r,e,t,i,s,o,u,h){var g=Hr(t),m=h.defval,v=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),x=!0,y=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:t,enumerable:!1})}catch{y.__rowNum__=t}else y.__rowNum__=t;if(!u||r[t])for(var T=e.s.c;T<=e.e.c;++T){var b=u?r[t][T]:r[i[T]+g];if(b===void 0||b.t===void 0){if(m===void 0)continue;o[T]!=null&&(y[o[T]]=m);continue}var S=b.v;switch(b.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(o[T]!=null){if(S==null)if(b.t=="e"&&S===null)y[o[T]]=null;else if(m!==void 0)y[o[T]]=m;else if(v&&S===null)y[o[T]]=null;else continue;else y[o[T]]=v&&(b.t!=="n"||b.t==="n"&&h.rawNumbers!==!1)?S:Sa(b,S,h);S!=null&&(x=!1)}}return{row:y,isempty:x}}function X0(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},i=0,s=1,o=[],u=0,h="",g={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},v=m.range!=null?m.range:r["!ref"];switch(m.header===1?i=1:m.header==="A"?i=2:Array.isArray(m.header)?i=3:m.header==null&&(i=0),typeof v){case"string":g=Xt(v);break;case"number":g=Xt(r["!ref"]),g.s.r=v;break;default:g=v}i>0&&(s=0);var x=Hr(g.s.r),y=[],T=[],b=0,S=0,w=Array.isArray(r),G=g.s.r,Z=0,K={};w&&!r[G]&&(r[G]=[]);var ne=m.skipHidden&&r["!cols"]||[],pe=m.skipHidden&&r["!rows"]||[];for(Z=g.s.c;Z<=g.e.c;++Z)if(!(ne[Z]||{}).hidden)switch(y[Z]=Jr(Z),t=w?r[G][Z]:r[y[Z]+x],i){case 1:o[Z]=Z-g.s.c;break;case 2:o[Z]=y[Z];break;case 3:o[Z]=m.header[Z-g.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),h=u=Sa(t,null,m),S=K[u]||0,!S)K[u]=1;else{do h=u+"_"+S++;while(K[h]);K[u]=S,K[h]=1}o[Z]=h}for(G=g.s.r+s;G<=g.e.r;++G)if(!(pe[G]||{}).hidden){var Re=kI(r,g,G,y,i,o,w,m);(Re.isempty===!1||(i===1?m.blankrows!==!1:m.blankrows))&&(T[b++]=Re.row)}return T.length=b,T}var Vy=/"/g;function MI(r,e,t,i,s,o,u,h){for(var g=!0,m=[],v="",x=Hr(t),y=e.s.c;y<=e.e.c;++y)if(i[y]){var T=h.dense?(r[t]||[])[y]:r[i[y]+x];if(T==null)v="";else if(T.v!=null){g=!1,v=""+(h.rawNumbers&&T.t=="n"?T.v:Sa(T,null,h));for(var b=0,S=0;b!==v.length;++b)if((S=v.charCodeAt(b))===s||S===o||S===34||h.forceQuotes){v='"'+v.replace(Vy,'""')+'"';break}v=="ID"&&(v='"ID"')}else T.f!=null&&!T.F?(g=!1,v="="+T.f,v.indexOf(",")>=0&&(v='"'+v.replace(Vy,'""')+'"')):v="";m.push(v)}return h.blankrows===!1&&g?null:m.join(u)}function xg(r,e){var t=[],i=e??{};if(r==null||r["!ref"]==null)return"";var s=Xt(r["!ref"]),o=i.FS!==void 0?i.FS:",",u=o.charCodeAt(0),h=i.RS!==void 0?i.RS:`
`,g=h.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),v="",x=[];i.dense=Array.isArray(r);for(var y=i.skipHidden&&r["!cols"]||[],T=i.skipHidden&&r["!rows"]||[],b=s.s.c;b<=s.e.c;++b)(y[b]||{}).hidden||(x[b]=Jr(b));for(var S=0,w=s.s.r;w<=s.e.r;++w)(T[w]||{}).hidden||(v=MI(r,s,w,x,u,g,o,i),v!=null&&(i.strip&&(v=v.replace(m,"")),(v||i.blankrows!==!1)&&t.push((S++?h:"")+v)));return delete i.dense,t.join("")}function lA(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=xg(r,e);return t}function FI(r){var e="",t,i="";if(r==null||r["!ref"]==null)return[];var s=Xt(r["!ref"]),o="",u=[],h,g=[],m=Array.isArray(r);for(h=s.s.c;h<=s.e.c;++h)u[h]=Jr(h);for(var v=s.s.r;v<=s.e.r;++v)for(o=Hr(v),h=s.s.c;h<=s.e.c;++h)if(e=u[h]+o,t=m?(r[v]||[])[h]:r[e],i="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;i=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}g[g.length]=e+"="+i}return g}function oA(r,e,t){var i=t||{},s=+!i.skipHeader,o=r||{},u=0,h=0;if(o&&i.origin!=null)if(typeof i.origin=="number")u=i.origin;else{var g=typeof i.origin=="string"?Or(i.origin):i.origin;u=g.r,h=g.c}var m,v={s:{c:0,r:0},e:{c:h,r:u+e.length-1+s}};if(o["!ref"]){var x=Xt(o["!ref"]);v.e.c=Math.max(v.e.c,x.e.c),v.e.r=Math.max(v.e.r,x.e.r),u==-1&&(u=x.e.r+1,v.e.r=u+e.length-1+s)}else u==-1&&(u=0,v.e.r=e.length-1+s);var y=i.header||[],T=0;e.forEach(function(S,w){qr(S).forEach(function(G){(T=y.indexOf(G))==-1&&(y[T=y.length]=G);var Z=S[G],K="z",ne="",pe=kt({c:h+T,r:u+w+s});m=_c(o,pe),Z&&typeof Z=="object"&&!(Z instanceof Date)?o[pe]=Z:(typeof Z=="number"?K="n":typeof Z=="boolean"?K="b":typeof Z=="string"?K="s":Z instanceof Date?(K="d",i.cellDates||(K="n",Z=An(Z)),ne=i.dateNF||tr[14]):Z===null&&i.nullError&&(K="e",Z=0),m?(m.t=K,m.v=Z,delete m.w,delete m.R,ne&&(m.z=ne)):o[pe]=m={t:K,v:Z},ne&&(m.z=ne))})}),v.e.c=Math.max(v.e.c,h+y.length-1);var b=Hr(u);if(s)for(T=0;T<y.length;++T)o[Jr(T+h)+b]={t:"s",v:y[T]};return o["!ref"]=gr(v),o}function PI(r,e){return oA(null,r,e)}function _c(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var i=Or(e);return r[i.r]||(r[i.r]=[]),r[i.r][i.c]||(r[i.r][i.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?_c(r,kt(e)):_c(r,kt({r:e,c:t||0}))}function LI(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function VI(){return{SheetNames:[],Sheets:{}}}function BI(r,e,t,i){var s=1;if(!t)for(;s<=65535&&r.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&r.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);s=o&&+o[2]||0;var u=o&&o[1]||t;for(++s;s<=65535&&r.SheetNames.indexOf(t=u+s)!=-1;++s);}if($T(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function UI(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var i=LI(r,e);switch(r.Workbook.Sheets[i]||(r.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[i].Hidden=t}function jI(r,e){return r.z=e,r}function uA(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function zI(r,e,t){return uA(r,"#"+e,t)}function HI(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function GI(r,e,t,i){for(var s=typeof e!="string"?e:Xt(e),o=typeof e=="string"?e:gr(e),u=s.s.r;u<=s.e.r;++u)for(var h=s.s.c;h<=s.e.c;++h){var g=_c(r,u,h);g.t="n",g.F=o,delete g.v,u==s.s.r&&h==s.s.c&&(g.f=t,i&&(g.D=!0))}return r}var F1={encode_col:Jr,encode_row:Hr,encode_cell:kt,encode_range:gr,decode_col:og,decode_row:lg,split_cell:ib,decode_cell:Or,decode_range:Bn,format_cell:Sa,sheet_add_aoa:uT,sheet_add_json:oA,sheet_add_dom:rA,aoa_to_sheet:Fo,json_to_sheet:PI,table_to_sheet:nA,table_to_book:dI,sheet_to_csv:xg,sheet_to_txt:lA,sheet_to_json:X0,sheet_to_html:tA,sheet_to_formulae:FI,sheet_to_row_object_array:X0,sheet_get_cell:_c,book_new:VI,book_append_sheet:BI,book_set_sheet_visibility:UI,cell_set_number_format:jI,cell_set_hyperlink:uA,cell_set_internal_link:zI,cell_add_comment:HI,sheet_set_array_formula:GI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const qI=({trip:r,onClose:e})=>{if(!r)return null;const i=new Date(r.departureTime).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",onClick:e,children:z.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md max-h-96 overflow-y-auto",onClick:s=>s.stopPropagation(),children:[z.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900 dark:text-white",children:"Detalhes da Viagem"}),z.jsxs("div",{className:"space-y-2 text-gray-800 dark:text-gray-200",children:[z.jsxs("div",{children:[z.jsx("strong",{children:"Motorista:"})," ",r.driver]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Veículo:"})," ",r.vehicle]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Placa:"})," ",r.plate]}),z.jsxs("div",{children:[z.jsx("strong",{children:"KM:"})," ",r.km," KM"]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Origem:"})," ",r.origin]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Destino:"})," ",r.destination]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Data/Hora:"})," ",i]})]}),r.checklist&&r.checklist.length>0&&z.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[z.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Checklist"}),z.jsx("div",{className:"space-y-1",children:r.checklist.map(s=>z.jsxs("div",{className:"flex items-center",children:[z.jsx("span",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${s.checked?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600"}`,children:s.checked&&z.jsx("svg",{className:"w-2 h-2",fill:"currentColor",viewBox:"0 0 20 20",children:z.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),z.jsx("span",{className:`ml-2 text-sm ${s.checked?"text-gray-500 dark:text-gray-400 line-through":"text-gray-700 dark:text-gray-300"}`,children:s.text})]},s.id))})]}),z.jsx("div",{className:"mt-6 flex justify-end",children:z.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700",children:"Fechar"})})]})})},XI=({trips:r,drivers:e,vehicles:t,plates:i,onDeleteTrip:s})=>{const[o,u]=tt.useState(null),[h,g]=tt.useState(null),[m,v]=tt.useState(!1),[x,y]=tt.useState(null),[T,b]=tt.useState(null),[S,w]=tt.useState(null),[G,Z]=tt.useState({driver:"",vehicle:"",plate:"",date:""}),K=tt.useRef(null);tt.useEffect(()=>{const J=ye=>{K.current&&!K.current.contains(ye.target)&&v(!1)};return m&&document.addEventListener("mousedown",J),()=>{document.removeEventListener("mousedown",J)}},[m]);const ne=J=>{const Pe=new Date(J.departureTime).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return`*Motorista:* ${J.driver}
*Veículo:* ${J.vehicle}
*Placa:* ${J.plate}
*Km:* ${J.km} KM
*Origem:* ${J.origin}
*Destino:* ${J.destination}
*Data e Hora da Saída:* ${Pe}`},pe=J=>{const ye=ne(J).replace(/\*/g,"");navigator.clipboard.writeText(ye).then(()=>{u(J.id),setTimeout(()=>u(null),2e3)})},Re=J=>{const ye=ne(J),He=`https://api.whatsapp.com/send?text=${encodeURIComponent(ye)}`;window.open(He,"_blank","noopener,noreferrer")},N=J=>{const ye=setTimeout(()=>{w(J)},500);b(ye)},D=()=>{T&&(clearTimeout(T),b(null))},R=()=>{T&&(clearTimeout(T),b(null))},k=async J=>{confirm("Tem certeza que deseja excluir esta viagem?")&&(await s(J),w(null))},F=(J,ye)=>{Z(Pe=>({...Pe,[J]:ye}))},B=()=>{Z({driver:"",vehicle:"",plate:"",date:""})},P=()=>{const J=["Motorista","Veículo","Placa","KM","Origem","Destino","Data/Hora Saída"],ye=new Set;qe.forEach(q=>{var Q;(Q=q.checklist)==null||Q.forEach(oe=>ye.add(oe.text))});const Pe=Array.from(ye),He=[...J,...Pe],W=qe.map(q=>{var Ne;const oe=new Date(q.departureTime).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),de={};(Ne=q.checklist)==null||Ne.forEach(De=>{de[De.text]=De.checked});const ve={Motorista:q.driver,Veículo:q.vehicle,Placa:q.plate,KM:q.km,Origem:q.origin,Destino:q.destination,"Data/Hora Saída":oe};return Pe.forEach(De=>{De in de?ve[De]=de[De]?"OK":"NÃO OK":ve[De]=""}),ve}),xe=F1.json_to_sheet(W,{header:He}),V=F1.book_new();F1.book_append_sheet(V,xe,"Viagens");let X="viagens";if(Be){const q=[];G.driver&&q.push(`motorista_${G.driver.replace(/[^a-zA-Z0-9]/g,"_")}`),G.vehicle&&q.push(`veiculo_${G.vehicle.replace(/[^a-zA-Z0-9]/g,"_")}`),G.plate&&q.push(`placa_${G.plate.replace(/[^a-zA-Z0-9]/g,"_")}`),G.date&&q.push(`data_${G.date.replace(/[^a-zA-Z0-9]/g,"_")}`),X+=`_filtrado_${q.join("_")}`}X+=`_${new Date().toISOString().split("T")[0]}.xlsx`,II(V,X)},qe=r.filter(J=>{const ye=!G.driver||J.driver===G.driver,Pe=!G.vehicle||J.vehicle===G.vehicle,He=!G.plate||J.plate===G.plate;let W=!0;if(G.date){const xe=new Date(G.date),V=new Date(J.departureTime);W=xe.getFullYear()===V.getFullYear()&&xe.getMonth()===V.getMonth()&&xe.getDate()===V.getDate()}return ye&&Pe&&He&&W}),Be=G.driver||G.vehicle||G.plate||G.date;return r.length===0?z.jsxs("div",{className:"text-center py-10 px-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[z.jsx("h3",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Nenhuma viagem registrada"}),z.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Adicione uma nova viagem no formulário acima."})]}):z.jsxs(z.Fragment,{children:[z.jsx(qI,{trip:h,onClose:()=>g(null)}),x&&z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",children:z.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 w-80 max-h-96 overflow-y-auto",children:z.jsxs("div",{className:"p-4",children:[z.jsxs("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:["Checklist - ",x.driver]}),x.checklist&&x.checklist.length>0?z.jsx("div",{className:"space-y-3",children:x.checklist.map(J=>z.jsxs("div",{className:"flex items-center",children:[z.jsx("span",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${J.checked?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600"}`,children:J.checked&&z.jsx("svg",{className:"w-2 h-2",fill:"currentColor",viewBox:"0 0 20 20",children:z.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),z.jsx("span",{className:`ml-2 text-sm ${J.checked?"text-gray-500 dark:text-gray-400 line-through":"text-gray-700 dark:text-gray-300"}`,children:J.text})]},J.id))}):z.jsx("div",{className:"text-center py-4",children:z.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Nenhum checklist foi preenchido para esta viagem."})}),z.jsx("div",{className:"mt-4 flex justify-end",children:z.jsx("button",{onClick:()=>y(null),className:"px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Fechar"})})]})})}),z.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:[z.jsxs("div",{className:"px-4 py-3 sm:px-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[z.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Viagens ",Be&&`(${qe.length} de ${r.length})`]}),z.jsxs("div",{className:"flex items-center gap-2",children:[z.jsx("button",{onClick:P,className:"p-2 text-green-600 hover:text-green-700 dark:text-green-400 dark:hover:text-green-300 rounded-md transition-colors","aria-label":"Exportar viagens",children:z.jsx(HC,{className:"w-5 h-5"})}),z.jsx("button",{onClick:()=>v(!m),className:`p-2 rounded-md transition-colors ${Be?"text-primary-600 bg-primary-100 dark:bg-primary-900 dark:text-primary-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,"aria-label":"Filtrar viagens",children:z.jsx(zC,{className:"w-5 h-5"})})]})]}),z.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:qe.map(J=>z.jsxs("li",{className:`flex items-center justify-between px-4 py-3 sm:px-6 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors relative ${S===J.id?"bg-red-50 dark:bg-red-900/20":""}`,onClick:()=>g(J),onMouseDown:()=>N(J.id),onMouseUp:D,onMouseLeave:R,onTouchStart:()=>N(J.id),onTouchEnd:D,children:[z.jsxs("div",{className:"flex flex-col",children:[z.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-base",children:J.driver}),z.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[J.vehicle," • ",J.destination]}),z.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:[new Date(J.departureTime).toLocaleDateString("pt-BR")," ",new Date(J.departureTime).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]}),S===J.id?z.jsxs("div",{className:"flex items-center gap-2 ml-2",onClick:ye=>ye.stopPropagation(),children:[z.jsx("button",{onClick:()=>k(J.id),className:"font-medium rounded-md p-2 transition-all duration-200 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/20","aria-label":"Excluir viagem",children:z.jsx(Rc,{className:"w-5 h-5"})}),z.jsx("button",{onClick:()=>w(null),className:"font-medium rounded-md p-2 transition-all duration-200 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700","aria-label":"Cancelar exclusão",children:"✕"})]}):z.jsxs("div",{className:"flex items-center gap-2 ml-2",onClick:ye=>ye.stopPropagation(),children:[J.checklist&&J.checklist.length>0&&z.jsx("button",{onClick:()=>y(J),className:"font-medium rounded-md p-2 transition-all duration-200 text-orange-600 dark:text-orange-400 hover:bg-orange-100 dark:hover:bg-gray-700","aria-label":"Ver checklist da viagem",children:z.jsx(bE,{className:"w-5 h-5"})}),z.jsx("button",{onClick:()=>pe(J),className:`font-medium rounded-md p-2 transition-all duration-200 ${o===J.id?"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300":"text-primary-600 dark:text-primary-400 hover:bg-primary-100 dark:hover:bg-gray-700"}`,"aria-label":"Copiar dados da viagem",children:o===J.id?z.jsx("span",{className:"flex items-center gap-1",children:z.jsx(UC,{className:"w-5 h-5"})}):z.jsx("span",{className:"flex items-center gap-1",children:z.jsx(BC,{className:"w-5 h-5"})})}),z.jsx("button",{onClick:()=>Re(J),className:"font-medium rounded-md p-2 transition-all duration-200 text-[#25D366] hover:bg-green-100 dark:hover:bg-gray-700","aria-label":"Compartilhar no WhatsApp",children:z.jsx("span",{className:"flex items-center gap-1",children:z.jsx(jC,{className:"w-7 h-7"})})})]})]},J.id))}),qe.length===0&&r.length>0&&z.jsx("div",{className:"text-center py-8 px-6",children:z.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Nenhuma viagem encontrada com os filtros aplicados."})})]}),m&&z.jsx("div",{ref:K,className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",children:z.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 w-80 max-h-96 overflow-y-auto",children:z.jsxs("div",{className:"p-4",children:[z.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Filtrar Viagens"}),z.jsxs("div",{className:"space-y-3",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"filter-driver",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Motorista"}),z.jsxs("select",{id:"filter-driver",value:G.driver,onChange:J=>F("driver",J.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[z.jsx("option",{value:"",children:"Todos os motoristas"}),e.map(J=>z.jsx("option",{value:J.name,children:J.name},J.id))]})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"filter-vehicle",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Veículo"}),z.jsxs("select",{id:"filter-vehicle",value:G.vehicle,onChange:J=>F("vehicle",J.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[z.jsx("option",{value:"",children:"Todos os veículos"}),t.map(J=>z.jsx("option",{value:J.name,children:J.name},J.id))]})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"filter-plate",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Placa"}),z.jsxs("select",{id:"filter-plate",value:G.plate,onChange:J=>F("plate",J.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[z.jsx("option",{value:"",children:"Todas as placas"}),i.map(J=>z.jsx("option",{value:J.number,children:J.number},J.id))]})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"filter-date",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Data"}),z.jsx("input",{type:"date",id:"filter-date",value:G.date,onChange:J=>F("date",J.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:[color-scheme:light]"})]})]}),z.jsxs("div",{className:"mt-4 flex justify-between",children:[z.jsx("button",{onClick:B,className:"px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Limpar Filtros"}),z.jsx("button",{onClick:()=>v(!1),className:"px-3 py-1.5 text-xs font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700",children:"Fechar"})]})]})})})]})};function YI(){const[r,e]=tt.useState([]),[t,i]=tt.useState([]),[s,o]=tt.useState([]),[u,h]=tt.useState([]);tt.useEffect(()=>{const w=e0(Bi(Zn,"drivers"),t0("name")),G=r0(w,D=>{const R=[];D.forEach(k=>{R.push({id:k.id,name:k.data().name})}),e(R)}),Z=e0(Bi(Zn,"vehicles"),t0("name")),K=r0(Z,D=>{const R=[];D.forEach(k=>{R.push({id:k.id,name:k.data().name})}),i(R)}),ne=e0(Bi(Zn,"plates"),t0("number")),pe=r0(ne,D=>{const R=[];D.forEach(k=>{R.push({id:k.id,number:k.data().number})}),o(R)}),Re=e0(Bi(Zn,"trips"),t0("departureTime","desc")),N=r0(Re,D=>{const R=D.docs.map(k=>{const F=k.data(),B=F.departureTime,P=B&&typeof B.toDate=="function"?B.toDate().toISOString():String(new Date),qe={id:k.id,driver:F.driver||"",vehicle:F.vehicle||"",plate:F.plate||"",km:F.km||0,origin:F.origin||"",destination:F.destination||"",departureTime:P,checklist:F.checklist||[]};return qe.checklist&&qe.checklist.length>0&&console.log("Trip with checklist loaded:",qe.id,qe.checklist),qe});h(R)});return()=>{G(),K(),pe(),N()}},[]);const g=tt.useCallback(async w=>{try{console.log("Saving trip with checklist:",w),await Gu(Bi(Zn,"trips"),{...w,departureTime:new Date(w.departureTime)})}catch(G){console.error("Error adding trip: ",G),alert("Falha ao adicionar viagem.")}},[]),m=tt.useCallback(async w=>{try{await Hu(tl(Zn,"trips",w))}catch(G){console.error("Error deleting trip: ",G),alert("Falha ao excluir viagem.")}},[]),v=tt.useCallback(async w=>{const G=w.trim();if(G&&!r.find(Z=>Z.name.toLowerCase()===G.toLowerCase()))try{return await Gu(Bi(Zn,"drivers"),{name:G}),!0}catch(Z){return console.error("Error adding driver: ",Z),alert("Falha ao adicionar motorista."),!1}return alert("Motorista já existe ou o nome é inválido."),!1},[r]),x=tt.useCallback(async w=>{if(r.length<=1){alert("É necessário ter pelo menos um motorista.");return}try{await Hu(tl(Zn,"drivers",w))}catch(G){console.error("Error removing driver: ",G),alert("Falha ao remover motorista.")}},[r.length]),y=tt.useCallback(async w=>{const G=w.trim();if(G&&!t.find(Z=>Z.name.toLowerCase()===G.toLowerCase()))try{return await Gu(Bi(Zn,"vehicles"),{name:G}),!0}catch(Z){return console.error("Error adding vehicle: ",Z),alert("Falha ao adicionar veículo."),!1}return alert("Veículo já existe ou o nome é inválido."),!1},[t]),T=tt.useCallback(async w=>{if(t.length<=1){alert("É necessário ter pelo menos um veículo.");return}try{await Hu(tl(Zn,"vehicles",w))}catch(G){console.error("Error removing vehicle: ",G),alert("Falha ao remover veículo.")}},[t.length]),b=tt.useCallback(async w=>{const G=w.trim();if(G&&!s.find(Z=>Z.number.toLowerCase()===G.toLowerCase()))try{return await Gu(Bi(Zn,"plates"),{number:G}),!0}catch(Z){return console.error("Error adding plate: ",Z),alert("Falha ao adicionar placa."),!1}return alert("Placa já existe ou o número é inválido."),!1},[s]),S=tt.useCallback(async w=>{if(s.length<=1){alert("É necessário ter pelo menos uma placa.");return}try{await Hu(tl(Zn,"plates",w))}catch(G){console.error("Error removing plate: ",G),alert("Falha ao remover placa.")}},[s.length]);return z.jsxs("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8",children:[z.jsxs("header",{className:"text-center mb-10",children:[z.jsx("h1",{className:"text-4xl sm:text-5xl font-extrabold text-gray-800 dark:text-white tracking-tight",children:"Controle de Viagens Kalfritec"}),z.jsx("p",{className:"mt-4 text-lg text-gray-600 dark:text-gray-400",children:"Gerencie os registros de viagens por KM."})]}),z.jsxs("main",{children:[z.jsx(t6,{drivers:r,vehicles:t,plates:s,onAddTrip:g,onAddDriver:v,onRemoveDriver:x,onAddVehicle:y,onRemoveVehicle:T,onAddPlate:b,onRemovePlate:S}),z.jsx(XI,{trips:u,drivers:r,vehicles:t,plates:s,onDeleteTrip:m})]}),z.jsx("footer",{className:"text-center mt-12 py-4",children:z.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Desenvolvido por Alysson Krombauer"})})]})}const cA=document.getElementById("root");if(!cA)throw new Error("Could not find root element to mount to");const KI=X4.createRoot(cA);KI.render(z.jsx(V4.StrictMode,{children:z.jsx(YI,{})}));
